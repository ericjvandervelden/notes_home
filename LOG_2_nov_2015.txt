/ INSTALL FEDORA

/ 7	. 

[root@localhost ~]# visudo
## Same thing without a password
%wheel  ALL=(ALL)       NOPASSWD: ALL

[root@localhost ~]# usermod -a -G wheel eric

/ Ga nu rechtsboven, click 	, 
/ we zien Eric J. Van der Velden	, we click > en we kiezen logout	, 
/ log weer in als eric	, en eric zit in wheel	, en kan	, 
$ sudo su -
#

/ 7	. 

[root@localhost ~]# rsync -avz /run/media/eric/WD/almond2/home/eric/ /home/eric/ 
/ OK

/ we start ff	, we doen: restore latest session, en we zien de tabs	,

/ 7	 

/ install chrome	, 

/ Lees	,
http://www.if-not-true-then-false.com/2010/install-google-chrome-with-yum-on-fedora-red-hat-rhel/

[root@localhost ~]# cat /etc/yum.repos.d/google-chrome.repo
[google-chrome]
name=google-chrome
baseurl=http://dl.google.com/linux/chrome/rpm/stable/x86_64
enabled=1
gpgcheck=1
gpgkey=https://dl.google.com/linux/linux_signing_key.pub
~

[root@localhost ~]# yum install google-chrome-stable
Loaded plugins: langpacks
google-chrome                                               |  951 B  00:00     
Resolving Dependencies
--> Running transaction check
---> Package google-chrome-stable.x86_64 0:46.0.2490.80-1 will be installed
--> Processing Dependency: lsb >= 4.0 for package: google-chrome-stable-46.0.2490.80-1.x86_64
--> Processing Dependency: libXss.so.1()(64bit) for package: google-chrome-stable-46.0.2490.80-1.x86_64
--> Running transaction check
---> Package libXScrnSaver.x86_64 0:1.2.2-8.fc21 will be installed
---> Package redhat-lsb.x86_64 0:4.1-29.fc21 will be installed
--> Processing Dependency: redhat-lsb-printing = 4.1-29.fc21 for package: redhat-lsb-4.1-29.fc21.x86_64
--> Processing Dependency: redhat-lsb-languages = 4.1-29.fc21 for package: redhat-lsb-4.1-29.fc21.x86_64
--> Processing Dependency: redhat-lsb-desktop(x86-64) = 4.1-29.fc21 for package: redhat-lsb-4.1-29.fc21.x86_64
--> Processing Dependency: redhat-lsb-cxx(x86-64) = 4.1-29.fc21 for package: redhat-lsb-4.1-29.fc21.x86_64
--> Processing Dependency: redhat-lsb-core(x86-64) = 4.1-29.fc21 for package: redhat-lsb-4.1-29.fc21.x86_64
--> Running transaction check
---> Package redhat-lsb-core.x86_64 0:4.1-29.fc21 will be installed
--> Processing Dependency: redhat-lsb-submod-security(x86-64) = 4.1-29.fc21 for package: redhat-lsb-core-4.1-29.fc21.x86_64
--> Processing Dependency: spax for package: redhat-lsb-core-4.1-29.fc21.x86_64
--> Processing Dependency: /usr/sbin/sendmail for package: redhat-lsb-core-4.1-29.fc21.x86_64
--> Processing Dependency: /usr/bin/strip for package: redhat-lsb-core-4.1-29.fc21.x86_64
--> Processing Dependency: /usr/bin/strings for package: redhat-lsb-core-4.1-29.fc21.x86_64
--> Processing Dependency: /usr/bin/patch for package: redhat-lsb-core-4.1-29.fc21.x86_64
--> Processing Dependency: /usr/bin/m4 for package: redhat-lsb-core-4.1-29.fc21.x86_64
--> Processing Dependency: /usr/bin/ar for package: redhat-lsb-core-4.1-29.fc21.x86_64
--> Processing Dependency: /bin/mailx for package: redhat-lsb-core-4.1-29.fc21.x86_64
--> Processing Dependency: /bin/ed for package: redhat-lsb-core-4.1-29.fc21.x86_64
---> Package redhat-lsb-cxx.x86_64 0:4.1-29.fc21 will be installed
---> Package redhat-lsb-desktop.x86_64 0:4.1-29.fc21 will be installed
--> Processing Dependency: redhat-lsb-submod-multimedia(x86-64) = 4.1-29.fc21 for package: redhat-lsb-desktop-4.1-29.fc21.x86_64
--> Processing Dependency: qt3(x86-64) for package: redhat-lsb-desktop-4.1-29.fc21.x86_64
--> Processing Dependency: libpng12.so.0()(64bit) for package: redhat-lsb-desktop-4.1-29.fc21.x86_64
---> Package redhat-lsb-languages.x86_64 0:4.1-29.fc21 will be installed
--> Processing Dependency: perl(XML::LibXML) for package: redhat-lsb-languages-4.1-29.fc21.x86_64
--> Processing Dependency: perl(Text::Soundex) for package: redhat-lsb-languages-4.1-29.fc21.x86_64
--> Processing Dependency: perl(Test::Simple) for package: redhat-lsb-languages-4.1-29.fc21.x86_64
--> Processing Dependency: perl(Test::Harness) for package: redhat-lsb-languages-4.1-29.fc21.x86_64
--> Processing Dependency: perl(Sys::Syslog) for package: redhat-lsb-languages-4.1-29.fc21.x86_64
--> Processing Dependency: perl(Pod::Plainer) for package: redhat-lsb-languages-4.1-29.fc21.x86_64
--> Processing Dependency: perl(Pod::LaTeX) for package: redhat-lsb-languages-4.1-29.fc21.x86_64
--> Processing Dependency: perl(Pod::Checker) for package: redhat-lsb-languages-4.1-29.fc21.x86_64
--> Processing Dependency: perl(Locale::Maketext) for package: redhat-lsb-languages-4.1-29.fc21.x86_64
--> Processing Dependency: perl(Locale::Codes::Constants) for package: redhat-lsb-languages-4.1-29.fc21.x86_64
--> Processing Dependency: perl(Locale::Codes) for package: redhat-lsb-languages-4.1-29.fc21.x86_64
--> Processing Dependency: perl(File::CheckTree) for package: redhat-lsb-languages-4.1-29.fc21.x86_64
--> Processing Dependency: perl(Fatal) for package: redhat-lsb-languages-4.1-29.fc21.x86_64
--> Processing Dependency: perl(ExtUtils::MakeMaker) for package: redhat-lsb-languages-4.1-29.fc21.x86_64
--> Processing Dependency: perl(Env) for package: redhat-lsb-languages-4.1-29.fc21.x86_64
--> Processing Dependency: perl(Class::ISA) for package: redhat-lsb-languages-4.1-29.fc21.x86_64
--> Processing Dependency: perl(CPAN) for package: redhat-lsb-languages-4.1-29.fc21.x86_64
--> Processing Dependency: perl(CGI) for package: redhat-lsb-languages-4.1-29.fc21.x86_64
--> Processing Dependency: perl(B::Lint) for package: redhat-lsb-languages-4.1-29.fc21.x86_64
---> Package redhat-lsb-printing.x86_64 0:4.1-29.fc21 will be installed
--> Running transaction check
---> Package binutils.x86_64 0:2.24-32.fc21 will be installed
---> Package ed.x86_64 0:1.10-3.fc21 will be installed
---> Package libpng12.x86_64 0:1.2.50-8.fc21 will be installed
---> Package m4.x86_64 0:1.4.17-6.fc21 will be installed
---> Package mailx.x86_64 0:12.5-14.fc21 will be installed
---> Package patch.x86_64 0:2.7.5-1.fc21 will be installed
---> Package perl-B-Lint.noarch 0:1.18-1.fc21 will be installed
--> Processing Dependency: perl(Module::Pluggable) for package: perl-B-Lint-1.18-1.fc21.noarch
---> Package perl-CGI.noarch 0:4.03-1.fc21 will be installed
---> Package perl-CPAN.noarch 0:2.00-310.fc21 will be installed
--> Processing Dependency: perl(Digest::SHA) for package: perl-CPAN-2.00-310.fc21.noarch
---> Package perl-Class-ISA.noarch 0:0.36-1013.fc21 will be installed
---> Package perl-Env.noarch 0:1.04-292.fc21 will be installed
---> Package perl-ExtUtils-MakeMaker.noarch 0:6.98-2.fc21 will be installed
--> Processing Dependency: perl(ExtUtils::Packlist) for package: perl-ExtUtils-MakeMaker-6.98-2.fc21.noarch
--> Processing Dependency: perl(ExtUtils::Manifest) for package: perl-ExtUtils-MakeMaker-6.98-2.fc21.noarch
--> Processing Dependency: perl(ExtUtils::Installed) for package: perl-ExtUtils-MakeMaker-6.98-2.fc21.noarch
--> Processing Dependency: perl(ExtUtils::Install) for package: perl-ExtUtils-MakeMaker-6.98-2.fc21.noarch
---> Package perl-File-CheckTree.noarch 0:4.42-292.fc21 will be installed
---> Package perl-Locale-Codes.noarch 0:3.35-1.fc21 will be installed
---> Package perl-Locale-Maketext.noarch 0:1.26-1.fc21 will be installed
---> Package perl-Pod-Checker.noarch 4:1.71-2.fc21 will be installed
---> Package perl-Pod-LaTeX.noarch 0:0.61-293.fc21 will be installed
--> Processing Dependency: perl(Pod::ParseUtils) >= 0.3 for package: perl-Pod-LaTeX-0.61-293.fc21.noarch
--> Processing Dependency: perl(Pod::Select) for package: perl-Pod-LaTeX-0.61-293.fc21.noarch
--> Processing Dependency: perl(Pod::Find) for package: perl-Pod-LaTeX-0.61-293.fc21.noarch
---> Package perl-Pod-Plainer.noarch 0:1.03-7.fc21 will be installed
---> Package perl-Sys-Syslog.x86_64 0:0.33-6.fc21 will be installed
---> Package perl-Test-Harness.noarch 0:3.35-1.fc21 will be installed
---> Package perl-Test-Simple.noarch 0:1.001008-2.fc21 will be installed
---> Package perl-Text-Soundex.x86_64 0:3.04-293.fc21 will be installed
--> Processing Dependency: perl(Text::Unidecode) for package: perl-Text-Soundex-3.04-293.fc21.x86_64
---> Package perl-XML-LibXML.x86_64 1:2.0119-1.fc21 will be installed
--> Processing Dependency: perl(XML::SAX::Exception) for package: 1:perl-XML-LibXML-2.0119-1.fc21.x86_64
--> Processing Dependency: perl(XML::SAX::DocumentLocator) for package: 1:perl-XML-LibXML-2.0119-1.fc21.x86_64
--> Processing Dependency: perl(XML::SAX::Base) for package: 1:perl-XML-LibXML-2.0119-1.fc21.x86_64
--> Processing Dependency: perl(XML::NamespaceSupport) for package: 1:perl-XML-LibXML-2.0119-1.fc21.x86_64
---> Package perl-autodie.noarch 0:2.25-3.fc21 will be installed
--> Processing Dependency: perl(IPC::System::Simple) >= 0.12 for package: perl-autodie-2.25-3.fc21.noarch
---> Package qt3.x86_64 0:3.3.8b-63.fc21 will be installed
---> Package redhat-lsb-submod-multimedia.x86_64 0:4.1-29.fc21 will be installed
---> Package redhat-lsb-submod-security.x86_64 0:4.1-29.fc21 will be installed
---> Package spax.x86_64 0:1.5.3-4.fc21 will be installed
---> Package ssmtp.x86_64 0:2.64-14.fc21 will be installed
--> Running transaction check
---> Package perl-Digest-SHA.x86_64 1:5.95-1.fc21 will be installed
--> Processing Dependency: perl(Digest::base) for package: 1:perl-Digest-SHA-5.95-1.fc21.x86_64
---> Package perl-ExtUtils-Install.noarch 0:1.59-310.fc21 will be installed
--> Processing Dependency: perl-devel for package: perl-ExtUtils-Install-1.59-310.fc21.noarch
---> Package perl-ExtUtils-Manifest.noarch 0:1.63-2.fc21 will be installed
---> Package perl-IPC-System-Simple.noarch 0:1.25-2.fc21 will be installed
---> Package perl-Module-Pluggable.noarch 1:5.10-2.fc21 will be installed
---> Package perl-Pod-Parser.noarch 0:1.63-1.fc21 will be installed
---> Package perl-Text-Unidecode.noarch 0:1.24-1.fc21 will be installed
---> Package perl-XML-NamespaceSupport.noarch 0:1.11-13.fc21 will be installed
---> Package perl-XML-SAX.noarch 0:0.99-12.fc21 will be installed
--> Processing Dependency: perl(LWP::UserAgent) for package: perl-XML-SAX-0.99-12.fc21.noarch
---> Package perl-XML-SAX-Base.noarch 0:1.08-11.fc21 will be installed
--> Running transaction check
---> Package perl-Digest.noarch 0:1.17-292.fc21 will be installed
---> Package perl-devel.x86_64 4:5.18.4-310.fc21 will be installed
--> Processing Dependency: systemtap-sdt-devel for package: 4:perl-devel-5.18.4-310.fc21.x86_64
--> Processing Dependency: perl(ExtUtils::ParseXS) for package: 4:perl-devel-5.18.4-310.fc21.x86_64
--> Processing Dependency: libdb-devel for package: 4:perl-devel-5.18.4-310.fc21.x86_64
--> Processing Dependency: glibc-devel for package: 4:perl-devel-5.18.4-310.fc21.x86_64
--> Processing Dependency: gdbm-devel for package: 4:perl-devel-5.18.4-310.fc21.x86_64
---> Package perl-libwww-perl.noarch 0:6.07-1.fc21 will be installed
--> Processing Dependency: perl(WWW::RobotRules) >= 6 for package: perl-libwww-perl-6.07-1.fc21.noarch
--> Processing Dependency: perl(URI) >= 1.10 for package: perl-libwww-perl-6.07-1.fc21.noarch
--> Processing Dependency: perl(Net::HTTP) >= 6.04 for package: perl-libwww-perl-6.07-1.fc21.noarch
--> Processing Dependency: perl(LWP::MediaTypes) >= 6 for package: perl-libwww-perl-6.07-1.fc21.noarch
--> Processing Dependency: perl(HTTP::Status) >= 6 for package: perl-libwww-perl-6.07-1.fc21.noarch
--> Processing Dependency: perl(HTTP::Response) >= 6 for package: perl-libwww-perl-6.07-1.fc21.noarch
--> Processing Dependency: perl(HTTP::Request::Common) >= 6 for package: perl-libwww-perl-6.07-1.fc21.noarch
--> Processing Dependency: perl(HTTP::Request) >= 6 for package: perl-libwww-perl-6.07-1.fc21.noarch
--> Processing Dependency: perl(HTTP::Negotiate) >= 6 for package: perl-libwww-perl-6.07-1.fc21.noarch
--> Processing Dependency: perl(HTTP::Date) >= 6 for package: perl-libwww-perl-6.07-1.fc21.noarch
--> Processing Dependency: perl(HTTP::Cookies) >= 6 for package: perl-libwww-perl-6.07-1.fc21.noarch
--> Processing Dependency: perl(File::Listing) >= 6 for package: perl-libwww-perl-6.07-1.fc21.noarch
--> Processing Dependency: perl(Authen::NTLM) >= 1.02 for package: perl-libwww-perl-6.07-1.fc21.noarch
--> Processing Dependency: perl(URI::Heuristic) for package: perl-libwww-perl-6.07-1.fc21.noarch
--> Processing Dependency: perl(URI::Escape) for package: perl-libwww-perl-6.07-1.fc21.noarch
--> Processing Dependency: perl(HTTP::Headers::Util) for package: perl-libwww-perl-6.07-1.fc21.noarch
--> Processing Dependency: perl(HTTP::Config) for package: perl-libwww-perl-6.07-1.fc21.noarch
--> Processing Dependency: perl(HTML::HeadParser) for package: perl-libwww-perl-6.07-1.fc21.noarch
--> Processing Dependency: perl(HTML::Entities) for package: perl-libwww-perl-6.07-1.fc21.noarch
--> Processing Dependency: perl(Encode::Locale) for package: perl-libwww-perl-6.07-1.fc21.noarch
--> Processing Dependency: perl(Digest::MD5) for package: perl-libwww-perl-6.07-1.fc21.noarch
--> Running transaction check
---> Package gdbm-devel.x86_64 0:1.11-4.fc21 will be installed
---> Package glibc-devel.x86_64 0:2.20-8.fc21 will be installed
--> Processing Dependency: glibc-headers = 2.20-8.fc21 for package: glibc-devel-2.20-8.fc21.x86_64
--> Processing Dependency: glibc = 2.20-8.fc21 for package: glibc-devel-2.20-8.fc21.x86_64
--> Processing Dependency: glibc-headers for package: glibc-devel-2.20-8.fc21.x86_64
---> Package libdb-devel.x86_64 0:5.3.28-12.fc21 will be installed
--> Processing Dependency: libdb(x86-64) = 5.3.28-12.fc21 for package: libdb-devel-5.3.28-12.fc21.x86_64
---> Package perl-Digest-MD5.x86_64 0:2.54-2.fc21 will be installed
---> Package perl-Encode-Locale.noarch 0:1.05-1.fc21 will be installed
---> Package perl-ExtUtils-ParseXS.noarch 1:3.24-2.fc21 will be installed
---> Package perl-File-Listing.noarch 0:6.04-8.fc21 will be installed
---> Package perl-HTML-Parser.x86_64 0:3.71-6.fc21 will be installed
--> Processing Dependency: perl(HTML::Tagset) >= 3 for package: perl-HTML-Parser-3.71-6.fc21.x86_64
---> Package perl-HTTP-Cookies.noarch 0:6.01-8.fc21 will be installed
---> Package perl-HTTP-Date.noarch 0:6.02-9.fc21 will be installed
--> Processing Dependency: perl(Time::Zone) for package: perl-HTTP-Date-6.02-9.fc21.noarch
---> Package perl-HTTP-Message.noarch 0:6.11-1.fc21 will be installed
--> Processing Dependency: perl(IO::Uncompress::Bunzip2) >= 2.021 for package: perl-HTTP-Message-6.11-1.fc21.noarch
--> Processing Dependency: perl(IO::Compress::Bzip2) >= 2.021 for package: perl-HTTP-Message-6.11-1.fc21.noarch
--> Processing Dependency: perl(IO::Uncompress::RawInflate) for package: perl-HTTP-Message-6.11-1.fc21.noarch
--> Processing Dependency: perl(IO::Uncompress::Inflate) for package: perl-HTTP-Message-6.11-1.fc21.noarch
--> Processing Dependency: perl(IO::Uncompress::Gunzip) for package: perl-HTTP-Message-6.11-1.fc21.noarch
--> Processing Dependency: perl(IO::HTML) for package: perl-HTTP-Message-6.11-1.fc21.noarch
--> Processing Dependency: perl(IO::Compress::Gzip) for package: perl-HTTP-Message-6.11-1.fc21.noarch
--> Processing Dependency: perl(IO::Compress::Deflate) for package: perl-HTTP-Message-6.11-1.fc21.noarch
--> Processing Dependency: perl(Compress::Raw::Zlib) for package: perl-HTTP-Message-6.11-1.fc21.noarch
---> Package perl-HTTP-Negotiate.noarch 0:6.01-8.fc21 will be installed
---> Package perl-LWP-MediaTypes.noarch 0:6.02-5.fc21 will be installed
---> Package perl-NTLM.noarch 0:1.09-8.fc21 will be installed
--> Processing Dependency: perl(Digest::HMAC_MD5) for package: perl-NTLM-1.09-8.fc21.noarch
---> Package perl-Net-HTTP.noarch 0:6.06-5.fc21 will be installed
--> Processing Dependency: perl(IO::Socket::SSL) >= 1.38 for package: perl-Net-HTTP-6.06-5.fc21.noarch
---> Package perl-URI.noarch 0:1.65-1.fc21 will be installed
--> Processing Dependency: perl(Business::ISBN) for package: perl-URI-1.65-1.fc21.noarch
---> Package perl-WWW-RobotRules.noarch 0:6.02-9.fc21 will be installed
---> Package systemtap-sdt-devel.x86_64 0:2.9-1.fc21 will be installed
--> Processing Dependency: pyparsing for package: systemtap-sdt-devel-2.9-1.fc21.x86_64
--> Running transaction check
---> Package glibc.x86_64 0:2.20-5.fc21 will be updated
--> Processing Dependency: glibc = 2.20-5.fc21 for package: glibc-common-2.20-5.fc21.x86_64
---> Package glibc.x86_64 0:2.20-8.fc21 will be an update
---> Package glibc-headers.x86_64 0:2.20-8.fc21 will be installed
--> Processing Dependency: kernel-headers >= 2.2.1 for package: glibc-headers-2.20-8.fc21.x86_64
--> Processing Dependency: kernel-headers for package: glibc-headers-2.20-8.fc21.x86_64
---> Package libdb.x86_64 0:5.3.28-9.fc21 will be updated
--> Processing Dependency: libdb(x86-64) = 5.3.28-9.fc21 for package: libdb-utils-5.3.28-9.fc21.x86_64
---> Package libdb.x86_64 0:5.3.28-12.fc21 will be an update
---> Package perl-Business-ISBN.noarch 0:2.07-2.fc21 will be installed
--> Processing Dependency: perl(Business::ISBN::Data) >= 20120719.001 for package: perl-Business-ISBN-2.07-2.fc21.noarch
---> Package perl-Compress-Raw-Zlib.x86_64 0:2.066-2.fc21 will be installed
---> Package perl-Digest-HMAC.noarch 0:1.03-8.fc21 will be installed
---> Package perl-HTML-Tagset.noarch 0:3.20-19.fc21 will be installed
---> Package perl-IO-Compress.noarch 0:2.066-1.fc21 will be installed
--> Processing Dependency: perl(Compress::Raw::Bzip2) >= 2.066 for package: perl-IO-Compress-2.066-1.fc21.noarch
---> Package perl-IO-HTML.noarch 0:1.001-1.fc21 will be installed
---> Package perl-IO-Socket-SSL.noarch 0:2.002-1.fc21 will be installed
--> Processing Dependency: perl(Net::SSLeay) >= 1.46 for package: perl-IO-Socket-SSL-2.002-1.fc21.noarch
--> Processing Dependency: perl(IO::Socket::IP) >= 0.20 for package: perl-IO-Socket-SSL-2.002-1.fc21.noarch
--> Processing Dependency: perl(Net::SSLeay) for package: perl-IO-Socket-SSL-2.002-1.fc21.noarch
---> Package perl-TimeDate.noarch 1:2.30-4.fc21 will be installed
---> Package pyparsing.noarch 0:2.0.3-1.fc21 will be installed
--> Running transaction check
---> Package glibc-common.x86_64 0:2.20-5.fc21 will be updated
---> Package glibc-common.x86_64 0:2.20-8.fc21 will be an update
---> Package kernel-headers.x86_64 0:4.1.8-100.fc21 will be installed
---> Package libdb-utils.x86_64 0:5.3.28-9.fc21 will be updated
---> Package libdb-utils.x86_64 0:5.3.28-12.fc21 will be an update
---> Package perl-Business-ISBN-Data.noarch 0:20140910.002-1.fc21 will be installed
---> Package perl-Compress-Raw-Bzip2.x86_64 0:2.066-1.fc21 will be installed
---> Package perl-IO-Socket-IP.noarch 0:0.35-1.fc21 will be installed
---> Package perl-Net-SSLeay.x86_64 0:1.65-2.fc21 will be installed
--> Finished Dependency Resolution

Dependencies Resolved

================================================================================
 Package                      Arch   Version                Repository     Size
================================================================================
Installing:
 google-chrome-stable         x86_64 46.0.2490.80-1         google-chrome  45 M
Installing for dependencies:
 binutils                     x86_64 2.24-32.fc21           updates       5.0 M
 ed                           x86_64 1.10-3.fc21            fedora         76 k
 gdbm-devel                   x86_64 1.11-4.fc21            fedora         58 k
 glibc-devel                  x86_64 2.20-8.fc21            updates       902 k
 glibc-headers                x86_64 2.20-8.fc21            updates       489 k
 kernel-headers               x86_64 4.1.8-100.fc21         updates       996 k
 libXScrnSaver                x86_64 1.2.2-8.fc21           fedora         28 k
 libdb-devel                  x86_64 5.3.28-12.fc21         updates        43 k
 libpng12                     x86_64 1.2.50-8.fc21          fedora        156 k
 m4                           x86_64 1.4.17-6.fc21          fedora        264 k
 mailx                        x86_64 12.5-14.fc21           updates       251 k
 patch                        x86_64 2.7.5-1.fc21           updates       121 k
 perl-B-Lint                  noarch 1.18-1.fc21            fedora         25 k
 perl-Business-ISBN           noarch 2.07-2.fc21            fedora         26 k
 perl-Business-ISBN-Data      noarch 20140910.002-1.fc21    fedora         30 k
 perl-CGI                     noarch 4.03-1.fc21            fedora        204 k
 perl-CPAN                    noarch 2.00-310.fc21          updates       304 k
 perl-Class-ISA               noarch 0.36-1013.fc21         fedora        9.3 k
 perl-Compress-Raw-Bzip2      x86_64 2.066-1.fc21           fedora         37 k
 perl-Compress-Raw-Zlib       x86_64 2.066-2.fc21           updates        64 k
 perl-Digest                  noarch 1.17-292.fc21          fedora         23 k
 perl-Digest-HMAC             noarch 1.03-8.fc21            fedora         17 k
 perl-Digest-MD5              x86_64 2.54-2.fc21            updates        36 k
 perl-Digest-SHA              x86_64 1:5.95-1.fc21          updates        64 k
 perl-Encode-Locale           noarch 1.05-1.fc21            updates        21 k
 perl-Env                     noarch 1.04-292.fc21          fedora         16 k
 perl-ExtUtils-Install        noarch 1.59-310.fc21          updates        81 k
 perl-ExtUtils-MakeMaker      noarch 6.98-2.fc21            fedora        284 k
 perl-ExtUtils-Manifest       noarch 1.63-2.fc21            fedora         31 k
 perl-ExtUtils-ParseXS        noarch 1:3.24-2.fc21          fedora         82 k
 perl-File-CheckTree          noarch 4.42-292.fc21          fedora         18 k
 perl-File-Listing            noarch 6.04-8.fc21            fedora         13 k
 perl-HTML-Parser             x86_64 3.71-6.fc21            fedora        120 k
 perl-HTML-Tagset             noarch 3.20-19.fc21           fedora         18 k
 perl-HTTP-Cookies            noarch 6.01-8.fc21            fedora         26 k
 perl-HTTP-Date               noarch 6.02-9.fc21            fedora         14 k
 perl-HTTP-Message            noarch 6.11-1.fc21            updates        93 k
 perl-HTTP-Negotiate          noarch 6.01-8.fc21            fedora         17 k
 perl-IO-Compress             noarch 2.066-1.fc21           fedora        266 k
 perl-IO-HTML                 noarch 1.001-1.fc21           fedora         23 k
 perl-IO-Socket-IP            noarch 0.35-1.fc21            updates        45 k
 perl-IO-Socket-SSL           noarch 2.002-1.fc21           fedora        234 k
 perl-IPC-System-Simple       noarch 1.25-2.fc21            fedora         37 k
 perl-LWP-MediaTypes          noarch 6.02-5.fc21            fedora         24 k
 perl-Locale-Codes            noarch 3.35-1.fc21            updates       299 k
 perl-Locale-Maketext         noarch 1.26-1.fc21            updates        98 k
 perl-Module-Pluggable        noarch 1:5.10-2.fc21          fedora         30 k
 perl-NTLM                    noarch 1.09-8.fc21            fedora         20 k
 perl-Net-HTTP                noarch 6.06-5.fc21            fedora         29 k
 perl-Net-SSLeay              x86_64 1.65-2.fc21            fedora        313 k
 perl-Pod-Checker             noarch 4:1.71-2.fc21          fedora         31 k
 perl-Pod-LaTeX               noarch 0.61-293.fc21          fedora         36 k
 perl-Pod-Parser              noarch 1.63-1.fc21            updates       111 k
 perl-Pod-Plainer             noarch 1.03-7.fc21            fedora        9.4 k
 perl-Sys-Syslog              x86_64 0.33-6.fc21            fedora         47 k
 perl-Test-Harness            noarch 3.35-1.fc21            updates       309 k
 perl-Test-Simple             noarch 1.001008-2.fc21        updates       183 k
 perl-Text-Soundex            x86_64 3.04-293.fc21          fedora         24 k
 perl-Text-Unidecode          noarch 1.24-1.fc21            updates       143 k
 perl-TimeDate                noarch 1:2.30-4.fc21          fedora         52 k
 perl-URI                     noarch 1.65-1.fc21            fedora        112 k
 perl-WWW-RobotRules          noarch 6.02-9.fc21            fedora         18 k
 perl-XML-LibXML              x86_64 1:2.0119-1.fc21        updates       388 k
 perl-XML-NamespaceSupport    noarch 1.11-13.fc21           fedora         19 k
 perl-XML-SAX                 noarch 0.99-12.fc21           fedora         64 k
 perl-XML-SAX-Base            noarch 1.08-11.fc21           fedora         29 k
 perl-autodie                 noarch 2.25-3.fc21            updates        98 k
 perl-devel                   x86_64 4:5.18.4-310.fc21      updates       480 k
 perl-libwww-perl             noarch 6.07-1.fc21            fedora        212 k
 pyparsing                    noarch 2.0.3-1.fc21           updates       103 k
 qt3                          x86_64 3.3.8b-63.fc21         updates       3.5 M
 redhat-lsb                   x86_64 4.1-29.fc21            fedora         29 k
 redhat-lsb-core              x86_64 4.1-29.fc21            fedora         42 k
 redhat-lsb-cxx               x86_64 4.1-29.fc21            fedora         20 k
 redhat-lsb-desktop           x86_64 4.1-29.fc21            fedora         25 k
 redhat-lsb-languages         x86_64 4.1-29.fc21            fedora         22 k
 redhat-lsb-printing          x86_64 4.1-29.fc21            fedora         20 k
 redhat-lsb-submod-multimedia x86_64 4.1-29.fc21            fedora         20 k
 redhat-lsb-submod-security   x86_64 4.1-29.fc21            fedora         20 k
 spax                         x86_64 1.5.3-4.fc21           updates       208 k
 ssmtp                        x86_64 2.64-14.fc21           updates        55 k
 systemtap-sdt-devel          x86_64 2.9-1.fc21             updates        68 k
Updating for dependencies:
 glibc                        x86_64 2.20-8.fc21            updates       3.5 M
 glibc-common                 x86_64 2.20-8.fc21            updates        11 M
 libdb                        x86_64 5.3.28-12.fc21         updates       735 k
 libdb-utils                  x86_64 5.3.28-12.fc21         updates       108 k

Transaction Summary
================================================================================
Install  1 Package  (+82 Dependent packages)
Upgrade             (  4 Dependent packages)

Total size: 78 M
Is this ok [y/d/N]: y
Downloading packages:

//////////////////////////////////////////////////

warning: /var/cache/yum/x86_64/21/google-chrome/packages/google-chrome-stable-46.0.2490.80-1.x86_64.rpm: Header V4 DSA/SHA1 Signature, key ID 7fac5991: NOKEY
Retrieving key from https://dl-ssl.google.com/linux/linux_signing_key.pub
Importing GPG key 0x7FAC5991:
 Userid     : "Google, Inc. Linux Package Signing Key <linux-packages-keymaster@google.com>"
 Fingerprint: 4cca 1eaf 950c ee4a b839 76dc a040 830f 7fac 5991
 From       : https://dl-ssl.google.com/linux/linux_signing_key.pub
Is this ok [y/N]: y

////////////////////////////////////////////////////////

Running transaction check
Running transaction test
Transaction test succeeded
Running transaction (shutdown inhibited)
  Updating   : glibc-common-2.20-8.fc21.x86_64                             1/91 
  Updating   : glibc-2.20-8.fc21.x86_64                                    2/91 
  Installing : perl-Compress-Raw-Zlib-2.066-2.fc21.x86_64                  3/91 
  Installing : perl-Test-Harness-3.35-1.fc21.noarch                        4/91 
  Updating   : libdb-5.3.28-12.fc21.x86_64                                 5/91 
  Installing : perl-XML-SAX-Base-1.08-11.fc21.noarch                       6/91 
  Installing : perl-Pod-Parser-1.63-1.fc21.noarch                          7/91 
  Installing : perl-Encode-Locale-1.05-1.fc21.noarch                       8/91 
  Installing : perl-XML-NamespaceSupport-1.11-13.fc21.noarch               9/91 
  Installing : perl-Digest-1.17-292.fc21.noarch                           10/91 
  Installing : 1:perl-Digest-SHA-5.95-1.fc21.x86_64                       11/91 
  Installing : perl-Digest-MD5-2.54-2.fc21.x86_64                         12/91 
  Installing : perl-LWP-MediaTypes-6.02-5.fc21.noarch                     13/91 
  Installing : perl-Digest-HMAC-1.03-8.fc21.noarch                        14/91 
  Installing : perl-NTLM-1.09-8.fc21.noarch                               15/91 
  Installing : perl-Pod-LaTeX-0.61-293.fc21.noarch                        16/91 
  Installing : perl-Pod-Plainer-1.03-7.fc21.noarch                        17/91 
  Installing : libdb-devel-5.3.28-12.fc21.x86_64                          18/91 
  Installing : perl-Test-Simple-1.001008-2.fc21.noarch                    19/91 
  Installing : spax-1.5.3-4.fc21.x86_64                                   20/91 
  Installing : perl-Sys-Syslog-0.33-6.fc21.x86_64                         21/91 
  Installing : patch-2.7.5-1.fc21.x86_64                                  22/91 
  Installing : qt3-3.3.8b-63.fc21.x86_64                                  23/91 
  Installing : libXScrnSaver-1.2.2-8.fc21.x86_64                          24/91 
  Installing : libpng12-1.2.50-8.fc21.x86_64                              25/91 
  Installing : ssmtp-2.64-14.fc21.x86_64                                  26/91 
  Installing : perl-Compress-Raw-Bzip2-2.066-1.fc21.x86_64                27/91 
  Installing : perl-IO-Compress-2.066-1.fc21.noarch                       28/91 
  Installing : perl-Net-SSLeay-1.65-2.fc21.x86_64                         29/91 
  Installing : m4-1.4.17-6.fc21.x86_64                                    30/91 
  Installing : ed-1.10-3.fc21.x86_64                                      31/91 
  Installing : binutils-2.24-32.fc21.x86_64                               32/91 
  Installing : mailx-12.5-14.fc21.x86_64                                  33/91 
  Installing : perl-Locale-Maketext-1.26-1.fc21.noarch                    34/91 
  Installing : perl-Env-1.04-292.fc21.noarch                              35/91 
  Installing : perl-ExtUtils-Manifest-1.63-2.fc21.noarch                  36/91 
  Installing : redhat-lsb-submod-multimedia-4.1-29.fc21.x86_64            37/91 
  Installing : redhat-lsb-submod-security-4.1-29.fc21.x86_64              38/91 
  Installing : redhat-lsb-core-4.1-29.fc21.x86_64                         39/91 
  Installing : redhat-lsb-cxx-4.1-29.fc21.x86_64                          40/91 
  Installing : redhat-lsb-desktop-4.1-29.fc21.x86_64                      41/91 
  Installing : redhat-lsb-printing-4.1-29.fc21.x86_64                     42/91 
  Installing : perl-IPC-System-Simple-1.25-2.fc21.noarch                  43/91 
  Installing : perl-autodie-2.25-3.fc21.noarch                            44/91 
  Installing : perl-HTML-Tagset-3.20-19.fc21.noarch                       45/91 
  Installing : kernel-headers-4.1.8-100.fc21.x86_64                       46/91 
  Installing : glibc-headers-2.20-8.fc21.x86_64                           47/91 
  Installing : glibc-devel-2.20-8.fc21.x86_64                             48/91 
  Installing : perl-File-CheckTree-4.42-292.fc21.noarch                   49/91 
  Installing : 1:perl-TimeDate-2.30-4.fc21.noarch                         50/91 
  Installing : perl-HTTP-Date-6.02-9.fc21.noarch                          51/91 
  Installing : perl-File-Listing-6.04-8.fc21.noarch                       52/91 
  Installing : perl-IO-Socket-IP-0.35-1.fc21.noarch                       53/91 
  Installing : gdbm-devel-1.11-4.fc21.x86_64                              54/91 
  Installing : 4:perl-Pod-Checker-1.71-2.fc21.noarch                      55/91 
  Installing : perl-CGI-4.03-1.fc21.noarch                                56/91 
  Installing : perl-Class-ISA-0.36-1013.fc21.noarch                       57/91 
  Installing : 1:perl-Module-Pluggable-5.10-2.fc21.noarch                 58/91 
  Installing : perl-B-Lint-1.18-1.fc21.noarch                             59/91 
  Installing : perl-Locale-Codes-3.35-1.fc21.noarch                       60/91 
  Installing : pyparsing-2.0.3-1.fc21.noarch                              61/91 
  Installing : systemtap-sdt-devel-2.9-1.fc21.x86_64                      62/91 
  Installing : perl-ExtUtils-MakeMaker-6.98-2.fc21.noarch                 63/91 
  Installing : perl-ExtUtils-Install-1.59-310.fc21.noarch                 64/91 
  Installing : 1:perl-ExtUtils-ParseXS-3.24-2.fc21.noarch                 65/91 
  Installing : 4:perl-devel-5.18.4-310.fc21.x86_64                        66/91 
  Installing : perl-CPAN-2.00-310.fc21.noarch                             67/91 
  Installing : perl-IO-HTML-1.001-1.fc21.noarch                           68/91 
  Installing : perl-Business-ISBN-Data-20140910.002-1.fc21.noarch         69/91 
  Installing : perl-Business-ISBN-2.07-2.fc21.noarch                      70/91 
  Installing : perl-URI-1.65-1.fc21.noarch                                71/91 
  Installing : perl-HTTP-Message-6.11-1.fc21.noarch                       72/91 
  Installing : perl-HTTP-Cookies-6.01-8.fc21.noarch                       73/91 
  Installing : perl-HTML-Parser-3.71-6.fc21.x86_64                        74/91 
  Installing : perl-HTTP-Negotiate-6.01-8.fc21.noarch                     75/91 
  Installing : perl-WWW-RobotRules-6.02-9.fc21.noarch                     76/91 
  Installing : perl-IO-Socket-SSL-2.002-1.fc21.noarch                     77/91 
  Installing : perl-Net-HTTP-6.06-5.fc21.noarch                           78/91 
  Installing : perl-libwww-perl-6.07-1.fc21.noarch                        79/91 
  Installing : perl-XML-SAX-0.99-12.fc21.noarch                           80/91 
  Installing : 1:perl-XML-LibXML-2.0119-1.fc21.x86_64                     81/91 
  Installing : perl-Text-Unidecode-1.24-1.fc21.noarch                     82/91 
  Installing : perl-Text-Soundex-3.04-293.fc21.x86_64                     83/91 
  Installing : redhat-lsb-languages-4.1-29.fc21.x86_64                    84/91 
  Installing : redhat-lsb-4.1-29.fc21.x86_64                              85/91 
  Installing : google-chrome-stable-46.0.2490.80-1.x86_64                 86/91 
Redirecting to /bin/systemctl start  atd.service
  Updating   : libdb-utils-5.3.28-12.fc21.x86_64                          87/91 
  Cleanup    : libdb-utils-5.3.28-9.fc21.x86_64                           88/91 
  Cleanup    : libdb-5.3.28-9.fc21.x86_64                                 89/91 
  Cleanup    : glibc-common-2.20-5.fc21.x86_64                            90/91 
  Cleanup    : glibc-2.20-5.fc21.x86_64                                   91/91 
  Verifying  : perl-LWP-MediaTypes-6.02-5.fc21.noarch                      1/91 
  Verifying  : libdb-5.3.28-12.fc21.x86_64                                 2/91 
  Verifying  : spax-1.5.3-4.fc21.x86_64                                    3/91 
  Verifying  : perl-Text-Unidecode-1.24-1.fc21.noarch                      4/91 
  Verifying  : perl-B-Lint-1.18-1.fc21.noarch                              5/91 
  Verifying  : perl-Business-ISBN-2.07-2.fc21.noarch                       6/91 
  Verifying  : perl-WWW-RobotRules-6.02-9.fc21.noarch                      7/91 
  Verifying  : perl-Business-ISBN-Data-20140910.002-1.fc21.noarch          8/91 
  Verifying  : perl-Digest-1.17-292.fc21.noarch                            9/91 
  Verifying  : systemtap-sdt-devel-2.9-1.fc21.x86_64                      10/91 
  Verifying  : perl-IO-HTML-1.001-1.fc21.noarch                           11/91 
  Verifying  : perl-IO-Compress-2.066-1.fc21.noarch                       12/91 
  Verifying  : perl-Compress-Raw-Zlib-2.066-2.fc21.x86_64                 13/91 
  Verifying  : perl-Text-Soundex-3.04-293.fc21.x86_64                     14/91 
  Verifying  : perl-Digest-HMAC-1.03-8.fc21.noarch                        15/91 
  Verifying  : perl-Sys-Syslog-0.33-6.fc21.x86_64                         16/91 
  Verifying  : perl-XML-SAX-0.99-12.fc21.noarch                           17/91 
  Verifying  : perl-XML-NamespaceSupport-1.11-13.fc21.noarch              18/91 
  Verifying  : glibc-2.20-8.fc21.x86_64                                   19/91 
  Verifying  : redhat-lsb-cxx-4.1-29.fc21.x86_64                          20/91 
  Verifying  : perl-ExtUtils-MakeMaker-6.98-2.fc21.noarch                 21/91 
  Verifying  : pyparsing-2.0.3-1.fc21.noarch                              22/91 
  Verifying  : patch-2.7.5-1.fc21.x86_64                                  23/91 
  Verifying  : redhat-lsb-core-4.1-29.fc21.x86_64                         24/91 
  Verifying  : perl-NTLM-1.09-8.fc21.noarch                               25/91 
  Verifying  : perl-Encode-Locale-1.05-1.fc21.noarch                      26/91 
  Verifying  : google-chrome-stable-46.0.2490.80-1.x86_64                 27/91 
  Verifying  : perl-Locale-Codes-3.35-1.fc21.noarch                       28/91 
  Verifying  : 1:perl-Module-Pluggable-5.10-2.fc21.noarch                 29/91 
  Verifying  : glibc-common-2.20-8.fc21.x86_64                            30/91 
  Verifying  : perl-HTTP-Cookies-6.01-8.fc21.noarch                       31/91 
  Verifying  : qt3-3.3.8b-63.fc21.x86_64                                  32/91 
  Verifying  : perl-Class-ISA-0.36-1013.fc21.noarch                       33/91 
  Verifying  : perl-URI-1.65-1.fc21.noarch                                34/91 
  Verifying  : perl-CGI-4.03-1.fc21.noarch                                35/91 
  Verifying  : 4:perl-Pod-Checker-1.71-2.fc21.noarch                      36/91 
  Verifying  : perl-File-Listing-6.04-8.fc21.noarch                       37/91 
  Verifying  : gdbm-devel-1.11-4.fc21.x86_64                              38/91 
  Verifying  : perl-ExtUtils-Install-1.59-310.fc21.noarch                 39/91 
  Verifying  : 1:perl-ExtUtils-ParseXS-3.24-2.fc21.noarch                 40/91 
  Verifying  : redhat-lsb-desktop-4.1-29.fc21.x86_64                      41/91 
  Verifying  : glibc-devel-2.20-8.fc21.x86_64                             42/91 
  Verifying  : perl-IO-Socket-IP-0.35-1.fc21.noarch                       43/91 
  Verifying  : 1:perl-TimeDate-2.30-4.fc21.noarch                         44/91 
  Verifying  : perl-File-CheckTree-4.42-292.fc21.noarch                   45/91 
  Verifying  : perl-Pod-LaTeX-0.61-293.fc21.noarch                        46/91 
  Verifying  : kernel-headers-4.1.8-100.fc21.x86_64                       47/91 
  Verifying  : perl-HTML-Parser-3.71-6.fc21.x86_64                        48/91 
  Verifying  : 4:perl-devel-5.18.4-310.fc21.x86_64                        49/91 
  Verifying  : libXScrnSaver-1.2.2-8.fc21.x86_64                          50/91 
  Verifying  : libdb-utils-5.3.28-12.fc21.x86_64                          51/91 
  Verifying  : perl-libwww-perl-6.07-1.fc21.noarch                        52/91 
  Verifying  : perl-CPAN-2.00-310.fc21.noarch                             53/91 
  Verifying  : perl-Test-Harness-3.35-1.fc21.noarch                       54/91 
  Verifying  : libpng12-1.2.50-8.fc21.x86_64                              55/91 
  Verifying  : perl-HTTP-Message-6.11-1.fc21.noarch                       56/91 
  Verifying  : perl-IO-Socket-SSL-2.002-1.fc21.noarch                     57/91 
  Verifying  : ssmtp-2.64-14.fc21.x86_64                                  58/91 
  Verifying  : perl-HTML-Tagset-3.20-19.fc21.noarch                       59/91 
  Verifying  : perl-IPC-System-Simple-1.25-2.fc21.noarch                  60/91 
  Verifying  : redhat-lsb-submod-security-4.1-29.fc21.x86_64              61/91 
  Verifying  : perl-Compress-Raw-Bzip2-2.066-1.fc21.x86_64                62/91 
  Verifying  : redhat-lsb-submod-multimedia-4.1-29.fc21.x86_64            63/91 
  Verifying  : redhat-lsb-languages-4.1-29.fc21.x86_64                    64/91 
  Verifying  : perl-Net-SSLeay-1.65-2.fc21.x86_64                         65/91 
  Verifying  : libdb-devel-5.3.28-12.fc21.x86_64                          66/91 
  Verifying  : perl-Test-Simple-1.001008-2.fc21.noarch                    67/91 
  Verifying  : perl-Pod-Parser-1.63-1.fc21.noarch                         68/91 
  Verifying  : 1:perl-Digest-SHA-5.95-1.fc21.x86_64                       69/91 
  Verifying  : perl-autodie-2.25-3.fc21.noarch                            70/91 
  Verifying  : perl-Digest-MD5-2.54-2.fc21.x86_64                         71/91 
  Verifying  : glibc-headers-2.20-8.fc21.x86_64                           72/91 
  Verifying  : perl-ExtUtils-Manifest-1.63-2.fc21.noarch                  73/91 
  Verifying  : perl-HTTP-Negotiate-6.01-8.fc21.noarch                     74/91 
  Verifying  : perl-Env-1.04-292.fc21.noarch                              75/91 
  Verifying  : redhat-lsb-4.1-29.fc21.x86_64                              76/91 
  Verifying  : 1:perl-XML-LibXML-2.0119-1.fc21.x86_64                     77/91 
  Verifying  : m4-1.4.17-6.fc21.x86_64                                    78/91 
  Verifying  : ed-1.10-3.fc21.x86_64                                      79/91 
  Verifying  : perl-Locale-Maketext-1.26-1.fc21.noarch                    80/91 
  Verifying  : binutils-2.24-32.fc21.x86_64                               81/91 
  Verifying  : redhat-lsb-printing-4.1-29.fc21.x86_64                     82/91 
  Verifying  : perl-Net-HTTP-6.06-5.fc21.noarch                           83/91 
  Verifying  : perl-Pod-Plainer-1.03-7.fc21.noarch                        84/91 
  Verifying  : mailx-12.5-14.fc21.x86_64                                  85/91 
  Verifying  : perl-XML-SAX-Base-1.08-11.fc21.noarch                      86/91 
  Verifying  : perl-HTTP-Date-6.02-9.fc21.noarch                          87/91 
  Verifying  : libdb-utils-5.3.28-9.fc21.x86_64                           88/91 
  Verifying  : glibc-common-2.20-5.fc21.x86_64                            89/91 
  Verifying  : glibc-2.20-5.fc21.x86_64                                   90/91 
  Verifying  : libdb-5.3.28-9.fc21.x86_64                                 91/91 

Installed:
  google-chrome-stable.x86_64 0:46.0.2490.80-1                                  

Dependency Installed:
  binutils.x86_64 0:2.24-32.fc21                                                
  ed.x86_64 0:1.10-3.fc21                                                       
  gdbm-devel.x86_64 0:1.11-4.fc21                                               
  glibc-devel.x86_64 0:2.20-8.fc21                                              
  glibc-headers.x86_64 0:2.20-8.fc21                                            
  kernel-headers.x86_64 0:4.1.8-100.fc21                                        
  libXScrnSaver.x86_64 0:1.2.2-8.fc21                                           
  libdb-devel.x86_64 0:5.3.28-12.fc21                                           
  libpng12.x86_64 0:1.2.50-8.fc21                                               
  m4.x86_64 0:1.4.17-6.fc21                                                     
  mailx.x86_64 0:12.5-14.fc21                                                   
  patch.x86_64 0:2.7.5-1.fc21                                                   
  perl-B-Lint.noarch 0:1.18-1.fc21                                              
  perl-Business-ISBN.noarch 0:2.07-2.fc21                                       
  perl-Business-ISBN-Data.noarch 0:20140910.002-1.fc21                          
  perl-CGI.noarch 0:4.03-1.fc21                                                 
  perl-CPAN.noarch 0:2.00-310.fc21                                              
  perl-Class-ISA.noarch 0:0.36-1013.fc21                                        
  perl-Compress-Raw-Bzip2.x86_64 0:2.066-1.fc21                                 
  perl-Compress-Raw-Zlib.x86_64 0:2.066-2.fc21                                  
  perl-Digest.noarch 0:1.17-292.fc21                                            
  perl-Digest-HMAC.noarch 0:1.03-8.fc21                                         
  perl-Digest-MD5.x86_64 0:2.54-2.fc21                                          
  perl-Digest-SHA.x86_64 1:5.95-1.fc21                                          
  perl-Encode-Locale.noarch 0:1.05-1.fc21                                       
  perl-Env.noarch 0:1.04-292.fc21                                               
  perl-ExtUtils-Install.noarch 0:1.59-310.fc21                                  
  perl-ExtUtils-MakeMaker.noarch 0:6.98-2.fc21                                  
  perl-ExtUtils-Manifest.noarch 0:1.63-2.fc21                                   
  perl-ExtUtils-ParseXS.noarch 1:3.24-2.fc21                                    
  perl-File-CheckTree.noarch 0:4.42-292.fc21                                    
  perl-File-Listing.noarch 0:6.04-8.fc21                                        
  perl-HTML-Parser.x86_64 0:3.71-6.fc21                                         
  perl-HTML-Tagset.noarch 0:3.20-19.fc21                                        
  perl-HTTP-Cookies.noarch 0:6.01-8.fc21                                        
  perl-HTTP-Date.noarch 0:6.02-9.fc21                                           
  perl-HTTP-Message.noarch 0:6.11-1.fc21                                        
  perl-HTTP-Negotiate.noarch 0:6.01-8.fc21                                      
  perl-IO-Compress.noarch 0:2.066-1.fc21                                        
  perl-IO-HTML.noarch 0:1.001-1.fc21                                            
  perl-IO-Socket-IP.noarch 0:0.35-1.fc21                                        
  perl-IO-Socket-SSL.noarch 0:2.002-1.fc21                                      
  perl-IPC-System-Simple.noarch 0:1.25-2.fc21                                   
  perl-LWP-MediaTypes.noarch 0:6.02-5.fc21                                      
  perl-Locale-Codes.noarch 0:3.35-1.fc21                                        
  perl-Locale-Maketext.noarch 0:1.26-1.fc21                                     
  perl-Module-Pluggable.noarch 1:5.10-2.fc21                                    
  perl-NTLM.noarch 0:1.09-8.fc21                                                
  perl-Net-HTTP.noarch 0:6.06-5.fc21                                            
  perl-Net-SSLeay.x86_64 0:1.65-2.fc21                                          
  perl-Pod-Checker.noarch 4:1.71-2.fc21                                         
  perl-Pod-LaTeX.noarch 0:0.61-293.fc21                                         
  perl-Pod-Parser.noarch 0:1.63-1.fc21                                          
  perl-Pod-Plainer.noarch 0:1.03-7.fc21                                         
  perl-Sys-Syslog.x86_64 0:0.33-6.fc21                                          
  perl-Test-Harness.noarch 0:3.35-1.fc21                                        
  perl-Test-Simple.noarch 0:1.001008-2.fc21                                     
  perl-Text-Soundex.x86_64 0:3.04-293.fc21                                      
  perl-Text-Unidecode.noarch 0:1.24-1.fc21                                      
  perl-TimeDate.noarch 1:2.30-4.fc21                                            
  perl-URI.noarch 0:1.65-1.fc21                                                 
  perl-WWW-RobotRules.noarch 0:6.02-9.fc21                                      
  perl-XML-LibXML.x86_64 1:2.0119-1.fc21                                        
  perl-XML-NamespaceSupport.noarch 0:1.11-13.fc21                               
  perl-XML-SAX.noarch 0:0.99-12.fc21                                            
  perl-XML-SAX-Base.noarch 0:1.08-11.fc21                                       
  perl-autodie.noarch 0:2.25-3.fc21                                             
  perl-devel.x86_64 4:5.18.4-310.fc21                                           
  perl-libwww-perl.noarch 0:6.07-1.fc21                                         
  pyparsing.noarch 0:2.0.3-1.fc21                                               
  qt3.x86_64 0:3.3.8b-63.fc21                                                   
  redhat-lsb.x86_64 0:4.1-29.fc21                                               
  redhat-lsb-core.x86_64 0:4.1-29.fc21                                          
  redhat-lsb-cxx.x86_64 0:4.1-29.fc21                                           
  redhat-lsb-desktop.x86_64 0:4.1-29.fc21                                       
  redhat-lsb-languages.x86_64 0:4.1-29.fc21                                     
  redhat-lsb-printing.x86_64 0:4.1-29.fc21                                      
  redhat-lsb-submod-multimedia.x86_64 0:4.1-29.fc21                             
  redhat-lsb-submod-security.x86_64 0:4.1-29.fc21                               
  spax.x86_64 0:1.5.3-4.fc21                                                    
  ssmtp.x86_64 0:2.64-14.fc21                                                   
  systemtap-sdt-devel.x86_64 0:2.9-1.fc21                                       

Dependency Updated:
  glibc.x86_64 0:2.20-8.fc21          glibc-common.x86_64 0:2.20-8.fc21        
  libdb.x86_64 0:5.3.28-12.fc21       libdb-utils.x86_64 0:5.3.28-12.fc21      

Complete!
[root@localhost ~]# yum list installed *chrome*
Loaded plugins: langpacks
Installed Packages
google-chrome-stable.x86_64            46.0.2490.80-1             @google-chrome

/ we zien de chrome icon	, 

/ 7	. 

[eric@localhost ~]$ sudo hostnamectl set-hostname almond.nuts.org

[eric@localhost ~]$ sudo vi /etc/hosts
...
192.168.123.182 almond.nuts.org almond
fe80::2e44:fdff:fe68:82d4 almond.nuts.org almond

/ 7	.
[eric@localhost ~]$ sudo vi /etc/selinux/config 
#SELINUX=enforcing
SELINUX=permissive

/ 7	. 

# sudo su -
# yum update
  Updating   : 1:java-1.8.0-openjdk-headless-1.8.0.65-3.b17.fc21.x8    349/1502 
warning: /usr/lib/jvm/java-1.8.0-openjdk-1.8.0.65-3.b17.fc21.x86_64/jre/lib/security/US_export_policy.jar created as /usr/lib/jvm/java-1.8.0-openjdk-1.8.0.65-3.b17.fc21.x86_64/jre/lib/security/US_export_policy.jar.rpmnew
warning: /usr/lib/jvm/java-1.8.0-openjdk-1.8.0.65-3.b17.fc21.x86_64/jre/lib/security/java.security created as /usr/lib/jvm/java-1.8.0-openjdk-1.8.0.65-3.b17.fc21.x86_64/jre/lib/security/java.security.rpmnew
warning: /usr/lib/jvm/java-1.8.0-openjdk-1.8.0.65-3.b17.fc21.x86_64/jre/lib/security/local_policy.jar created as /usr/lib/jvm/java-1.8.0-openjdk-1.8.0.65-3.b17.fc21.x86_64/jre/lib/security/local_policy.jar.rpmnew
  Updating   : javapackages-tools-4.1.0-8.fc21.noarch                  350/1502 

[root@almond ~]#  yum list installed *java*
Loaded plugins: langpacks
Installed Packages
abrt-java-connector.x86_64         1.1.0-2.fc21          @koji-override-0/$releasever
java-1.8.0-openjdk-headless.x86_64 1:1.8.0.65-3.b17.fc21 @updates               
javapackages-tools.noarch          4.1.0-8.fc21          @updates               
python-javapackages.noarch         4.1.0-8.fc21          @updates               
tzdata-java.noarch                 2015g-1.fc21          @updates               

/ 7	. 

[eric@almond ~]$ g++
bash: g++: command not found...
Install package 'gcc-c++' to provide command 'g++'? [N/y] 
/ TODO

[eric@almond ~]$ sudo yum install gcc-c++

/ 7	. 

/ 13	.

/ Lees	,
http://linuxlove.eu/howto-view-system-logs-fedora-21-journalctl-examples/

[root@almond ~]# journalctl -u gdm.service 
/ TODO

/ 1333	. 

/ Lees	,
http://superuser.com/questions/444236/fedora-keyboard-unresponsive-after-wake-up-in-vaio-laptop

To automatically rebind keyboard after resume, open your /etc/default/grub file with your favorite text editor and and append atkbd.reset to the kernel line, like this:

GRUB_CMDLINE_LINUX="... atkbd.reset"

Don't forget to run grub2-mkconfig. Consequently, the system will take care of resetting the driver on resume.

/ Lees	,
http://forums.fedoraforum.org/showthread.php?t=283236
# make your grub config
grub2-mkconfig > /boot/grub2/grub.cfg

/ Kijk naar /etc/default/grub en /boot/grub2/grub.cfg

/ 13	. 

/ Lees	,
https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=626426



/ Einde INSTALL FEDORA

/ WILDFLY

/ twitter jboss developer	,
http://blog.eisele.net/2015/10/wildfly-swarm-jax-rs-microservice-on-docker.html?m=1
https://rpestano.wordpress.com/2015/11/08/test-your-rest-endpoints-inside-the-container-arqtip-1/
https://rpestano.wordpress.com/2014/11/08/arquillian-cucumber-dbunit/

/ twitter gupta
https://github.com/javaee-samples/docker-java
https://htmlpreview.github.io/?https://github.com/javaee-samples/docker-java/blob/master/readme.html

/ google: jboss developer kubernetes docker	,
https://access.redhat.com/articles/1353773
http://www.slideshare.net/arungupta1/package-your-java-ee-application-using-docker-and-kubernetes

/ google: gupta kubernetes docket wildfly
https://github.com/arun-gupta/kubernetes-java-sample
https://github.com/arun-gupta/docker-images/tree/master/wildfly-mysql-javaee7
http://blog.arungupta.me/openshift-v3-getting-started-javaee7-wildfly-mysql/

/ twitter  red hat jboss
/ -> http://developers.redhat.com/promotions/distributed-javaee-architecture/?tcUser=Eric+J.+Van+der+Velden&tcDownloadFileName=Modern_Java_EE_Design_Patterns_Red_Hat.pdf&tcRedirect=5000&tcSrcLink=https%3A%2F%2Fwww.jboss.org%2Fdownload-manager%2Fcontent%2Forigin%2Ffiles%2Fsha256%2Fa3%2Fa3ff84543ab8a8e303c85c584c978e6d9f2183539f2afa2c564a7b30645bdae1%2FModern_Java_EE_Design_Patterns_Red_Hat.pdf&p=Modern+Java+EE+Design+Patterns&pv=Modern+Java+EE+Design+Patterns&tcDownloadURL=https%3A%2F%2Faccess.cdn.redhat.com%2Fcontent%2Forigin%2Ffiles%2Fsha256%2Fa3%2Fa3ff84543ab8a8e303c85c584c978e6d9f2183539f2afa2c564a7b30645bdae1%2FModern_Java_EE_Design_Patterns_Red_Hat.pdf%3F_auth_%3D1447102136_a17fd56ff96e339ee207782589556f9a
/ we hebben download	,
[eric@almond Logs]$ mv ~/Downloads/Modern_Java_EE_Design_Patterns_Red_Hat.pdf ~/Documents/

/ twitter red hat jboss	,
http://www.redhat.com/en/about/blog/container-stack-openstack-part-1-2

http://planet.jboss.org/post/4_day_docker_and_kubernetes_training

/ google: gupta kubernetes docker
https://www.youtube.com/watch?v=R2nj1vRjLwE



/ Einde WILDFLY

/ FEDORA

[eric@almond Logs]$ sudo yum install vim
Installing:
 vim-enhanced         x86_64       2:7.4.827-1.fc21         updates       1.1 M
Installing for dependencies:
 gpm-libs             x86_64       1.20.7-6.fc21            fedora         36 k
 vim-common           x86_64       2:7.4.827-1.fc21         updates       6.0 M
 vim-filesystem       x86_64       2:7.4.827-1.fc21         updates        22 k

/ Einde FEDORA

/ DOCKER INSTALL LOCAL GOOGLE CLOUD

/ 7	. 

 we zijn op	,
https://docs.docker.com

/ click linker menu	, 
Docker Engine
/ we zien 
Install
/ we zien 
On Linux distributions
/ we zien 
Installatin on Fedora

/ install on fedora	,

/ Lees	,
https://docs.docker.com/engine/installation/fedora/

[eric@almond Docker2]$ < /etc/group grep eric
wheel:x:10:eric
eric:x:1000:eric
/ TODO

# cat >/etc/yum.repos.d/docker.repo <<-EOF
[dockerrepo]
name=Docker Repository
baseurl=https://yum.dockerproject.org/repo/main/fedora/21
enabled=1
gpgcheck=1
gpgkey=https://yum.dockerproject.org/gpg
EOF

/ Intermezzo

$ sudo cat >/etc/yum.repos.d/docker.repo <<-EOF
...
bash: /etc/yum.repos.d/docker.repo: Permission denied
/ WH omdat de sudo alleen voor cat geldt	, niet voor de >	, 

/ Er staat nu in de docs	,

$ sudo tee /etc/yum.repos.d/docker.repo <<-'EOF'
...
/ Einde Intermezzo


[eric@almond Docker2]$ sudo yum install docker-engine
Installing:
 docker-engine             x86_64     1.9.0-1.fc21       dockerrepo     8.2 M
Installing for dependencies:
 docker-engine-selinux     noarch     1.9.0-1.fc21       dockerrepo      25 k

Is this ok [y/d/N]: y
Downloading packages:
warning: /var/cache/yum/x86_64/21/dockerrepo/packages/docker-engine-selinux-1.9.0-1.fc21.noarch.rpm: Header V4 RSA/SHA512 Signature, key ID 2c52609d: NOKEY
Public key for docker-engine-selinux-1.9.0-1.fc21.noarch.rpm is not installed
(1/2): docker-engine-selinux-1.9.0-1.fc21.noarch.rpm      |  25 kB  00:00     
(2/2): docker-engine-1.9.0-1.fc21.x86_64.rpm              | 8.2 MB  00:13     
------------------------------------------------------------------------------
Total                                            641 kB/s | 8.2 MB  00:13     
Retrieving key from https://yum.dockerproject.org/gpg
Importing GPG key 0x2C52609D:
 Userid     : "Docker Release Tool (releasedocker) <docker@docker.com>"
 Fingerprint: 5811 8e89 f3a9 1289 7c07 0adb f762 2157 2c52 609d
 From       : https://yum.dockerproject.org/gpg
Is this ok [y/N]: 
y
Running transaction check
Running transaction test
Transaction test succeeded
Running transaction (shutdown inhibited)
  Installing : docker-engine-selinux-1.9.0-1.fc21.noarch                  1/2 
  Installing : docker-engine-1.9.0-1.fc21.x86_64                          2/2 
  Verifying  : docker-engine-selinux-1.9.0-1.fc21.noarch                  1/2 
  Verifying  : docker-engine-1.9.0-1.fc21.x86_64                          2/2 

Installed:
  docker-engine.x86_64 0:1.9.0-1.fc21                                         

Dependency Installed:
  docker-engine-selinux.noarch 0:1.9.0-1.fc21                                 


[eric@almond Docker2]$ sudo systemctl status docker
[eric@almond Docker2]$ sudo systemctl enable docker
Created symlink from /etc/systemd/system/multi-user.target.wants/docker.service to /usr/lib/systemd/system/docker.service.

[eric@almond Docker2]$ docker run hello-world
Unable to find image 'hello-world:latest' locally
latest: Pulling from library/hello-world

b901d36b6f2f: Pull complete 
0a6ba66e537a: Pull complete 
Digest: sha256:8be990ef2aeb16dbcb9271ddfe2610fa6658d13f6dfb8bc72074cc1ca36966a7
Status: Downloaded newer image for hello-world:latest

Hello from Docker.
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the "hello-world" image from the Docker Hub.
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

Share images, automate workflows, and more with a free Docker Hub account:
 https://hub.docker.com

For more examples and ideas, visit:
 https://docs.docker.com/userguide/

/ 7	. 

/ rechtsboven 



/ 7. 

/ install on google cloud	

/ Lees	,
https://docs.docker.com/engine/installation/google/

/ 'Google cloud console'	, 
https://cloud.google.com/console
/=
https://console.cloud.google.com/project

/ 'Compute engine enabled'	, 
https://developers.google.com/compute/docs/signup
/=
https://cloud.google.com/compute/docs/quickstart

/ See GOOGLE CLOUD bij 1ste 7	. 
https://cloud.google.com/compute/docs/quickstart

/ we hebben voor studie 'Web server project' al create	,

/ 13	. 

/we zijn nog op	,
https://docs.docker.com/engine/installation/google/

/ click 'Google Cloud SDK'	,
https://cloud.google.com/sdk/
/ See GOOGLE CLOUD SDK
/ De project id is:  web-server-project-1148

$ curl -sSL https://sdk.cloud.google.com | bash
$ gcloud auth login
$ gcloud config set project <google-cloud-project-id>
/ Al , met $ gcloud init	,

/ we zien de link 'Container optimized image'	 
https://cloud.google.com/compute/docs/containers

/ Lees ook	,
https://cloud.google.com/compute/docs/load-balancing/

/ Intermezzo

/ Ga naar	,
https://cloud.google.com/docs/
/ we zien App engine, Compute engine, Container engine	,

/ Einde Intermezzo

/ Lees	,
https://cloud.google.com/compute/docs/containers
/ er is	Container engine,  
https://cloud.google.com/container-engine/docs/
/ en Container VMs	, dit zijn Container-optimized Google Compute Engine images	,

[eric@almond Logs]$ gcloud compute instances create --help
SYNOPSIS
    gcloud compute instances create NAME [NAME ...] [--boot-disk-auto-delete]
        [--boot-disk-device-name BOOT_DISK_DEVICE_NAME]
        [--boot-disk-size BOOT_DISK_SIZE] [--boot-disk-type BOOT_DISK_TYPE]
        [--can-ip-forward] [--custom-cpu CUSTOM_CPU]
        [--custom-memory CUSTOM_MEMORY] [--description DESCRIPTION]
        [--disk [PROPERTY=VALUE,...]]
        [--image IMAGE | centos-6 | centos-7 | container-vm | coreos | debian-7
          | debian-7-backports | debian-8 | opensuse-13 | rhel-6 | rhel-7
          | sles-11 | sles-12 | ubuntu-12-04 | ubuntu-14-04 | ubuntu-15-04
          | ubuntu-15-10 | windows-2008-r2 | windows-2012-r2]
...

/ we doen container-vm	, precies de bedoeling	,
/ Hoe maken we deze zelf, heeft fedora deze ook	?
/ TODO

/ Lees	, 
https://docs.docker.com/engine/installation/google/
////////////////////////////////////////////////////
/ we zien de link 'Container-optimized image'	,
https://cloud.google.com/compute/docs/containers#container-optimized_google_compute_engine_images
/ we zien link	' Kubernetes home page.',
http://kubernetes.io/gettingstarted/
/ TODO
/ we zien de link 'Container-Optimized Images page.
https://cloud.google.com/compute/docs/containers/container_vms
/ Dit is precies wat de Docker doc page uses	, https://docs.docker.com/engine/installation/google/

/ Ga ook naar	,
https://www.docker.com/docker-community

 /13	. 

/ we  lezen 	,
https://cloud.google.com/compute/docs/containers/container_vms

[eric@almond default]$ gcloud compute images list --project google-containers
NAME                                PROJECT           ALIAS              DEPRECATED STATUS
container-vm-v20151215              google-containers container-vm                  READY
centos-6-v20151104                  centos-cloud      centos-6                      READY
centos-7-v20151104                  centos-cloud      centos-7                      READY
coreos-alpha-899-1-0-v20151218      coreos-cloud                                    READY
coreos-beta-877-1-0-v20151202       coreos-cloud                                    READY
coreos-stable-835-9-0-v20151208     coreos-cloud      coreos                        READY
backports-debian-7-wheezy-v20151104 debian-cloud      debian-7-backports            READY
debian-7-wheezy-v20151104           debian-cloud      debian-7                      READY
debian-8-jessie-v20151104           debian-cloud      debian-8                      READY
container-vm-v20151215              google-containers container-vm                  READY
opensuse-13-1-v20150822             opensuse-cloud    opensuse-13                   READY
opensuse-13-2-v20150511             opensuse-cloud    opensuse-13                   READY
opensuse-leap-42-1-v20151124        opensuse-cloud                                  READY
rhel-6-v20151104                    rhel-cloud        rhel-6                        READY
rhel-7-v20151104                    rhel-cloud        rhel-7                        READY
sles-11-sp4-v20150714               suse-cloud        sles-11                       READY
sles-12-sp1-v20151215               suse-cloud        sles-12                       READY
ubuntu-1204-precise-v20151119       ubuntu-os-cloud   ubuntu-12-04                  READY
ubuntu-1404-trusty-v20151113        ubuntu-os-cloud   ubuntu-14-04                  READY
ubuntu-1504-vivid-v20151120         ubuntu-os-cloud   ubuntu-15-04                  READY
ubuntu-1510-wily-v20151114          ubuntu-os-cloud   ubuntu-15-10                  READY
windows-server-2008-r2-dc-v20151006 windows-cloud     windows-2008-r2               READY
windows-server-2012-r2-dc-v20151006 windows-cloud     windows-2012-r2               READY

[eric@almond default]$ gcloud compute instances create --help
     --machine-type MACHINE_TYPE
        Specifies the machine type used for the instances. To get a list of
        available machine types, run 'gcloud compute machine-types list'. If

NAME           ZONE           CPUS MEMORY_GB DEPRECATED
f1-micro       europe-west1-b 1     0.60



/ 13	. 
[eric@almond Logs]$ gcloud compute instances create docker-playground --image container-vm --machine-type f1-micro
Created [https://www.googleapis.com/compute/v1/projects/web-server-project-1148/zones/europe-west1-c/instances/docker-playground].
NAME              ZONE           MACHINE_TYPE PREEMPTIBLE INTERNAL_IP EXTERNAL_IP   STATUS
docker-playground europe-west1-c f1-micro                 10.240.0.2  104.155.20.71 RUNNING
/ --zone europe-west1-c hoeft NIET	,


/ Ga naar 
https://console.developers.google.com/home/dashboard?project=web-server-project-1148
/ menu, Compute Engine	,
/ Hij staat erbij	,
/ OK

[eric@almond Logs]$ gcloud compute ssh --zone europe-west1-c docker-playground
WARNING: You do not have an SSH key for Google Compute Engine.
WARNING: [/usr/bin/ssh-keygen] will be executed to generate a key.
Generating public/private rsa key pair.
Enter passphrase (empty for no passphrase): 
Enter same passphrase again: 
Your identification has been saved in /home/eric/.ssh/google_compute_engine.
Your public key has been saved in /home/eric/.ssh/google_compute_engine.pub.
The key fingerprint is:
SHA256:hVk5YH5lliSFsL4NwJkZB5k20CzRxzcN9qrR7M+hDOo eric@almond.nuts.org
The key's randomart image is:
+---[RSA 2048]----+
|    o*o==o=B*.   |
|    ..OOo***o    |
|     o*o=.oo.    |
|       o = .     |
|        S +      |
|         B       |
|        + o .    |
|       . o + .   |
|     .E   o o    |
+----[SHA256]-----+
Updated [https://www.googleapis.com/compute/v1/projects/web-server-project-1148].
Warning: Permanently added '104.155.20.71' (ECDSA) to the list of known hosts.
Warning: Permanently added '104.155.20.71' (ECDSA) to the list of known hosts.
Linux docker-playground 3.16.0-0.bpo.4-amd64 #1 SMP Debian 3.16.7-ckt11-1+deb8u4~bpo70+1 (2015-09-22) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
/ OK

/ docker-playground is een VM, die is zoals mijn fedora op mijn laptop	,

eric@docker-playground:~$ docker images
REPOSITORY                       TAG                 IMAGE ID            CREATED             VIRTUAL SIZE
gcr.io/google_containers/pause   0.8.0               2c40b0526b63        9 months ago        241.7 kB
eric@docker-playground:~$ docker ps -a 
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES

eric@docker-playground:~$ docker run hello-world
Unable to find image 'hello-world:latest' locally
latest: Pulling from library/hello-world
b901d36b6f2f: Pull complete 
0a6ba66e537a: Pull complete 
Digest: sha256:8be990ef2aeb16dbcb9271ddfe2610fa6658d13f6dfb8bc72074cc1ca36966a7
Status: Downloaded newer image for hello-world:latest

Hello from Docker.
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the "hello-world" image from the Docker Hub.
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

Share images, automate workflows, and more with a free Docker Hub account:
 https://hub.docker.com

For more examples and ideas, visit:
 https://docs.docker.com/userguide/

eric@docker-playground:~$ 
/ OK

/ Komt uit docker hub	,
https://hub.docker.com/_/hello-world/
/ ->
https://github.com/docker-library/hello-world



/ we zien de link 'deploying Containers on Google Cloud Platform'	, 
https://cloud.google.com/compute/docs/containers

/ op de GUI we delete de VM	, 
/ we zien op onze command line	, we herhalen de laatste regel	,

eric@docker-playground:~$ 
Broadcast message from root@docker-playground (Mon Dec  7 20:38:03 2015):

Power button pressed 
The system is going down for system halt NOW!

Broadcast message from root@docker-playground (Mon Dec  7 20:38:03 2015):

Power button pressed 
The system is going down for system halt NOW!
Connection to 104.155.20.71 closed by remote host.
Connection to 104.155.20.71 closed.
ERROR: (gcloud.compute.ssh) [/usr/bin/ssh] exited with return code [255]. See https://cloud.google.com/compute/docs/troubleshooting#ssherrors for troubleshooting hints.

/ delete a vm	,
eric@almond default]$ gcloud compute instances delete docker-playground
The following instances will be deleted. Attached disks configured to 
be auto-deleted will be deleted unless they are attached to any other 
instances. Deleting a disk is irreversible and any data on the disk 
will be lost.
 - [docker-playground] in [europe-west1-c]

Do you want to continue (Y/n)?  Y

Deleted [https://www.googleapis.com/compute/v1/projects/web-server-project-1148/zones/europe-west1-c/instances/docker-playground].

/ 13	. 

/ Lees	,
https://cloud.google.com/compute/docs/containers/container_vms

[eric@almond my]$ pwd
/home/eric/Devel/Cloud/Google/my
[eric@almond my]$ vi containers.yaml

apiVersion: v1
kind: Pod
metadata:
    name: simple-echo
spec:
    containers:
        -   name: simple-echo
            image: gcr.io/google-containers/busybox
            command: ['nc','-p','8080','-l','-l','-e','echo','hello world']
            imagePullPolicy: Always
            ports:
                -   containerPort: 8080
                    hostPort: 8080

/ NB. 
///////////////////////////////
/ In yaml files moet achter de : een space	,

[eric@almond my]$ gcloud compute instances delete container-vm-test1

[eric@almond my]$ gcloud compute instances create container-vm-test1 \
--image container-vm \
--metadata-from-file google-container-manifest=containers.yaml \
--machine-type=f1-micro

Created [https://www.googleapis.com/compute/v1/projects/web-server-project-1148/zones/europe-west1-c/instances/container-vm-test1].
NAME               ZONE           MACHINE_TYPE PREEMPTIBLE INTERNAL_IP EXTERNAL_IP    STATUS
container-vm-test1 europe-west1-c f1-micro                 10.240.0.2  104.155.28.136 RUNNING

[eric@almond my]$ gcloud compute ssh container-vm-test1
Warning: Permanently added '104.155.28.136' (ECDSA) to the list of known hosts.
Linux container-vm-test1 3.16.0-0.bpo.4-amd64 #1 SMP Debian 3.16.7-ckt11-1+deb8u6~bpo70+1 (2015-11-11) x86_64

eric@container-vm-test1:~$ docker ps -a
CONTAINER ID        IMAGE                                  COMMAND                  CREATED             STATUS              PORTS                    NAMES
01c691c26868        gcr.io/google-containers/busybox       "nc -p 8080 -l -l -e "   12 seconds ago      Up 11 seconds                                k8s_simple-echo.88391439_simple-echo-container-vm-test1_default_dedaf2e990d8c296563d6cbff3cb1a81_708fbb2c
25b1dc8611a1        gcr.io/google_containers/pause:0.8.0   "/pause"                 16 seconds ago      Up 15 seconds       0.0.0.0:8080->8080/tcp   k8s_POD.839d01d9_simple-echo-container-vm-test1_default_dedaf2e990d8c296563d6cbff3cb1a81_6f708157

eric@container-vm-test1:~$ ps ajx --width 2000
 PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND
    1  2095  2095  2095 ?           -1 Ss       0   0:00 /usr/bin/python /usr/bin/supervisord -c /etc/supervisor/supervisord.conf
    1  2243  2240  2240 ?           -1 Sl       0   0:00 /usr/bin/docker -d -p /var/run/docker.pid -H unix:// -r=false
    1  2538  2538  2538 ?           -1 Ss       0   0:00 startpar -f -- google-accounts-manager
    1  2541  2537  2537 ?           -1 S        0   0:00 /usr/bin/python /usr/share/google/google_daemon/manage_accounts.py --daemon
    1  2553  2548  2548 ?           -1 S        0   0:00 /usr/bin/python /usr/share/google/google_daemon/manage_addresses.py
    1  2564  2561  2561 ?           -1 S        0   0:00 /usr/bin/python /usr/share/google/google_daemon/manage_clock_sync.py
    1  2586  2582  2582 ?           -1 Sl       0   0:02 /usr/local/bin/kubelet --manifest-url=http://metadata.google.internal/computeMetadata/v1/instance/attributes/google-container-manifest --manifest-url-header=Metadata-Flavor:Google --config=/etc/kubernetes/manifests
 2243  2757  2240  2240 ?           -1 Sl       0   0:00 docker-proxy -proto tcp -host-ip 0.0.0.0 -host-port 8080 -container-ip 172.17.0.1 -container-port 8080
 2243  2772  2772  2772 ?           -1 Ssl      0   0:00 /pause
 2243  2813  2813  2813 ?           -1 Ss       0   0:00 nc -p 8080 -l -l -e echo hello world!
 2541  2851  2537  2537 ?           -1 S        0   0:00 /usr/bin/python /usr/share/google/google_daemon/manage_accounts.py --daemon

eric@container-vm-test1:~$ nc localhost 8080
hello world!

/ 13	. 

/ Terug naar,	
https://cloud.google.com/compute/docs/gcloud-compute
/ TODO (Afmaken)

/ 7	. 




 




/ 7	. 

Docker Machine

Docker Compose

Docker Swarm

/ TODO

/ Einde DOCKER INSTALL LOCAL GOOGLE CLOUD

/ DOCKER JAVA

/ 7	.

/ Lees op twitter	,
http://www.toptal.com/devops/getting-started-with-docker-simplifying-devops?hootPostID=2508a01e5c033bae75e65a8dff619036&mkt_tok=3RkMMJWWfF9wsRonuqTMZKXonjHpfsX57ewlUa%200lMI%2F0ER3fOvrPUfGjI4ATsZnI%20SLDwEYGJlv6SgFQ7LMMaZq1rgMXBk%3D

/ Zoek in hub.docker.com naar phusion	, met Stars	,
https://hub.docker.com/r/phusion/baseimage/
/ Ga naar	,
https://github.com/phusion/baseimage-docker/find/master
/ we zien 
Vagrantfile
image/Dockerfile
/ TODO

/ 7	. 

/ we zien dat official java in debian is	, maar er is ook	,

https://hub.docker.com/r/jboss/wildfly/
/ ->
https://github.com/jboss-dockerfiles/wildfly/blob/master/Dockerfile
$ vi Dockerfile
FROM jboss/base-jdk:8
/ deze moeten we in docker hub zoeken, niet in github	,
https://hub.docker.com/r/jboss/base-jdk/
/ Zoek naar base-jdk onder 'automated' of 'stars'	,
/ we kunnen ook vinden in github	,
https://github.com/jboss-dockerfiles?utf8=%E2%9C%93&query=base-jdk 
$ vi Dockerfile
FROM jboss/base:latest
RUN yum -y install java-1.7.0-openjdk-devel && yum clean all
/ Zoek in docker hub naar jboss/base	,
https://hub.docker.com/r/jboss/base/
$ vi Dockerfile
FROM centos:7

////////////////////////
/ dus als je java wilt met redhat	, ipv. debian , moet je jboss/base-jdk:8 nemen	,

/ 7	.

/ Lees	over h2	,
https://hub.docker.com/r/zhilvis/h2-db/~/dockerfile/

/ Lees	,
https://medium.com/@hlship/containing-the-database-620b079aea79#.8a5evsgvl

/ 7	.

[eric@almond java]$ pwd
/home/eric/Devel/Docker2/java
[eric@almond java]$ cat PingPong.java 

import java.io.IOException;
import java.io.OutputStream;
import java.net.InetSocketAddress;
import com.sun.net.httpserver.HttpExchange;
import com.sun.net.httpserver.HttpHandler;
import com.sun.net.httpserver.HttpServer;

public class PingPong {

    public static void main(String[] args) throws Exception {
        HttpServer server = HttpServer.create(new InetSocketAddress(8080), 0);
        server.createContext("/ping", new MyHandler());
        server.setExecutor(null);
        server.start();
    }

    static class MyHandler implements HttpHandler {
        @Override
        public void handle(HttpExchange t) throws IOException {
            String response = "pong\n";
            t.sendResponseHeaders(200, response.length());
            OutputStream os = t.getResponseBody();
            os.write(response.getBytes());
            os.close();
        }
    }
}

/ 13	. 

https://docs.oracle.com/javase/8/
/ we zien link naar	,
http://docs.oracle.com/javase/8/docs/api/

/ maar er is ook	,
http://docs.oracle.com/javase/8/docs/jre/api/net/httpserver/spec/index.html?overview-summary.html
/ Hoe kom je daar	?

[eric@almond java]$ docker build --rm -t my/pingpong .
Sending build context to Docker daemon 3.584 kB
Step 1 : FROM java:8
8: Pulling from library/java

5e5f21412e19: Pull complete 
df82ac64861d: Pull complete 
ce5064412ef8: Pull complete 
46cb1e153bac: Pull complete 
65e700d53fe2: Pull complete 
e4c1902ba8e2: Pull complete 
041291567735: Pull complete 
38bbdcdf22d3: Pull complete 
ee4c5fbd36c4: Pull complete 
d4849089125b: Pull complete 
Digest: sha256:465e27bf9447f09839c7003bcfb77e13ca015a814f88ebd1d28b7a98920f4830
Status: Downloaded newer image for java:8
 ---> d4849089125b
Step 2 : COPY PingPong.java /
 ---> d8af1a25835f
Removing intermediate container b007c54f6096
Step 3 : RUN javac PingPong.java
 ---> Running in 1716007f73ea
 ---> 81b041ac6d9f
Removing intermediate container 1716007f73ea
Step 4 : EXPOSE 8080
 ---> Running in 5ee345f22cb5
 ---> d0e45d7f4e3c
Removing intermediate container 5ee345f22cb5
Step 5 : ENTRYPOINT java
 ---> Running in ba4ac0be1b4b
 ---> 5d3523cc31a3
Removing intermediate container ba4ac0be1b4b
Step 6 : CMD PingPong
 ---> Running in 7e8ee91708a9
 ---> 72a848b5361a
Removing intermediate container 7e8ee91708a9
Successfully built 72a848b5361a

[eric@almond java]$  docker run -d  --name pingpong -p 8080:8080 my/pingpong
[eric@almond java]$ curl http://localhost:8080/ping
pong

/ we kunnen ook	,
[eric@almond java]$ docker exec -it pingpong /bin/bash
root@ba4bc7a47d39:/# curl http://localhost:8080/ping
pong

/ de naam die je aan exec geeft is dus die we met docker run meegaven met --name	, het is de name van de container,	 my/pingpong is de name van de image	,

/ ook	,
root@ba4bc7a47d39:/# ls  
PingPong$MyHandler.class  bin	etc   lib64  opt   run	 sys  var
PingPong.class		  boot	home  media  proc  sbin  tmp
PingPong.java		  dev	lib   mnt    root  srv	 usr
root@ba4bc7a47d39:/# ps ajx
 PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND
    0     1     1     1 ?           -1 Ssl      0   0:00 java PingPong
    0    25    25    25 ?           35 Ss       0   0:00 /bin/bash

/ 13	. 

/ als je de computer uitzet	, en weer start , is de container Exited	.
/ doe daarom	,
[eric@almond Docker]$ docker start pingpong
pingpong
[eric@almond Docker]$ curl http://localhost:8080/ping
pong

/ 13	. 

[eric@almond java]$ docker images | awk '/<none>/{print $3}' | xargs docker rmi 

/ 13	. 


/ als je een bestaande image opnieuw build	, overwrite hij hem	,
[eric@almond java]$ docker build --rm -t my/pingpong .
[eric@almond java]$ docker images | awk '/pingpong/'
my/pingpong             latest              4875d7d0f840        6 minutes ago       641.9 MB

/ 7	. 

/ Lees	over entrypoint	,
https://docs.docker.com/engine/articles/dockerfile_best-practices/

https://docs.docker.com/engine/reference/builder/#entrypoint 

https://www.ctl.io/developers/blog/post/dockerfile-entrypoint-vs-cmd/

/ 7	.  

https://www.ctl.io/developers/blog/post/dockerfile-entrypoint-vs-cmd/

/ 13	. 

/ we set in de Dockerfile GEEN entrypoint en cmd	,
/ we geven cmd zelf mee	bij run container	,

[eric@almond java]$ pwd
/home/eric/Devel/Docker2/java

[eric@almond java]$ vi Dockerfile 
FROM java:8
COPY PingPong.java /
RUN javac PingPong.java
EXPOSE 8080

[eric@almond java]$ docker run -d -p 8080:8080 --name pingpong my/pingpong

[eric@almond java]$ docker run -d -p 8080:8080 --name pingpong my/pingpong java PingPong
[eric@almond java]$ curl http://localhost:8080/ping
pong

/ 13	. 

/ we kunnen in Dockerfile	,

FROM java:8
COPY PingPong.java /
RUN javac PingPong.java
EXPOSE 8080
CMD ["java","PingPong"]

/ of	,

FROM java:8
COPY PingPong.java /
RUN javac PingPong.java
EXPOSE 8080
ENTRYPOINT ["java"]
CMD ["PingPong"]

/ wat is het verschil?

/ 7	.

/ Lees	,
https://www.ctl.io/developers/blog/post/dockerfile-entrypoint-vs-cmd/

/ 13.

$ cat Dockerfile
from debian
cmd ping localhost

[eric@almond misc]$ docker build --rm -t misc .

[eric@almond misc]$ pwd
/home/eric/Devel/Docker2/misc
[eric@almond misc]$ docker run --rm --name misc -t misc 
PING localhost (127.0.0.1): 56 data bytes
64 bytes from 127.0.0.1: icmp_seq=0 ttl=64 time=0.049 ms
64 bytes from 127.0.0.1: icmp_seq=1 ttl=64 time=0.102 ms
...
[eric@almond misc]$ docker exec -it misc /bin/bash
root@a1afd2cffbbc:/# ps ajx
 PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND
    0     1     1     1 ?            1 Ss+      0   0:00 /bin/sh -c ping localho
    1     8     1     1 ?            1 S+       0   0:00 ping localhost
    0     9     9     9 ?           16 Ss       0   0:00 /bin/bash
    9    16    16     9 ?           16 R+       0   0:00 ps ajx

/ als we geen -t geven aan run hierboven	, zien we geen PING regels	,


/ 1313	.

[eric@almond misc]$ docker run --rm --name misc -t misc $(hostname)
exec: "almond.nuts.org": executable file not found in $PATH
[eric@almond misc]$ docker run --rm --name misc -t misc ping $(hostname)
PING almond.nuts.org (69.172.201.208): 56 data bytes
^C
[eric@almond misc]$ docker exec -it misc /bin/bash
root@3fd32913a562:/# ps ajx
 PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND
    0     1     1     1 ?            1 Ss+      0   0:00 ping almond.nuts.org
    0     9     9     9 ?           17 Ss       0   0:00 /bin/bash
    9    17    17     9 ?           17 R+       0   0:00 ps ajx

/ op laptop	,
[eric@almond misc]$ host almond.nuts.org
almond.nuts.org has address 69.172.201.208
/ een internet address	,

/ 1313

[eric@almond misc]$ docker run --rm --name misc -t misc hostname
a78eaec1cfe0
[eric@almond misc]$

[eric@almond misc]$ docker run --rm --name misc -t  --entrypoint hostname misc
0243992bc92e
[eric@almond misc]$

/ 13	. 

$ cat Dockerfile

from debian
cmd ["ping","localhost"]

[eric@almond misc]$ docker build --rm -t misc .
[eric@almond misc]$ docker run --rm --name misc -t misc
PING localhost (127.0.0.1): 56 data bytes
64 bytes from 127.0.0.1: icmp_seq=0 ttl=64 time=0.061 ms
64 bytes from 127.0.0.1: icmp_seq=1 ttl=64 time=0.104 ms
...
^c
[eric@almond misc]docker ps -a
CONTAINER ID        IMAGE               COMMAND             CREATED              STATUS              PORTS               NAMES
7b0e26464740        misc                "ping localhost"    About a minute ago   Up About a minute                       misc

/De container is nog Up	,
/ TODO

/ Als we 
$ docker stop misc
/ hoeven we NIET docker rm misc	, omdat we docker run --rm hebben 	,

/ we kunnnen	,
[eric@almond misc]$ docker exec -it misc /bin/bash
root@7b0e26464740:/# ps ajx
 PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND
    0     1     1     1 ?            1 Ss+      0   0:00 ping localhost
    0     9     9     9 ?           17 Ss       0   0:00 /bin/bash
    9    17    17     9 ?           17 R+       0   0:00 ps ajx

[eric@almond misc]$ docker run --rm --name misc -t misc -c 3
exec: "-c": executable file not found in $PATH
/ Dit kan wel als ping locahost in entrypoint staat	, dan wordt -c 3 erbij gevoegd	,


/ 13	. 

$ cat Dockerfile

from debian
entrypoint ping
cmd localhost


[eric@almond misc]$ docker build --rm -t misc .
[eric@almond misc]$ docker run --rm --name misc -t misc
ping: missing host operand

/ 1313	.

$ cat Dockerfile

from debian
entrypoint ["ping"]
cmd ["localhost"]

[eric@almond misc]$ docker build --rm -t misc .
[eric@almond misc]$ docker run --rm --name misc -t misc
PING localhost (127.0.0.1): 56 data bytes
64 bytes from 127.0.0.1: icmp_seq=0 ttl=64 time=0.062 ms
64 bytes from 127.0.0.1: icmp_seq=1 ttl=64 time=0.116 ms
...

[eric@almond misc]$ docker exec -it misc /bin/bash
root@4ffb07326a54:/# ps ajx
 PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND
    0     1     1     1 ?            1 Ss+      0   0:00 ping localhost
    0     8     8     8 ?           16 Ss       0   0:00 /bin/bash
    8    16    16     8 ?           16 R+       0   0:00 ps ajx


/ 1313	.

$ cat Dockerfile

from debian
entrypoint ["ping"]
cmd localhost 

[eric@almond misc]$ docker build --rm -t misc .
[eric@almond misc]$ docker run --rm --name misc -t misc
ping: invalid value (`localhost' near `localhost')

/ 1313	.

$ cat Dockerfile

from debian
entrypoint ping
cmd ["localhost"]

[eric@almond misc]$ docker build --rm -t misc .
[eric@almond misc]$ docker run --rm --name misc -t misc
Try 'ping --help' or 'ping --usage' for more information.

















 


/ Einde DOCKER JAVA

/ JBOSS

https://developer.jboss.org/blogs/weekly-editorial/2015/12/31/this-week-in-jboss-31th-december-2015-happy-new-year

/ Einde JBOSS

/ DOCKER MANUAL AGAIN DOCKER2

/ 7	. 

/ Na Install in menu komt 
/ Docker Fundamentals	, 
/ Quickstart containers

/ Lees	,
https://docs.docker.com/engine/userguide/basics/

[eric@almond Docker2]$  pwd
/home/eric/Devel/Docker2

[eric@almond Docker2]$ docker info
Containers: 1
Images: 2
Server Version: 1.9.1
Storage Driver: devicemapper
 Pool Name: docker-253:1-2504345-pool
 Pool Blocksize: 65.54 kB
 Base Device Size: 107.4 GB
 Backing Filesystem: 
 Data file: /dev/loop0
 Metadata file: /dev/loop1
 Data Space Used: 1.822 GB
 Data Space Total: 107.4 GB
 Data Space Available: 44.87 GB
 Metadata Space Used: 1.577 MB
 Metadata Space Total: 2.147 GB
 Metadata Space Available: 2.146 GB
 Udev Sync Supported: true
 Deferred Removal Enabled: false
 Deferred Deletion Enabled: false
 Deferred Deleted Device Count: 0
 Data loop file: /var/lib/docker/devicemapper/devicemapper/data
 Metadata loop file: /var/lib/docker/devicemapper/devicemapper/metadata
 Library Version: 1.02.109 (2015-09-22)
Execution Driver: native-0.2
Logging Driver: json-file
Kernel Version: 4.2.6-301.fc23.x86_64
Operating System: Fedora 23 (Workstation Edition)
CPUs: 4
Total Memory: 15.55 GiB
Name: almond.nuts.org
ID: 3ZYS:Z6KE:DPOK:OSSW:4VZ7:F5ZM:ITHC:7KPB:ENKW:2OST:NPL4:7XIM

/ 13	. 

eric@almond Docker2]$ docker pull ubuntu
Using default tag: latest
latest: Pulling from library/ubuntu
0a85502c06c9: Pull complete 
0998bf8fb9e9: Pull complete 
a6785352b25c: Pull complete 
e9ae3c220b23: Pull complete 
Digest: sha256:f91f9bab1fe6d0db0bfecc751d127a29d36e85483b1c68e69a246cf1df9b4251
Status: Downloaded newer image for ubuntu:latest

/ we kunnen naar de GUI gaan	,
https://hub.docker.com/
/ zoek op wildfly	, 
jboss/wildfly
/ click details	,

/zoek op ubuntu	,
/ click details	,
/ we zien tab Repo info	,
/ we zien list van 4 Docker file	, click van latest de link (ernaast)	,
https://github.com/tianon/docker-brew-ubuntu-core/blob/3852ef7c7e841ea8c126c9b00e64eeca61fe5ab0/trusty/Dockerfile
/ we zien de docker file	,

/ 13	. 

/ weer terug	,

[eric@almond Docker2]$ docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             VIRTUAL SIZE
ubuntu              latest              e9ae3c220b23        4 weeks ago         187.9 MB


[eric@almond Docker2]$ docker run -it ubuntu /bin/bash
root@4e6d4d9d6a54:/#  ctrl+pq
$ 
/ Maar de container is nog steeds Up (doe docker ps -a)	, 
/ Beter is om # exit 	, dan is de container Exited (doe docker ps -a)	, 

[eric@almond Docker2]$ docker rm -f $(awk 'NR>1{print $1}' <(docker ps -a))
/ of	,
[eric@almond Docker2]$ docker ps -a  | awk 'NR>1{print $1}'  | xargs docker rm -f
4e6d4d9d6a54
dd7abfc378cf
39992ad88f79
/ alle containers worden allen verwijderd	,

/ Intermezzo

/ **
[eric@almond Docker2]$ docker images  | awk 'NR>1{print $1}'
/ is zoals	,
[eric@almond Docker2]$ awk 'NR>1{print $1}'  < <(docker images)

/ *
/ Maar hoe doe je met pipes	,
[eric@almond Docker2]$ awk 'NR>1{print $1}'  <(docker images)
/ Hierin is	,
[eric@almond Docker2]$ echo <(docker images)
/dev/fd/63
/ dit is de naam van de file	,

/ we kunnen 	,
[eric@almond Docker2]$ docker images >/tmp/images
[eric@almond Docker2]$ awk 'NR>1{print $1}'  /tmp/images		/ *
[eric@almond Docker2]$ awk 'NR>1{print $1}' < /tmp/images		/ **


/ Einde Intermezzo

/ zo verwijder je een image	,

[eric@almond Docker2]$ docker rmi 0a6ba66e537a
Untagged: hello-world:latest
Deleted: 0a6ba66e537a53a5ea94f7c6a99c534c6adb12e3ed09326d4bf3b38f7c3ba4e7
Deleted: b901d36b6f2fd759c362819c595301ca981622654e7ea8a1aac893fbd2740b4c

[eric@almond Docker2]$ docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             VIRTUAL SIZE
ubuntu              latest              e9ae3c220b23        4 weeks ago         187.9 MB

/ 13	. 

[eric@almond Docker2]$ docker run --rm ubuntu /bin/sh -c 'while true;do echo Hello, world!;sleep 1;done'
Hello, world!
Hello, world!
Hello, world!
Hello, world!
Hello, world!
Hello, world!
^C
[eric@almond Docker2]$  docker ps -a
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES


/ 13	. 

[eric@almond Docker2]$  JOB=$(docker run -d ubuntu /bin/sh -c "while true; do echo Hello world; sleep 1; done")
[eric@almond Docker2]$ echo "$JOB"
9b6a6d838153292cbe1b1cbb48c65617e40580f04b3d1a4055111695cf8e535a
[eric@almond Docker2]$ docker ps -a
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMES
9b6a6d838153        ubuntu              "/bin/sh -c 'while tr"   24 seconds ago      Up 23 seconds                           boring_swartz
[eric@almond Docker2]$ docker logs "$JOB"
Hello world
Hello world
...
[eric@almond Docker2]$ docker stop "$JOB"
9b6a6d838153292cbe1b1cbb48c65617e40580f04b3d1a4055111695cf8e535a
[eric@almond Docker2]$ docker ps -a
CONTAINER ID        IMAGE               COMMAND                  CREATED              STATUS                       PORTS               NAMES
9b6a6d838153        ubuntu              "/bin/sh -c 'while tr"   About a minute ago   Exited (137) 4 seconds ago                       boring_swartz

[eric@almond Docker2]$ docker start "$JOB"
9b6a6d838153292cbe1b1cbb48c65617e40580f04b3d1a4055111695cf8e535a
[eric@almond Docker2]$ docker ps -a
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMES
9b6a6d838153        ubuntu              "/bin/sh -c 'while tr"   About an hour ago   Up 22 seconds                           boring_swartz
[eric@almond Docker2]$ docker stop "$JOB"
9b6a6d838153292cbe1b1cbb48c65617e40580f04b3d1a4055111695cf8e535a
[eric@almond Docker2]$ docker ps -a
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                       PORTS               NAMES
9b6a6d838153        ubuntu              "/bin/sh -c 'while tr"   About an hour ago   Exited (137) 2 seconds ago                       boring_swartz

[eric@almond Docker2]$ docker rm "$JOB"
9b6a6d838153292cbe1b1cbb48c65617e40580f04b3d1a4055111695cf8e535a
[eric@almond Docker2]$ docker ps -a
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES

[eric@almond Docker2]$  JOB=$(docker run -d ubuntu /bin/sh -c "while true; do echo Hello world; sleep 1; done")
[eric@almond Docker2]$ docker ps -a
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMES
4f72260c3545        ubuntu              "/bin/sh -c 'while tr"   4 seconds ago       Up 2 seconds                            gloomy_albattani
[eric@almond Docker2]$ docker stop "$JOB"
4f72260c35451a3a263ff8128ef21356690e9bf16af78d3f5c5dd3de767efa15
[eric@almond Docker2]$ docker ps -a
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                       PORTS               NAMES
4f72260c3545        ubuntu              "/bin/sh -c 'while tr"   26 seconds ago      Exited (137) 3 seconds ago                       gloomy_albattani

/ 13	. 

/ als we niet -d 	, 

[eric@almond Docker2]$  docker run ubuntu /bin/sh -c "while true; do echo hello world; sleep 1; done"
hello world
hello world
...
^c
$ 
/ De container is dan Exited	, dus alsof we docker stop <container name> hebben gedaan	, alleen het gaat veel sneller dan docker stop <container name>
/ TODO

/ 13	. 

/ wat is het verschil tussen stop en kill?

So stop attempts to trigger a graceful shutdown by sending the standard POSIX signal SIGTERM, whereas killjust kills the process by default (but also allows to send any other signal. 

/ Lees	,
http://superuser.com/questions/756999/whats-the-difference-between-docker-stop-and-docker-kill

/ 13	. 

/ 137	,

/ Lees,	
https://nmap.org/ncat/guide/ncat-tricks.html

/ we oef eerst op de laptop	nc	,
/ nc = Ncat	,


/ in 1ste window	,
eric@almond Docker2]$ nc -l 4545

/ in 2de window	,
eric@almond Docker2]$ echo foo bar | nc localhost 4545 

/ we zien in 1ste window	,
[eric@almond Docker2]$ nc -l 4545
foo bar
[eric@almond Docker2]$
/ Dus we kunnen maar 1 msg send	,
/ Maar we kunnen --keep-open	, dan kan het zo vaak je wilt	,
[eric@almond Docker2]$ nc -l 4545 --keep-open
foo bar
foo bar
foo bar
...

/ 137	,

[eric@almond Docker2]$ JOB=$(docker run -d -p 4444 ubuntu /bin/nc -l 4444)
[eric@almond Docker2]$ docker port "$JOB" 4444
0.0.0.0:32768
[eric@almond Docker2]$ PORT=$(docker port $JOB 4444 | awk -F: '{ print $2 }')
[eric@almond Docker2]$ echo hello world | nc 127.0.0.1 $PORT
[eric@almond Docker2]$ docker logs "$JOB"
hello world

/ we kunnen maar 1 keer  
[eric@almond Docker2]$ echo hello world | nc 127.0.0.1 $PORT

[eric@almond Docker2]$ docker ps -a
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                        PORTS               NAMES
36fda533ad19        ubuntu              "/bin/nc -l 4444"        8 minutes ago       Exited (0) 58 seconds ago                         furious_yalow

/ we kunnen 'm opnieuw start	,

[eric@almond Docker2]$ docker start $JOB
36fda533ad199101e6ccdae2ccd290045cc025a5d51a5c3439f5270ceb79ff67

/ Geef --keep-open	, 
/ TODO

/ 13	. 

/ we hadden een ERROR	,

[eric@almond Docker2]$ docker run --rm -p 4444 ubuntu /bin/nc -l 4444
docker: Error response from daemon: failed to create endpoint loving_darwin on network bridge: COMMAND_FAILED: '/usr/sbin/iptables -w -t nat -A DOCKER -p tcp -d 0/0 --dport 32777 -j DNAT --to-destination 172.17.0.2:4444 ! -i docker0' failed: iptables: No chain/target/match by that name..

[eric@almond Docker2]$ docker run --rm -P training/webapp python app.py
docker: Error response from daemon: failed to create endpoint tender_brahmagupta on network bridge: COMMAND_FAILED: '/usr/sbin/iptables -w -t nat -A DOCKER -p tcp -d 0/0 --dport 32807 -j DNAT --to-destination 172.17.0.2:5000 ! -i docker0' failed: iptables: No chain/target/match by that name..

/ Lees	,
https://github.com/docker/docker/issues/16816
...
After restarting docker daemon everything worked fine and we could see DOCKER chain came back to nat table:


[eric@almond Docker2]$ sudo iptables -F
[eric@almond Docker2]$ sudo systemctl restart docker

/ OK	,
[eric@almond Docker2]$ docker run --rm -P training/webapp python app.py
 * Running on http://0.0.0.0:5000/ (Press CTRL+C to quit)


/ 13	. 

/ 7	. 

/ Docker Fundamentals	, 
/ User guide

https://docs.docker.com/engine/userguide/

/ 13	. 

/ Dockerizing applications: A Hello world

https://docs.docker.com/engine/userguide/dockerizing/

[eric@almond Logs]$ docker run ubuntu /bin/echo "Foo bar"
Foo bar
[eric@almond Logs]$ docker run ubuntu /bin/pwd
/
[eric@almond Logs]$ docker run ubuntu /bin/ls
bin
boot
dev
etc
home
lib
lib64
media
mnt
opt
proc
root
run
sbin
srv
sys
tmp
usr
var

/ Lees	,
http://unix.stackexchange.com/questions/21147/what-are-pseudo-terminals-pty-tty

/ 13	. 

/ we doen WEL/NIET -d	,
[eric@almond Logs]$ docker run ubuntu /bin/bash -c "while true; do echo \"Foo Bar\";sleep 1;done"
Foo Bar
...


[eric@almond Logs]$ rm-all-containers 
Error response from daemon: Conflict, You cannot remove a running container. Stop the container before attempting removal or use -f
Error: failed to remove containers: [0a27f1746b01]

[eric@almond Logs]$ stop-all-containers 
0a27f1746b01
[eric@almond Logs]$ rm-all-containers 
0a27f1746b01

/ 7. 	

Run a simple application

eric@almond Logs]$ docker run -d -P training/webapp python app.py
Unable to find image 'training/webapp:latest' locally
latest: Pulling from training/webapp
2880a3395ede: Pull complete 
515565c29c94: Pull complete 
98b15185dba7: Pull complete 
2ce633e3e9c9: Pull complete 
2ee0b8f351f7: Pull complete 
2505b734adda: Pull complete 
20dd0c759013: Pull complete 
f95ebd363bf2: Pull complete 
1952e3bf3d7e: Pull complete 
abb991a4ed5e: Pull complete 
7cbae6914197: Pull complete 
f74dd040041e: Pull complete 
54bb4e8718e8: Pull complete 
Digest: sha256:06e9c1983bd6d5db5fba376ccd63bfa529e8d02f23d5079b8f74a616308fb11d
Status: Downloaded newer image for training/webapp:latest
b771808beded9b1616cf0ea56779c00538f97bfc362bfb21b29a25012191c22b

/ we zagen eerst pull	, en dan extract	, 

[eric@almond Logs]$ docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             VIRTUAL SIZE
ubuntu              latest              e9ae3c220b23        4 weeks ago         187.9 MB
training/webapp     latest              54bb4e8718e8        7 months ago        348.7 MB

/ ga naar docker hub		, 
https://hub.docker.com/r/training/webapp/
 /we zien rechts onder	, Source Repository	,
docker -training/webapp	, click	,
https://github.com/docker-training/webapp
$ vi Dockerfile
FROM ubuntu:14.04
...
EXPOSE 5000
...

/ Maar in onze images zien we NIET apart ubuntu:14.04
/ TODO

/ 13	. 

/ Geef	,
[eric@almond Docker2]$ docker run -P --rm --name test training/webapp
[eric@almond misc]$ docker port test
5000/tcp -> 0.0.0.0:32770
/ Geef in browser	,
localhost:32770

$ vi Dockerfile
...
CMD ["python", "app.py"]
/ we kunnen dus de command weglaten	, in de user guide staat hij wel	,

/ 13	. 

/ we kunnen ook	,
eric@almond Docker2]$ docker run -p 12345:5000 --rm --name test training/webapp
 * Running on http://0.0.0.0:5000/ (Press CTRL+C to quit)
/ en dan	, 
localhost:12345

/ als we 	,
[eric@almond Docker2]$ docker run -p 12345:4000 --rm --name test training/webapp
 * Running on http://0.0.0.0:5000/ (Press CTRL+C to quit)
/ en we geven localhost:12345	, dan zien we in de browser: This site cannot be reached.


/ 

/ 13	. 

The -P flag is new and tells Docker to map any required network ports inside our container to our host.
/ Klopt	, als we NIET -P , is er ook geen port in de host	, zoals 32770	 	,


/ -P is -p 5000	, want deze hebben we EXPOSE in onze Dockerfile	,
/ we kunnen ook -p 33333:5000	, de port op de localhost is dan 33333	, in de container is de port 5000	,

[eric@almond Logs]$ docker ps 
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS                     NAMES
b771808beded        training/webapp     "python app.py"     34 minutes ago      Up 34 minutes       0.0.0.0:32768->5000/tcp   stoic_tesla

/ we moeten dus geven	, 
http://localhost:32768
Hello world!

[eric@almond Logs]$ docker ps 
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS                     NAMES
b771808beded        training/webapp     "python app.py"     About an hour ago   Up About an hour    0.0.0.0:32768->5000/tcp   stoic_tesla

[eric@almond Logs]$ docker logs b771808beded 
 * Running on http://0.0.0.0:5000/ (Press CTRL+C to quit)
172.17.0.1 - - [12/Dec/2015 19:37:49] "GET / HTTP/1.1" 200 -
172.17.0.1 - - [12/Dec/2015 19:37:49] "GET /favicon.ico HTTP/1.1" 404 -

[eric@almond Logs]$ docker top b771808beded
UID                 PID                 PPID                C                   STIME               TTY                 TIME                CMD
root                9612                1029                0                   20:01               ?                   00:00:01            python app.py

[eric@almond Logs]$  docker inspect b771808beded
[
{
    "Id": "b771808beded9b1616cf0ea56779c00538f97bfc362bfb21b29a25012191c22b",
    "Created": "2015-12-12T19:01:53.349909819Z",
    "Path": "python",
    "Args": [
        "app.py"
    ],
    "State": {
        "Status": "running",
        "Running": true,
        "Paused": false,
        "Restarting": false,
        "OOMKilled": false,
        "Dead": false,
        "Pid": 9612,
        "ExitCode": 0,
        "Error": "",
        "StartedAt": "2015-12-12T19:01:53.809116533Z",
        "FinishedAt": "0001-01-01T00:00:00Z"
    },
    "Image": "54bb4e8718e8600d78a5d7c62208c2f13c8caf0e4fe73d2bc0e474e93659c0b5",
    "ResolvConfPath": "/var/lib/docker/containers/b771808beded9b1616cf0ea56779c00538f97bfc362bfb21b29a25012191c22b/resolv.conf",
    "HostnamePath": "/var/lib/docker/containers/b771808beded9b1616cf0ea56779c00538f97bfc362bfb21b29a25012191c22b/hostname",
    "HostsPath": "/var/lib/docker/containers/b771808beded9b1616cf0ea56779c00538f97bfc362bfb21b29a25012191c22b/hosts",
    "LogPath": "/var/lib/docker/containers/b771808beded9b1616cf0ea56779c00538f97bfc362bfb21b29a25012191c22b/b771808beded9b1616cf0ea56779c00538f97bfc362bfb21b29a25012191c22b-json.log",
    "Name": "/stoic_tesla",
    "RestartCount": 0,
    "Driver": "devicemapper",
    "ExecDriver": "native-0.2",
    "MountLabel": "",
    "ProcessLabel": "",
    "AppArmorProfile": "",
    "ExecIDs": null,
    "HostConfig": {
        "Binds": null,
        "ContainerIDFile": "",
        "LxcConf": [],
        "Memory": 0,
        "MemoryReservation": 0,
        "MemorySwap": 0,
        "KernelMemory": 0,
        "CpuShares": 0,
        "CpuPeriod": 0,
        "CpusetCpus": "",
        "CpusetMems": "",
        "CpuQuota": 0,
        "BlkioWeight": 0,
        "OomKillDisable": false,
        "MemorySwappiness": -1,
        "Privileged": false,
        "PortBindings": {},
        "Links": null,
        "PublishAllPorts": true,
        "Dns": [],
        "DnsOptions": [],
        "DnsSearch": [],
        "ExtraHosts": null,
        "VolumesFrom": null,
        "Devices": [],
        "NetworkMode": "default",
        "IpcMode": "",
        "PidMode": "",
        "UTSMode": "",
        "CapAdd": null,
        "CapDrop": null,
        "GroupAdd": null,
        "RestartPolicy": {
            "Name": "no",
            "MaximumRetryCount": 0
        },
        "SecurityOpt": null,
        "ReadonlyRootfs": false,
        "Ulimits": null,
        "LogConfig": {
            "Type": "json-file",
            "Config": {}
        },
        "CgroupParent": "",
        "ConsoleSize": [
            0,
            0
        ],
        "VolumeDriver": ""
    },
    "GraphDriver": {
        "Name": "devicemapper",
        "Data": {
            "DeviceId": "69",
            "DeviceName": "docker-253:1-2504345-b771808beded9b1616cf0ea56779c00538f97bfc362bfb21b29a25012191c22b",
            "DeviceSize": "107374182400"
        }
    },
    "Mounts": [],
    "Config": {
        "Hostname": "b771808beded",
        "Domainname": "",
        "User": "",
        "AttachStdin": false,
        "AttachStdout": false,
        "AttachStderr": false,
        "ExposedPorts": {
            "5000/tcp": {}
        },
        "Tty": false,
        "OpenStdin": false,
        "StdinOnce": false,
        "Env": [
            "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
        ],
        "Cmd": [
            "python",
            "app.py"
        ],
        "Image": "training/webapp",
        "Volumes": null,
        "WorkingDir": "/opt/webapp",
        "Entrypoint": null,
        "OnBuild": null,
        "Labels": {},
        "StopSignal": "SIGTERM"
    },
    "NetworkSettings": {
        "Bridge": "",
        "SandboxID": "d1a3aaaed310039ee17e1380c828a8b042e6fdf154ed671fb53e65c995071f24",
        "HairpinMode": false,
        "LinkLocalIPv6Address": "",
        "LinkLocalIPv6PrefixLen": 0,
        "Ports": {
            "5000/tcp": [
                {
                    "HostIp": "0.0.0.0",
                    "HostPort": "32768"
                }
            ]
        },
        "SandboxKey": "/var/run/docker/netns/d1a3aaaed310",
        "SecondaryIPAddresses": null,
        "SecondaryIPv6Addresses": null,
        "EndpointID": "70ee1104cd9fd1842000af5bc2af805b2516399319af7f3f917d47a4bc9df20a",
        "Gateway": "172.17.0.1",
        "GlobalIPv6Address": "",
        "GlobalIPv6PrefixLen": 0,
        "IPAddress": "172.17.0.2",
        "IPPrefixLen": 16,
        "IPv6Gateway": "",
        "MacAddress": "02:42:ac:11:00:02",
        "Networks": {
            "bridge": {
                "EndpointID": "70ee1104cd9fd1842000af5bc2af805b2516399319af7f3f917d47a4bc9df20a",
                "Gateway": "172.17.0.1",
                "IPAddress": "172.17.0.2",
                "IPPrefixLen": 16,
                "IPv6Gateway": "",
                "GlobalIPv6Address": "",
                "GlobalIPv6PrefixLen": 0,
                "MacAddress": "02:42:ac:11:00:02"
            }
        }
    }
}
]
[eric@almond Logs]$ docker inspect -f '{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}' b771808beded9b1616cf0ea56779c00538f97bfc362bfb21b29a25012191c22b
172.17.0.2
/ TODO

/ 7	. 

Build your own images

/ rm alle <none> images	,
[eric@almond sinatra]$ docker images | awk '/<none>/{print $3}' | xargs docker rmi



/ waar zijn de images	?

/ Lees	,
http://stackoverflow.com/questions/19234831/where-are-docker-images-stored-on-the-host-machine

/ ze schijnen te zijn in	,

[eric@almond Logs]$ sudo ls -lh /var/lib/docker/devicemapper/devicemapper/data-rw-------. 1 root root 100G Dec 12 20:38 /var/lib/docker/devicemapper/devicemapper/data
/ 100G	!
Note these files are thin provisioned "sparse" files so aren't as big as they seem.

/ Lees	,
http://superuser.com/questions/94217/ls-and-du-shows-very-different-size

[root@almond devicemapper]# du -h  data
2.4G	data

[root@almond devicemapper]# du -h --apparent-size data
100G	data
 
/ 13	. 

eric@almond Docker2]$ docker pull busybox
Using default tag: latest
latest: Pulling from library/busybox

c00ef186408b: Pull complete 
ac6a7980c6c2: Pull complete 
Digest: sha256:e4f93f6ed15a0cdd342f5aae387886fba0ab98af0a102da6276eaf24d6e6ade0
Status: Downloaded newer image for busybox:latest

[eric@almond Docker2]$ docker run -it --rm busybox
/ =
[eric@almond Docker2]$ docker run -it --rm busybox /bin/sh
/ # pwd
/
/ # ps axj
PID   USER     TIME   COMMAND
    1 root       0:00 sh
    8 root       0:00 ps axj
/ # which sh
/bin/sh
/ # exit
[eric@almond Docker2]$ 


/ Intermezzo

/ op hub.docker.com	, zoek op alpine	,
https://hub.docker.com/_/alpine/
/ dit is official repo	,

Alpine Linux is a Linux distribution built around musl libc and BusyBox. The image is only 5 MB in size and has access to a package repository that is much more complete than other BusyBox based images. This makes Alpine Linux a great image base for utilities and even production applications. Read more about Alpine Linux here and you can see how their mantra fits in right at home with Docker images.

/ musl libc is zoals glibc,

FROM alpine:3.3
RUN apk add --no-cache mysql-client
ENTRYPOINT ["mysql"]
/ TODO

/ Einde Intermezzo

/ Op	,
https://docs.docker.com/v1.11/engine/userguide/containers/dockerimages/
/= Build your own images	,
/ Lees	, 
Tip: You can use a third-party dockviz tool or the Image layers site to display
visualizations of image data.
/ We kozen bijv. Image layers	, 
/ Click 'Load a sample image set'	, 
/ Kies java:latest
https://hub.docker.com/_/java/
/ click op een Dockerfile	,
https://github.com/docker-library/java/blob/930076b47e3a318fa0428c39579fe00f36e3b8b0/openjdk-7-jdk/Dockerfile
/ we zien	,
FROM buildpack-deps:jessie-scm
/ Search for : buildpack-deps	,
https://hub.docker.com/_/buildpack-deps/
/ we zien jessie, wheezy	, kies jessie	,
https://github.com/docker-library/buildpack-deps/tree/master/jessie
/ we zien FROM buildpack-deps:jessie-scm 
/ terug naar	,
https://hub.docker.com/_/buildpack-deps/
/ we zien jessie-scm	,
https://github.com/docker-library/buildpack-deps/tree/master/jessie/scm
/ we zien Dockerfile	,
FROM buildpack-deps:jessie-curl
/ we gaan terug	,
https://hub.docker.com/_/buildpack-deps/
/ en we kiezen jessie-curl	,
https://github.com/docker-library/buildpack-deps/blob/master/jessie/curl/Dockerfile
FROM debian:jessie
/ Geef in https://hub.docker.com/_/debian/: debian	,
https://hub.docker.com/_/debian/
/ we zien jessie	,
https://github.com/tianon/docker-brew-debian/blob/8072332b0dadf2f2590292c5e545bf0f9c2320e6/jessie/Dockerfile
FROM scratch
ADD rootfs.tar.xz /
CMD ["/bin/bash"]
/ TODO
/ terug naar https://hub.docker.com/	, zoek naar scratch	,
https://hub.docker.com/_/scratch/


/ Intermezzo

/ 13	. 
[eric@almond Docker2]$ docker search openshift
NAME                                         DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED
openshift/hello-openshift                    Simple Example for Running a Container on ...   11                   
openshift/origin-release                     Build environment for OpenShift Origin          7                    [OK]
/ TODO

/ we gaan naar docker-library	,
https://github.com/docker-library
/ we zien	,
official images
java
buildpack-deps
...

/we open official images	,
https://github.com/docker-library/official-images
/ Deze heeft ook een Dockerfile	,
FROM docker:git
/ (*)
/ click op lib	,
https://github.com/docker-library/official-images/tree/master/library
/ we zien we allemaal	, maar GEEN Dockerfile's	,


/ open library	, we zien debian	,
$ vi Dockerfile	
jessie: git://github.com/tianon/docker-brew-debian@bd71f2dfe1569968f341b9d195f8249c8f765283 jessie
/ TODO
/ Waar is deze Dockerfile	?
/ TODO

/ 13		. 

/ Ad (*)
/ we zien in library ook docker	,
https://github.com/docker-library/official-images/blob/master/library/docker
$ vi Dockerfile
git: git://github.com/docker-library/docker@ed9933c9cd998b27a8d65efe810e8cd13c116316 1.9/git
/ ga terug naar docker-library	, 
java
docker
...
/ Kies docker, 1.9, git	,
https://github.com/docker-library/docker/tree/master/1.9/git
$ vi Dockerfile
FROM docker:1.9
/ ga terug naar	, docker, 1.9	,
https://github.com/docker-library/docker/tree/master/1.9
$ vi Dockerfile
FROM alpine:3.2
/ Ga terug naar docker-libary,	 kies official images	, library	,
/ we zien alpine	,  fedora	, java, ubuntu	,
/ het zijn allemaal files	,
$ vi alpine
3.2: git://github.com/gliderlabs/docker-alpine@b0549af94764986cec43e5f8ccb3458b425f535f versions/library-3.2

/ 13	. 

/ In https://hub.docker.com/
Search: java
/ we zien 	
jdk, latest: 8-jdk/Dockerfile
/ en	,
alpine-jdk: 8-jdk/alpine/Dockerfile

/ we gaan naar op github naar docker-library/openjdk	,
https://github.com/docker-library/openjdk/tree/a0a4970a343a3c021dad760f2281d20f61931e3c/8-jdk/ we zijn in docker-library/openjdk
alpine
	Dockerfile
Dockerfile

/ Eerst	,
Dockerfile

/ 1313	. 
$ vi Dockerfile
FROM buildpack-deps:jessie-scm

/ we gaan naar	,
https://github.com/docker-library/buildpack-deps
jessie
	scm	
		Dockerfile (*)
	curl	
		Dockerfile (**)

$ vi (*)
FROM buildpack-deps:jessie-curl

$ vi (**)
FROM debian:jessie

/ Via https://hub.docker.com/_/debian/ komen we in	,
https://github.com/tianon/docker-brew-debian/blob/8072332b0dadf2f2590292c5e545bf0f9c2320e6/jessie/Dockerfile
FROM scratch

/ Lees 
https://hub.docker.com/_/scratch/ 

/ 13	. 

alpine
	Dockerfile (***)

/ we gaan naar op github naar docker-library/openjdk	,
$ vi (***)
FROM alpine:3.4

/ we komen in github in gliderlabs/docker-alpine	,
https://github.com/gliderlabs/docker-alpine/blob/45ba65c1116aaf668f7ab5f2b3ae2ef4b00738be/versions/library-3.4/Dockerfile

FROM scratch


 
/ 13	. 


			
/ Intermezzo

we zoeken in github naar wildfly	,
https://github.com/wildfly/wildfly
/ maar ook	,
https://github.com/jboss-dockerfiles/wildfly
$ vi Dockerfile
FROM jboss/base-jdk:8

/ er is ook 	,
https://github.com/jboss-dockerfiles
/ maar die kun je niet vinden met search	, 
/ TODO

/ Ga naar	,
https://github.com/jboss-dockerfiles/base-jdk
$ vi Dockerfile
FROM jboss/base:latest

/Hoe zit het met :8	?
/ TODO

/ Lees	,
https://github.com/jboss-dockerfiles/base/blob/master/Dockerfile
$ vi Dockerfile
FROM centos:7

/ Ook, we zien jboss/base, jboss/base-jdk, maar we zijn in jboss-dockerfiles	,
/ TODO


/ Einde Intermezzo

/ Intermezzo

 /we kunnen kijken bij docker-library/official-images	, naar ubuntu	,
https://github.com/docker-library/official-images/blob/master/library/ubuntu
...
14.04: git://github.com/tianon/docker-brew-ubuntu-core@3852ef7c7e841ea8c126c9b00e64eeca61fe5ab0 trusty


/ of	,
https://hub.docker.com/_/ubuntu/
/ Daar staan links naar docker files	, en we komen dan direct uit	,
 /we click op trusty 14.04	,
https://github.com/tianon/docker-brew-ubuntu-core/blob/3852ef7c7e841ea8c126c9b00e64eeca61fe5ab0/trusty/Dockerfile

/ Einde Intermezzo

[eric@almond Docker2]$ docker search wildfly
...


/ we gaan verder op	,
https://docs.docker.com/engine/userguide/dockerimages/

$ mkdir -p ubuntu/sinatra
$ cd ubuntu/sinatra
$ vi Dockerfile
FROM ubuntu
RUN apt-get update && apt-get install -y ruby ruby-dev
RUN gem install sinatra

[eric@almond sinatra]$ docker build -t ouruser/sinatra:v2 .
Sending build context to Docker daemon 2.048 kB
Step 1 : FROM ubuntu
 ---> e9ae3c220b23
Step 2 : RUN apt-get update && apt-get install -y ruby ruby-dev
 ---> Running in 327fed82c86a
Ign http://archive.ubuntu.com trusty InRelease
Get:1 http://archive.ubuntu.com trusty-updates InRelease [64.4 kB]
Get:2 http://archive.ubuntu.com trusty-security InRelease [64.4 kB]
Hit http://archive.ubuntu.com trusty Release.gpg
Hit http://archive.ubuntu.com trusty Release
Get:3 http://archive.ubuntu.com trusty-updates/main Sources [311 kB]
Get:4 http://archive.ubuntu.com trusty-updates/restricted Sources [5219 B]
Get:5 http://archive.ubuntu.com trusty-updates/universe Sources [183 kB]
Get:6 http://archive.ubuntu.com trusty-updates/main amd64 Packages [836 kB]
Get:7 http://archive.ubuntu.com trusty-updates/restricted amd64 Packages [23.4 kB]
Get:8 http://archive.ubuntu.com trusty-updates/universe amd64 Packages [431 kB]
Get:9 http://archive.ubuntu.com trusty-security/main Sources [127 kB]
Get:10 http://archive.ubuntu.com trusty-security/restricted Sources [3920 B]
Get:11 http://archive.ubuntu.com trusty-security/universe Sources [36.5 kB]
Get:12 http://archive.ubuntu.com trusty-security/main amd64 Packages [477 kB]
Get:13 http://archive.ubuntu.com trusty-security/restricted amd64 Packages [20.2 kB]
Get:14 http://archive.ubuntu.com trusty-security/universe amd64 Packages [156 kB]
Get:15 http://archive.ubuntu.com trusty/main Sources [1335 kB]
Get:16 http://archive.ubuntu.com trusty/restricted Sources [5335 B]
Get:17 http://archive.ubuntu.com trusty/universe Sources [7926 kB]
Get:18 http://archive.ubuntu.com trusty/main amd64 Packages [1743 kB]
Get:19 http://archive.ubuntu.com trusty/restricted amd64 Packages [16.0 kB]
Get:20 http://archive.ubuntu.com trusty/universe amd64 Packages [7589 kB]
Fetched 21.4 MB in 39s (547 kB/s)
Reading package lists...
Reading package lists...
Building dependency tree...
Reading state information...
The following extra packages will be installed:
  binutils ca-certificates cpp cpp-4.8 gcc gcc-4.8 libasan0 libatomic1
  libc-dev-bin libc6-dev libcloog-isl4 libgcc-4.8-dev libgmp10 libgomp1
  libisl10 libitm1 libmpc3 libmpfr4 libquadmath0 libruby1.9.1 libtsan0
  libyaml-0-2 linux-libc-dev manpages manpages-dev openssl ruby1.9.1
  ruby1.9.1-dev
Suggested packages:
  binutils-doc cpp-doc gcc-4.8-locales gcc-multilib make autoconf automake1.9
  libtool flex bison gdb gcc-doc gcc-4.8-multilib gcc-4.8-doc libgcc1-dbg
  libgomp1-dbg libitm1-dbg libatomic1-dbg libasan0-dbg libtsan0-dbg
  libquadmath0-dbg glibc-doc man-browser ri ruby1.9.1-examples ri1.9.1
  graphviz ruby-switch
The following NEW packages will be installed:
  binutils ca-certificates cpp cpp-4.8 gcc gcc-4.8 libasan0 libatomic1
  libc-dev-bin libc6-dev libcloog-isl4 libgcc-4.8-dev libgmp10 libgomp1
  libisl10 libitm1 libmpc3 libmpfr4 libquadmath0 libruby1.9.1 libtsan0
  libyaml-0-2 linux-libc-dev manpages manpages-dev openssl ruby ruby-dev
  ruby1.9.1 ruby1.9.1-dev
0 upgraded, 30 newly installed, 0 to remove and 8 not upgraded.
Need to get 24.2 MB of archives.
After this operation, 90.0 MB of additional disk space will be used.
Get:1 http://archive.ubuntu.com/ubuntu/ trusty-updates/main libasan0 amd64 4.8.4-2ubuntu1~14.04 [63.0 kB]
Get:2 http://archive.ubuntu.com/ubuntu/ trusty-updates/main libatomic1 amd64 4.8.4-2ubuntu1~14.04 [8650 B]
Get:3 http://archive.ubuntu.com/ubuntu/ trusty/main libgmp10 amd64 2:5.1.3+dfsg-1ubuntu1 [218 kB]
Get:4 http://archive.ubuntu.com/ubuntu/ trusty/main libisl10 amd64 0.12.2-1 [419 kB]
Get:5 http://archive.ubuntu.com/ubuntu/ trusty/main libcloog-isl4 amd64 0.18.2-1 [57.5 kB]
Get:6 http://archive.ubuntu.com/ubuntu/ trusty-updates/main libgomp1 amd64 4.8.4-2ubuntu1~14.04 [23.1 kB]
Get:7 http://archive.ubuntu.com/ubuntu/ trusty-updates/main libitm1 amd64 4.8.4-2ubuntu1~14.04 [28.6 kB]
Get:8 http://archive.ubuntu.com/ubuntu/ trusty/main libmpfr4 amd64 3.1.2-1 [203 kB]
Get:9 http://archive.ubuntu.com/ubuntu/ trusty-updates/main libquadmath0 amd64 4.8.4-2ubuntu1~14.04 [126 kB]
Get:10 http://archive.ubuntu.com/ubuntu/ trusty-updates/main libtsan0 amd64 4.8.4-2ubuntu1~14.04 [94.7 kB]
Get:11 http://archive.ubuntu.com/ubuntu/ trusty-updates/main libyaml-0-2 amd64 0.1.4-3ubuntu3.1 [48.1 kB]
Get:12 http://archive.ubuntu.com/ubuntu/ trusty/main libmpc3 amd64 1.0.1-1ubuntu1 [38.4 kB]
Get:13 http://archive.ubuntu.com/ubuntu/ trusty-updates/main openssl amd64 1.0.1f-1ubuntu2.16 [488 kB]
Get:14 http://archive.ubuntu.com/ubuntu/ trusty-updates/main ca-certificates all 20141019ubuntu0.14.04.1 [189 kB]
Get:15 http://archive.ubuntu.com/ubuntu/ trusty/main manpages all 3.54-1ubuntu1 [627 kB]
Get:16 http://archive.ubuntu.com/ubuntu/ trusty-updates/main binutils amd64 2.24-5ubuntu14 [2076 kB]
Get:17 http://archive.ubuntu.com/ubuntu/ trusty-updates/main cpp-4.8 amd64 4.8.4-2ubuntu1~14.04 [4597 kB]
Get:18 http://archive.ubuntu.com/ubuntu/ trusty/main cpp amd64 4:4.8.2-1ubuntu6 [27.5 kB]
Get:19 http://archive.ubuntu.com/ubuntu/ trusty-updates/main libgcc-4.8-dev amd64 4.8.4-2ubuntu1~14.04 [1687 kB]
Get:20 http://archive.ubuntu.com/ubuntu/ trusty-updates/main gcc-4.8 amd64 4.8.4-2ubuntu1~14.04 [5049 kB]
Get:21 http://archive.ubuntu.com/ubuntu/ trusty/main gcc amd64 4:4.8.2-1ubuntu6 [5098 B]
Get:22 http://archive.ubuntu.com/ubuntu/ trusty-updates/main libc-dev-bin amd64 2.19-0ubuntu6.6 [68.9 kB]
Get:23 http://archive.ubuntu.com/ubuntu/ trusty-updates/main linux-libc-dev amd64 3.13.0-71.114 [770 kB]
Get:24 http://archive.ubuntu.com/ubuntu/ trusty-updates/main libc6-dev amd64 2.19-0ubuntu6.6 [1910 kB]
Get:25 http://archive.ubuntu.com/ubuntu/ trusty/main ruby all 1:1.9.3.4 [5334 B]
Get:26 http://archive.ubuntu.com/ubuntu/ trusty-updates/main ruby1.9.1 amd64 1.9.3.484-2ubuntu1.2 [35.6 kB]
Get:27 http://archive.ubuntu.com/ubuntu/ trusty-updates/main libruby1.9.1 amd64 1.9.3.484-2ubuntu1.2 [2645 kB]
Get:28 http://archive.ubuntu.com/ubuntu/ trusty/main manpages-dev all 3.54-1ubuntu1 [1820 kB]
Get:29 http://archive.ubuntu.com/ubuntu/ trusty-updates/main ruby1.9.1-dev amd64 1.9.3.484-2ubuntu1.2 [871 kB]
Get:30 http://archive.ubuntu.com/ubuntu/ trusty/main ruby-dev all 1:1.9.3.4 [4660 B]
debconf: unable to initialize frontend: Dialog
debconf: (TERM is not set, so the dialog frontend is not usable.)
debconf: falling back to frontend: Readline
debconf: unable to initialize frontend: Readline
debconf: (This frontend requires a controlling tty.)
debconf: falling back to frontend: Teletype
dpkg-preconfigure: unable to re-open stdin: 
Fetched 24.2 MB in 53s (452 kB/s)
Selecting previously unselected package libasan0:amd64.
(Reading database ... 11542 files and directories currently installed.)
Preparing to unpack .../libasan0_4.8.4-2ubuntu1~14.04_amd64.deb ...
Unpacking libasan0:amd64 (4.8.4-2ubuntu1~14.04) ...
Selecting previously unselected package libatomic1:amd64.
Preparing to unpack .../libatomic1_4.8.4-2ubuntu1~14.04_amd64.deb ...
Unpacking libatomic1:amd64 (4.8.4-2ubuntu1~14.04) ...
Selecting previously unselected package libgmp10:amd64.
Preparing to unpack .../libgmp10_2%3a5.1.3+dfsg-1ubuntu1_amd64.deb ...
Unpacking libgmp10:amd64 (2:5.1.3+dfsg-1ubuntu1) ...
Selecting previously unselected package libisl10:amd64.
Preparing to unpack .../libisl10_0.12.2-1_amd64.deb ...
Unpacking libisl10:amd64 (0.12.2-1) ...
Selecting previously unselected package libcloog-isl4:amd64.
Preparing to unpack .../libcloog-isl4_0.18.2-1_amd64.deb ...
Unpacking libcloog-isl4:amd64 (0.18.2-1) ...
Selecting previously unselected package libgomp1:amd64.
Preparing to unpack .../libgomp1_4.8.4-2ubuntu1~14.04_amd64.deb ...
Unpacking libgomp1:amd64 (4.8.4-2ubuntu1~14.04) ...
Selecting previously unselected package libitm1:amd64.
Preparing to unpack .../libitm1_4.8.4-2ubuntu1~14.04_amd64.deb ...
Unpacking libitm1:amd64 (4.8.4-2ubuntu1~14.04) ...
Selecting previously unselected package libmpfr4:amd64.
Preparing to unpack .../libmpfr4_3.1.2-1_amd64.deb ...
Unpacking libmpfr4:amd64 (3.1.2-1) ...
Selecting previously unselected package libquadmath0:amd64.
Preparing to unpack .../libquadmath0_4.8.4-2ubuntu1~14.04_amd64.deb ...
Unpacking libquadmath0:amd64 (4.8.4-2ubuntu1~14.04) ...
Selecting previously unselected package libtsan0:amd64.
Preparing to unpack .../libtsan0_4.8.4-2ubuntu1~14.04_amd64.deb ...
Unpacking libtsan0:amd64 (4.8.4-2ubuntu1~14.04) ...
Selecting previously unselected package libyaml-0-2:amd64.
Preparing to unpack .../libyaml-0-2_0.1.4-3ubuntu3.1_amd64.deb ...
Unpacking libyaml-0-2:amd64 (0.1.4-3ubuntu3.1) ...
Selecting previously unselected package libmpc3:amd64.
Preparing to unpack .../libmpc3_1.0.1-1ubuntu1_amd64.deb ...
Unpacking libmpc3:amd64 (1.0.1-1ubuntu1) ...
Selecting previously unselected package openssl.
Preparing to unpack .../openssl_1.0.1f-1ubuntu2.16_amd64.deb ...
Unpacking openssl (1.0.1f-1ubuntu2.16) ...
Selecting previously unselected package ca-certificates.
Preparing to unpack .../ca-certificates_20141019ubuntu0.14.04.1_all.deb ...
Unpacking ca-certificates (20141019ubuntu0.14.04.1) ...
Selecting previously unselected package manpages.
Preparing to unpack .../manpages_3.54-1ubuntu1_all.deb ...
Unpacking manpages (3.54-1ubuntu1) ...
Selecting previously unselected package binutils.
Preparing to unpack .../binutils_2.24-5ubuntu14_amd64.deb ...
Unpacking binutils (2.24-5ubuntu14) ...
Selecting previously unselected package cpp-4.8.
Preparing to unpack .../cpp-4.8_4.8.4-2ubuntu1~14.04_amd64.deb ...
Unpacking cpp-4.8 (4.8.4-2ubuntu1~14.04) ...
Selecting previously unselected package cpp.
Preparing to unpack .../cpp_4%3a4.8.2-1ubuntu6_amd64.deb ...
Unpacking cpp (4:4.8.2-1ubuntu6) ...
Selecting previously unselected package libgcc-4.8-dev:amd64.
Preparing to unpack .../libgcc-4.8-dev_4.8.4-2ubuntu1~14.04_amd64.deb ...
Unpacking libgcc-4.8-dev:amd64 (4.8.4-2ubuntu1~14.04) ...
Selecting previously unselected package gcc-4.8.
Preparing to unpack .../gcc-4.8_4.8.4-2ubuntu1~14.04_amd64.deb ...
Unpacking gcc-4.8 (4.8.4-2ubuntu1~14.04) ...
Selecting previously unselected package gcc.
Preparing to unpack .../gcc_4%3a4.8.2-1ubuntu6_amd64.deb ...
Unpacking gcc (4:4.8.2-1ubuntu6) ...
Selecting previously unselected package libc-dev-bin.
Preparing to unpack .../libc-dev-bin_2.19-0ubuntu6.6_amd64.deb ...
Unpacking libc-dev-bin (2.19-0ubuntu6.6) ...
Selecting previously unselected package linux-libc-dev:amd64.
Preparing to unpack .../linux-libc-dev_3.13.0-71.114_amd64.deb ...
Unpacking linux-libc-dev:amd64 (3.13.0-71.114) ...
Selecting previously unselected package libc6-dev:amd64.
Preparing to unpack .../libc6-dev_2.19-0ubuntu6.6_amd64.deb ...
Unpacking libc6-dev:amd64 (2.19-0ubuntu6.6) ...
Selecting previously unselected package ruby.
Preparing to unpack .../ruby_1%3a1.9.3.4_all.deb ...
Unpacking ruby (1:1.9.3.4) ...
Selecting previously unselected package ruby1.9.1.
Preparing to unpack .../ruby1.9.1_1.9.3.484-2ubuntu1.2_amd64.deb ...
Unpacking ruby1.9.1 (1.9.3.484-2ubuntu1.2) ...
Selecting previously unselected package libruby1.9.1.
Preparing to unpack .../libruby1.9.1_1.9.3.484-2ubuntu1.2_amd64.deb ...
Unpacking libruby1.9.1 (1.9.3.484-2ubuntu1.2) ...
Selecting previously unselected package manpages-dev.
Preparing to unpack .../manpages-dev_3.54-1ubuntu1_all.deb ...
Unpacking manpages-dev (3.54-1ubuntu1) ...
Selecting previously unselected package ruby1.9.1-dev.
Preparing to unpack .../ruby1.9.1-dev_1.9.3.484-2ubuntu1.2_amd64.deb ...
Unpacking ruby1.9.1-dev (1.9.3.484-2ubuntu1.2) ...
Selecting previously unselected package ruby-dev.
Preparing to unpack .../ruby-dev_1%3a1.9.3.4_all.deb ...
Unpacking ruby-dev (1:1.9.3.4) ...
Setting up libasan0:amd64 (4.8.4-2ubuntu1~14.04) ...
Setting up libatomic1:amd64 (4.8.4-2ubuntu1~14.04) ...
Setting up libgmp10:amd64 (2:5.1.3+dfsg-1ubuntu1) ...
Setting up libisl10:amd64 (0.12.2-1) ...
Setting up libcloog-isl4:amd64 (0.18.2-1) ...
Setting up libgomp1:amd64 (4.8.4-2ubuntu1~14.04) ...
Setting up libitm1:amd64 (4.8.4-2ubuntu1~14.04) ...
Setting up libmpfr4:amd64 (3.1.2-1) ...
Setting up libquadmath0:amd64 (4.8.4-2ubuntu1~14.04) ...
Setting up libtsan0:amd64 (4.8.4-2ubuntu1~14.04) ...
Setting up libyaml-0-2:amd64 (0.1.4-3ubuntu3.1) ...
Setting up libmpc3:amd64 (1.0.1-1ubuntu1) ...
Setting up openssl (1.0.1f-1ubuntu2.16) ...
Setting up ca-certificates (20141019ubuntu0.14.04.1) ...
debconf: unable to initialize frontend: Dialog
debconf: (TERM is not set, so the dialog frontend is not usable.)
debconf: falling back to frontend: Readline
debconf: unable to initialize frontend: Readline
debconf: (This frontend requires a controlling tty.)
debconf: falling back to frontend: Teletype
Setting up manpages (3.54-1ubuntu1) ...
Setting up binutils (2.24-5ubuntu14) ...
Setting up cpp-4.8 (4.8.4-2ubuntu1~14.04) ...
Setting up cpp (4:4.8.2-1ubuntu6) ...
Setting up libgcc-4.8-dev:amd64 (4.8.4-2ubuntu1~14.04) ...
Setting up gcc-4.8 (4.8.4-2ubuntu1~14.04) ...
Setting up gcc (4:4.8.2-1ubuntu6) ...
Setting up libc-dev-bin (2.19-0ubuntu6.6) ...
Setting up linux-libc-dev:amd64 (3.13.0-71.114) ...
Setting up libc6-dev:amd64 (2.19-0ubuntu6.6) ...
Setting up manpages-dev (3.54-1ubuntu1) ...
Setting up libruby1.9.1 (1.9.3.484-2ubuntu1.2) ...
Setting up ruby1.9.1-dev (1.9.3.484-2ubuntu1.2) ...
Setting up ruby-dev (1:1.9.3.4) ...
Setting up ruby (1:1.9.3.4) ...
Setting up ruby1.9.1 (1.9.3.484-2ubuntu1.2) ...
Processing triggers for libc-bin (2.19-0ubuntu6.6) ...
Processing triggers for ca-certificates (20141019ubuntu0.14.04.1) ...
Updating certificates in /etc/ssl/certs... 173 added, 0 removed; done.
Running hooks in /etc/ca-certificates/update.d....done.
 ---> aa004737d5d8
Removing intermediate container 327fed82c86a
Step 3 : RUN gem install sinatra
 ---> Running in e4d8b37278c7
unable to convert "\xC3" to UTF-8 in conversion from ASCII-8BIT to UTF-8 to US-ASCII for README.rdoc, skipping
unable to convert "\xC3" to UTF-8 in conversion from ASCII-8BIT to UTF-8 to US-ASCII for README.rdoc, skipping
Successfully installed rack-1.6.4
Successfully installed tilt-2.0.1
Successfully installed rack-protection-1.5.3
Successfully installed sinatra-1.4.6
4 gems installed
Installing ri documentation for rack-1.6.4...
Installing ri documentation for tilt-2.0.1...
Installing ri documentation for rack-protection-1.5.3...
Installing ri documentation for sinatra-1.4.6...
Installing RDoc documentation for rack-1.6.4...
Installing RDoc documentation for tilt-2.0.1...
Installing RDoc documentation for rack-protection-1.5.3...
Installing RDoc documentation for sinatra-1.4.6...
 ---> 6929d3f6a65b
Removing intermediate container e4d8b37278c7
Successfully built 6929d3f6a65b

Now you can see the build process at work. The first thing Docker does is upload the build context: basically the contents of the directory youre building in. This is done because the Docker daemon does the actual build of the image and it needs the local context to do it.
/ Met context bedoelen ze WH de Dockerfile	,

/ we zien ook de containers	,

Step 1 : FROM ubuntu
 ---> e9ae3c220b23
Step 2 : RUN apt-get update && apt-get install -y ruby ruby-dev
 ---> Running in 327fed82c86a
 ---> aa004737d5d8
Removing intermediate container 327fed82c86a
Step 3 : RUN gem install sinatra
 ---> Running in e4d8b37278c7
Removing intermediate container e4d8b37278c7
Successfully built 6929d3f6a65b

/ 13. 

instructions in later sections of the Guide or you can refer to the Dockerfile reference for a detailed description and examples of every instruction. To help you write a clear, readable, maintainable
Dockerfile, weve also written a Dockerfile Best Practices guide.
/ TODO

/ 13	. 

/ cmd exec form or shell form	,

/ 137	. 

/ -d of niet	, bij docker run	,
/ doe  zonder -d en met --rm	, 
$ docker run --rm 

[eric@almond misc]$ pwd
/home/eric/Devel/Docker2/misc
[eric@almond misc]$ cat Dockerfile 
from debian 
cmd ["//bin/echo","$HOME"]

[eric@almond misc]$ docker build -t misc .
[eric@almond misc]$ docker run   misc
$HOME

/ als we met -d	, moeten we daarna docker logs <container name>	,
[eric@almond misc]$ docker run -d  misc
7f38cff18d904a218b53261480279327cb4bcdc831ca02073c665f8111f0f024
[eric@almond Mars]$ docker logs jolly_poincare
$HOME

[eric@almond Mars]$ docker ps -a
CONTAINER ID        IMAGE               COMMAND                  CREATED              STATUS                          PORTS               NAMES
7f38cff18d90        misc                "//bin/echo $HOME"       51 seconds ago       Exited (0) 49 seconds ago                           trusting_engelbart
c135b26c8f82        misc                "//bin/echo $HOME"       About a minute ago   Exited (0) About a minute ago                       sick_leakey
4542958cdc9d        misc                "//bin/echo $HOME"       2 minutes ago        Exited (0) 2 minutes ago                            sleepy_engelbart
af6dc30ea061        misc                "//bin/echo $HOME"       9 minutes ago        Exited (0) 9 minutes ago                            nostalgic_heyrovsky
e2924940baf2        misc                "//bin/echo $HOME"       11 minutes ago 

/ Elke keer als we docker run doen	, komt er een container bij	,
/ Tenzij we --rm geven	, 

//////////////////////////////////
$ docker run --rm misc

/ 137	. 

/ exec form	,

[eric@almond misc]$ cat Dockerfile 
from debian 
cmd ["//bin/echo","$HOME"]

[eric@almond misc]$ docker build -t misc .
[eric@almond misc]$ docker run --rm misc
$HOME

/ shell form

[eric@almond misc]$ cat Dockerfile 
from debian 
cmd /bin/echo $HOME

[eric@almond misc]$ docker build -t misc .
[eric@almond misc]$ docker run --rm misc
/root

/ 137

/ we kunnen ook entrypoint geven ipv cmd	,

[eric@almond misc]$ cat Dockerfile 
from debian 
entrypoint ["/bin/echo","$HOME"]
[eric@almond misc]$ docker build -t misc .
[eric@almond misc]$ docker run --rm misc
$HOME

/ SAMENVATTING 

/ 13	. 

/ top geeft command names	, dus als je top -b , zie je alleen: top
/ top -c geeft command lines	, dus zie je top -c	, en als je top -b -c doet, zie je top -b -c	, 
/ top -c werkt dus net als ps ajx

/ 13	. 

$ vi Dockerfile
entrypoint ["top","-b"]
cmd ["-c"]
[eric@almond misc]$ docker build -t misc .
[eric@almond misc]$ docker run --rm misc
    1 root      20   0   21804   2148   1892 R   0.0  0.0   0:00.08 top -b -c
/ we kunnen ^c doen	, 

$ vi Dockerfile
entrypoint top -b -c
/ we zien	,
    1 root      20   0    4328    688    604 S   0.0  0.0   0:00.09 /bin/sh -c+
    9 root      20   0   21812   2268   1996 R   0.0  0.0   0:00.00 top -b -c
/ we kunnen GEEN ^c
[eric@almond Docker2]$ stop-all-containers 
/ OK

$ vi Dockerfile
entrypoint top -b
cmd ["-c"]
/ cmd ["-c'] werkt NIET samen met shell form van entrypoint	, we zien alleen top	, omdat -c geen optie is op top zien we -b niet	,

$ vi Dockerfile
entrypoint ["top","-b","-c"]
/=
entrypoint ["top","-b"]
cmd ["-c"]

$ vi Dockerfile
entrypoint ["top"]
cmd ["-b","-c"]
/ OK	, 
/ Maar nu kunnen beide opties -b en -c vervangen worden als je in docker run een optie geeft	, bijv -S 

/ Bij docker exec heeft -it alleen zin, als we bash als command geven	, als we ps ajx geven	, hoeven we geen -it te geven aan docker exec	,

[eric@almond misc]$ pwd
/home/eric/Devel/Docker2/misc
[eric@almond misc]$ cat Dockerfile 
from debian 
entrypoint ["top"]
cmd ["-b","-c"]
[eric@almond misc]$ docker build -t misc .
[eric@almond misc]$ docker run --rm --name misc misc
...
    1 root      20   0   21812   2312   2032 R   0.0  0.0   0:00.08 top -b -c

[eric@almond Docker2]$ docker exec   misc ps ajx
 PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND
    0     1     1     1 ?           -1 Ss       0   0:00 top -b -c
    0     8     8     8 ?           -1 Rs       0   0:00 ps ajx
[eric@almond Docker2]$ docker exec  -it  misc bash
root@f4ab581c0c47:/# ps ajx
 PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND
    0     1     1     1 ?           -1 Ss       0   0:00 top -b -c
    0    16    16    16 ?           23 Ss       0   0:00 bash
   16    23    23    16 ?           23 R+       0   0:00 ps ajx

/ 13	. 

/ verschil exec en attach: 

/ 1313	,

/ we doen,	
[eric@almond misc]$ docker run --rm --name misc misc
top - 20:25:59 up 160 days, 12:00,  0 users,  load average: 0.73, 0.93, 0.68
Tasks:   1 total,   1 running,   0 sleeping,   0 stopped,   0 zombie
%Cpu(s): 19.6 us,  9.6 sy,  0.1 ni, 70.4 id,  0.2 wa,  0.0 hi,  0.0 si,  0.0 st
KiB Mem:  16310148 total, 10892016 used,  5418132 free,   787848 buffers
KiB Swap:  8191996 total,   444896 used,  7747100 free.  3458988 cached Mem

  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND
    1 root      20   0   21804   2132   1872 R   0.0  0.0   0:00.08 top -b -c^C
[eric@almond misc]$ 
/ we kunnen dus met ^C stop	, en omdat --rm ook rm	,
//////////////////////////////////////////////////////
/ we zien GEEN bash	, alleen top	,

/ 1313

[eric@almond misc]$ docker exec -it misc ps ajx
 PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND
    0     1     1     1 ?           -1 Ss       0   0:00 top -b -c
    0    16    16    16 ?           16 Rs+      0   0:00 ps ajx
/ Weer GEEN bash	,

[eric@almond misc]$ docker exec -it misc bash
root@0a5d8e21e6e3:/# 
/ Dit kan ook	,
/ Nu zien we aan de docker run kant	,
...
  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND
    1 root      20   0   21812   2216   1944 R   0.0  0.0   0:00.10 top -b -c
   24 root      20   0   20212   2936   2656 S   0.0  0.0   0:00.09 bash
//////////////////////////////////////////////
/ we zien dat bash NIET PID 1 is	,

/ we geven
root@0a5d8e21e6e3:/#  exit
/ De docker run kant gaat door	,

/ 1313	, 

[eric@almond misc]$ docker attach misc
/ is niet zo interessant nu	, we zien precies hetzelfde als aan de docker run kant	, 
/ als we ^C doen, stopt ook de docker run kant	,


/ 13	. 

/ als we geen command, dan is het command /bin/bash	,	
[eric@almond misc]$ docker run  --name test3 centos
/ De container is meteen Exited	,
[eric@almond misc]$ docker run  -i --name test3 centos
/ De container is Running	, maar ^c werkt niet	,
[eric@almond misc]$ docker run  -t --name test3 centos
/ De container is Running	, we krijgen een promt: pseudo tty, we kunnen bijv ls geven	, maar krijgen geen antwoord	,
[eric@almond misc]$ docker run  -it --name test3 centos
/ OK	, 
/ Als we 
docker exec test3 ps ajx
/ dan zien we bij run -i of run -t of run -it geen verschil	,
/ TODO

/ 13	. 

/ we willen 2 running containers	, makkelijkst met -d	, doe niet -it, en dan # exit	, want dan is de container EXITED	, 

[eric@almond misc]$ docker run -d --name test misc
076ecdf0a8bff46f4d61869ac930bd12e7b370497e05da1602c90193c98dff1f
[eric@almond misc]$ docker run -d --name test2 misc
5a46a2e59ed7da0279312afb8a90ed41c73fdf390ac5f97261322b66f55bcc62

/ we kunnen 	, 
[eric@almond misc]$ docker logs test
...

/ we zien beide containers,	
/ ze hebben elk een ip adres	,
[eric@almond Docker2]$ docker network inspect bridge
[
    {
        "Name": "bridge",
        "Id": "bf8ef5e7f2f36bfe3ba33abe30962ca1e635a7a6ad481ac41dbdc1b52312438c",
        "Scope": "local",
        "Driver": "bridge",
        "IPAM": {
            "Driver": "default",
            "Options": null,
            "Config": [
                {
                    "Subnet": "172.17.0.0/16",
                    "Gateway": "172.17.0.1"
                }
            ]
        },
        "Containers": {
            "076ecdf0a8bff46f4d61869ac930bd12e7b370497e05da1602c90193c98dff1f": {
                "Name": "test",
                "EndpointID": "1690ab7ccaa9ed6b2c6044ee1ce483d4a0acaea3c61f6523dddc02152666928d",
                "MacAddress": "02:42:ac:11:00:02",
                "IPv4Address": "172.17.0.2/16",
                "IPv6Address": ""
            },
            "5a46a2e59ed7da0279312afb8a90ed41c73fdf390ac5f97261322b66f55bcc62": {
                "Name": "test2",
                "EndpointID": "e0016813ddc3405dfb32452935ba185260f6c097f94eb51fb604b6e55d4f0403",
                "MacAddress": "02:42:ac:11:00:03",
                "IPv4Address": "172.17.0.3/16",
                "IPv6Address": ""
            }
        },
        "Options": {
            "com.docker.network.bridge.default_bridge": "true",
            "com.docker.network.bridge.enable_icc": "true",
            "com.docker.network.bridge.enable_ip_masquerade": "true",
            "com.docker.network.bridge.host_binding_ipv4": "0.0.0.0",
            "com.docker.network.bridge.name": "docker0",
            "com.docker.network.driver.mtu": "1500"
        }
    }
]

[eric@almond Docker2]$ ping 172.17.0.2
/ OK
[eric@almond Docker2]$ ping 172.17.0.3
/ OK

/ Einde SAMENVATTING



/ 137	.

[eric@almond misc]$ cat Dockerfile 
from debian 
entrypoint ["top","-b"]
cmd ["-c"]

/ we zien dat top PID 1 krijgt	, en zo signals ontvangt	, want docker stop werkt OK	,

/ we zullen zien "top -b -c"	, omdat we geen arg geven op command line aan docker run misc	,

[eric@almond misc]$ docker build -t misc .
[eric@almond misc]$ docker run --rm misc
top - 12:40:17 up 67 days,  4:15,  0 users,  load average: 0.54, 0.40, 0.36
Tasks:   1 total,   1 running,   0 sleeping,   0 stopped,   0 zombie
%Cpu(s): 11.7 us,  5.8 sy,  0.1 ni, 82.3 id,  0.2 wa,  0.0 hi,  0.0 si,  0.0 st
KiB Mem:  16310148 total, 14646896 used,  1663252 free,   502868 buffers
KiB Swap:  8191996 total,     1316 used,  8190680 free.  5480448 cached Mem

  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND
    1 root      20   0   21804   2136   1880 R   0.0  0.0   0:00.09 top -b -c
/ Dit blijft zich herhalen	,

/ Lees	,
http://www.tecmint.com/12-top-command-examples-in-linux/
http://www.golinuxhub.com/2014/03/8-examples-to-help-you-understand-top.html

/ In andere shell	,
[eric@almond Mars]$ docker ps -a
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                      PORTS               NAMES
91ab208645a9        misc                "top -b -c"              38 seconds ago      Up 37 seconds                                   silly_wescoff
[eric@almond Mars]$  docker stop 91ab208645a9
91ab208645a9
/ OK, dus top PID 1 krijgt signal	,
/ we zien in eerste shell	, dat hij er mee stopt	,
  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND
    1 root      20   0   21812   2216   1944 R   0.0  0.0   0:00.09 top -b -c
[eric@almond misc]$

/ 137	. 

/ als runs	, dan met docker exec	,


/ top gaf al "top -b -c"	, maar als we straks een option geven aan docker run misc	, dan zien we alleen top
/ TODO

/ in 1ste shell	,
[eric@almond misc]$ docker run --rm --name test misc 

/ in 2de shell	,
[eric@almond Mars]$  docker exec -it test ps ajx
 PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND
    0     1     1     1 ?           -1 Ss       0   0:00 top -b -c
    0     8     8     8 ?            8 Rs+      0   0:00 ps ajx
[eric@almond Mars]$ 
/ Dus returns meteen	,

[eric@almond Mars]$ docker stop test
test

/ 137	. 

/ we geven option aan docker run misc	,

/ we zien dat de cmd ["-c"] wordt overwrite door docker run misc -S	,

[eric@almond misc]$ docker run --rm --name test misc -S
top - 13:00:56 up 67 days,  4:35,  0 users,  load average: 0.67, 0.74, 0.71
Tasks:   1 total,   1 running,   0 sleeping,   0 stopped,   0 zombie
%Cpu(s): 11.6 us,  5.8 sy,  0.1 ni, 82.3 id,  0.2 wa,  0.0 hi,  0.0 si,  0.0 st
KiB Mem:  16310148 total, 14654612 used,  1655536 free,   502944 buffers
KiB Swap:  8191996 total,     1316 used,  8190680 free.  5484216 cached Mem

  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND
    1 root      20   0   21804   2148   1884 R   0.0  0.0   0:00.08 top

eric@almond Mars]$  docker exec -it test ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root         1  0.5  0.0  21812  2224 ?        Ss   13:00   0:00 top -b -S
root         8  0.0  0.0  17492  1976 ?        Rs+  13:01   0:00 ps aux
[eric@almond Mars]$ docker stop test
test

/ 137	. 

/ Als we de shell form doen, dan zien we een sh proc met PID 1 	, en top heeft PID 8 , of 9, of ...

This means that the executable will not be the containers PID 1 - and will not receive Unix signals - so your executable will not receive a SIGTERM from docker stop <container>.

[eric@almond misc]$ cat Dockerfile 
from debian 
entrypoint top -b
[eric@almond misc]$ docker build -t misc .
[eric@almond misc]$ docker run --rm --name test misc
top - 13:09:43 up 67 days,  4:44,  0 users,  load average: 0.25, 0.37, 0.56
Tasks:   2 total,   1 running,   1 sleeping,   0 stopped,   0 zombie
%Cpu(s):  4.1 us,  2.8 sy,  0.0 ni, 92.9 id,  0.1 wa,  0.0 hi,  0.0 si,  0.0 st
KiB Mem:  16310148 total, 14668516 used,  1641632 free,   503008 buffers
KiB Swap:  8191996 total,     1316 used,  8190680 free.  5483548 cached Mem

  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND
    1 root      20   0    4328    688    604 S   0.0  0.0   0:00.07 sh
    9 root      20   0   21812   2276   2000 R   0.0  0.0   0:00.00 top

/ In ander shell	,
[eric@almond Mars]$  docker exec test ps aux
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root         1  0.7  0.0   4328   792 ?        Ss   13:13   0:00 /bin/sh -c top 
root         8  0.0  0.0  21812  2256 ?        S    13:13   0:00 top -b
root         9  0.0  0.0  17492  1996 ?        Rs+  13:13   0:00 ps aux

[eric@almond Mars]$ docker stop test
test
/ Werkt WEL	, 
/ Maar signal gaat niet naar top	?
/ TODO

/ 1ste shell	,
  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND
    1 root      20   0    4328    792    704 S   0.0  0.0   0:00.07 sh
    8 root      20   0   21812   2256   1980 R   0.0  0.0   0:00.02 top[eric@almond misc]$  
/ Het duurt ook lang	,




/ 13	. 

/ we hebben inderdaad ubuntu:latest used	, 
/ want als we doen	, 
$ vi Dockerfile
FROM ubuntu:latest
...
/ dan	,

[eric@almond sinatra]$ docker build -t ouruser/sinatra:v3 .
Sending build context to Docker daemon 2.048 kB
Step 1 : FROM ubuntu:latest
 ---> e9ae3c220b23
Step 2 : RUN apt-get update && apt-get install -y ruby ruby-dev
 ---> Using cache
 ---> aa004737d5d8
Step 3 : RUN gem install sinatra
 ---> Using cache
 ---> 6929d3f6a65b
Successfully built 6929d3f6a65b

eric@almond sinatra]$ docker rmi ouruser/sinatra:v3
Untagged: ouruser/sinatra:v3


/ 13	. 

[eric@almond sinatra]$ docker run -it ouruser/sinatra:v2 /bin/bash
root@d1ab9356bfbb:/# exit
exit


/ 13	. 

eric@almond sinatra]$ docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             VIRTUAL SIZE
ouruser/sinatra     v2                  6929d3f6a65b        39 hours ago        319 MB

[eric@almond sinatra]$ docker tag 6929d3f6a65b ouruser/sinatra:devel
[eric@almond sinatra]$ docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             VIRTUAL SIZE
ouruser/sinatra     v2                  6929d3f6a65b        39 hours ago        319 MB
ouruser/sinatra     devel               6929d3f6a65b        39 hours ago        319 MB

/ 13	. 

[eric@almond sinatra]$ docker images --digests
REPOSITORY          TAG                 DIGEST              IMAGE ID            CREATED             VIRTUAL SIZE
ouruser/sinatra     v2                  <none>              6929d3f6a65b        39 hours ago        319 MB
ouruser/sinatra     devel               <none>              6929d3f6a65b        39 hours ago        319 MB
... 

Images that use the v2 or later format 
/ TODO

[eric@almond sinatra]$  docker rmi ouruser/sinatra:devel
Untagged: ouruser/sinatra:devel


/ 13	. 

/ docker push 
/ TODO

/ 13	. 

/ 7	. 

/ networking containers



 

/ 13	. 

/ met -d	,

[eric@almond sinatra]$ docker run -d -P --name web training/webapp python app.py
3372645eb10f8c2b232d5ee770c575167ce323a216dbfe33c5f1028d5a88820c
[eric@almond sinatra]$ docker ps -a
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS                     NAMES
3372645eb10f        training/webapp     "python app.py"     7 seconds ago       Up 5 seconds        0.0.0.0:32768->5000/tcp   web

/ zonder -d	,

eric@almond sinatra]$ docker run  -P --name web training/webapp python app.py
 * Running on http://0.0.0.0:5000/ (Press CTRL+C to quit)
^C
[eric@almond sinatra]$ docker ps -a
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS                      PORTS               NAMES
39cd5a734791        training/webapp     "python app.py"     36 seconds ago      Exited (0) 26 seconds ago                       web

[eric@almond sinatra]$ docker rm web
web
/ we kunnen dus na ^c meteen rm container	, met ^c doen we dus stop	,

[eric@almond sinatra]$ docker network ls
NETWORK ID          NAME                DRIVER
75762898642f        bridge              bridge              
266d78f1bdc6        none                null                
e0f458d228f0        host                host              

[eric@almond sinatra]$ docker run -itd --name=test ubuntu
bd01ebb47fe901027444689134056b7136f460418fd9e956bd4cb5cc7beb862e

 
 
[eric@almond sinatra]$ docker network inspect bridge
[
    {
        "Name": "bridge",
        "Id": "75762898642fd4ad33c790ffa0a02b56d0983dc11b08c49e453b15fd586c1269",
        "Scope": "local",
        "Driver": "bridge",
        "IPAM": {
            "Driver": "default",
            "Config": [
                {
                    "Subnet": "172.17.0.0/16"
                }
            ]
        },
        "Containers": {
            "bd01ebb47fe901027444689134056b7136f460418fd9e956bd4cb5cc7beb862e": {
                "EndpointID": "6b6b37c53bb109d149177fb7cefd09442dd5c7994c525449556a2a2d45ac5701",
                "MacAddress": "02:42:ac:11:00:02",
                "IPv4Address": "172.17.0.2/16",
                "IPv6Address": ""
            }
        },
        "Options": {
            "com.docker.network.bridge.default_bridge": "true",
            "com.docker.network.bridge.enable_icc": "true",
            "com.docker.network.bridge.enable_ip_masquerade": "true",
            "com.docker.network.bridge.host_binding_ipv4": "0.0.0.0",
            "com.docker.network.bridge.name": "docker0",
            "com.docker.network.driver.mtu": "1500"
        }
    }
]

[eric@almond sinatra]$  docker network disconnect bridge test
[eric@almond sinatra]$ docker network inspect bridge
[
    {
        "Name": "bridge",
        "Id": "75762898642fd4ad33c790ffa0a02b56d0983dc11b08c49e453b15fd586c1269",
        "Scope": "local",
        "Driver": "bridge",
        "IPAM": {
            "Driver": "default",
            "Config": [
                {
                    "Subnet": "172.17.0.0/16"
                }
            ]
        },
        "Containers": {},
        "Options": {
            "com.docker.network.bridge.default_bridge": "true",
            "com.docker.network.bridge.enable_icc": "true",
            "com.docker.network.bridge.enable_ip_masquerade": "true",
            "com.docker.network.bridge.host_binding_ipv4": "0.0.0.0",
            "com.docker.network.bridge.name": "docker0",
            "com.docker.network.driver.mtu": "1500"
        }
    }
]


[eric@almond sinatra]$  docker network connect bridge test
[eric@almond sinatra]$ docker network inspect bridge
...
/ test is er weer	, 

[eric@almond sinatra]$ docker network create  -d bridge my-bridge-network
36441837c4b3e4be9145b127b53b3285b418b58d2d9bd216fd6f5fd958457a89
[eric@almond sinatra]$ docker network inspect my-bridge-network
[
    {
        "Name": "my-bridge-network",
        "Id": "36441837c4b3e4be9145b127b53b3285b418b58d2d9bd216fd6f5fd958457a89",
        "Scope": "local",
        "Driver": "bridge",
        "IPAM": {
            "Driver": "default",
            "Config": [
                {}
            ]
        },
        "Containers": {},
        "Options": {}
    }
]

/ 7	. 

[eric@almond misc]$ docker  run --net my-bridge-2 --rm --name test -it  centos
[root@95e5e2b27e3b /]# 

[eric@almond misc]$ docker network inspect my-bridge-2
[
    {
        "Name": "my-bridge-2",
        "Id": "d864cce2936f8dcdda64f74ee1ca2adf52ffeec64140212dbd79825b79821a36",
        "Scope": "local",
        "Driver": "bridge",
        "IPAM": {
            "Driver": "default",
            "Options": {},
            "Config": [
                {
                    "Subnet": "172.18.0.0/16",
                    "Gateway": "172.18.0.1/16"
                }
            ]
        },
        "Containers": {
            "95e5e2b27e3b443d80b7de9e06fe884ccfea08bf3e53f73a0047756b89734002": {
                "Name": "test",
                "EndpointID": "d0cf250212fc8f0ca2319aecdbacbfbc5e0c3edb9c208bd9e12ef2b94ea9f133",
                "MacAddress": "02:42:ac:12:00:02",
                "IPv4Address": "172.18.0.2/16",
                "IPv6Address": ""
            }
        },
        "Options": {}
    }
]

[eric@almond misc]$ docker network disconnect my-bridge-2 test 
[eric@almond misc]$ docker network connect bridge test 
[eric@almond misc]$ docker stop test

/ 7	. 

/ docker exec opens a shell to your running db container:

/ 7	. 

/ update image	,

/ we hebben bijv	,
[eric@almond misc]$ docker images ubuntu 
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
ubuntu              14.04               06ab2de020f4        7 months ago        187.9 MB
ubuntu              latest              4b1e42b414f6        8 months ago        187.9 MB
/maar wat 8 months ago latest was, is dat nu niet meer , WH	,

[eric@almond misc]$ docker pull ubuntu
Using default tag: latest
latest: Pulling from library/ubuntu
43db9dbdcb30: Pull complete 
85a9cd1fcca2: Pull complete 
c23af8496102: Pull complete 
e88c36ca55d8: Pull complete 
Digest: sha256:7ce82491d6e35d3aa7458a56e470a821baecee651fba76957111402591d20fc1
Status: Downloaded newer image for ubuntu:latest

[eric@almond misc]$ docker images ubuntu 
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
ubuntu              latest              ac526a356ca4        4 days ago          125.2 MB
ubuntu              14.04               06ab2de020f4        7 months ago        187.9 MB

/ Hij is updated	, en veel kleiner	, 

/ Het is WH beter om tags te download	, niet latest	,

[eric@almond misc]$ docker pull training/postgres
Using default tag: latest
latest: Pulling from training/postgres
a3ed95caeb02: Already exists 
6e71c809542e: Already exists 
2978d9af87ba: Already exists 
e1bca35b062f: Already exists 
500b6decf741: Already exists 
74b14ef2151f: Already exists 
7afd5ed3826e: Already exists 
3c69bb244f5e: Already exists 
d86f9ec5aedf: Already exists 
010fabf20157: Already exists 
Digest: sha256:a945dc6dcfbc8d009c3d972931608344b76c2870ce796da00a827bd50791907e
Status: Image is up to date for training/postgres:latest

/ Deze is up to date	,

/ 7	. 

/ Lees	,
Dockerize an application
	Dockerizing Postgres
https://docs.docker.com/v1.11/engine/examples/postgresql_service/

/ Lees	, 
Engine Reference	,
	Docker run reference

/ 7	 

[eric@almond misc]$ pwd
/home/eric/Devel/Docker2/misc

[eric@almond misc]$ cat Dockerfile 
from debian 
run echo "Foo Bar"
entrypoint ["top"]
cmd ["-b","-c"]

 


[eric@almond misc]$ docker build --rm -t misc .
Sending build context to Docker daemon 2.048 kB
Step 1 : FROM debian
 ---> bd94bc3c03b9
Step 2 : RUN echo "Foo Bar"
 ---> Running in 9d9420e1c32b
Foo Bar
 ---> d18010c0194f
Removing intermediate container 9d9420e1c32b
Step 3 : ENTRYPOINT top
 ---> Running in a1fbc998bfb4
 ---> 1e456f7743f7
Removing intermediate container a1fbc998bfb4
Step 4 : CMD -b -c
 ---> Running in bd17218e6662
 ---> 09c73925b71a
Removing intermediate container bd17218e6662
Successfully built 09c73925b71a

[eric@almond misc]$ docker history misc
IMAGE               CREATED             CREATED BY                                      SIZE                COMMENT
09c73925b71a        6 minutes ago       /bin/sh -c #(nop) CMD ["-b" "-c"]               0 B                 
1e456f7743f7        6 minutes ago       /bin/sh -c #(nop) ENTRYPOINT &{["top"]}         0 B                 
d18010c0194f        6 minutes ago       /bin/sh -c echo "Foo Bar"                       0 B                 
bd94bc3c03b9        7 months ago        /bin/sh -c #(nop) CMD ["/bin/bash"]             0 B                 
401cfe922c2a        7 months ago        /bin/sh -c #(nop) ADD file:863d6edd178364362a   125.1 MB  

/ WH 
run command worden exec in image 	, door docker build	,
entrypoint, cmd worden exec in container	, door docker run	,



/ 7	. 

/ we zien dat de Dockerfile van training/postgres heel anders is dan docker-library postgres	, training/postgres uses service postgres start	, docker-library CMD ["docker"]	, 
/ TODO

/ in docker-library/postgres/9.4	,
$ vi Dockerfile
FROM debian:jessie

/ we zien jessie in docker-library/buildpack-deps	,
/ TODO

/ op https://hub.docker.com/_/debian/	,
8.2, 8, jessie, latest (jessie/Dockerfile)
/ Dus jessie is latest	,
/ we kijken in de docker file	,
$ vi https://github.com/tianon/docker-brew-debian/.../jessie/Dockerfile
FROM scratch
ADD rootfs.tar.xz /
CMD ["/bin/bash"]
/ TODO

[eric@almond sinatra]$ docker pull debian:jessie
jessie: Pulling from library/debian
9ee13ca3b908: Pull complete 
23cb15b0fcec: Pull complete 
Digest: sha256:24a900d1671b269d6640b4224e7b63801880d8e3cb2bcbfaa10a5dddcf4469ed
Status: Downloaded newer image for debian:jessie
/=
[eric@almond sinatra]$ docker pull debian
Using default tag: latest
latest: Pulling from library/debian
Digest: sha256:2a5204f0a00510e9b99d7ec0fe40bea495b8e3630b820b04675488aad4188e06
Status: Downloaded newer image for debian:latest

/ Lees	official repo	,
https://github.com/docker-library/postgres/.../9.4/Dockerfile

/ Intermezzo

[eric@almond sinatra]$ docker rmi debian
Untagged: debian:latest
[eric@almond sinatra]$ docker run -it --name deb debian
Unable to find image 'debian:latest' locally
latest: Pulling from library/debian
Digest: sha256:2a5204f0a00510e9b99d7ec0fe40bea495b8e3630b820b04675488aad4188e06
Status: Downloaded newer image for debian:latest
root@54bad2620187:/# exit
/ Nu doet hij toch weer 'docker pull debian'	,

/ EInde Intermezzo

eric@almond sinatra]$ docker pull postgres
Using default tag: latest
latest: Pulling from library/postgres
d630ddc7aec4: Pull complete 
c74beba9de66: Pull complete 
77a33b9160e7: Pull complete 
c27cdb916a4a: Pull complete 
f114dda4521b: Pull complete 
11f38e247778: Pull complete 
d13a3ea275ee: Pull complete 
d85c3186396c: Pull complete 
a6fc0a49fe73: Pull complete 
edf89d70f219: Pull complete 
113ae1719852: Pull complete 
aaaba168d6ad: Pull complete 
96d547d0633c: Pull complete 
9564ca20b9bd: Pull complete 
827e490b257c: Pull complete 
08ce037a3d7c: Pull complete 
7299ae2bdb92: Pull complete 
a42c68cbbca3: Pull complete 
b305a133422a: Pull complete 
Digest: sha256:bdef0bcea806b2377c6b3e88c6a741b7fb821fc3211a2b971b180817f25a3dfb
Status: Downloaded newer image for postgres:latest

[eric@almond sinatra]$ docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             VIRTUAL SIZE
postgres            latest              b305a133422a        10 days ago         265.1 MB

/ 13	. 

/ we doen toch training/postgres eerst	,

[eric@almond sinatra]$ docker pull ubuntu:14.04
Status: Downloaded newer image for ubuntu:14.04

[eric@almond sinatra]$ docker pull training/postgres

[eric@almond sinatra]$ docker run --net=my-bridge-network --name db  --rm training/postgres
2015-12-15 21:03:03 UTC LOG:  database system was interrupted; last known up at 2014-06-02 23:51:25 UTC
2015-12-15 21:03:03 UTC LOG:  database system was not properly shut down; automatic recovery in progress
2015-12-15 21:03:03 UTC LOG:  redo starts at 0/1782F38
2015-12-15 21:03:03 UTC LOG:  record with zero length at 0/17835C8
2015-12-15 21:03:03 UTC LOG:  redo done at 0/1783598
2015-12-15 21:03:03 UTC LOG:  last completed transaction was at log time 2014-06-02 23:51:25.978993+00
2015-12-15 21:03:03 UTC LOG:  database system is ready to accept connections
2015-12-15 21:03:03 UTC LOG:  autovacuum launcher started

[eric@almond sinatra]$ docker exec -it db /bin/bash
root@7b05df348961:/# ps ajx
 PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND
    0     1     1     1 ?           -1 Ss       0   0:00 su postgres -c /usr/lib
    1     9     9     9 ?           -1 Ss     102   0:00 /usr/lib/postgresql/9.3
    9    11    11    11 ?           -1 Ss     102   0:00 postgres: checkpointer 
    9    12    12    12 ?           -1 Ss     102   0:00 postgres: writer proces
    9    13    13    13 ?           -1 Ss     102   0:00 postgres: wal writer pr
    9    14    14    14 ?           -1 Ss     102   0:00 postgres: autovacuum la
    9    15    15    15 ?           -1 Ss     102   0:00 postgres: stats collect
    0    16    16    16 ?           26 Ss       0   0:00 /bin/bash
   16    26    26    16 ?           26 R+       0   0:00 ps ajx
root@7b05df348961:/# psql -U docker   
psql: FATAL:  Peer authentication failed for user "docker"

/ we moeten pg_hba.conf aanpassen	, en ee signal geven	,
/ Dit moeten we steeds in elke container doen	,
/ deze is in /etc/	,

root@1aed22ac7e4c:/etc/postgresql/9.3/main# vi pg_hba.conf              
# "local" is for Unix domain socket connections only
local   all             all                                    trust
# IPv4 local connections:
host    all             all             127.0.0.1/32           trust
# IPv6 local connections:
host    all             all             ::1/128                trust

/ we hoeven alleen de 1ste trust te maken	, er stond peer	,

root@1aed22ac7e4c:/etc/postgresql/9.3/main# ps ajx
 PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND
    0     1     1     1 ?           -1 Ss       0   0:00 su postgres -c /usr/lib
    1     8     8     8 ?           -1 Ss     102   0:00 /usr/lib/postgresql/9.3
    8    10    10    10 ?           -1 Ss     102   0:00 postgres: checkpointer 
    8    11    11    11 ?           -1 Ss     102   0:00 postgres: writer proces
    8    12    12    12 ?           -1 Ss     102   0:00 postgres: wal writer pr
    8    13    13    13 ?           -1 Ss     102   0:00 postgres: autovacuum la
    8    14    14    14 ?           -1 Ss     102   0:00 postgres: stats collect
    0    15    15    15 ?          143 Ss       0   0:00 /bin/bash
   15   143   143    15 ?          143 R+       0   0:00 ps ajx

root@1aed22ac7e4c:/etc/postgresql/9.3/main# kill -HUP 8      

 /we wilden doen	,
# pg_ctl reload
/ maar er is geen pg_ctl	,


root@1aed22ac7e4c:/etc/postgresql/9.3/main# psql -U postgres
psql (9.3.10)
Type "help" for help.

postgres=# \q
root@1aed22ac7e4c:/etc/postgresql/9.3/main# psql -U docker  
psql (9.3.10)
Type "help" for help.

docker=# \q

/ 13	. 

/ RUN worden tijdens de build exec	, 

/ 13	. 

[eric@almond Docker2]$ docker network inspect my-bridge-network
[
    {
        "Name": "my-bridge-network",
        "Id": "36441837c4b3e4be9145b127b53b3285b418b58d2d9bd216fd6f5fd958457a89",
        "Scope": "local",
        "Driver": "bridge",
        "IPAM": {
            "Driver": "default",
            "Config": [
                {}
            ]
        },
        "Containers": {
            "cc2355e0a7c36a543ab1eb74e4430042c5afa9694cf8fa0865ee54b62e3dda4f": {
                "EndpointID": "7018ec8e892f883f0a029236739b97827ccd8037742a349db2415b98eafa9c71",
                "MacAddress": "02:42:ac:12:00:02",
                "IPv4Address": "172.18.0.2/16",
                "IPv6Address": ""
            }
        },
        "Options": {}
    }
]

/ 	13	. 

[eric@almond Docker2]$ docker run -P --name web training/webapp python app.py
/ met of zonder -P

[eric@almond Docker2]$ docker network connect my-bridge-network web

[eric@almond Docker2]$ docker network inspect my-bridge-network
[eric@almond Docker2]$ docker network inspect my-bridge-network
[
    {
        "Name": "my-bridge-network",
        "Id": "36441837c4b3e4be9145b127b53b3285b418b58d2d9bd216fd6f5fd958457a89",
        "Scope": "local",
        "Driver": "bridge",
        "IPAM": {
            "Driver": "default",
            "Config": [
                {}
            ]
        },
        "Containers": {
            "5e68a2c9d15cb73de908ea2dcbf7d7326aeffd2e428a2277ae26ced31250f233": {
                "EndpointID": "2fa2554cceedb7556e4e1d25b9e49c120ba1e6b843d9b40bcfca98fbc12145b3",
                "MacAddress": "02:42:ac:12:00:03",
                "IPv4Address": "172.18.0.3/16",
                "IPv6Address": ""
            },
            "cc2355e0a7c36a543ab1eb74e4430042c5afa9694cf8fa0865ee54b62e3dda4f": {
                "EndpointID": "7018ec8e892f883f0a029236739b97827ccd8037742a349db2415b98eafa9c71",
                "MacAddress": "02:42:ac:12:00:02",
                "IPv4Address": "172.18.0.2/16",
                "IPv6Address": ""
            }
        },
        "Options": {}
    }
]

/ we zijn op db	,

root@cc2355e0a7c3:/# ping web
PING web (172.18.0.3) 56(84) bytes of data.
64 bytes from web (172.18.0.3): icmp_seq=1 ttl=64 time=0.258 ms
64 bytes from web (172.18.0.3): icmp_seq=2 ttl=64 time=0.152 ms
^C

/ we kunnen ook	,
root@cc2355e0a7c3:/# ping 172.18.0.3
PING 172.18.0.3 (172.18.0.3) 56(84) bytes of data.
64 bytes from 172.18.0.3: icmp_seq=1 ttl=64 time=0.254 ms
64 bytes from 172.18.0.3: icmp_seq=2 ttl=64 time=0.142 ms
^C
--- 172.18.0.3 ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2000ms
rtt min/avg/max/mdev = 0.137/0.177/0.254/0.056 ms
root@cc2355e0a7c3:/# ping 172.18.0.2
PING 172.18.0.2 (172.18.0.2) 56(84) bytes of data.
64 bytes from 172.18.0.2: icmp_seq=1 ttl=64 time=0.100 ms
64 bytes from 172.18.0.2: icmp_seq=2 ttl=64 time=0.088 ms
^C

/ we kunnen NIET op db	, 
# ping db
root@cc2355e0a7c3:/# ping db
PING db.nuts.org (69.172.201.208) 56(84) bytes of data.
/ TODO

/ Als we op web gaan 	, zien we hetzelfde	,

/ 7	. 

/ Lees	,
https://docs.docker.com/engine/userguide/networking/dockernetworks/

/ we lezen dat als we containers op name willen vinden, we een eigen user-network moeten maken	, of bridge gebruiken en dan met --link connect	, 
/ we doen 1ste	,

$ docker network create -d bridge my-bridge

[eric@almond Logs]$ docker run -it --rm --name first --net=my-bridge centos 
[root@1473fc9638a8 /]# cat /etc/hosts
172.19.0.2	1473fc9638a8
127.0.0.1	localhost
::1	localhost ip6-localhost ip6-loopback
fe00::0	ip6-localnet
ff00::0	ip6-mcastprefix
ff02::1	ip6-allnodes
ff02::2	ip6-allrouters
172.19.0.3	second
172.19.0.3	second.my-bridge

eric@almond Logs]docker run -it --rm --name second --net=my-bridge centos
  [root@21f67d6c71f2 /]#  cat /etc/hosts
172.19.0.3	21f67d6c71f2
127.0.0.1	localhost
::1	localhost ip6-localhost ip6-loopback
fe00::0	ip6-localnet
ff00::0	ip6-mcastprefix
ff02::1	ip6-allnodes
ff02::2	ip6-allrouters
172.19.0.2	first
172.19.0.2	first.my-bridge

/ second verschijnt pas in /etc/hosts op first als hij created is	, 

[root@1473fc9638a8 /]# ping second
PING second (172.19.0.3) 56(84) bytes of data.
64 bytes from second (172.19.0.3): icmp_seq=1 ttl=64 time=0.267 ms
64 bytes from second (172.19.0.3): icmp_seq=2 ttl=64 time=0.144 ms
...




/ 7	. 

Manage data in containers

/ we doen eerst wat we altijd doen, zonder -v	,
[eric@almond postgres]$ docker run -P --name web training/webapp python app.py
 * Running on http://0.0.0.0:5000/ (Press CTRL+C to quit)

[eric@almond Docker2]$ docker exec -it web /bin/bash
root@db6d42bcb448:/opt/webapp# ls
Procfile  app.py  requirements.txt  tests.py


/ we komen niet in /	, maar in /opt/webapp
/ TODO

/ 13	. 

/ -v

[eric@almond postgres]$ docker run -v /webapp -P --name web --rm training/webapp python app.py
 * Running on http://0.0.0.0:5000/ (Press CTRL+C to quit)

[eric@almond Docker2]$ docker inspect web 
[
   "Mounts": [
        {
            "Name": "a035dd5fe498a0460e46b1c79cdb7e11771f62fc5608ec4a77de2031c8aa662f",
            "Source": "/var/lib/docker/volumes/a035dd5fe498a0460e46b1c79cdb7e11771f62fc5608ec4a77de2031c8aa662f/_data",
            "Destination": "/webapp",
            "Driver": "local",
            "Mode": "",
            "RW": true
        }
    ],

/ Op op de host is de volume var/lib/docker/volumes/a035dd5fe498a0460e46b1c79cdb7e11771f62fc5608ec4a77de2031c8aa662f/_data	, 
/ in de container /webapp	,

 [eric@almond Docker2]$ docker exec -it web /bin/bash
root@f3195ad1bc76:/opt/webapp# ls
Procfile  app.py  requirements.txt  tests.py
root@db6d42bcb448:/opt/webapp# ls /
bin   dev  home  lib64  mnt  proc  run   srv  tmp  var
boot  etc  lib   media  opt  root  sbin  sys  usr  webapp


/ 13	. 

[eric@almond Docker2]$ docker run -v $(pwd)/src/webapp:/webapp -P --name web --rm training/webapp python app.py
 * Running on http://0.0.0.0:5000/ (Press CTRL+C to quit)


[eric@almond Docker2]$ mkdir src/webapp -p
[eric@almond Docker2]$ echo "Foo Bar" >src/webapp/foo.txt 

[eric@almond Docker2]$ docker run -v $(pwd)/src/webapp:/webapp -P --name web --rm training/webapp python app.py
 * Running on http://0.0.0.0:5000/ (Press CTRL+C to quit)

[eric@almond Docker2]$ docker exec -it web bash
root@079744a9a6c3:/opt/webapp# ls /webapp/
foo.txt
root@079744a9a6c3:/opt/webapp# cat /webapp/foo.txt 
Foo Bar

/ 13	. 

[eric@almond Docker2]$ docker run -v $(pwd)/src/webapp:/opt/webapp -P --name web --rm training/webapp python app.py
python: can't open file 'app.py': [Errno 2] No such file or directory

/ dus de local dir overwrites the container dir	,


/ 13	. 

Mounting a host directory can be useful for testing.

/ we kunnen kijken wat de 4 files zijn, en ze op de host neerzetten , en mount	, 
/ Dus 1 keer zonder -v start	, en kijken met exec wat er staat	,

[eric@almond Docker2]$ docker run -P --name web --rm training/webapp python app.py
 * Running on http://0.0.0.0:5000/ (Press CTRL+C to quit)

[eric@almond Docker2]$ docker exec -it web bash
root@71e000de13db:/opt/webapp# ls
Procfile  app.py  requirements.txt  tests.py

/ we nemen ze alle 4 over op de host in src/webapp	, 
/ en we doen , met -v	,
[eric@almond Docker2]$ docker run -v $(pwd)/src/webapp:/opt/webapp -P --name web --rm training/webapp python app.py
 * Running on http://0.0.0.0:5000/ (Press CTRL+C to quit)

eric@almond Docker2]$ docker exec -it web bash
root@873a2cf99667:/opt/webapp# ls 
Procfile  app.py  foo.txt  requirements.txt  tests.py

/ we hadden op de host ook foo.txt erbij staan	,

/ 13	. 

[eric@almond Docker2]$ docker run -v $(pwd)/src/webapp:/opt/webapp -P --name web --rm training/webapp python app.py
 * Running on http://0.0.0.0:5000/ (Press CTRL+C to quit)

[eric@almond Docker2]$ docker run -v $(pwd)/src/webapp:/opt/webapp -P --name web2 --rm training/webapp python app.py
 * Running on http://0.0.0.0:5000/ (Press CTRL+C to quit)

[eric@almond Docker2]$ docker ps -a
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS                     NAMES
29ebf825a406        training/webapp     "python app.py"     8 seconds ago       Up 7 seconds        0.0.0.0:32784->5000/tcp   web2
a0a603562eab        training/webapp     "python app.py"     3 minutes ago       Up 3 minutes        0.0.0.0:32782->5000/tcp   web

/ we zien dus dat de ports op de host 32784 en 32782 zijn waaronder we de service die 

/ we doen op de host	,
http://localhost:32782/
/ en	, 
http://localhost:32784/
/ allebei OK	,

/ Maar in de containers doen we, 	
root@a0a603562eab:/opt/webapp# apt-get update && apt-get install curl
root@a0a603562eab:/opt/webapp# curl localhost:5000                   
Hello world!

/ of	,
# curl --url localhost:5000


/ Intermezzo

/ Met inspect of network inspect zien we de ip &'s van de containers	,
/ Wat we u  hier wilde weten is de port op de host of containers waar een service bereikbaar was	,

/ er is 
docker network inspect bridge
docker inspect web 


/ Einde Intermezzo

/ 13	. 

[eric@almond Docker2]$ docker run --rm -it -v ~/.bash_history:/root/.bash_history centos

/ Lees	,
https://docs.docker.com/engine/userguide/dockervolumes/

/ we moeten /root/.bash_history in container, NIET /.bash_history	,

/als we exit container, we zien de commands gegeven (als root) in de container in ~/.bash_history	,  die van eric dus	,

/ 13	 

/ start 2 centos containers in bridge network	,

[eric@almond Logs]$ docker run -it --rm --name first centos 
[root@7e565a3e3314 /]# 

[eric@almond Logs]$ docker run -it --rm --name second centos 
[root@14a2e0176beb /]# 

[eric@almond Logs]$ docker network inspect bridge
       "Containers": {
            "14a2e0176beb7b2e8eec5b692c852666b5b770476709b51f4abdee88801c1047": {
                "EndpointID": "9d948008d391682ba675fc027ddf5472512745df56e16f26b9875717705f8f9e",
                "MacAddress": "02:42:ac:11:00:03",
                "IPv4Address": "172.17.0.3/16",
                "IPv6Address": ""
            },
            "7e565a3e33143105eae9efaffb2c38033d912537ee9d2769d1ae1eda70fa580b": {
                "EndpointID": "64f8e4b090b7eac527f5d93b5835462b988d414284cc0d6b9992357094c8db38",
                "MacAddress": "02:42:ac:11:00:02",
                "IPv4Address": "172.17.0.2/16",
                "IPv6Address": ""
            }





/ 13	. 

/ named volumes	,

[eric@almond Docker2]$ docker create -v /dbdata --name dbdata training/postgres /bin/true

[eric@almond Docker2]$ docker run --volumes-from dbdata --name db1 training/postgres 


eric@almond Docker2]$ docker run --volumes-from dbdata --name db2 training/postgres
2015-12-17 14:57:55 UTC LOG:  database system was interrupted; last known up at 2014-06-02 23:51:25 UTC
2015-12-17 14:57:55 UTC LOG:  database system was not properly shut down; automatic recovery in progress
2015-12-17 14:57:55 UTC LOG:  redo starts at 0/1782F38
2015-12-17 14:57:55 UTC LOG:  record with zero length at 0/17835C8
2015-12-17 14:57:55 UTC LOG:  redo done at 0/1783598
2015-12-17 14:57:55 UTC LOG:  last completed transaction was at log time 2014-06-02 23:51:25.978993+00
2015-12-17 14:57:55 UTC LOG:  autovacuum launcher started
2015-12-17 14:57:55 UTC LOG:  database system is ready to accept connections


[eric@almond Docker2]$ docker exec -it db1 bash
root@1089c738f04f:/# ls 
bin   dbdata  etc   lib    media  opt	root  sbin  sys  usr
boot  dev     home  lib64  mnt	  proc	run   srv   tmp  var

eric@almond Docker2]$ docker exec -it db1 bash
root@1089c738f04f:/# 

[eric@almond Docker2]$ docker exec -it db2 bash
root@94793914eee3:/# cat >/dbdata/foo.txt
Foo Bar

/ dan in db1	, 
root@1089c738f04f:/# cat /dbdata/foo.txt 
Foo Bar

/ we edit in db1	,
root@1089c738f04f:/# vi /dbdata/foo.txt 
Foo Bar
Gee Hee

/ en dit zien we dat in db2 ook	, 

/ op de host	,
/ we moeten de root container inspect die de volume heeft	, deze heeft de mount point	,
[eric@almond Docker2]$ docker inspect dbdata
   "Mounts": [
        {
            "Name": "8c7556255a64495d9b283265f2a9cb098bf6a3c61930ac7897939cd36c980a1d",
            "Source": "/var/lib/docker/volumes/8c7556255a64495d9b283265f2a9cb098bf6a3c61930ac7897939cd36c980a1d/_data",
...

[eric@almond Docker2]$ sudo  cat /var/lib/docker/volumes/8c7556255a64495d9b283265f2a9cb098bf6a3c61930ac7897939cd36c980a1d/_data/foo.txt
Foo Bar
Gee Hee

/ 7	.  

Store images on Docker Hub
/ TODO

/ Einde DOCKER MANUAL AGAIN DOCKER2


/ DOCKER MISC

/ 7	. 

/ exec	,

/ Hoe connect to running container	?

/ 13	. 

/ in de ene shell	,

[eric@almond sinatra]$ docker run -it --rm --name my  debian
root@a465626d366d:/# 

/ of	,

[eric@almond sinatra]$ docker run -tid --name my    debian
c9ce4577b14d3313e4f857430a42f81726de9a05239dd86010ec7239a6b67c58
[eric@almond sinatra]$ 

/ of	,

[eric@almond sinatra]$ docker run -tid --name my    debian
oot@fd4007248196:/# 
/ Maar we kunnen niets met deze bash	, niet interactive	,




/ in andere shell	,
[eric@almond sinatra]$ docker exec -it my /bin/bash
root@c9ce4577b14d:/# ps ajx
 PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND
    0     1     1     1 ?            1 Ss+      0   0:00 /bin/bash
    0    10    10    10 ?           17 Ss       0   0:00 /bin/bash
   10    17    17    10 ?           17 R+       0   0:00 ps ajx
root@c9ce4577b14d:/# exit
exit
[eric@almond sinatra]$ docker exec -ti my /bin/bash
root@c9ce4577b14d:/# psa jx
bash: psa: command not found
root@c9ce4577b14d:/# ps ajx
 PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND
    0     1     1     1 ?            1 Ss+      0   0:00 /bin/bash
    0    18    18    18 ?           27 Ss       0   0:00 /bin/bash
   18    27    27    18 ?           27 R+       0   0:00 ps ajx

[eric@almond sinatra]$ docker stop my
my
[eric@almond sinatra]$ docker rm my
my

/ 13	. 

[eric@almond sinatra]$ docker run -d  --name my  debian
145460d172415568510683b66d9272654e2b0722800036614a709ddd75a02f2b
[eric@almond sinatra]$ docker ps -a
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS                      PORTS               NAMES
145460d17241        debian              "/bin/bash"         17 seconds ago      Exited (0) 15 seconds ago                       my

/ 13	. 

/ we zien dat als we -i en/of -t geven	, de container Up is	, of we -d geven of niet	, en er is een /bin/bash start	,
/ geven we niets of -d	, dan is de container Exited	, 
/ TODO



/ 13	.

[eric@almond sinatra]$ docker run -i --rm  --name my  debian

/ deze start /bin/bash	,

/ in een andere shell	,
[eric@almond sinatra]$ docker exec -it my /bin/bash
root@d7e84dc09e27:/# ps ajx
 PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND
    0     1     1     1 ?           -1 Ss       0   0:00 /bin/bash
    0     8     8     8 ?           15 Ss       0   0:00 /bin/bash
    8    15    15     8 ?           15 R+       0   0:00 ps ajx
root@d7e84dc09e27:/# exit
exit
[eric@almond sinatra]$ docker stop my
my

/ 13	. 

/ 	7. 

/ attach

/ 13	. 

/ in een terminal	,

[eric@almond sinatra]$ docker run  -i --name my    debian

/ in een andere terminal	, 

[eric@almond sinatra]$ docker attach my 
^C
/ doet niets	,

/ in een andere terminal	,
[eric@almond sinatra]$ docker stop my && docker rm my
my
my

/ 13	. 

/ in een terminal	,

[eric@almond sinatra]$ docker run  -t --name my    debian

/ in een andere terminal	, 

[eric@almond sinatra]$ docker attach my 
^C
/ doet niets	,

/ in een andere terminal	,
[eric@almond sinatra]$ docker stop my && docker rm my
my
my

/ 13	. 

/ in een ene terminal	, 
[eric@almond sinatra]$ docker run  -it --name my  --rm  debian

/ in een andere terminal	, 
[eric@almond sinatra]$ docker attach my 
/ Enter
root@9370a68331c1:/# ls
bin   dev  home  lib64	mnt  proc  run	 srv  tmp  var
boot  etc  lib	 media	opt  root  sbin  sys  usr
root@9370a68331c1:/# ps ajx
 PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND
    0     1     1     1 ?           10 Ss       0   0:00 /bin/bash
    1    10    10     1 ?           10 R+       0   0:00 ps ajx
root@9370a68331c1:/# exit
exit

/ 7	. 

/ ssh in docker 	,

/ 13	. 

$ vi Dockerfile

from centos
run yum -y install openssh-server openssh-clients
run yum clean all

expose 22
cmd ["/usr/sbin/sshd","-D"]

[eric@almond ssh]$ docker build --rm -t local/centos-sshd .

[eric@almond ssh]$ docker run --rm --name sshd -P local/centos-sshd
Could not load host key: /etc/ssh/ssh_host_rsa_key
Could not load host key: /etc/ssh/ssh_host_ecdsa_key
Could not load host key: /etc/ssh/ssh_host_ed25519_key

/ we lazen dat we moeten	,
ssh-keygen -A

/ -P 
/ TODO

/ vanwege het cmd heeft -it geen zin straks bij docker run	,

/ 13	. 

$ vi Dockerfile

from centos
run yum -y install openssh-server openssh-clients
run yum clean all

run echo 'root:rtdMpo45' | chpasswd

run FIL="/etc/ssh/sshd_config" TMP=$(mktemp);awk '{print gensub("(#)(PermitRootLogin yes)","\\2",1)}' "$FIL" >"$TMP";mv -f "$TMP" "$FIL"

run ssh-keygen -A

expose 22
cmd ["/usr/sbin/sshd","-D"]

[eric@almond ssh]$ docker build --rm -t local/centos-sshd .

[eric@almond ssh]$ docker run --rm --name sshd -P local/centos-sshd

[eric@almond ssh]$ docker exec -it sshd /usr/bin/bash
[root@edde747448fc /]# cat /etc/hosts
172.17.0.2	edde747448fc
127.0.0.1	localhost
...

/ edde747448fc	, localhost zijn allebei deze container	,

[root@edde747448fc /]# ssh localhost
root@localhost's password: rtdMpo45
/ of	,
[root@edde747448fc /]# ssh edde747448fc
root@edde747448fc's password: rtdMpo45 

/ 1313	.

/ we kunnen ook vanuit de host inlog in de container	,
[eric@almond Logs]$ docker port sshd
22/tcp -> 0.0.0.0:32775

[eric@almond Logs]$ ssh localhost -p 32775
root@localhost's password: rtdMpo45
Last login: Thu Dec 24 21:47:59 2015 from edde747448fc

/ 13	. 

/ we lezen in oude notes,	
bash-4.3#  ssh-keygen -t dsa -P '' -f ~/.ssh/id_dsa

/ 13	. 

/ we zien in oude Dockerfile	,
/home/eric/Devel/Docker/sshd

run ssh-keygen -N "" -t rsa -f ~/.ssh/id_rsa
run cat /root/.ssh/id_rsa.pub >>~/.ssh/authorized_keys

#run [ ! -e ~/.ssh ] && mkdir ~/.ssh
run if [ ! -e ~/.ssh ];then mkdir ~/.ssh;fi
copy id_dsa.pub /tmp/
run cat  /tmp/id_dsa.pub  >> ~/.ssh/authorized_keys

/ om van container naar container in te log	?
/ TODO





/ 7	. 

/ Als docker in een VM	,
$ docker-machine ip my-docker-vm
192.168.99.100
/ en doe	,
http://192.168.99.100:49155

/ Lees	,
Use Docker
Provision & set up docker hosts

https://docs.docker.com/machine/

/ Lees	,
Get started with Docker Machine and a local VM
https://docs.docker.com/machine/get-started/

/Lees	,

Use Docker
Provision & set up docker hosts
User docker machine with a cloud provider	,

/ Lees	,
http://superuser.openstack.org/articles/using-docker-machine-with-openstack

/ Lees	,
https://github.com/dhiltgen/docker-machine-kvm



/ 13	. 

/ X in docker	, 

/ geef in google,	
docker xlib

/ Lees	,
https://linuxmeerkat.wordpress.com/2014/10/17/running-a-gui-application-in-a-docker-container/
http://stackoverflow.com/questions/16296753/can-you-run-gui-apps-in-a-docker-container

/ geef in google,	
docker x

http://stackoverflow.com/questions/16296753/can-you-run-gui-apps-in-a-docker-container
http://stackoverflow.com/questions/16296753/can-you-run-gui-apps-in-a-docker-container

/ 7	. 

eric@almond sinatra]$ docker run -it --rm -name db postgres
The files belonging to this database system will be owned by user "postgres".
This user must also own the server process.

The database cluster will be initialized with locale "en_US.utf8".
The default database encoding has accordingly been set to "UTF8".
The default text search configuration will be set to "english".

Data page checksums are disabled.

fixing permissions on existing directory /var/lib/postgresql/data ... ok
creating subdirectories ... ok
selecting default max_connections ... 100
selecting default shared_buffers ... 128MB
selecting dynamic shared memory implementation ... posix
creating configuration files ... ok
creating template1 database in /var/lib/postgresql/data/base/1 ... ok
initializing pg_authid ... ok
initializing dependencies ... ok
creating system views ... ok
loading system objects' descriptions ... ok
creating collations ... ok
creating conversions ... ok
creating dictionaries ... ok
setting privileges on built-in objects ... ok
creating information schema ... ok
loading PL/pgSQL server-side language ... ok
vacuuming database template1 ... ok
copying template1 to template0 ... ok
copying template1 to postgres ... ok
syncing data to disk ... ok

WARNING: enabling "trust" authentication for local connections
You can change this by editing pg_hba.conf or using the option -A, or
--auth-local and --auth-host, the next time you run initdb.

Success. You can now start the database server using:

    postgres -D /var/lib/postgresql/data
or
    pg_ctl -D /var/lib/postgresql/data -l logfile start

****************************************************
WARNING: No password has been set for the database.
         This will allow anyone with access to the
         Postgres port to access your database. In
         Docker's default configuration, this is
         effectively any other container on the same
         system.

         Use "-e POSTGRES_PASSWORD=password" to set
         it in "docker run".
****************************************************
waiting for server to start....
LOG:  database system was shut down at 2015-12-15 14:13:52 UTC
LOG:  MultiXact member wraparound protections are now enabled
LOG:  database system is ready to accept connections
LOG:  autovacuum launcher started
 done
server started
ALTER ROLE


/docker-entrypoint.sh: ignoring /docker-entrypoint-initdb.d/*

LOG:  received fast shutdown request
LOG:  aborting any active transactions
LOG:  autovacuum launcher shutting down
waiting for server to shut down....
LOG:  shutting down
LOG:  database system is shut down
 done
server stopped

PostgreSQL init process complete; ready for start up.

LOG:  database system was shut down at 2015-12-15 14:13:54 UTC
LOG:  MultiXact member wraparound protections are now enabled
LOG:  database system is ready to accept connections
LOG:  autovacuum launcher started

/ Intermezzo 

^C
LOG:  received fast shutdown request
LOG:  aborting any active transactions
LOG:  autovacuum launcher shutting down
LOG:  shutting down
LOG:  database system is shut down

[eric@almond sinatra]$ docker ps -a
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES

/ we deden 'docker run --rm '	, 

/ Einde Intermezzo 

/ in andere terminal	,
[eric@almond sinatra]$ docker exec -it db /bin/bash
root@160bd2c30c69:/# ps ajx
 PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND
    0     1     1     1 ?            1 Ss+    999   0:00 postgres
    1    78    78    78 ?           -1 Ss     999   0:00 postgres: checkpointer 
    1    79    79    79 ?           -1 Ss     999   0:00 postgres: writer proces
    1    80    80    80 ?           -1 Ss     999   0:00 postgres: wal writer pr
    1    81    81    81 ?           -1 Ss     999   0:00 postgres: autovacuum la
    1    82    82    82 ?           -1 Ss     999   0:00 postgres: stats collect
    0   155   155   155 ?          163 Ss       0   0:00 /bin/bash
  155   163   163   155 ?          163 R+       0   0:00 ps ajx
root@160bd2c30c69:/# psql 
psql: FATAL:  role "root" does not exist

root@160bd2c30c69:/# psql -U postgres
psql (9.4.5)
Type "help" for help.

postgres=# 

/ of	, 

root@160bd2c30c69:/# su - postgres
No directory, logging in with HOME=/
$ pwd
/
$ psql 
psql (9.4.5)
Type "help" for help.

postgres=# \dt
No relations found.
postgres=# \l
                                 List of databases
   Name    |  Owner   | Encoding |  Collate   |   Ctype    |   Access privileges
   
-----------+----------+----------+------------+------------+--------------------
---
 postgres  | postgres | UTF8     | en_US.utf8 | en_US.utf8 | 
 template0 | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres        
  +
           |          |          |            |            | postgres=CTc/postgr
es
 template1 | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres        
  +
           |          |          |            |            | postgres=CTc/postgr
es
(3 rows)

/ 13	. 

/ we kunnen ook	,
[eric@almond sinatra]$ docker run  -it --rm --name db postgres /bin/bash
root@80024f5c6cb0:/# ./docker-entrypoint.sh postgres
...

/ en dan weer in andere terminal	,
[eric@almond sinatra]$ docker exec -it db /bin/bash  

/ We lezen nl in de Dockerfile	,

COPY docker-entrypoint.sh /

ENTRYPOINT ["/docker-entrypoint.sh"]

EXPOSE 5432
CMD ["postgres"]





/ Einde DOCKER MISC

/ DOCKER NOTES

http://nicholasjackson.github.io/other/micro-docker-images-for-microservices/
http://blog.hypriot.com/post/introducing-hypriot-cluster-lab-docker-clustering-as-easy-as-it-gets/



/ Einde DOCKER NOTES

/ DOCKER

/ Ga naar	, 
http://blog.docker.com

/ we zien bijv	,
DockerCon EU 2015 Videos: Docker, Docker, Docker
Docker Webinar Q&A: Persistent Storage & Docker

/ Einde DOCKER

/ DOCKER JENKINS MAVEN

/ Geef in google: docker-maven-plugin
/ Lees 	,
https://www.wouterdanes.net


/ Einde DOCKER JENKINS MAVEN

/ FEDORA

/ Lees	,
http://www.tecmint.com/things-to-do-after-fedora-23-installation/

/ Einde FEDORA

/ KVM

/ 7	. 

/ geef in google, 
fedora kvm

/ Lees,	
https://fedoraproject.org/wiki/Getting_started_with_virtualization

QEMU/KVM without Libvirt

QEMU/KVM can be invoked directly without libvirt, however you won't be able to use tools such as virt-manager, virt-install, or virsh. Plain QEMU (without KVM) can also virtualize other processor architectures like ARM or PowerPC. See How to use qemu

OpenStack consists of a number services for running IaaS clouds. They are the Object Store (Swift), Compute (Nova) and Image (Glance) services. It is a Fedora 16 feature.

/ 7	. 

/ Lees	,
https://fedoraproject.org/wiki/Getting_started_with_virtualization

/ we hebben download	,

-rw-r-----. 1 eric eric  1469054976 Dec 20 14:58 Fedora-Live-Workstation-x86_64-23-10.iso
-rw-r-----. 1 eric eric  2149580800 Dec 20 15:56 Fedora-Server-DVD-x86_64-23.iso
-rw-r-----. 1 eric eric   153114772 Dec 20 18:52 Fedora-Cloud-Base-23-20151030.x86_64.raw.xz
-rw-r-----. 1 eric eric   256607792 Dec 20 19:00 Fedora-Cloud-Base-Vagrant-23-20151030.x86_64.vagrant-libvirt.box
-rw-r-----. 1 eric eric   232006836 Dec 20 19:06 Fedora-Cloud-Atomic-23-20151215.x86_64.raw.xz
/ Atomic Vagrant TODO

/ brasero
/ we zien brasero niet op de desktop	, 
/ als we search doen, krijgen we brasero	, maar we zien Install (button). click , en we zien daaronder ook Launch	, dan pas komen we op Brasero	,

/ Doe dvd er in	,
/ Kies 'Burn image', 
/ click 'Click here to select a disk image'	, 
-rw-r-----. 1 eric eric  1469054976 Dec 20 14:58 Fedora-Live-Workstation-x86_64-23-10.iso
/ select disk to write 'Blank DVD+R ...'	(staat er al)	, 
/ click Burn	,



 



/ Einde KVM

/ OPENSTACK

/ 7	. 

/ Geef in google	, 
fedora openstack

https://www.rdoproject.org/install/quickstart/

https://www.youtube.com/watch?v=GYTctLuPbOs

http://docs.openstack.org/



/ 7	. 


/ geef in google	,
fedora 23 install openstack


/ Lees,	
https://fedoraproject.org/wiki/OpenStack


/ Lees	,
https://ask.openstack.org/en/question/80456/is-rdo-kilo-expected-to-be-built-in-fedora-23/
/ links to	,
https://www.rdoproject.org/packaging/rdo-packaging.html
/ en	,
https://hguemar.fedorapeople.org/slides/rdo-packaging-kilo/#1

/ Lees	,
http://www.linuxtechi.com/use-fedora-23-cloud-image-redhat-openstack/

/ Einde OPENSTACK

/ ATOMIC

http://www.projectatomic.io/blog/2015/09/clustering-atomic-hosts-with-kubernetes-ansible-and-vagrant/

/ Einde ATOMIC
/ ANGULARJS

/ 7	. 

/ Lees over polymer	,
http://jcrowther.io/2015/05/26/using-polymer-webcomponents-with-angular-js/
/ en	,
https://pascalprecht.github.io/2014/10/25/integrating-web-components-with-angularjs/

/ Einde ANGULARJS

/ GOOGLE CLOUD 

/ 7	. 

https://cloud.google.com/
/ click NIET op My console	,
/ click Documentation	,
/ links zien we verticaal menu	, click Compute, Compute engine
 /we zien links 
Linux getting started
Creating VM instances
/ Maar voor Creating VM instances moeten we toch eerst Linux getting started	,
https://cloud.google.com/compute/docs/quickstart

/ we create een nieuw project	,
Project name: Web server project
/ we komen op de dashboard	, we zien 'compute engine enabled'	, click	,
/ Dit is een payed service	,
/ we click 'enable billing'	,

/ we hebben onze billing reopen	, 
/ we kunnen deze nu kiezen als billing voor 'Web server project'	,

/ hij heeft eerst compute engine initialized for 'web server project, 
/ nu kunnen we vm's gaan maken	,

/ we zijn My console	, en kiezen in het menu Compute engine	,
/ we zien in het horizontal menu 'VM instances'	, click


/ we click create instance	,
name : test web server
zone: europe-west1-c
machine type: micro 			/ dit is de VM	,
boot disk: Debian GNU/Linux 7.9 (wheezy)
firewall: allow http traffic
/ click Create	,

/ we zien	,
Create VM instance "test-web-server" and its boot disk "test-web-server"

/ click SSH in de row van de VM	, we krijgen een nieuw window	, met een shell er ine,

ericjvandervelden@test-web-server:~$ pwd
/home/ericjvandervelden
$ sudo visudo
#
# This file MUST be edited with the 'visudo' command as root.
#
# Please consider adding local content in /etc/sudoers.d/ instead of
# directly modifying this file.
#
# See the man page for details on how to write a sudoers file.
#
Defaults        env_reset
Defaults        mail_badpass
Defaults        secure_path="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
# Host alias specification
# User alias specification
# Cmnd alias specification
# User privilege specification
root    ALL=(ALL:ALL) ALL
# Allow members of group sudo to execute any command
%sudo   ALL=(ALL:ALL) ALL
# See sudoers(5) for more information on "#include" directives:
#includedir /etc/sudoers.d
ericjvandervelden ALL=NOPASSWD: ALL

/ $ sudo visudo open met nano	, 
/ Geef in google: sudo visudo editor debian
/ Lees	,
http://askubuntu.com/questions/539243/how-to-change-visudo-editor-from-nano-to-vim
/ TODO

ericjvandervelden@test-web-server:~$ sudo apt-get install apache2

/ weer in google cloud interface	, click ip adres op de VM row	,
http://130.211.69.227/
/ OK

/ in VM's shell	,
ericjvandervelden@test-web-server:~$ ls -l /usr/bin/vi
lrwxrwxrwx 1 root root 20 Nov  4 19:23 /usr/bin/vi -> /etc/alternatives/vi
ericjvandervelden@test-web-server:~$ ls -l /etc/alternatives/vi
lrwxrwxrwx 1 root root 17 Nov  4 19:23 /etc/alternatives/vi -> /usr/bin/vim.tiny

/ we edit	,
ericjvandervelden@test-web-server:~$ sudo vi /var/www/index.html 
<!doctype html>
Foo Bar

/ we reload	,
http://130.211.69.227/
/ OK

 /we gaan terug naar google cloud interface	, 
/ we check onze VM (1ste keer , we hadden hem nog niet checked)	, en bovenin worden buttons enabled	, zoals stop, delete	,

/ we click de delete button	,
/ OK

/ 7	. 

/ systemd
https://www.youtube.com/watch?v=6F1mrT5qSWI

/ 7	. 

/ Compute engine quickstart

/ we create 'back-end' VM	, 
/ bovenin horizontal menu 'NEW INSTANCE'	,
/ create 'front-end' VM
/ click SSH op back-end row	, we zien een nieuw window	,

/ op de back-end server doen we	,
$ sudo apt-get update
$ sudo apt-get install mongodb

ericjvandervelden@back-end:~$ mongo
MongoDB shell version: 2.4.9
connecting to: test
> 

/ we open een 2de ssh connection to back-end	, door een 2de keer de SSH button te click in de VM row	,
ericjvandervelden@back-end:~$ ps jax | grep mongo
    1  7000  7000  7000 ?           -1 Ssl    107   0:01 /usr/bin/mongod --config /etc/mongodb.conf
 2501  7307  7307  2501 pts/0     7307 Sl+   1001   0:00 mongo
/ We zien de server en de client	,

> exit
ericjvandervelden@back-end:~$ sudo service mongodb stop
mongodb stop/waiting

ericjvandervelden@back-end:~$ mkdir $HOME/db
ericjvandervelden@back-end:~$ sudo mongod --dbpath $HOME/db --port 80 --logpath /var/tmp/mongodb

/ in 2nd connection	,
ericjvandervelden@back-end:~$ ps jax | grep mongo
 2501  7365  7365  2501 pts/0     7365 S+       0   0:00 sudo mongod --dbpath /home/ericjvandervelden/db --port 80 --logpath /var/tmp/mongodb
 7365  7366  7365  2501 pts/0     7365 Sl+      0   0:00 mongod --dbpath /home/ericjvandervelden/db --port 80 --logpath /var/tmp/mongodb

/ in 2nd connection	,
ericjvandervelden@back-end:~$ mongo
MongoDB shell version: 2.4.9
connecting to: test
Fri Dec  4 21:45:22.523 Error: couldn't connect to server 127.0.0.1:270
17 at src/mongo/shell/mongo.js:145
exception: connect failed
/ TODO

/ we doen in 1ste conn	,
^c
/ en we geven --fork mee	,

ericjvandervelden@back-end:~$ sudo mongod --dbpath $HOME/db --fork --port 80  --logpath /var/tmp/mongodb
about to fork child process, waiting until server is ready for connections.
forked process: 7572
all output going to: /var/tmp/mongodb
log file [/var/tmp/mongodb] exists; copied to temporary file [/var/tmp/mongodb.2015-12-04T21-49-04]
child process started successfully, parent exiting

/13	. 

/ install en run web-app in front-end VM,

$ sudo apt-get update
$ sudo apt-get install git nodejs npm

ericjvandervelden@front-end:~$ git clone https://github.com/GoogleCloudPlatform/todomvc-mongodb.git
ericjvandervelden@front-end:~$ cd todomvc-mongodb/
ericjvandervelden@front-end:~/todomvc-mongodb$ ls
app-spec.md       CONTRIBUTING.md  LICENSE       package.json
bower_components  index.html       media         readme.md
codestyle.md      js               node_modules  server.js
ericjvandervelden@front-end:~/todomvc-mongodb$ npm install

/ We hebben 2 terminals 	, naar de front-end VM en naar de back-end VM	, 
/doe op back-end	,
ericjvandervelden@instance-1:~$ /sbin/ifconfig
eth0      Link encap:Ethernet  HWaddr 42:01:0a:f0:00:03  
          inet addr:10.240.0.3  Bcast:10.240.0.3  Mask:255.255.255.255

/ doe op de front-end	,
ericjvandervelden@instance-2:~/todomvc-mongodb$ /sbin/ifconfig 
eth0      Link encap:Ethernet  HWaddr 42:01:0a:f0:00:02  
          inet addr:10.240.0.2  Bcast:10.240.0.2  Mask:255.255.255.255

/ doe op de front-end	,
ericjvandervelden@front-end:~/todomvc-mongodb$ nohup nodejs server.js --be_ip 10.240.0.3 --fe_ip 10.240.0.2 &
[1] 11393
ericjvandervelden@front-end:~/todomvc-mongodb$ nohup: ignoring input an
d appending output to nohup.out
/ Enter	,
ericjvandervelden@front-end:~/todomvc-mongodb$ 

/ of	, zonder nohup	,
/ TODO

sudo nodejs server.js --be_ip 10.240.0.3 --fe_ip 10.240.0.2
[Error: /home/ericjvandervelden/todomvc-mongodb/node_modules/mongoose/node_modules/mongodb/node_modules/bson/bui
ld/Release/bson.node: invalid ELF header]
js-bson: Failed to load c++ bson extension, using pure JS version
App listening on port 8080
GET / 200 7.357 ms - 2760
GET /learn.json 404 1.276 ms - 23
GET /api/todos 200 10.246 ms - 2
GET /favicon.ico 404 0.624 ms - 24

/ 13	. 
click http://104.155.58.10:8080
/ OK
/ we zien TODO app	,

/ click
http://todomvc.com/

/ 13	. 

/ Lees	, 
Find Google cloud platform samples on github: http://googlecloudplatform.github.io/
Learn how to set up Load balancing https://cloud.google.com/compute/docs/load-balancing/?hl=en_US&_ga=1.59420206.2083072423.1427531363
Learn how to run containers https://cloud.google.com/compute/docs/containers?hl=en_US&_ga=1.85699098.2083072423.1427531363

www-widgetapi-script
www.googletagmanager.com/qtm.js


/we click 




/ Einde GOOGLE CLOUD 

/ GOOGLE CLOUD SDK
/ 

https://cloud.google.com/sdk/

/ 7	 .

[eric@almond Google]$ curl https://sdk.cloud.google.com
!/bin/bash

URL=https://dl.google.com/dl/cloudsdk/channels/rapid/install_google_cloud_sdk.bash

function download {
  scratch=$(mktemp -d -t tmp.XXXXXXXXXX) || exit
  script_file=$scratch/install_google_cloud_sdk.bash

  echo "Downloading Google Cloud SDK install script: $URL"
  curl -# $URL > $script_file || exit
  chmod 775 $script_file

  echo "Running install script from: $script_file"
  $script_file
}

download

/ we hebben deze curl result saved in een script	, deze debug	, en gezien dat hij install_google_cloud_sdk.bash in een tmp dir in /tmp download	,
/ vervolgens debug we dit script	,  

   bash --debugger /tmp/tmp.EVQVd3GhcR/install_google_cloud_sdk.bash ""
 

[eric@almond Google]$ curl https://dl.google.com/dl/cloudsdk/channels/rapid/install_google_cloud_sdk.bash

#! /bin/bash

# curl https://dl.google.com/dl/cloudsdk/release/install_google_cloud_sdk.bash | bash

__SDK_DIR=google-cloud-sdk
__SDK_URL_DIR=https://dl.google.com/dl/cloudsdk/channels/rapid
__SDK_TGZ=google-cloud-sdk.tar.gz
__SDK_TTY=/dev/tty

COMMAND=${0##*/}

usage() {
  echo "
$COMMAND [ --disable-prompts ] [ --install-dir=DIRECTORY ]

Installs the Google Cloud SDK by downloading and unpacking
$__SDK_TGZ in a directory of your choosing, and then runs the
install.sh script included in the download.

--disable-prompts
  Disables prompts. Prompts are always disabled when there is no controlling
  tty. Alternatively export CLOUDSDK_CORE_DISABLE_PROMPTS=1 before running
  the script.

--install-dir=DIRECTORY
  Sets the installation root directory to DIRECTORY. The Cloud SDK will be
  installed in DIRECTORY/$__SDK_DIR. The default is \$HOME. Alternatively,
  export CLOUDSDK_INSTALL_DIR=DIRECTORY before running the script or
  export PREFIX=DIRECTORY for backwards compatibility with older versions of
  this script.
" >&2
  exit 2
}

# Accept PREFIX as a CLOUDSDK_INSTALL_DIR default for backwards compatibility.
if [ -z "$CLOUDSDK_INSTALL_DIR" ]; then
/ NEE
  CLOUDSDK_INSTALL_DIR=$PREFIX
fi

while true; do
  case $# in
    0)  break ;;
    1)  break ;;
/ JA
/ Deze hebben we erbij set	, om bash --debugger "" truc	,
  esac
  shift
done

download_src=$__SDK_URL_DIR/$__SDK_TGZ

bashdb<11> pr $download_src
https://dl.google.com/dl/cloudsdk/channels/rapid/google-cloud-sdk.tar.gz
/ we gaan nu naar (*)


# Prompt the user for some string input, with a default. If the user enters
# nothing, use the default. Put the result in the target variable.
promptWithDefault() {
  # $1: The question being asked.
  # $2: The default answer.
  # $3: The name of the variable to put the result in.
  if [ -n "$CLOUDSDK_CORE_DISABLE_PROMPTS" ]; then
    __pwd_response=""
  else
/ JA
    __pwd_message="$1 ($2): "
    read -p "$__pwd_message" __pwd_response
/ Geef $HOME/Devel/Cloud/Google
  fi
  if [ -z "$__pwd_response" ]; then
    __pwd_response=$2
  fi
  # Expand embedded $... and leading ~... but do not glob.
  set -o noglob
  __pwd_variable=$3
  eval set -- $__pwd_response

bashdb<73> pr $0
/tmp/tmp.EVQVd3GhcR/install_google_cloud_sdk.bash
bashdb<74> pr $1
Installation\ directory\ \(this\ will\ create\ a\ google-cloud-sdk\ subdirectory\)
ashdb<75> pr $2
/home/eric
bashdb<76> pr $3
install_dir
/ WAS	,

bashdb<73> pr $0
/tmp/tmp.EVQVd3GhcR/install_google_cloud_sdk.bash
bashdb<80> pr $1
/home/eric/Devel/Cloud/Google
bashdb<82>  pr $2

/ NU

  eval $__pwd_variable="'$*'"

bashdb<90> pr $install_dir
/home/eric/Devel/Cloud/Google

  set +o noglob
}

# Ask the user a yes-or-no question, and get put "1" or nothing in the target
# variable, so it can be tested in an if statement.
promptYesNo() {
  # $1: The question being asked.
  # $2: The default answer, 'y' or 'n'.
  # $3: The name of the variable to put "1" or nothing in.
  if [ -n "$CLOUDSDK_CORE_DISABLE_PROMPTS" ]; then
    __pyn_response=""
  else
    __pyn_default="y/N"
    if [ "$2" == "y" ]; then
      __pyn_default="Y/n"
    fi
    __pyn_message="$1 ($__pyn_default): "
    read -p "$__pyn_message" __pyn_response
  fi
  if [ -z "$__pyn_response" ]; then
    __pyn_response=$2
  fi
  if [ "$__pyn_response" == "y" -o "$__pyn_response" == "Y" ]; then
    eval $3=1
  else
    eval $3=
  fi
}

trace() {
  echo "$@" >&2
  "$@"
}

download() {
  # $1: The source URL.
  # $2: The local file to write to.

bashdb<33> pr $1
https://dl.google.com/dl/cloudsdk/channels/rapid/google-cloud-sdk.tar.gz
bashdb<34> pr $2
/tmp/tmp.yGY9SOOMv0/google-cloud-sdk.tar.gz

  __download_src=$1
  __download_dst=$2

  if trace which curl >/dev/null; then
/ JA
    trace curl -# -f "$__download_src" > "$__download_dst"
/ we zien	,
curl -# -f https://dl.google.com/dl/cloudsdk/channels/rapid/google-cloud-sdk.tar.gz
######################################################################## 100.0%

  elif trace which wget >/dev/null; then
    trace wget -O - "$__download_src" > "$__download_dst"
  else
    echo "Either curl or wget must be installed to download files." >&2
    return 1
  fi
}

install() {
  if [ -z "$CLOUDSDK_INSTALL_DIR" ]; then
/ JA
    CLOUDSDK_INSTALL_DIR=$HOME
  fi
  install_dir=$CLOUDSDK_INSTALL_DIR
  download_dst=$scratch/$__SDK_TGZ
/ tmp/tmp.yGY9SOOMv0/google-cloud-sdk.tar.gz

  # Download the bundle from Google.
  download "$download_src" "$download_dst" || return
  echo
/t
  __install_msg="Installation directory (this will create a $__SDK_DIR subdirectory)"
  while true; do

/ WAS	,
/ $install_dir="/home/eric"
    promptWithDefault "$__install_msg" "$install_dir" install_dir

bashdb<93> pr $install_dir
/home/eric/Devel/Cloud/Google

    if [ -z "$install_dir" ]; then
 /NEE
    fi
    trace mkdir -p "$install_dir" || return


    # Make sure the destination is clear.
    destination="$install_dir/$__SDK_DIR"
bashdb<96> pr $destination
/home/eric/Devel/Cloud/Google/google-cloud-sdk

    if [ ! -e "$destination" ]; then
/ JA
      break
/ uit while true	,
    fi
  done

  # Extract the bundle to the destination.
  trace tar -C "$install_dir" -xvf "$download_dst" || return
bashdb<99> pr $install_dir
/home/eric/Devel/Cloud/Google
bashdb<100> pr $download_dst
/tmp/tmp.yGY9SOOMv0/google-cloud-sdk.tar.gz

  echo

  # Run the bundled install script.
  trace "$destination/install.sh" || return
/ TODO
}

/ (*)
PS4=
/ ""
scratch=$(mktemp -d -t tmp.XXXXXXXXXX) && trap "command rm -rf $scratch" EXIT || exit 1
/ /tmp/tmp.yGY9SOOMv0
/ Zonet tmp dir met dit script	, nu een tmp dir voor de .tag.gz die moet worden download	,

if [ -z "$CLOUDSDK_CORE_DISABLE_PROMPTS" ]; then
/ JA
  if { command true < $__SDK_TTY; } > /dev/null 2>&1; then
/ TODO
/ JA
    # Grab prompt input from the tty.
    install < $__SDK_TTY
$__SDK_TTY="/dev/tty"
  else
    # No tty so don't prompt.
    CLOUDSDK_CORE_DISABLE_PROMPTS=1
    export CLOUDSDK_CORE_DISABLE_PROMPTS
    install
  fi
else
  install
fi

/ we moeten dus de install.sh in de sdk nog debug	, 
/ TODO

/ 7	. 

/ we run nu (ipv debug	,)


eric@almond Google]$ curl https://sdk.cloud.google.com | bash
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   421    0   421    0     0   1859      0 --:--:-- --:--:-- --:--:--  1862
Downloading Google Cloud SDK install script: https://dl.google.com/dl/cloudsdk/channels/rapid/install_google_cloud_sdk.bash
######################################################################## 100.0%
Running install script from: /tmp/tmp.fFyNP4toCj/install_google_cloud_sdk.bash
which curl
curl -# -f https://dl.google.com/dl/cloudsdk/channels/rapid/google-cloud-sdk.tar.gz
######################################################################## 100.0%

Installation directory (this will create a google-cloud-sdk subdirectory) (/home/eric): $HOME/Devel/Cloud/Google
mkdir -p /home/eric/Devel/Cloud/Google
tar -C /home/eric/Devel/Cloud/Google -xvf /tmp/tmp.ZI4wKacJQQ/google-cloud-sdk.tar.gz
...
google-cloud-sdk/install.sh
google-cloud-sdk/install.bat
google-cloud-sdk/completion.bash.inc
google-cloud-sdk/completion.zsh.inc
google-cloud-sdk/path.bash.inc
google-cloud-sdk/path.zsh.inc
google-cloud-sdk/.install/
google-cloud-sdk/.install/core.snapshot.json
google-cloud-sdk/.install/core.manifest
google-cloud-sdk/.install/.download/

/home/eric/Devel/Cloud/Google/google-cloud-sdk/install.sh
Welcome to the Google Cloud SDK!

To help improve the quality of this product, we collect anonymized data on how
the SDK is used. You may choose to opt out of this collection now (by choosing
'N' at the below prompt), or at any time in the future by running the following
command:
    gcloud config set disable_usage_reporting true

Do you want to help improve the Google Cloud SDK (Y/n)?  Y


This will install all the core command line tools necessary for working with
the Google Cloud Platform.



Your current Cloud SDK version is: 0.9.89
Installing components from version: 0.9.89


                    These components will be installed.                     

                         Name                          Version      Size  

 BigQuery Command Line Tool                               2.0.18  < 1 MiB 
 BigQuery Command Line Tool (Platform Specific)           2.0.18  < 1 MiB 
 Cloud SDK Core Libraries (Platform Specific)         2015.11.24  < 1 MiB 
 Cloud Storage Command Line Tool                            4.16  2.6 MiB 
 Cloud Storage Command Line Tool (Platform Specific)        4.15  < 1 MiB 
 Default set of gcloud commands                                           


For the latest full release notes, please visit:
  https://cloud.google.com/sdk/release_notes


 Creating update staging area                             

 Installing: BigQuery Command Line Tool                   

 Installing: BigQuery Command Line Tool (Platform Spec... 

 Installing: Cloud SDK Core Libraries (Platform Specific) 

 Installing: Cloud Storage Command Line Tool              

 Installing: Cloud Storage Command Line Tool (Platform... 

 Installing: Default set of gcloud commands               

 Creating backup and activating new installation          


Update done!


Modify profile to update your $PATH and enable shell command 
completion? (Y/n)? Y

The Google Cloud SDK installer will now prompt you to update an rc 
file to bring the Google Cloud CLIs into your environment.

Enter a path to an rc file to update, or leave blank to use 
[/home/eric/.bashrc]:  
Backing up [/home/eric/.bashrc] to [/home/eric/.bashrc.backup].
[/home/eric/.bashrc] has been updated.
Start a new shell for the changes to take effect.

/ we zien
$ cat ~/.bashrc
...
# The next line updates PATH for the Google Cloud SDK.
source '/home/eric/Devel/Cloud/Google/google-cloud-sdk/path.bash.inc'

# The next line enables shell command completion for gcloud.
source '/home/eric/Devel/Cloud/Google/google-cloud-sdk/completion.bash.inc'

$ exec -l $SHELL
/ TODO

[eric@almond Google]$ echo $PATH
/usr/lib64/qt-3.3/bin:/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/home/eric/.local/bin:/home/eric/bin:/home/eric/Devel/Gradle/Java/gradle-2.4/bin
/ WAS

/ open 
eric@almond Google]$ echo $PATH
/home/eric/Devel/Cloud/Google/google-cloud-sdk/bin:/usr/lib64/qt-3.3/bin:/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/home/eric/.local/bin:/home/eric/bin:/home/eric/Devel/Gradle/Java/gradle-2.4/bin:/home/eric/.local/bin:/home/eric/bin:/home/eric/Devel/Gradle/Java/gradle-2.4/bin
/ NU
/ TODO

/ Maar als we een nieuwe shell open	, dan OK	,

eric@almond Google]$ echo $PATH
/home/eric/Devel/Cloud/Google/google-cloud-sdk/bin:/usr/lib64/qt-3.3/bin:/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/home/eric/.local/bin:/home/eric/bin:/home/eric/Devel/Gradle/Java/gradle-2.4/bin

/ 7	. 



eric@almond Logs]$ gcloud init
Welcome! This command will take you through the configuration of gcloud.

Your current configuration has been set to: [default]

To continue, you must login. Would you like to login (Y/n)?  

Your browser has been opened to visit:

    https://accounts.google.com/o/oauth2/auth?redirect_uri=http%3A%2F%2Flocalhost%3A8085%2F&prompt=select_account&response_type=code&client_id=32555940559.apps.googleusercontent.com&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fcloud-platform+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fappengine.admin+https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fcompute&access_type=offline


Created new window in existing browser session.

/ Inderdaad	, in de browser zien we een form	,
/ we kiezen account ericjvandervelden@gmail.com
/ volgend scherm	,
Know who you are on Google
View your email address
View and manage your Google Compute Engine resources
View and manage your applications deployed on Google App Engine
View and manage your data across Google Cloud Platform services
Allow
/ volgend scherm	,
https://cloud.google.com/sdk/auth_success
You are now authenticated with the Google Cloud SDK!

/we  zien in command line,	
Created new window in existing browser session.
You are now logged in as: [ericjvandervelden@gmail.com]

Enter project id you would like to use:  web-server-project-1148
Your current project has been set to: [web-server-project-1148].

Your project default compute zone has been set to [europe-west1-c].
You can change it by running [gcloud config set compute/zone NAME].

Your project default compute region has been set to [europe-west1].
You can change it by running [gcloud config set compute/region NAME].

Could not retrieve list of repos via [gcloud alpha source repos list]
Perhaps alpha commands are not enabled or the repos list command failed.

Generally projects have a repository named [default]. Would you like 
to try clone it? (Y/n)?  
here would you like to clone [default] repository to 
[/home/eric/Devel/Cloud/Google/google-cloud-sdk/default]:
Cloning into '/home/eric/Devel/Cloud/Google/google-cloud-sdk/default'...
warning: You appear to have cloned an empty repository.
Checking connectivity... done.

Git repository has been cloned to [/home/eric/Devel/Cloud/Google/google-cloud-sdk/default]

gcloud has now been configured!
You can use [gcloud config] to change more gcloud settings.

Your current configuration is: [default]

[compute]
region = europe-west1
zone = europe-west1-c
[core]
account = ericjvandervelden@gmail.com
disable_usage_reporting = False
project = web-server-project-1148
[meta]
active_config = default

/ 13	. 

/ we zijn op gcloud tool guide	,
/ https://cloud.google.com/sdk/gcloud/

Run gcloud init ...
Prompts you to clone the listable 'Cloud-hosted Git repositories' associated ...
/ we click de link 'Cloud-hosted Git repositories'
https://cloud.google.com/tools/cloud-repositories/docs/
/we lezen , see 'Cloud Source Repository Quickstart'
https://cloud.google.com/tools/cloud-repositories/docs/cloud-repositories-quickstart

/ Moeten we use	,
/home/eric/Devel/Cloud/Google/google-cloud-sdk/default
/ TODO

/ we proberen eerst	,
[eric@almond my]$ pwd
/home/eric/Devel/Cloud/Google/my
[eric@almond my]$ git init my-project
Initialized empty Git repository in /home/eric/Devel/Cloud/Google/my/my-project/.git/
[eric@almond my]$ cd my-project/
/ local git repo precies dezelfde toestand   als	, 
/home/eric/Devel/Cloud/Google/google-cloud-sdk/default
/ We gaan toch daarheen	,

[eric@almond default]$ pwd
/home/eric/Devel/Cloud/Google/google-cloud-sdk/default
[eric@almond default]$ git remote -v
origin	https://source.developers.google.com/p/web-server-project-1148/r/default (fetch)
origin	https://source.developers.google.com/p/web-server-project-1148/r/default (push)

/ Dus we zien dat we de 'git remote add' kunnen overslaan	, 
/ Geeft in chrome	,
https://source.developers.google.com/p/web-server-project-1148/r/default
/ Inderdaad	, we zien een lege repo	,

/ Intermezzo 

/ we hebben een github account	, maar nog geen repo	,
https://github.com/

/ click grote button 2	, 'create repositories'	,
https://help.github.com/articles/create-a-repo/

/ click + rechtsboven	,
fill in form	,
/ we maken	,
https://github.com/ericjvandervelden/my-first-repo

/ Net als	,
Search: googlecloudplatform	
/ vertical menu eronder: click users
/ OK


/ Einde Intermezzo 

[eric@almond default]$ git pull https://github.com/GoogleCloudPlatform/appengine-helloworld-python
remote: Counting objects: 21, done.
remote: Total 21 (delta 0), reused 0 (delta 0), pack-reused 21
Unpacking objects: 100% (21/21), done.
From https://github.com/GoogleCloudPlatform/appengine-helloworld-python
 * branch            HEAD       -> FETCH_HEAD

[eric@almond default]$ ls
app.yaml  CONTRIB.md  favicon.ico  LICENSE  main.py  README.md

[eric@almond default]$ git push origin master
Counting objects: 21, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (20/20), done.
Writing objects: 100% (21/21), 9.76 KiB | 0 bytes/s, done.
Total 21 (delta 5), reused 0 (delta 0)
remote: Storing objects: 100% (21/21), done.
remote: Processing commits: 100% (6/6), done.
To https://source.developers.google.com/p/web-server-project-1148/r/default
 * [new branch]      master -> master

/ Inderdaad	, reload	,
https://source.developers.google.com/p/web-server-project-1148/r/default
 of	,
https://source.developers.google.com/p/web-server-project-1148
/->
https://console.developers.google.com/code/develop/browse/gSi2ezBhu3O/master?project=web-server-project-1148&authuser=0
/ OK

/ we edit in de cloud repo	,
/ click rechtboven Edit	, daarna Commit	, en nog een keer Commit	, na msg	,

[eric@almond default]$ git pull origin master
Unpacking objects: 100% (3/3), done.
From https://source.developers.google.com/p/web-server-project-1148/r/default
 * branch            master     -> FETCH_HEAD
   9353344..2e1eaa0  master     -> origin/master
Updating 9353344..2e1eaa0
Fast-forward
 main.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

/ OK

https://cloud.google.com/tools/cloud-repositories/docs/cloud-repositories-quickstart
 Guides
/ TODO

/ 13	. 

/ terug naar gcloud	,
https://cloud.google.com/sdk/gcloud/



 
 



/ 7	 

/ Lees	,
https://cloud.google.com/sdk/gcloud/#gcloud.init
/ we zien over init	, we zien link 'gcloud compute'	,
https://cloud.google.com/compute/docs/gcloud-compute/#auth

/ 7	. 

/ Keer terug 	,
https://console.developers.google.com/home/dashboard?project=web-server-project-1148&_ga=1.222561816.2083072423.1427531363

/ click 'Deploy an hello world app	, 
https://console.developers.google.com/start/appengine?project=web-server-project-1148
/ Dit is app engine	, geen compute engine	,


/ ga naar	,
Google App Engine SDK for Java

/ we download	,
-rw-r-----. 1 eric eric  172503344 Dec  6 16:43 appengine-java-sdk-1.9.30.zip

[eric@almond Google]$ pwd
/home/eric/Devel/Cloud/Google
[eric@almond Google]$ unzip  ~/Downloads/appengine-java-sdk-1.9.30.zip 

[eric@almond Google]$ cat ~/.bash_profile 
...
PATH=$PATH:$HOME/Devel/Cloud/Google/appengine-java-sdk-1.9.30/bin

/ javac -source 1.7 -target 1.7

[eric@almond Google]$ pwd
/home/eric/Devel/Cloud/Google
[eric@almond Google]$ unzip  ~/Downloads/appengine-try-java-master.zip 

$ less pom.xml

     <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-compiler-plugin</artifactId>
        <version>3.3</version>
        <configuration>
            <source>1.7</source>
            <target>1.7</target>
        </configuration>
      </plugin>
        </plugins>
    </build>

/ Lees	,
https://maven.apache.org/plugins/maven-compiler-plugin/

[eric@almond appengine-try-java-master]$ mvn clean install

[eric@almond appengine-try-java-master]$ appcfg.sh -A web-server-project-1148 update target/appengine-try-java-1.0

appcfg.sh should ideally be run using Java 7 (also known as 1.7).
/ TODO

/ Maar gaat OK	, 
/ we krijgen een nieuw window	, weer auth scherm	, maar nu voor app engine	,
https://accounts.google.com/o/oauth2/auth?access_type=offline&approval_prompt=force&client_id=550516889912.apps.googleusercontent.com&redirect_uri=urn:ietf:wg:oauth:2.0:oob&response_type=code&scope=https://www.googleapis.com/auth/appengine.admin%20https://www.googleapis.com/auth/cloud-platform

View and manage your applications deployed on Google App Engine
View and manage your data across Google Cloud Platform services
/ Allow
Please copy this code, switch to your application and paste it there:
4/2AHTL4kpg1pdnGus8j2nKNdjpUy2_L1MJIW5T5LBrEw 
/ TODO

/ we gaan terug naar	,
https://console.developers.google.com/start/appengine?project=web-server-project-1148
/ en we zien  de link naar 
web-server-project-1148.appspot.com
/ OK
/ we zien 
Hello, World

/ we gaan terug naar	,
https://console.developers.google.com/start/appengine?project=web-server-project-1148
/ en we click	,
View your project dashboard	,
https://console.developers.google.com/appengine?project=web-server-project-1148&moduleId=default&versionId=1&duration=PT1H
/ click Instances	, daar zien we onderin row 	, met Shutdown	,
/ TODO

/ 7	. 

http://googlecloudplatform.github.io/

Go TODO list manager
Apache Hive and Pig on Compute Engine

/ 7	. 

/ Lees	,
https://github.com/GoogleCloudPlatform/cloud-sdk-docker













/ 7	. 








/ Einde GOOGLE CLOUD SDK

/ BASHDB

eric@almond Google]$ cat my.sh 
#!/usr/bin/bash
var="one two three four five"
set -- $var
...

[eric@almond Google]$ bash --debugger my.sh ""
/ of	,
[eric@almond Google]$ bash --debugger my.sh '' 
bashdb<0> eval [ "$1" = "''" ]
$? is 0
bashdb<1> eval [ "$2" = "" ]
$? is 0
bashdb<2> eval [ -z "$2"  ]
$? is 0


[eric@almond Google]$ bash --debugger my.sh \"\"
bashdb<8> eval [ "$1" = "\\"\\"" ]
$? is 0



/ Einde BASHDB

/ GOOGLE APPS SCRIPT

https://www.google.com/script/start/

/ Einde GOOGLE APPS SCRIPT

/ GOOGLE GUI

 13	. 

https://developers.google.com/gadgets/docs/ui?hl=en
/ TODO

/ 13	. 

https://developers.google.com/

See the full product directory.

Missed the Chrome Developer Summit?
All sessions available on demand.
Watch now

https://github.com/polymerlabs
https://github.com/polymerlabs/polylint
https://github.com/polymerlabs/polydev

App Layout Elements
/ vervangt Paper Layout Elements  : voor material design	,
/ Rob	,

https://polymerlabs.github.io/app-layout

@Polymer (twitter)
polymer-project.org
blog.polymer-project.org

/ 7	. 

https://www.youtube.com/watch?v=MyQ8mtR9WxI&index=9&list=PLNYkxOF6rcICcHeQY02XLvoGL34rZFWZn

/ Web Apps

/ service workers, push notifications


/ 7	. 

https://www.youtube.com/watch?v=g7f1Az5fxgU&list=PLNYkxOF6rcICcHeQY02XLvoGL34rZFWZn&index=10

/ progressive web apps, Rob Dodson,





/ Einde GOOGLE GUI

/ TWITTER

/ video/text in 
Cloud->Ansible
Cloud->Fabric8
Java -> JBoss -> JTA (Hawkular)


/ Einde TWITTER

/ DOCKER & KUBERNETES

/ arun gupta

https://www.youtube.com/watch?v=aSATsLG59Zs

/ Wat is docker-compose	? Kan dit samen met Kubernetes	?



/ Einde DOCKER & KUBERNETES


/ MICROSERVICES

/ 7. 	

/ video gupta & microservices	,

https://www.youtube.com/watch?v=iJVW7v8O9BU

49:38
https://dzone.com/refcardz/getting-started-with-microservices

gibhub: arungupta/microservices

/ distributed logging	,
59:12	ELK stack
gibhub: arungupta/elk

1:03 DDD (article of Evans)

thymeleaf: ipv jsp	,

1:17:40 jsf resource library contracts

/ in 
gibhub: arungupta/microservices
/ is docs over zookeeper	,

/ modem	, 

http://192.168.0.1/status/system.asp
admin
admin
/ kies menu draadloos
2.4GZ
Kanaal automatisch	, 

/ Ga naar arun-gupta/microservices	, 
catalog
src/main
java/org/javaee7/wildfly/samples/ever...
https://github.com/arun-gupta/microservices/tree/master/microservice/catalog/src/main/java/org/javaee7/wildfly/samples/everest/catalog
/ en we zien CatalogItemREST

/ op arun blog, zoek naar Gilt en Wix

1.41.11 

2.00
github.com/couchbaselabs/touchbase (CEAN)

2.01 kumuluzEE: fat-jar	, net als JBoss Swarm	,

//////////////////////////
2.08.14: verschil kumuluzEE en Wildfly

2.08.57: custom CDI annotations voor EJBs
/ TODO

/ 2.14
Docker & Cloudbuddy 
CloudFlare : dynamically update DNS

/ event sourcing and cqrs

https://www.elastic.co/products/kibana

2.22.25
github.com/arun-gupta/microservices
github.com/javaee-samples/docker-java
dzone.com/refcardz/getting-started-with-microservices


/ Einde MICORSERVICES

/ KUBERNETES

https://www.youtube.com/watch?v=WwBdNXt6wO4

Brendan Burns

Swagger (client): swagger.io, zoals kubectl

twemproxy : redis

reconciliation=verzoening

github.com/GoogleCloudPlatform/kubernetes/cloud.google.com/container-engine

/ vervolg: 
https://www.youtube.com/watch?v=tA8XNVPZM2w

/ Einde KUBERNETES

/ KUBERNETES

/ ray tsang
https://www.youtube.com/watch?v=kT1vmK0r184


/ Einde KUBERNETES

/ Bekijk	Kubernetes ,
https://www.youtube.com/watch?v=KIdK5WGZUms

/ MESOS 

/ 7	. 

https://www.youtube.com/watch?v=gVGZHzRjvo0

Ben Hindman: Mesos

12:00 Jenkins
/ TODO

18:00 Aurora
/ TODO

19:59: Spark, REPL	,

http://mesosphere.io/learn

/ 7	. 

https://www.youtube.com/watch?v=dyLtK4FhCZE

Joe Stein

http://stealth.ly

http://allthingshadoop.com

/ Mesos komt van Google, Borg -> Omega	,

http://static.usenix.org/event/nsdi11/tech/full_papers/Hindman_new.pdf
http://www.youtube.com/watch?v=YB1VW0LKzJ4
http://eurosys2013.tudos.org/wp-content/uploads/2013/paper/Schwarzkopf.pdf
http://www.youtube.com/watch?v=0ZFMIO98Jkc&feature=youtu.be

http://github.com/mesosphere/marathon

22:50: docker version ,
/ TODO
26:10: cpu limit	,
/ TODO


/ 7	. 

/ mesos and kubernetes	,

https://www.youtube.com/watch?v=pFCJ3WiVjyA





/ Einde MESOS 

/ MICROSERVICES

/ anti-patterns	,
https://www.youtube.com/watch?v=I56HzTKvZKc


/ Einde MICROSERVICES

/ UPGRADE FEDORA

/ Lees	,
https://fedoraproject.org/wiki/DNF_system_upgrade

[eric@almond Logs]$ sudo dnf update --refresh

[eric@almond Logs]$ sudo dnf install dnf-plugin-system-upgrade

[eric@almond Logs]$ sudo dnf system-upgrade download --releasever=22

$ sudo dnf system-upgrade reboot

/ 7	. 

/ van 22 -> 23 

[eric@almond Logs]$ sudo dnf system-upgrade download --releasever=23
...
Error: package libxml2-python-2.9.3-1.fc22.x86_64 requires libxml2 = 2.9.3-1.fc22, but none of the providers can be installed
(try to add '--allowerasing' to command line to replace conflicting packages)

[eric@almond Logs]$ sudo dnf system-upgrade download --releasever=23
...
Removing:
 kernel                          x86_64 4.1.10-100.fc21           @System   0  
 kernel-core                     x86_64 4.1.10-100.fc21           @System  42 M
 kernel-modules                  x86_64 4.1.10-100.fc21           @System  17 M
 libxml2-python                  x86_64 2.9.3-1.fc22              @@commandline

Downgrading:
 sos                             noarch 3.2-0.3.a.fc23            fedora  309 k
 sox                             x86_64 14.4.2-3.fc23             fedora  383 k

Transaction Summary
================================================================================
Install      86 Packages
Upgrade    1624 Packages
Remove        4 Packages
Downgrade     2 Packages

Complete!
Download complete! Use 'dnf system-upgrade reboot' to start the upgrade.
The downloaded packages were saved in cache till the next successful transaction.
You can remove cached packages by executing 'dnf clean packages'.



/ Einde UPGRADE FEDORA

/ DNF

/ 7	. 

$ dnf --help

List of Plugin Commands
...
repoquery                 search for packages matching keyword
system-upgrade            Prepare system for upgrade to a new release

/ man page over $ dnf system-upgrade
[eric@almond Logs]$ man dnf.plugin.system-upgrade



/ Einde DNF

/ CLOSED IN CHROME

/ docker	,
https://docs.docker.com/engine/examples/mongodb/
https://github.com/nginxinc/docker-nginx/blob/e35d3022416ca5221fcf958ed8aa6a55a5b043af/Dockerfile
https://hub.docker.com/r/sequenceiq/hadoop-docker/~/dockerfile/	 / !!!
http://highscalability.com/
https://medium.com/@gargar454/deploy-a-mongodb-cluster-in-steps-9-using-docker-49205e231319#.bzzg5fefp	 / !!!
https://groups.google.com/forum/#!forum/docker-user
http://stackoverflow.com/questions/18496940/how-to-deal-with-persistent-storage-e-g-databases-in-docker
https://github.com/sequenceiq/hadoop-docker/blob/master/Dockerfile
https://docker.wistia.com/medias/6m689744b4	 /via blog.docker.com
https://github.com/docker-library/mongo/blob/ea56087e928b5d734bf7661384ebf3c432d70f28/2.6/Dockerfile
https://gist.github.com/Mulkave/10559775
https://docs.docker.com/engine/examples/running_ssh_service	 / Administrate Docker, Application and services, Dockerizing an sshd service	,
https://docs.docker.com/engine/reference/run/ / Command and API references, Dockerfile reference
https://github.com/nginxinc/docker-nginx/blob/e35d3022416ca5221fcf958ed8aa6a55a5b043af/Dockerfile
https://github.com/docker-library/official-images/blob/master/library/ubuntu
https://github.com/jboss-dockerfiles/base/blob/master/Dockerfile
https://github.com/docker-library/postgres/blob/ed23320582f4ec5b0e5e35c99d98966dacbc6ed8/9.4/Dockerfile
http://www.rightrelevance.com/search/articles/hero?article=2bbaafad61d366590cdaac7885a4b8d45c9b7c3a&query=docker&taccount=docker_rr





/ systemd in docker	,
https://rhatdan.wordpress.com/2014/04/30/running-systemd-within-a-docker-container/
http://developerblog.redhat.com/2014/05/05/running-systemd-within-docker-container/




/ spanner	,
http://livestream.com/accounts/1545775/osdi12/videos/4646642
http://www.cs.cmu.edu/~pavlo/courses/fall2013/static/papers/murat-spanner.pdf

/ mongo	,
https://docs.mongodb.org/manual/security/
https://docs.mongodb.org/manual/tutorial/perform-two-phase-commits/
https://docs.mongodb.org/manual/reference/sql-comparison/
https://docs.mongodb.org/manual/core/sharding-introduction/


/ kuberetes	,
https://github.com/kubernetes/kubernetes/blob/master/docs/getting-started-guides/fedora/fedora_manual_config.md 	/ head
/ of	,
https://github.com/kubernetes/kubernetes/blob/release-1.1/docs/getting-started-guides/fedora/fedora_manual_config.md	/ version 1.1
http://blog.kubernetes.io/2015/11/one-million-requests-per-second-dependable-and-dynamic-distributed-systems-at-scale.html / !!!
http://rafabene.com/2015/11/11/how-expose-kubernetes-services/
blog.kubernetes.io
https://github.com/kubernetes/kubernetes
http://blog.hypriot.com/post/introducing-hypriot-cluster-lab-docker-clustering-as-easy-as-it-gets/ / !!!


/ gupta
https://www.youtube.com/watch?v=OEflMTJUV4c#t=255 / jee, docker , kubernetes	
https://www.youtube.com/watch?v=OEflMTJUV4c / Package your Java EE application using Docker and Kubernetes	, 
http://blog.arungupta.me/
https://www.youtube.com/watch?v=aSATsLG59Zs / Docker and Kubernetes Recipes for Java Developers
https://www.youtube.com/watch?v=iJVW7v8O9BU / microservices	,
https://github.com/arun-gupta/microservices/tree/master/microservice/catalog/src/main
http://www.thymeleaf.org/

/ microservices	,
https://www.youtube.com/watch?v=I56HzTKvZKc


/ tsang
https://www.youtube.com/watch?v=kT1vmK0r184 / Java based microservices with kubernetes	,

/ mesos	,
https://www.youtube.com/watch?v=dyLtK4FhCZE
https://www.youtube.com/watch?v=pFCJ3WiVjyA	 /	 Hindman	,
https://mesosphere.com/blog/2015/12/08/mesosphere-open-container-initiative/

/ jboss
https://developer.jboss.org/thread/1619	/ resteasy, cxf


/ wildfly

/ arquillian
http://www.tomitribe.com/blog/2015/12/arquillian-cube-production-near-unit-tests-against-docker-images/

/ fedora, redhat	,	
https://fedoraproject.org/wiki/PostgreSQL
https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Deployment_Guide/sec-Configuring_Yum_and_Yum_Repositories.html
https://www.youtube.com/watch?v=S9YmaNuvw5U	/ !!! systemd
https://www.gnu.org/software/mdk/manual/html_node/Debug-commands.html#Debug-commands	/ gdb

/ redhat cloud 
https://www.youtube.com/watch?v=omTGY8LjVdA / openshift
http://redhatstackblog.redhat.com/2015/03/27/an-ecosystem-of-integrated-cloud-products/?utm_content=buffer2c7d8&utm_medium=social&utm_source=facebook.com&utm_campaign=buffer	 /redhat cloudforms	,
https://twitter.com/openshift/status/663740512680067076	 / openshift	,
https://access.redhat.com/documentation/en/red-hat-enterprise-linux-atomic-host/version-7/getting-started-with-containers/#get_started_orchestrating_containers_with_kubernetes	/ atomic	, containers	,
https://blog.openshift.com/ / jboss tools, ...
https://www.youtube.com/watch?v=DCQ9SEdteHs&feature=youtu.be 	/ fabric8, kubernetes, openshift	,


/ kvm	, ovirt	,
http://www.ovirt.org/Installing_PostgreSQL_DB
https://fedoraproject.org/wiki/Getting_started_with_virtualization / See Cloud-> oVirt	,
https://docs.vagrantup.com/v2/why-vagrant/


/ postgres
https://wiki.postgresql.org/wiki/YUM_Installation
http://www.postgresql.org/docs/9.1/static/functions-info.html
http://www.postgresql.org/docs/9.4/static/app-postgres.html
https://wiki.postgresql.org/wiki/Replication,_Clustering,_and_Connection_Poolinghttp://momjian.us/main/writings/pgsql/replication.pdf
https://www.youtube.com/watch?v=GobQw9LMEaw	 / !!!
http://www.postgresql.org/docs/current/interactive/explicit-joins.html
https://www.youtube.com/watch?v=Z73_LQugO0c / postgresql scaling on AWS
http://lwn.net/Articles/653411/


/ openssh
http://www.cyberciti.biz/faq/centos-ssh/
https://bbs.archlinux.org/viewtopic.php?id=165382
http://askubuntu.com/questions/123072/ssh-automatically-accept-keys


/ hadoop	,
http://hortonworks.com/blog/openshift-v3-kubernetes-docker-hadoop-yarn/
https://www.mongodb.com/presentations/mongodb-and-hadoop-driving-business-insights 	/ !!!
http://timothysc.github.io/blog/2013/09/14/hadoop-mapreduce/ / on fedora	,
http://hadoop.apache.org/docs/stable/api/index.html
http://blog.sequenceiq.com/blog/2014/12/02/hadoop-2-6-0-docker/
http://stackoverflow.com/questions/21326274/hadoop-2-2-0-name-or-service-not-known-warning
http://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-common/SingleCluster.html#Execution
https://hub.docker.com/r/gelog/hadoop/
https://github.com/bigdatafoundation/docker-hadoop
http://hadoop.apache.org/docs/r2.4.1/hadoop-project-dist/hadoop-common/ClusterSetup.html
http://docs.hortonworks.com/HDPDocuments/HDP1/HDP-1.3.2/bk_getting-started-guide/content/ch_hdp1_getting_started_chp3.html
https://raseshmori.wordpress.com/2012/10/14/install-hadoop-nextgen-yarn-multi-node-cluster/
http://hortonworks.com/blog/apache-hadoop-yarn-resourcemanager/
http://hadoop.apache.org/docs/current/hadoop-yarn/hadoop-yarn-site/YARN.html
http://localhost:49241/dfshealth.html#tab-startup-progress
http://localhost:49242/cluster/
http://stackoverflow.com/questions/18634825/hadoop-cluster-stuck-hangs-on-reduce-copy


/ java
http://virtualjug.com/#sessions

/ spring
http://www.javaworld.com/article/2077714/java-web-development/xa-transactions-using-spring.html / !!!
http://www.tutorialspoint.com/spring/spring_java_based_configuration.htm
https://giannisapi.wordpress.com/2011/09/30/spring-3-testing-with-junit-4-using-contextconfiguration-and-abstracttransactionaljunit4springcontexttests/ / !!! test 
http://spring.io/guides


/ spring boot 
https://www.youtube.com/watch?v=Q6esdIY66rw
http://stackoverflow.com/questions/31048389/no-adapter-for-endpoint-exception-apache-camel-with-spring-boot-spring-ws
http://spring.io/guides/tutorials/bookmarks/ / spring rest

/ cockroach
http://www.cockroachlabs.com/



/ jsp
http://stackoverflow.com/questions/15434817/can-not-find-the-tag-library-descriptor-for-http-java-sun-com-jsp-jstl-core

/ jsf
http://www.infoq.com/news/2007/12/jsf-testing-tools / !!! test

/ cassandra	,
http://docs.datastax.com/en/cassandra/2.1/cassandra/configuration/configCassandra_yaml_r.html
http://docs.datastax.com/en/landing_page/doc/landing_page/current.html

/ google cloud	,
https://cloud.google.com/ / Kies My console,
https://console.cloud.google.com/home/dashboard?project=web-server-project-1148&_ga=1.222300696.2083072423.1427531363
/= WH	,
https://console.developers.google.com/home/dashboard?project=web-server-project-1148 
/ Kies in menu Billing, Payment settings
...
https://cloud.google.com/sdk/#linux
https://cloud.google.com/compute/docs/containers
https://cloud.google.com/compute/docs/load-balancing
http://googlecloudplatform.github.io/ / !!!
http://todomvc.com/
https://cloud.google.com/container-engine/docs/
https://cloud.google.com/sdk/gcloud/
http://web-server-project-1148.appspot.com/


/ go
https://golang.org/
http://nicholasjackson.github.io/other/micro-docker-images-for-microservices/



/ polymer	,
http://todomvc.com/
https://www.polymer-project.org/1.0/
https://elements.polymer-project.org/

/ android	,
http://developer.android.com/distribute/index.html





/ eclipse	,
http://help.eclipse.org/luna/index.jsp

/ c++
https://www.youtube.com/watch?v=YrGSQXZmAXs
http://www.cute-test.com/projects/cute/wiki/Using_the_Cute_Eclipse_Plugin
http://cute-test.com/projects/cute/wiki/Using_the_Cute_Eclipse_Plugin
http://stackoverflow.com/questions/8102397/const-char-vs-char
http://cute-test.com/projects/cute/wiki
http://www.learncpp.com/
http://help.eclipse.org/luna/index.jsp?topic=%2Forg.eclipse.cdt.doc.user%2Freference%2Fcdt_u_prop_general_idx.htm / c++ indexer page	,
http://clang.llvm.org/
http://stackoverflow.com/questions/5057021/why-are-c-inline-functions-in-the-header	/ !!!




/ math
https://en.wikipedia.org/wiki/Order_%28group_theory%29
http://dougx.net/fractals/index.php	/ fractals
http://mathoverflow.net/questions/51905/how-to-picture-mathbbc-p
http://groupprops.wiki-site.com/index.php/Nilpotent_group

/ mix
http://www.jklp.org/profession/books/mix/c02.html
http://www.jklp.org/profession/books/mix/c06.html

/ misc
http://192.168.0.1/wireless/radio.asp



/ angularjs
https://angularu.com/ng/
https://pascalprecht.github.io/2014/10/25/integrating-web-components-with-angularjs/



/ we hebben 	, 
http://googlecloudplatform.github.io/
blog.kubernetes.io
https://blog.openshift.com/ / jboss tools, ...
http://blog.arungupta.me/


/ CLOSED IN CHROME

/ ATTENTIONS CURRENT

/ 7	. 

827949-rc223-sql-syntax-apache-drill.pdf
/ sql on hadoop	,

https://youtu.be/w519CClzEuc
/ security docker	, er is ook een vervolg video met demos	,

http://www.tomitribe.com/blog/2015/12/arquillian-cube-production-near-unit-tests-against-docker-images/

https://blog.openshift.com/a-java-ee-7-application-on-openshift-3-with-jboss-tools/
/ of algemener	,
https://blog.openshift.com


http://forge.jboss.org/document/hands-on-lab
/ of algemener	,
http://forge.jboss.org/document


/ Einde ATTENTIONS CURRENT

/ GOOGLE CLOUD

/ 7	.

/ we zijn op	,
https://cloud.google.com/compute/docs/

Manage your virtual machines with Google tools

Access your virtual machine instances through the Google Cloud Platform Console, through the Google Compute Engine RESTful API, or through the gcloud command-line tool.

/ probeer restful api	, 
/ probeer gcloud	,

/ Einde GOOGLE CLOUD

/ 
/ zoek in google : google-widgetapi-script


/ OPEN IN CHROME

https://twitter.com/openshift/status/663740512680067076
https://docs.vagrantup.com/v2/why-vagrant/
https://access.redhat.com/documentation/en/red-hat-enterprise-linux-atomic-host/version-7/getting-started-with-containers/#get_started_orchestrating_containers_with_kubernetes
https://github.com/kubernetes/kubernetes/blob/master/docs/getting-started-guides/fedora/fedora_manual_config.md
http://blog.kubernetes.io/2015/11/one-million-requests-per-second-dependable-and-dynamic-distributed-systems-at-scale.html
http://blog.arungupta.me/
https://www.youtube.com/watch?v=aSATsLG59Zs	/ gupta
https://www.youtube.com/watch?v=iJVW7v8O9BU	/ gupta
https://www.youtube.com/watch?v=DCQ9SEdteHs&feature=youtu.be	/ fabric8
http://rafabene.com/2015/11/11/how-expose-kubernetes-services/
http://www.thymeleaf.org/
https://github.com/arun-gupta/microservices/tree/master/microservice/catalog/src/main
https://www.youtube.com/watch?v=dyLtK4FhCZE	/ mesos
https://www.youtube.com/watch?v=kT1vmK0r184	/ tjang
https://github.com/sequenceiq/hadoop-docker/blob/master/Dockerfile
https://github.com/nginxinc/docker-nginx/blob/e35d3022416ca5221fcf958ed8aa6a55a5b043af/Dockerfile
https://www.youtube.com/watch?v=pFCJ3WiVjyA / Hindman kubernetes & mesos
https://www.youtube.com/watch?v=I56HzTKvZKc / microservices anti-pattern
https://fedoraproject.org/wiki/DNF_system_upgrade


/ Einde OPEN IN CHROME

/ OPENSHIFT

/ 7	. 

/ https://www.youtube.com/watch?v=omTGY8LjVdA

/ atomic = als coreos	, 'n minimal os	, een kleine rhel	,
/ heeft systemd	, journald	, 
/ docker images gaan rpm vervangen	, je install een image ipv een rpm	,



/ Einde OPENSHIFT


/ GOLANG

/ 7	. 

/////////////////////////////////////////////////////////////////////////////////////////////

/ Lees	,
https://developer.fedoraproject.org/tech/languages/go/go-installation.html

$ sudo dnf install golang
Installing:
 go-srpm-macros        noarch        2-3.fc23              fedora         8.0 k
 golang                x86_64        1.5.2-2.fc23          updates        1.2 M
 golang-bin            x86_64        1.5.2-2.fc23          updates         40 M
 golang-src            noarch        1.5.2-2.fc23          updates        3.6 M

/ Dit is het enigste wat we moeten doen	,
$ vi ~/.bash_profile
export GOPATH=/home/eric/Devel/Golang/work2

/ als we de fedora pkg's use	, hoeven we GEEN 
export GOROOT=$HOME/go
export PATH=$PATH:$GOROOT/bin

/ Makkelijk	, 
[eric@almond $ PATH=$PATH:$GOPATH/bin

///////////////////////////////////////////////////////////////////////////////////////////////

/ We herstellen PATH met de hand	, GEEN go er in	, behalve  bin/ in $GOPATH/bin	,
[eric@almond work2]$ echo $PATH
/home/eric/Devel/Cloud/Google/google-cloud-sdk/bin:/home/eric/Devel/Cloud/Google/google-cloud-sdk/bin:/home/eric/Devel/Cloud/Google/google-cloud-sdk/bin:/home/eric/Devel/Cloud/Google/google-cloud-sdk/bin:/home/eric/Devel/Cloud/Google/google-cloud-sdk/bin:/usr/lib64/qt-3.3/bin:/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/home/eric/.local/bin:/home/eric/bin:/home/eric/Devel/Gradle/Java/gradle-2.4/bin:/home/eric/Devel/Cloud/Google/appengine-java-sdk-1.9.30/bin:/home/eric/Devel/Cloud/Google/go_appengine:/home/eric/.local/bin:/home/eric/bin:/home/eric/Devel/Cloud/Google/appengine-java-sdk-1.9.30/bin:/home/eric/Devel/Gradle/Java/gradle-2.13/bin:/home/eric/.local/bin:/home/eric/bin:/home/eric/Devel/Cloud/Google/appengine-java-sdk-1.9.30/bin:/home/eric/Devel/Gradle/Java/gradle-2.13/bin:/home/eric/.local/bin:/home/eric/bin:/home/eric/Devel/Cloud/Google/appengine-java-sdk-1.9.30/bin:/home/eric/Devel/Gradle/Java/gradle-2.13/bin:/home/eric/Devel/Golang/work2/bin


[eric@almond work2]$  pwd
/home/eric/Devel/Golang/work2
[eric@almond work2]$ cat src/my/my_hello/main.go 
package main
import "fmt"
func main(){
    fmt.Printf("Hello, world\n")
}
[eric@almond work2]$ go install my/my_hello
[eric@almond work2]$ bin/my_hello 
Hello, world

/ 7	. 

/ lees	,
https://golang.org/doc/install

[eric@almond work2]$  pwd
/home/eric/Devel/Golang/work2
[eric@almond work2]$ mkdir src/hello
[eric@almond work2]$ vi src/hello/hello.go
package main
import "fmt"
func main(){
	fmt.Printf("hello, world!\n")
}
[eric@almond work2]$  go build hello
[eric@almond work2]$ ls
bin  hello  src
[eric@almond work2]$ ./hello 
hello, world!

/ 13	. 

/ stel we maken nog een go file met een func main	,

[eric@almond work2]$ cat src/hello/main.go 
package main
import "fmt"
func main(){
	fmt.Printf("foo, bar!\n")
}
eric@almond work2]$  go build hello
# hello
src/hello/main.go:3: main redeclared in this block
	previous declaration at src/hello/hello.go:3

/ de naam hello.go of main.go maakt niet uit	, belangrijk is 
package main
func main(){
}
/ TODO

/ 13	. 

[eric@almond work2]$ mkdir src/hello/hello
[eric@almond work2]$ mv src/hello/hello.go src/hello/hello
[eric@almond work2]$ go build hello
can't load package: package hello: no buildable Go source files in /home/eric/Devel/Golang/work2/src/hello
[eric@almond work2]$ go build hello/hello
[eric@almond work2]$ ./hello 
hello, world!




/ 7	. 

/ op https://golang.org/doc/	, 
/ click 'A tour of Go'	,

/ 13	 

https://tour.golang.org/welcome/1
/ welcome bestaat uit 5 pages	,

[eric@almond work2]$ cat src/welcome/main.go 
package main
import "fmt"
func main(){
    fmt.Printf("Hello, !\n")
}
[eric@almond work2]$ go build welcome
[eric@almond work2]$ ./welcome 
Hello, !

/ 13	. 

https://tour.golang.org/basics/1

/ 1313	,

[eric@almond work2]$ cat src/basics/main.go 
package main
import ("fmt")
func main(){
    fmt.Printf("Hello, !\n")
}
[eric@almond work2]$ go install basics
[eric@almond work2]$ basics 
Hello, !

/ 1313	, 

[eric@almond work2]$ cat src/basics/main.go 
package main
import ("fmt";"math/rand")
func main(){
    fmt.Println("My favorite number is", rand.Intn(10))
}

/ ; tussen packages bij import	, of op een nieuwe regel	,
/ .Println ipv .Printf	,

/ 1313	. 

[eric@almond work2]$ cat src/basics/main.go 
package main
import (
	"fmt"
	"math"
)
func main(){
    fmt.Printf("My favorite number is %g\n", math.Sqrt(10))
}
[eric@almond work2]$ go install basics
[eric@almond work2]$ basics 
My favorite number is 3.1622776601683795

/ 1313	. 

/ Als we doen	,

[eric@almond work2]$ cat src/basics/main.go 
package main
import (
  "fmt"
  "math"
  "math/rand"
)
func main(){
    fmt.Printf("My favorite number is %g\n", math.Sqrt(10))
    fmt.Printf("My favorite number is %g\n", rand.Intn(10))
}
[eric@almond work2]$ go install basics
[eric@almond work2]$ basics 
My favorite number is 3.1622776601683795
My favorite number is %!g(int=1)
/ TODO

/ 1313	. 

[eric@almond work2]$ cat src/basics/main.go 
package main
import (
	"fmt"
	"math"
//	"math/rand"
)
func main(){
    fmt.Printf("My favorite number is %g\n", math.Sqrt(10))
    //fmt.Printf("My favorite number is %g\n", rand.Intn(10))
		fmt.Println(math.Pi)
    fmt.Printf("%g\n",math.Pi)
    fmt.Printf("%d\n",math.Pi)
}

/ comment is met //

[eric@almond work2]$ go install basics
[eric@almond work2]$ basics 
My favorite number is 3.1622776601683795
3.141592653589793
%!d(float64=3.141592653589793)
/ TODO

/ 1313	. 

[eric@almond work2]$ cat src/basics/main.go 

package main
import (
  "fmt"
  "math"
//  "math/rand"
)
func add(x int,y int)int{
  return x+y
}
func main(){
    fmt.Printf("My favorite number is %g\n", math.Sqrt(10))
    //fmt.Printf("My favorite number is %g\n", rand.Intn(10))
    fmt.Println(math.Pi)
    fmt.Printf("%g\n",math.Pi)
  	//fmt.Printf("%d\n",math.Pi)
    fmt.Println(add(3,5))
    fmt.Printf("%d\n",add(3,5))
}

[eric@almond work2]$ go install basics
[eric@almond work2]$ basics 
My favorite number is 3.1622776601683795
3.141592653589793
3.141592653589793
8
8

/ 1313	. 

func add(x,y int)int{
/ OK

/ 1313	.
[eric@almond work2]$ cat src/basics/main.go 

package main
import (
	"fmt"
	"math"
//	"math/rand"
)
func add(x,y int)int{
	return x+y
}
func swap(s,t string)(string,string){
	return t,s
}
func main(){
    fmt.Printf("My favorite number is %g\n", math.Sqrt(10))
    //fmt.Printf("My favorite number is %g\n", rand.Intn(10))
		fmt.Println(math.Pi)
		fmt.Printf("%g\n",math.Pi)
	//	fmt.Printf("%d\n",math.Pi)
		fmt.Println(add(3,5))
		fmt.Printf("%d\n",add(3,5))
		a,b:=swap("","")
		fmt.Println(a,b)
    fmt.Printf("%s, %s\n",a,b);
}

[eric@almond work2]$ go install basics
[eric@almond work2]$ basics 
My favorite number is 3.1622776601683795
3.141592653589793
3.141592653589793
8
8
 
, 

/ we mogen dus wel ; set	,

/ 1313	, 

[eric@almond work2]$ cat src/basics/main.go 
package main
import (
	"fmt"
	"math"
//	"math/rand"
)
func add(x,y int)int{
	return x+y
}
func swap(s,t string)(string,string){
	return t,s
}
func split(sum int)(x,y int){
	x=sum*4/9
	y=sum-x
	return
}
func main(){
    fmt.Printf("My favorite number is %g\n", math.Sqrt(10))
    //fmt.Printf("My favorite number is %g\n", rand.Intn(10))
		fmt.Println(math.Pi)
		fmt.Printf("%g\n",math.Pi)
		//mt.Printf("%d\n",math.Pi)
		fmt.Println(add(3,5))
		fmt.Printf("%d\n",add(3,5))
		a,b:=swap("","")
		fmt.Println(a,b)
		fmt.Printf("%s, %s\n",a,b);
		a2,b2:=split(17)
		fmt.Println(a2,b2)
}

[eric@almond work2]$ go install basics
[eric@almond work2]$ basics 
My favorite number is 3.1622776601683795
3.141592653589793
3.141592653589793
8
8
 
, 
7 10

/ Omdat x int is	, is 4*17/9 afgerond	,

/ Dit kun je maar 1 keer doen	, 
		a,b:=swap("","")
/ Als we	,
		a,b:=swap("","")
		a,b:=swap("","")
/ dan	,
src/basics/main.go:30: no new variables on left side of :=

/ 13	. 

[eric@almond work2]$ cat src/basics/main.go 
package main
import (
	"fmt"
	"math"
//	"math/rand"
)
func add(x,y int)int{
	return x+y
}
func swap(s,t string)(string,string){
	return t,s
}
func swap2(s,t string)(string,string){
	return t,s
}
func split(sum int)(x,y int){
	x=sum*4/9
	y=sum-x
	return
}
var c,python,java bool																								<-

func main(){
    fmt.Printf("My favorite number is %g\n", math.Sqrt(10))
    //fmt.Printf("My favorite number is %g\n", rand.Intn(10))
		fmt.Println(math.Pi)
		fmt.Printf("%g\n",math.Pi)
		//fmt.Printf("%d\n",math.Pi)
		fmt.Println(add(3,5))
		fmt.Printf("%d\n",add(3,5))
		a,b:=swap("","")
		fmt.Println(a,b)
		fmt.Printf("%s, %s\n",a,b);
		a2,b2:=split(17)
		fmt.Println(a2,b2)
		var i int																					<-
		fmt.Println(i,c,python,java)											<-
}

[eric@almond work2]$ go install basics
[eric@almond work2]$ basics 
My favorite number is 3.1622776601683795
3.141592653589793
3.141592653589793
8
8
 
, 
7 10
0 false false false

/ 1313	. 

[eric@almond work2]$ cat src/basics/main.go 
package main
import (
	"fmt"
	"math"
//	"math/rand"
)
func add(x,y int)int{
	return x+y
}
func swap(s,t string)(string,string){
	return t,s
}
func swap2(s,t string)(string,string){
	return t,s
}
func split(sum int)(x,y int){
	x=sum*4/9
	y=sum-x
	return
}
var c,python,java bool
var i,j int=1,2

func main(){
    fmt.Printf("My favorite number is %g\n", math.Sqrt(10))
    //fmt.Printf("My favorite number is %g\n", rand.Intn(10))
		fmt.Println(math.Pi)
		fmt.Printf("%g\n",math.Pi)
		//fmt.Printf("%d\n",math.Pi)
		fmt.Println(add(3,5))
		fmt.Printf("%d\n",add(3,5))
		a,b:=swap("","")
		fmt.Println(a,b)
		fmt.Printf("%s, %s\n",a,b);
		a2,b2:=split(17)
		fmt.Println(a2,b2)
		var i int
		fmt.Println(i,c,python,java)
		var d,erlang,scala=true,false,"no!"
		fmt.Println(i,j,d,erlang,scala)

}

/ de i in main overrides de i global	,

[eric@almond work2]$ basics 
My favorite number is 3.1622776601683795
3.141592653589793
3.141592653589793
8
8
 
, 
7 10
0 false false false
0 2 true false no!

/ 1313	. 

/ Kan alleen binnen fcts	,

/ := is var with implicit type	,

    a2,b2:=split(17)
/=
    var a2,b2=split(17)
/=
    var a2,b2 int=split(17)

/ 1313	. 

//var c,python,java bool
//var i,j int=1,2
//=
var (
  c,python,java bool
  i,j int=1,2
)

/ 1313	. 

[eric@almond work2]$ cat src/basics/main.go 
package main
import (
  "fmt"
  "math"
//  "math/rand"
  "math/cmplx"
)
var(
  ToBe bool=false
  MaxInt uint64=1<<64-1
  z complex128=cmplx.Sqrt(-5+12i)
  r int32='';	// of r rune	,
)

func main(){
    const f="%T(%v)\n"
    const g="%T(%x)\n"
    fmt.Printf(f,ToBe,ToBe)
    fmt.Printf(f,MaxInt,MaxInt)
    fmt.Printf(f,z,z)
    fmt.Printf(g,r,r)
}

[eric@almond work2]$ basics 
bool(false)
uint64(18446744073709551615)
complex128((2+3i))
int32(3a0)


/ Let op: %v in	, 
    const f="%T(%v)\n"
/ Let op: %x in	, 
    const g="%T(%x)\n"

/ 1313	.

/ als we een var in main opnieuw def	, naast global dan OK	, 
/ maar als we in main een var 2 keer def	,
src/basics/main.go:67: b redeclared in this block
	previous declaration at src/basics/main.go:46

/ Maar we kunnen wel een nieuw block maken	,

func main(){
    a,b:=swap("","")
    var i int
    const f="%T(%v)\n"
{
    var(
      i int
      f float64
      b bool
      s string
    )
    fmt.Printf("%v %v %v %q\n",i,f,b,s)
}


[eric@almond work2]$ basics 
...
0 0 false ""

/ 1313	.

/ In Go alleen explicit conversions	, itt in C	,

{
  var x,y int=3,4
  var f float64=math.Sqrt(float64(x*x+y*y))
  var z uint=uint(f)
  fmt.Println(x,y,z) 
  fmt.Printf("%d %f %g %d\n",x,f,f,z)

}

3 4 5
3 5.000000 5 5

/ 1313	. 

/ als er links geen type staat	, wordt de type infered van die rechts	, 
/ rechts kan een constant staan, of een var	,

{
  var v=42
  fmt.Printf("type %T\n",v)
}

[eric@almond work2]$ basics 
type int

/ 1313	.

/ we zien 2 chines chars	, 
/ we copy paste ze met de muis	, en doen	,

$ vi main.go
{
  var x,y int32='',''
  fmt.Printf("%x,%x\n",x,y)
}

[eric@almond work2]$ basics 
4e16,754c

/ we kunnen dus voortaan ctrl+shift+u, 4e16 en 754c:  en 	, 

$ vi main.go
{
  const World=""									<- kunnenwe zelf type	,
  const Pi=3.14												< Pi mag ook pi heten	, of def globally	,
  fmt.Println("Hello",World)
  fmt.Println("Hello",Pi,"Day")
  const Truth=true
  fmt.Println("Go rules?",Truth)
}

[eric@almond work2]$ basics 
Hello 
Hello 3.14 Day
Go rules? true

/ 13	. 

/ nested functies gaat NIET	,

$ vi main.go
func needInt(x int)int{return x*10+1}
func needFloat(x float64)float64{return x*0.1}

func main(){
{
  const(
    Big=1<<100
    Small=Big>>99
  )

  fmt.Println(needInt(Small))
  fmt.Println(needFloat(Small))
  fmt.Println(needFloat(Big))
}

[eric@almond work2]$ basics 
21
0.2
1.2676506002282295e+29

/ 13	. 

/ we gaan naar	,
https://tour.golang.org/flowcontrol/1

/ 1313	. 

[eric@almond work2]$ cat src/flow/main.go 
package main
import "fmt"
func main(){
	var sum int=0
	fmt.Println(sum)
}

[eric@almond work2]$ go install flow
[eric@almond work2]$ flow
0

/ 1313	.

[eric@almond work2]$ cat src/flow/main.go 
package main
import "fmt"
func main(){
	var sum int=0
	var i int
	for i=0;i<10;i++{
		sum+=i
	}
	fmt.Println(sum)
}

[eric@almond work2]$ go install flow
[eric@almond work2]$ flow
45

/ Dit kan NIET	,
	for var i int=0;i<10;i++{

/ Dit kan NIET	,
	sum int=0

/ dit kan WEL	,
	var sum=0

/ dit kan WEL	,
  var i int=0
  for ;i<10;i++{

/ Dit kan NIET	,
  var i int=0
  for i<10;i++{

/ Dit kan WEL	,
  var sum int=0
  var i int=0
  for i<10{
    sum+=i
    i=i+1
  }
/ Dus 2 of 0 ;'s	,

/ Dit kan NIET	,
	i int:=0

/ 1313	.

/ if	,

[eric@almond work2]$ cat src/flow/main.go 
package main
import(
	"fmt"
	"math"
)
func sqrt(x float64)string{
	if x<0{
		return sqrt(-x)+"i"
	}
	return fmt.Sprint(math.Sqrt(x))
}
func main(){
{
	fmt.Println(sqrt(2),sqrt(-4))
}
}

[eric@almond work2]$ cat src/flow/main.go 
[eric@almond work2]$ flow
1.4142135623730951 2i


/ 1313	. 

[eric@almond work2]$ cat src/flow/main.go 

func pow(x,n,lim float64)float64{
  var v float64=math.Pow(x,n)						// v is in heel fct block def	,
  if v<lim{
    return v
  }else{
	 	fmt.Printf("%g>%g\n", v,lim)	
	}
  return lim
}
// of	, 																// v is alleen def in if-else block	, 
func pow(x,n,lim float64)float64{
  if v:=math.Pow(x,n);v<lim{
    return v
  }else{
	 	fmt.Printf("%g>%g\n", v,lim)	
	}
  return lim
}

func main(){
{
  fmt.Println(
    pow(3,2,10),
    pow(3,3,20),
  )
}
}

[eric@almond work2]$ flow
9 20

/ 1313	.

func Sqrt(x float64)float64{
  z:=float64(1)
  for i:=1;i<10;i++{
    z=z-(z*z-x)/(2*z)
  }
  return z
}
func main(){
{
  fmt.Println(Sqrt(2))
  fmt.Println(math.Sqrt(2))
}
}

1.4142135623730951
1.4142135623730951

/ 1313.

/ Nu met dat verschil kleiner dan	,

func Sqrt(x float64)float64{
  z:=float64(1)
  t:=z
  for i:=1;i<10;i++{
    z=z-(z*z-x)/(2*z)
    d:=math.Abs(z-t)
    fmt.Println("t,z,d:",t,z,d)
    if math.Abs(z-t)<math.Pow10(-3){
      break
    }
    t=z
  }
  return z
}

func main(){
{
  fmt.Println(Sqrt(2))
  fmt.Println(math.Sqrt(2))
}

t,z,d: 1 1.5 0.5
t,z,d: 1.5 1.4166666666666667 0.08333333333333326
t,z,d: 1.4166666666666667 1.4142156862745099 0.002450980392156854
t,z,d: 1.4142156862745099 1.4142135623746899 2.123899820016817e-06
1.4142135623746899
1.4142135623730951


/ Dit kan NIET	,
  t:=z:=float64(1)

/ 1313	.

func os(){
  fmt.Print("Go runs on ")
  switch os:=runtime.GOOS;os{
  case "darwin":
    fmt.Println("OS X.")
  case "linux":
    fmt.Println("Linux.")
  default:
    fmt.Println("%s.",os)
  }
}

func main(){
{
  os();
}

Go runs on Linux.

/ 1313	. 

func today(){
  fmt.Println("When is Wednesday?")
  switch today:=time.Now().Weekday();time.Wednesday{
  case today+0:
    fmt.Println("Today.")
  case today+1:
    fmt.Println("Tomorrow.")
  case today+2:
    fmt.Println("In 2 days.")
  default:
    fmt.Println("Too far away.")
  }
}

func main(){
{
  today();
}
}

When is Wednesday?
In 2 days.

/ let op	;
	default: ...
/ NIET	, 
	case default: ...

/ 1313	.

func main(){
{
  defer fmt.Println("Deferred!")
  fmt.Println("Now")
}
}

$ flow
Now
Deferred!

/ 1313	.

func main(){
{
  defer fmt.Println("Deferred!")
  fmt.Println("Now")
}
{
  fmt.Println("Counting...")
  for i:=0;i<10;i++{
    defer fmt.Println(i)
  }
  fmt.Println("Done.")
}
}

$ flow
Now
Counting...
Done.
9
8
7
6
5
4
3
2
1
0
Deferred!


/ 13	. 

/ Pointers	,

/ 1313	.

/ slices	, [0:3] = index 0,1,2

[eric@almond work2]$ cat src/moretypes/main.go 
package main
import "fmt"

func main(){
	primes:=[6]int{2,3,5,7,11,13}
	var s[]int=primes[1:4]
	fmt.Println(s)
}
[eric@almond work2]$ go install moretypes
[eric@almond work2]$ moretypes 
[3 5 7]

/ 1313	.

/ NB. type string, NIET String	,

$ vi main.go
func main(){
{
  names:=[4]string{"John","Paul","George","Ringo"}
  a:=names[0:2]
  b:=names[1:3]
  fmt.Println(names)
  fmt.Println(a,b)
  b[0]="XXX"
  fmt.Println(names)
  fmt.Println(a,b)
}
}

[eric@almond work2]$ moretypes 
[John Paul George Ringo]
[John Paul] [Paul George]
[John XXX George Ringo]
[John XXX] [XXX George]

/ 1313	. 

/ slices	,

A slice literal is like an array literal without the length.

This is an array literal:
[3]bool{true, true, false}

/////////////////////////////////////////////////////////////////////////////////////////////
And this creates the same array as above, then builds a slice that references it:
[]bool{true, true, false}


/ 1313	.

/ len, cap	,

$ vi main.go

func main(){
{
  s:=[]int{2,3,5,7,11,13}
  printSlice(s)
  s=s[:0]
  printSlice(s)
  s=s[:4]
  printSlice(s)
  s=s[2:]
  printSlice(s)

}
}
func printSlice(s[]int){
  fmt.Printf("len=%d, cap=%d, %v\n",len(s),cap(s),s)
}

len=6, cap=6, [2 3 5 7 11 13]
len=0, cap=6, []
len=4, cap=6, [2 3 5 7]
len=2, cap=4, [5 7] 				/ TODO (cap=4)

/ we zien het ook in	,

$ vi main.go
func main(){
{
  fmt.Println("first")
  s:=[]int{2,3,5,7,11,13}
  printSlice(s)
  s=s[2:]
  printSlice(s)
  s=s[0:]
  printSlice(s)

}
{
  fmt.Println("second")
  s:=[]int{2,3,5,7,11,13}
  printSlice(s)
  s=s[:4]
  printSlice(s)
  s=s[:6]
  printSlice(s)
 
}
}
func printSlice(s[]int){
  fmt.Printf("len=%d, cap=%d, %v\n",len(s),cap(s),s)
}

first
len=6, cap=6, [2 3 5 7 11 13]
len=4, cap=4, [5 7 11 13]
len=4, cap=4, [5 7 11 13]
second
len=6, cap=6, [2 3 5 7 11 13]
len=4, cap=6, [2 3 5 7]
len=6, cap=6, [2 3 5 7 11 13]

/ de cap fluctueert alleen rechts	, je kunt de slice rechts eerst kleiner, en dan weer groter maken	, 
/ als je de slice links kleiner maakt, is dat definitief	,

/ 1313	.

{
  fmt.Println("third")
  var s[]int
  printSlice(s)
  s=append(s,0)
  printSlice(s)
  s=append(s,1)
  printSlice(s)
  s=append(s,2,3,4)
  printSlice(s)
  s=append(s,5,6,7)
  printSlice(s)
}

third
len=0, cap=0, []
len=1, cap=1, [0]
len=2, cap=2, [0 1]
len=5, cap=6, [0 1 2 3 4]					/ TODO cap=6	,
len=8, cap=12, [0 1 2 3 4 5 6 7]	/ TODO cap=12	,

/ 1313	.

The make function allocates a zeroed array and returns a slice that refers to that array:

{
  fmt.Println("fourth")
  var s[]int=make([]int,5)
  printSlice(s)
  var t[]int=make([]int,0,5)
  printSlice(t)
  var u[]int=t[:2]
  printSlice(u)
  var v[]int=u[2:5]
  printSlice(v)
}

fourth
len=5, cap=5, [0 0 0 0 0]
len=0, cap=5, []
len=2, cap=5, [0 0]
len=3, cap=3, [0 0 0]

/ 1313	. 

{
  fmt.Println("fifth")
  var s[]int=make([]int,5)
  s=append(s,7,7,7)
  printSlice(s)

}
fifth
len=8, cap=10, []int, [0 0 0 0 0 7 7 7]

/ 1313	.

{
  fmt.Println("sixth")
  var a[2]int;
  a[0]=7
  a[1]=13
  printArray(a)
  var s[]int=a[0:2]
  printSlice(s)
  s=append(s,3,4,5)
  printSlice(s)

}
}
func printSlice(s[]int){
  fmt.Printf("len=%d, cap=%d, %T, %v\n",len(s),cap(s),s,s)
}
func printArray(s[2]int){
  fmt.Printf("len=%d, cap=%d, %T, %v\n",len(s),cap(s),s,s)
}

sixth
len=2, cap=2, [2]int, [7 13]
len=2, cap=2, []int, [7 13]
len=5, cap=6, []int, [7 13 3 4 5]

/ 13

/ range

{
  fmt.Println("seventh")
  var a[]int=[]int{1,2,4,8,16,32,64,128} 	
  for i,v:=range a{
    fmt.Printf("2^%d=%d\n",i,v)
  }
}

seventh
2^0=1
2^1=2
2^2=4
2^3=8
2^4=16
2^5=32
2^6=64
2^7=128

/ NB	, 
	var a[]int={1,2,4,8,16,32,64,128}				
/ ERR	, je moet rechts het type meegeven	, dus []int{1,2,...}

  var a=[]int{1,2,4,8,16,32,64,128} 	
/ OK	, links dan hij het type afleiden	, rechts moet het staan	,

/ 13

/ map	,

/ 1313	. 

{
  fmt.Println("eighth")
  type V struct{
    Lat,Long float64
  }
  var m map[string]V			/  *
  fmt.Println(m)
  m=make(map[string]V)		/ **
  //m:=make(map[string]V)
  fmt.Println(m)
  m["Foo"]=V{20.6,-30.3} 	/ ***
  fmt.Println(m["Foo"])
}

/ Als we ** NIET doen	, dan bij ***	,
panic: assignment to entry in nil map

/  we kunnen of * en ** of	,
  m:=make(map[string]V)

/ we zien	,

eighth
map[]					/ TODO: Maar het is nil		
map[]
{20.6 -30.3}


 /1313	. 

/ Of we maken een map literal	,

/ Met een map literal doen we GEEN make	,

{
  fmt.Println("nineth")
  type V struct{
    Lat,Long float64
  }
  var m map[string]V=map[string]V{
    "Foo":V{20.6,-30.3},							/ NB: 	de , erachter	, TODO
  }
  fmt.Println(m)
  fmt.Println(m["Foo"])
}

nineth
map[Foo:{20.6 -30.3}]
{20.6 -30.3}


/ 1313	.


{
  fmt.Println("tenth")
  var m map[string]int=make(map[string]int)
  m["Answer"]=42
  fmt.Println(m["Answer"])
  m["Answer"]=48
  fmt.Println(m["Answer"])
  delete(m,"Answer")
  fmt.Println(m["Answer"])
  v,ok:=m["Answer"]
  fmt.Printf("%T, %T,%v,%v\n",v,ok,v,ok)
}

tenth
42
48
0
int, bool, 0, false

/ 1313	.

{
  fmt.Println("twelveth")
  fmt.Printf("%T, %v , %f\n",4.532,4.532,4.532)
}

float64, 4.532 , 4.532000

/ 1313	. 

/ wc

/ 131313	.

 /we oef	,
import ("fmt","strings")

{ 
  fmt.Println("13th")

  fmt.Printf("Fields are %q\n",strings.Fields(" foo bar      baz      "))

  var strs[]string=strings.Fields(" foo bar      bar      ")
  for _,str:=range strs{
    fmt.Printf("%s\n",str)
  }
}

13th
Fields are ["foo" "bar" "baz"]
foo
bar
bar

/ 131313

/ wc	,

{
  fmt.Println("14th")
  str:="foo bar foo bar baz"
  var strs[]string=strings.Fields(str)
  var cnt map[string]int
  cnt=make(map[string]int)
  for _,str:=range strs{
    cnt[str]=cnt[str]+1 
  }
  fmt.Println(cnt)
}

14th
map[foo:2 bar:2 baz:1]

/ 1313	.

/ fct as value	,

func main(){
{
  fmt.Println("15th")
  hypot:=func(x,y float64)float64{
    return math.Sqrt(x*x+y*y)
  }
  fmt.Println(hypot(5,12))
  fmt.Println(call(hypot))
  fmt.Println(call(math.Pow))
}
}
func call(fn func(float64,float64)float64)float64{
  return fn(3,4)
}

15th
13
5
81

/ 1313	.

/ closures	,

/ 131313	, 

/ we define adder global	, we kunnen func adder(){...}	, 

func main(){
{
  fmt.Println("16th")
  pos,neg:=_adder(),_adder()
  for i:=0;i<10;i++{
    fmt.Println( pos(i),  neg(-2*i))
  }
}
}
func adder()func(int)int{
  sum:=0
  var fct=func(x int)int{									/ OK	,
  //var fct func(int)int=func(x int)int{ 	/ OK	,
  //fct:=func(x int)int{									/ OK	,
    sum+=x
    return sum
  }
  return fct
}

16th
0 0
1 -2
3 -6
6 -12
10 -20
15 -30
21 -42
28 -56
36 -72
45 -90

/ 131313	. 

/ we maken adder ook inner fct	, we noteren _adder	,

{
  fmt.Println("16th")
  //func _adder()func(int)int{    // syntax error: nested func not allowed
  _adder:=func()func(int)int{ // OK
  //var _adder=func()func(int)int{  // OK ,
  //var _adder func()func(int)int=func()func(int)int{  // OK  ,
    sum:=0
    //var _fct=func(x int)int{                // OK
    //var fct func(int)int=func(x int)int{  // OK
    _fct:=func(x int)int{                 // OK
      fmt.Printf("before: %d, %d",x,sum)
      sum+=x
      fmt.Printf("after: %x, %d\n",x,sum)
      return sum
    }
    return _fct
  }
  pos,neg:=_adder(),_adder()
  for i:=0;i<10;i++{
    fmt.Println( pos(i),  neg(-2*i))
  }
}

/ voor iedere i wordt pos==adder()  maar 1 keer called	, omdat sum in z'n env zit	, wordt deze onthouden	,

16th
0 0
1 -2
3 -6
6 -12
10 -20
15 -30
21 -42
28 -56
36 -72
45 -90

/ 1313	.

/ fibonacci	, 

/ we doen het op 2 manieren	, zonder en met slice	, 

{
  fmt.Println("17th")
  var fibo func()func()int=func()func()int{
    var i,j int=0,1
    var fct func()int=func()int{
      var s=i+j
      i=j
      j=s
      return j
    }
    return fct
  }
  f:=fibo()
  for i:=0;i<10;i++{
    fmt.Println(f())
  }

  var fibo2 func()func()[]int=func()func()[]int{
    var n[]int=[]int{0,1}
    var fct func()[]int=func()[]int{
      var s=n[len(n)-2]+n[len(n)-1]
      n=append(n,s)
      return n
    }
    return fct
  }
  f2:=fibo2()
  for i:=0;i<10;i++{
    fmt.Println(f2())
  }
}

17th
1
2
3
5
8
13
21
34
55
89
[0 1 1]
[0 1 1 2]
[0 1 1 2 3]
[0 1 1 2 3 5]
[0 1 1 2 3 5 8]
[0 1 1 2 3 5 8 13]
[0 1 1 2 3 5 8 13 21]
[0 1 1 2 3 5 8 13 21 34]
[0 1 1 2 3 5 8 13 21 34 55]
[0 1 1 2 3 5 8 13 21 34 55 89]

/ Maar als we bij fibo2 i<10 in i<100 vervangen	, dan is de laatste slice	,

[0 1 1 2 3 5 8 13 21 34 55 89 144 233 377 610 987 1597 2584 4181 6765 10946 17711 28657 46368 75025 121393 196418 317811 514229 832040 1346269 2178309 3524578 5702887 9227465 14930352 24157817 39088169 63245986 102334155 165580141 267914296 433494437 701408733 1134903170 1836311903 2971215073 4807526976 7778742049 12586269025 20365011074 32951280099 53316291173 86267571272 139583862445 225851433717 365435296162 591286729879 956722026041 1548008755920 2504730781961 4052739537881 6557470319842 10610209857723 17167680177565 27777890035288 44945570212853 72723460248141 117669030460994 190392490709135 308061521170129 498454011879264 806515533049393 1304969544928657 2111485077978050 3416454622906707 5527939700884757 8944394323791464 14472334024676221 23416728348467685 37889062373143906 61305790721611591 99194853094755497 160500643816367088 259695496911122585 420196140727489673 679891637638612258 1100087778366101931 1779979416004714189 2880067194370816120 4660046610375530309 7540113804746346429 -6246583658587674878 1293530146158671551 -4953053512429003327 -3659523366270331776 -8612576878699335103 6174643828739884737 -2437933049959450366 3736710778780434371 1298777728820984005]

/ Dus dat gaat niet goed met grote getallen	, 

/ Lees	,
https://github.com/golang/go/wiki
https://github.com/golang/go/wiki/SliceTricks
http://stackoverflow.com/questions/22535775/the-last-element-of-a-slice
https://golang.org/pkg/math/big/

/ 13	. 

/ methods	,

/ 1313	. 

$ vi src/methods/main.go 

package main
import(
  "fmt"
  "math"
)
type V struct{  
  x,y float64
}
func(v V)Abs()float64{
  return math.Sqrt(v.x*v.x+v.y*v.y)
}
func main(){
  //var _Abs func(V v)()float64=func(v V)()float64{	 // ERR	,
  //var _Abs=func(v V)()float64{	// ERR	,
  //_Abs:=func(v V)()float64{			// ERR
  //  return math.Sqrt(v.x*v.x+v.y*v.y)
  //}

  //v:=V{3,4}				/ OK
  var v V=V{3,4}
  fmt.Println(v.Abs())
  //fmt.Println(v._Abs())
}

/ 1313	. 

/ exercise Stringers	,

/ 131313

func main(){
{
  fmt.Println("2nd")
	type IPAddr[4]byte
  hosts:=map[string]IPAddr{
    "lo":{127,0,0,1},
    "dns":{0,0,0,0},
  }
  for name,ip:=range hosts{
    fmt.Printf("%v: %v\n",name,ip)
  }
}
}

2nd
lo: [127 0 0 1]
dns: [0 0 0 0]

/ 131313

/ fmt.Printf looks for a String()string fct	,  dus looks in the type for the Stringer interface	,

type IPAddr[4]byte
func(a IPAddr)String()string{
  return fmt.Sprintf("%v.%v.%v.%v",a[0],a[1],a[2],a[3])
}
func main(){
{
  fmt.Println("2nd")
  hosts:=map[string]IPAddr{
    "lo":{127,0,0,1},
    "dns":{0,0,0,0},
  }
  for name,ip:=range hosts{
    fmt.Printf("%v: %v\n",name,ip)
  }
}

2nd
lo: 127.0.0.1
dns: 0.0.0.0

/ 1313	. 

/ 131313

/ fmt.Printf looks for a Error()string fct	,  dus looks in the type for the error interface	,

/ we maken een err type MyError	, en geven hem een string fct	, 
/ we maken een fct, die een err throws	,

type _Error struct{
  When time.Time
  What string
}
func(e*_Error)Error()string{
  return fmt.Sprintf("at %v, %s",e.When,e.What)
}
func run()error{
  return &_Error{
    time.Now(),
    "It did not work",
  }
}

func main(){
{
  fmt.Println("4th")
  if err:=run();err!=nil{
    fmt.Println(err)
  }
}
}

4th
at 2016-08-20 17:29:14.394360986 +0200 CEST, It did not work

/ 131313	. 

/ we probeerden

func run(i int)error{
	if i==0{
		return 0
	}
  return &_Error{
    time.Now(),
    "It did not work",
  }
}

func main(){
{
  fmt.Println("4th")
  if err:=run(0);err!=nil{
    fmt.Println(err)
  }
  if err:=run(1);err!=nil{
    fmt.Println(err)
  }
}

[eric@almond work2]$ go install methods
# methods
src/methods/main.go:31: cannot use 0 (type int) as type error in return argument:
	int does not implement error (missing Error method)

/ Het gaat anders	, see hieronder	,

/ 1313	. 

/ exercise met Sqrt & err	,


type _Error2 float64
func(e _Error2)Error()string{
  return fmt.Sprintf("Cannot sqrt negative number %d",float64(e))			<- cast e naar float64	, anders infinite loop	,
}
func Sqrt(x float64)(float64,error){
  if x<0{
    return x,_Error2(x)							<- cast x naar _Error2	, 
  }
  z:=float64(1)
  t:=z
  for i:=1;i<10;i++{
    z=z-(z*z-x)/(2*z)
    if math.Abs(z-t)<math.Pow10(-3){
      break
    }
    t=z
  }
  return z,nil
}

func main(){
{
  fmt.Println("5th")
  fmt.Println(Sqrt(2))
  fmt.Println(Sqrt(-3))

}

5th
1.4142135623746899 <nil>
-3 Cannot sqrt negative number %!d(float64=-3)

/ 1313	.

/ Lees	, 
http://www.captaincodeman.com/2015/03/05/dependency-injection-in-go-golang/
https://github.com/lib/pq
https://astaxie.gitbooks.io/build-web-application-with-golang/content/en/05.4.html
http://www.hydrogen18.com/blog/golang-orms-and-why-im-still-not-using-one.html
https://github.com/go-gorp/gorp

/ 1313	. 

{
  fmt.Println("6th")
  var r*strings.Reader=strings.NewReader("hello, reader!")
  var b[]byte=make([]byte,8)
  for{
    n,err:=r.Read(b)
    fmt.Printf("%v, %v, %v",n,err,b)
    fmt.Printf("b[:n]=%q\n",b[:n])
    if err==io.EOF{
      fmt.Printf("%T\n",err)
      break
    }
  }
}

6th
8, <nil>, [104 101 108 108 111 44 32 114]b[:n]="hello, r"
6, <nil>, [101 97 100 101 114 33 32 114]b[:n]="eader!"
0, EOF, [101 97 100 101 114 33 32 114]b[:n]=""

/ 131313

/ we probeerden ipv
    n,err:=r.Read(b)

		var n,err int,error=r.Read(b)
/ TODO

/ we maakten	,

{
  fmt.Println("7th")
  var f=func()(int,int){
    return 0,0
  }
  x,y:=f()
  fmt.Printf("%d, %d\n",x,y)
  //var s,t int,int=f()				/ TODO
}

/ 131313	. 

/ we werken met utf8	, 

{
  fmt.Println("6th")
  var r*strings.Reader=strings.NewReader(", !")
  var b[]byte=make([]byte,8)
  for{
    n,err:=r.Read(b)
    fmt.Printf("%v, %v, %v\n",n,err,b)
    fmt.Printf("b[:n]=%q\n",b[:n])
    if err==io.EOF{
      fmt.Printf("%T\n",err)
      break
    }
  }
}

6th
7, <nil>, [207 128 44 32 206 181 33 0]
b[:n]=", !"
0, EOF, [207 128 44 32 206 181 33 0]
b[:n]=""

[eric@almond work2]$ echo ", !"  | od -t u1 -t c
0000000 207 128  44  32 206 181  33  10
        317 200   ,     316 265   !  \n
0000010

/ 131313	.

/ we kunnen ook	, 
    fmt.Printf("%v, %v, %x\n",n,err,b)
/ dan zien we	,
7, <nil>, cf802c20ceb52100
b[:n]=", !"
0, EOF, cf802c20ceb52100
b[:n]=""

[eric@almond work2]$ echo ", !"  | od -t x1 -t c
0000000  cf  80  2c  20  ce  b5  21  0a
        317 200   ,     316 265   !  \n
0000010

/ 1313	.

/ exercise	,

[eric@almond Golang]$ tar tvzf ~/Downloads/go1.6.3.linux-amd64.tar.gz  | grep tour
drwxr-xr-x 0/0               0 2016-07-18 18:27 go/misc/tour/
...

import(
  "fmt"
  "math"
  "time"
  "io"
  "strings"
  "golang.org/x/tour/reader"		// ERR	,
)

type _Reader struct{}
func(r _Reader)Read([]byte)(int,error){
  return 0,nil
}

func main(){
{
  fmt.Println("8th")
  reader.Validate(_Reader())

}
}

/ In welk fedora package zit golang.org/x/tour/reader

$ go get golang.org/x/tour/gotour
$ gotour
/ TODO

/ 1313	. 

/ rot13 reader

/ als we de ex run zoals het op de site staat	, zien 	we de ERR msg	,
sandbox155870831/main.go:16: cannot use &r (type *rot13Reader) as type io.Reader in argument to io.Copy:
	*rot13Reader does not implement io.Reader (missing Read method)

/ Lees	,
https://golang.org/pkg/io/#Reader
type Reader interface {
        Read(p []byte) (n int, err error)
}

/ we maken	,

$ vi main.go

type rot13Reader struct{
  r io.Reader
}
func(r rot13Reader)Read(p []byte) (n int, err error){
}

func main(){
...

/ Lees	,
https://en.wikipedia.org/wiki/ROT13
https://blog.golang.org/strings

/ 131313	.

/ Geef in google	,
golang string to rune slice	,
/ Lees	,
http://stackoverflow.com/questions/15018545/how-to-index-characters-in-a-golang-string
/ we zien daar ook	,
See the Go Programming Language Specification section on Conversions.
 
/ we oef	,

{
  fmt.Println("10th")
  fmt.Println("[]byte")
  a:=[]byte("a")
  fmt.Printf("%T\n",a)
  fmt.Printf("%#v\n",b)
  fmt.Printf("%q\n",a)
  fmt.Printf("%v\n",a)
  fmt.Printf("%x\n",a)
  fmt.Println("[]rune")
  b:=[]rune("a")
  fmt.Printf("%T\n",b)
  fmt.Printf("%#v\n",b)
  fmt.Printf("%q\n",b)
  fmt.Printf("%x\n",b)
  fmt.Printf("%U\n",b)

  a2:="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"
  b2:="NOPQRSTUVWXYZABCDEFGHIJKLMnopqrstuvwxyzabcdefghijklm"
  var m map[byte]byte
  m=make(map[byte]byte)
  for i:=0;i<len(a2);i++{
    //fmt.Printf("%q,",a2[i])
    m[a2[i]]=b2[i]
  }
  fmt.Printf("%q\n",m)
  fmt.Printf("%v\n",m) //= fmt.Printf("%d\n",m)
  //fmt.Printf("%x\n",m)

}
10th
[]byte
[]uint8
[]byte{0xcf, 0x80, 0xce, 0xb5, 0x61}
"a"
[207 128 206 181 97]
cf80ceb561
[]rune
[]int32
[]int32{960, 949, 97}
['' '' 'a']
[3c0 3b5 61]
[U+03C0 U+03B5 U+0061]
map['H':'U' 'K':'X' 'a':'n' 'c':'p' 'd':'q' 'e':'r' 'm':'z' 'A':'N' 'u':'h' 'N':'A' 'T':'G' 'Y':'L' 'p':'c' 'z':'m' 'C':'P' 'Z':'M' 'b':'o' 'h':'u' 't':'g' 'M':'Z' 'D':'Q' 'f':'s' 's':'f' 'v':'i' 'B':'O' 'I':'V' 'L':'Y' 'P':'C' 'Q':'D' 'R':'E' 'X':'K' 'i':'v' 'G':'T' 'q':'d' 'x':'k' 'j':'w' 'g':'t' 'r':'e' 'y':'l' 'U':'H' 'J':'W' 'V':'I' 'l':'y' 'n':'a' 'E':'R' 'O':'B' 'S':'F' 'W':'J' 'k':'x' 'o':'b' 'w':'j' 'F':'S']
map[76:89 84:71 86:73 90:77 101:114 120:107 69:82 85:72 104:117 117:104 121:108 122:109 74:87 75:88 88:75 102:115 108:121 112:99 68:81 79:66 82:69 100:113 110:97 111:98 116:103 118:105 70:83 80:67 105:118 107:120 109:122 113:100 98:111 114:101 65:78 67:80 72:85 73:86 77:90 97:110 119:106 71:84 83:70 87:74 99:112 103:116 66:79 78:65 81:68 89:76 106:119 115:102]

/////////////////////////////////////////////////////////////////////////////////
/ we zien dat als we een string cast naar []byte	, we de utf-8 bytes zien	,
/ we zien dat als we een string cast naar []rune, we de unicode zien	,

/ rune = int32
/ byte=uint8	,
/ %#v geeft ook de type	, []int32{960, 97, 949, 98}
/ Hoe []int32{hex ...} TODO
/ %q geeft chars	, %x en %v=%d voor uint8 geven numbers	,

/ 7	. 

[eric@almond Golang]$ pwd
/home/eric/Devel/Golang
[eric@almond Golang]$ tar xvzf ~/Downloads/go1.7.linux-amd64.tar.gz 
[eric@almond Golang]$ cd go/
[eric@almond go]$ less misc/tour/solutions/rot13.go 
...

/ als we een nieuwe shell 	,  dan voor GOROOT	,
$ . ~/.bash_profile

/ 7	 

/ oef	

$ vi main.go

{
  fmt.Println("10ath")
  fmt.Println("[]byte")
  a:=[]byte("a")
  fmt.Printf("%T\n",a)
  fmt.Printf("%#v\n",a)
  fmt.Printf("%q\n",a)
  fmt.Printf("%v\n",a)
  fmt.Printf("%x\n",a)
  fmt.Println("[]rune")
  b:=[]rune("a")
  fmt.Printf("%T\n",b)
  fmt.Printf("%#v\n",b)
  fmt.Printf("%q\n",b)
  fmt.Printf("%x\n",b)
  fmt.Printf("%U\n",b)

  type rot13_Error struct{}

  var rot13 func(byte)byte=func(b byte)byte{
    if 'A'<=b && b<='Z'{
      return  'A'+byte(math.Mod(float64(b-'A'+13),26))
    }else if 'a'<=b && b<='z'{
      return  'a'+byte(math.Mod(float64(b-'a'+13),26))
    }else{
      return b
    }
  }
  var rot13_2 func(byte)byte=func(b byte)byte{
    if 'A'<=b && b<='Z'{
      return  'A'+(b-'A'+13)%26
    }else if 'a'<=b && b<='z'{
      return  'a'+(b-'a'+13)%26
    }else{
     return b
    }
  }
  rot13_2('a')
  var rot13_3 func(byte)byte=func(b byte)byte{
    var a,z byte
    if 'A'<=b && b<='Z'{
      a,z='A','Z'
    }else if 'a'<=b && b<='z'{
      a,z='a','z'
    }else{
      return b
    }
    return  a+(b-a+13)%(z-a+1)
  }
  var r3 byte=rot13_3('A')
  fmt.Printf("%q\n",r3)
  r3=rot13_3('n')
  fmt.Printf("%q\n",r3)

 	//fmt.Printf("%T\n",false)
  var test func(byte)bool=func(b byte)bool{
    if 'A'<=b && b<='Z'{
      return true
    }else{
      return false
    }
  }
  var r2 bool=test('a')
  fmt.Printf("%v\n",r2)

  fmt.Printf("%v, %v\n",'A',rot13('A'))
  fmt.Printf("%v, %v\n",'N',rot13('N'))

  var c2 byte='A'
  var f float64=float64(c2)
  fmt.Println(f)

  var s string="Lbh penpxrq gur pbqr!"
  var r4[]byte
  for i:=0;i<len(s);i++{
    r4=append(r4,rot13(s[i]))
  }
  var r5 string=string(r4)
  fmt.Printf("%s\n",r5);
}

th
[]byte
[]uint8
[]byte{0xcf, 0x80, 0xce, 0xb5, 0x61}
"a"
[207 128 206 181 97]
cf80ceb561
[]rune
[]int32
[]int32{960, 949, 97}
['' '' 'a']
[3c0 3b5 61]
[U+03C0 U+03B5 U+0061]
'N'
'a'
false
65, 78
78, 65
65
You cracked the code!

/ 7	. 

/ De exercise	,

func rot13(b byte)byte{
    var a,z byte
    if 'A'<=b && b<='Z'{
      a,z='A','Z'
    }else if 'a'<=b && b<='z'{
      a,z='a','z'
    }else{
      return b
    }
    return  a+(b-a+13)%(z-a+1)
  }
type rot13Reader struct{
  r io.Reader
}
func(r rot13Reader)Read(p []byte) (n int, err error){
  n,err=r.r.Read(p)
  for i:=0;i<n;i++{
    p[i]=rot13(p[i])
  }
  return
}

func main(){
{
  fmt.Println("10th")
  s:=strings.NewReader("Lbh penpxrq gur pbqr!")
  fmt.Printf("%T\n",s)
  r:=rot13Reader{s}
  io.Copy(os.Stdout,&r)
}
}

10th
*strings.Reader
You cracked the code!
th
[]byte
[]uint8
[]byte{0xcf, 0x80, 0xce, 0xb5, 0x61}
"a"
[207 128 206 181 97]
cf80ceb561
[]rune
[]int32
[]int32{960, 949, 97}
['' '' 'a']
[3c0 3b5 61]
[U+03C0 U+03B5 U+0061]
'N'
'a'
false
65, 78
78, 65
65
You cracked the code!

/ 7	. 

/ De exercise	,

func rot13(b byte)byte{
    var a,z byte
    if 'A'<=b && b<='Z'{
      a,z='A','Z'
    }else if 'a'<=b && b<='z'{
      a,z='a','z'
    }else{
      return b
    }
    return  a+(b-a+13)%(z-a+1)
  }
type rot13Reader struct{
  r io.Reader
}
func(r rot13Reader)Read(p []byte) (n int, err error){
  n,err=r.r.Read(p)
  for i:=0;i<n;i++{
    p[i]=rot13(p[i])
  }
  return
}

func main(){
{
  fmt.Println("10th")
  s:=strings.NewReader("Lbh penpxrq gur pbqr!")
  fmt.Printf("%T\n",s)
  r:=rot13Reader{s}
  io.Copy(os.Stdout,&r)
}
}

10th
*strings.Reader
You cracked the code!
th
[]byte
[]uint8
[]byte{0xcf, 0x80, 0xce, 0xb5, 0x61}
"a"
[207 128 206 181 97]
cf80ceb561
[]rune
[]int32
[]int32{960, 949, 97}
['' '' 'a']
[3c0 3b5 61]
[U+03C0 U+03B5 U+0061]
'N'
'a'
false
65, 78
78, 65
65
You cracked the code!

/ 7	. 

/ De exercise	,

func rot13(b byte)byte{
    var a,z byte
    if 'A'<=b && b<='Z'{
      a,z='A','Z'
    }else if 'a'<=b && b<='z'{
      a,z='a','z'
    }else{
      return b
    }
    return  a+(b-a+13)%(z-a+1)
  }
type rot13Reader struct{
  r io.Reader
}
func(r rot13Reader)Read(p []byte) (n int, err error){
  n,err=r.r.Read(p)
  for i:=0;i<n;i++{
    p[i]=rot13(p[i])
  }
  return
}

func main(){
{
  fmt.Println("10th")
  s:=strings.NewReader("Lbh penpxrq gur pbqr!")
  fmt.Printf("%T\n",s)
  r:=rot13Reader{s}
  io.Copy(os.Stdout,&r)
}
}

10th
*strings.Reader
You cracked the code!
th
[]byte
[]uint8
[]byte{0xcf, 0x80, 0xce, 0xb5, 0x61}
"a"
[207 128 206 181 97]
cf80ceb561
[]rune
[]int32
[]int32{960, 949, 97}
['' '' 'a']
[3c0 3b5 61]
[U+03C0 U+03B5 U+0061]
'N'
'a'
false
65, 78
78, 65
65
You cracked the code!

/ 7	. 

/ De exercise	,

func rot13(b byte)byte{
    var a,z byte
    if 'A'<=b && b<='Z'{
      a,z='A','Z'
    }else if 'a'<=b && b<='z'{
      a,z='a','z'
    }else{
      return b
    }
    return  a+(b-a+13)%(z-a+1)
  }
type rot13Reader struct{
  r io.Reader
}
func(r rot13Reader)Read(p []byte) (n int, err error){
  n,err=r.r.Read(p)
  for i:=0;i<n;i++{
    p[i]=rot13(p[i])
  }
  return
}

func main(){
{
  fmt.Println("10th")
  s:=strings.NewReader("Lbh penpxrq gur pbqr!")
  fmt.Printf("%T\n",s)
  r:=rot13Reader{s}
  io.Copy(os.Stdout,&r)
}
}

10th
*strings.Reader
You cracked the code!
th
[]byte
[]uint8
[]byte{0xcf, 0x80, 0xce, 0xb5, 0x61}
"a"
[207 128 206 181 97]
cf80ceb561
[]rune
[]int32
[]int32{960, 949, 97}
['' '' 'a']
[3c0 3b5 61]
[U+03C0 U+03B5 U+0061]
'N'
'a'
false
65, 78
78, 65
65
You cracked the code!

/ 7	. 

/ De exercise	,

func rot13(b byte)byte{
    var a,z byte
    if 'A'<=b && b<='Z'{
      a,z='A','Z'
    }else if 'a'<=b && b<='z'{
      a,z='a','z'
    }else{
      return b
    }
    return  a+(b-a+13)%(z-a+1)
  }
type rot13Reader struct{
  r io.Reader
}
func(r rot13Reader)Read(p []byte) (n int, err error){
  n,err=r.r.Read(p)
  for i:=0;i<n;i++{
    p[i]=rot13(p[i])
  }
  return
}

func main(){
{
  fmt.Println("10th")
  s:=strings.NewReader("Lbh penpxrq gur pbqr!")
  fmt.Printf("%T\n",s)
  r:=rot13Reader{s}
  io.Copy(os.Stdout,&r)
}
}

10th
*strings.Reader
You cracked the code!
th
[]byte
[]uint8
[]byte{0xcf, 0x80, 0xce, 0xb5, 0x61}
"a"
[207 128 206 181 97]
cf80ceb561
[]rune
[]int32
[]int32{960, 949, 97}
['' '' 'a']
[3c0 3b5 61]
[U+03C0 U+03B5 U+0061]
'N'
'a'
false
65, 78
78, 65
65
You cracked the code!

/ 7	. 

/ De exercise	,

func rot13(b byte)byte{
    var a,z byte
    if 'A'<=b && b<='Z'{
      a,z='A','Z'
    }else if 'a'<=b && b<='z'{
      a,z='a','z'
    }else{
      return b
    }
    return  a+(b-a+13)%(z-a+1)
  }
type rot13Reader struct{
  r io.Reader
}
func(r rot13Reader)Read(p []byte) (n int, err error){
  n,err=r.r.Read(p)
  for i:=0;i<n;i++{
    p[i]=rot13(p[i])
  }
  return
}

func main(){
{
  fmt.Println("10th")
  s:=strings.NewReader("Lbh penpxrq gur pbqr!")
  fmt.Printf("%T\n",s)
  r:=rot13Reader{s}
  io.Copy(os.Stdout,&r)
}
}

10th
*strings.Reader
You cracked the code!
th
[]byte
[]uint8
[]byte{0xcf, 0x80, 0xce, 0xb5, 0x61}
"a"
[207 128 206 181 97]
cf80ceb561
[]rune
[]int32
[]int32{960, 949, 97}
['' '' 'a']
[3c0 3b5 61]
[U+03C0 U+03B5 U+0061]
'N'
'a'
false
65, 78
78, 65
65
You cracked the code!

/ 7	. 

/ De exercise	,

func rot13(b byte)byte{
    var a,z byte
    if 'A'<=b && b<='Z'{
      a,z='A','Z'
    }else if 'a'<=b && b<='z'{
      a,z='a','z'
    }else{
      return b
    }
    return  a+(b-a+13)%(z-a+1)
  }
type rot13Reader struct{
  r io.Reader
}
func(r rot13Reader)Read(p []byte) (n int, err error){
  n,err=r.r.Read(p)
  for i:=0;i<n;i++{
    p[i]=rot13(p[i])
  }
  return
}

func main(){
{
  fmt.Println("10th")
  s:=strings.NewReader("Lbh penpxrq gur pbqr!")
  fmt.Printf("%T\n",s)
  r:=rot13Reader{s}
  io.Copy(os.Stdout,&r)
}
}

10th
*strings.Reader
You cracked the code!
th
[]byte
[]uint8
[]byte{0xcf, 0x80, 0xce, 0xb5, 0x61}
"a"
[207 128 206 181 97]
cf80ceb561
[]rune
[]int32
[]int32{960, 949, 97}
['' '' 'a']
[3c0 3b5 61]
[U+03C0 U+03B5 U+0061]
'N'
'a'
false
65, 78
78, 65
65
You cracked the code!

/ 7	. 

/ De exercise	,

func rot13(b byte)byte{
    var a,z byte
    if 'A'<=b && b<='Z'{
      a,z='A','Z'
    }else if 'a'<=b && b<='z'{
      a,z='a','z'
    }else{
      return b
    }
    return  a+(b-a+13)%(z-a+1)
  }
type rot13Reader struct{
  r io.Reader
}
func(r rot13Reader)Read(p []byte) (n int, err error){
  n,err=r.r.Read(p)
  for i:=0;i<n;i++{
    p[i]=rot13(p[i])
  }
  return
}

func main(){
{
  fmt.Println("10th")
  s:=strings.NewReader("Lbh penpxrq gur pbqr!")
  fmt.Printf("%T\n",s)
  r:=rot13Reader{s}
  io.Copy(os.Stdout,&r)
}
}

10th
*strings.Reader
You cracked the code!
th
[]byte
[]uint8
[]byte{0xcf, 0x80, 0xce, 0xb5, 0x61}
"a"
[207 128 206 181 97]
cf80ceb561
[]rune
[]int32
[]int32{960, 949, 97}
['' '' 'a']
[3c0 3b5 61]
[U+03C0 U+03B5 U+0061]
'N'
'a'
false
65, 78
78, 65
65
You cracked the code!

/ 7	. 

/ De exercise	,

func rot13(b byte)byte{
    var a,z byte
    if 'A'<=b && b<='Z'{
      a,z='A','Z'
    }else if 'a'<=b && b<='z'{
      a,z='a','z'
    }else{
      return b
    }
    return  a+(b-a+13)%(z-a+1)
  }
type rot13Reader struct{
  r io.Reader
}
func(r rot13Reader)Read(p []byte) (n int, err error){
  n,err=r.r.Read(p)
  for i:=0;i<n;i++{
    p[i]=rot13(p[i])
  }
  return
}

func main(){
{
  fmt.Println("10th")
  s:=strings.NewReader("Lbh penpxrq gur pbqr!")
  fmt.Printf("%T\n",s)
  r:=rot13Reader{s}
  io.Copy(os.Stdout,&r)
}
}

10th
*strings.Reader
You cracked the code!
th
[]byte
[]uint8
[]byte{0xcf, 0x80, 0xce, 0xb5, 0x61}
"a"
[207 128 206 181 97]
cf80ceb561
[]rune
[]int32
[]int32{960, 949, 97}
['' '' 'a']
[3c0 3b5 61]
[U+03C0 U+03B5 U+0061]
'N'
'a'
false
65, 78
78, 65
65
You cracked the code!

/ 7	. 

/ De exercise	,

func rot13(b byte)byte{
    var a,z byte
    if 'A'<=b && b<='Z'{
      a,z='A','Z'
    }else if 'a'<=b && b<='z'{
      a,z='a','z'
    }else{
      return b
    }
    return  a+(b-a+13)%(z-a+1)
  }
type rot13Reader struct{
  r io.Reader
}
func(r rot13Reader)Read(p []byte) (n int, err error){
  n,err=r.r.Read(p)
  for i:=0;i<n;i++{
    p[i]=rot13(p[i])
  }
  return
}

func main(){
{
  fmt.Println("10th")
  s:=strings.NewReader("Lbh penpxrq gur pbqr!")
  fmt.Printf("%T\n",s)
  r:=rot13Reader{s}
  fmt.Printf("%T\n",r)
  io.Copy(os.Stdout,&r)
}
}

10th
*strings.Reader
main.rot13Reader
You cracked the code!

/ we kunnen ook	,
  var s*strings.Reader=strings.NewReader("Lbh penpxrq gur pbqr!")
  var r rot13Reader=rot13Reader{s}
/ Let op : NIET 
  var r main.rot13Reader=rot13Reader{s}

/ 7	. 

{
  fmt.Println("11th")
  m:=image.NewRGBA(image.Rect(0,0,100,100))
  fmt.Println(m.Bounds())
  fmt.Println(m.At(0,0).RGBA())
}

11th
(0,0)-(100,100)
0 0 0 0

/ 7	. 

/ Goroutines	,

/ 13	.

func main(){
{
	fmt.Println("1st")
  var say func(string)=func(s string){
    for i:=0;i<5;i++{
      time.Sleep(100*time.Millisecond)
      fmt.Println(s)
    }
  }
  go say("world")
  say("hello")
}
}


hello
world
hello
world
hello
world
hello
world
world
hello

/ Als we 
  say("world")
  say("hello")
/ dan	,

world
world
world
world
world
hello
hello
hello
hello
hello

/ 13	. 

{
  fmt.Println("3rd")
  var ch chan int=make(chan int,2)
  ch<-1
  ch<-2
  ch<-3
  ch<-4
  fmt.Println(<-ch)
  fmt.Println(<-ch)
}
3rd
fatal error: all goroutines are asleep - deadlock!

/ de buffer is vol	, hij is niet geleegd	, 

/ we doen daarom	, 

{
  fmt.Println("3rd")
  var ch chan int=make(chan int,2)
  ch<-1
  ch<-2
  //ch<-3
  fmt.Println(<-ch)
  fmt.Println(<-ch)
}


/ 13	. 

{
  fmt.Println("4th")
  var fibo func(int,chan int)=func(n int, c chan int){
    var x,y int=0,1
    var i int
    for i=0;i<n;i++{
      c<-x
      x,y=y,x+y
    }
    close(c)
  }
  var c chan int=make(chan int)
  go fibo(10,c)
  var i int
  for i=range c{
    fmt.Println(i)
  }
}

4th
0
1
1
2
3
5
8
13
21
34

/ we moeten voor range in de sender close(c)	, want anders 	
4th
0
1
1
2
3
5
8
13
21
34
fatal error: all goroutines are asleep - deadlock!
/ want de recv gaat forever wait	, want er is geen writer meer	, en dat weet de recv niet	,
 

/ 13	 

/ lees	, 
https://golang.org/pkg/math/big/
/ Example Fibonacci

{
  fmt.Println("5th")
    var x,y*big.Int=big.NewInt(0),big.NewInt(1)				
    var lim big.Int
    lim.Exp(big.NewInt(10),big.NewInt(10000),nil)
    for x.Cmp(&lim)<0{
      x.Add(x,y)
      x,y=y,x
    }
    fmt.Println(x)
}   
/ of	,
{
  fmt.Println("5ath")
    var x,y*big.Int=big.NewInt(0),big.NewInt(1)
    var lim*big.Int=big.NewInt(0)
    lim.Exp(big.NewInt(10),big.NewInt(10000),nil)
    for x.Cmp(lim)<0{
      x.Add(x,y)
      x,y=y,x
    }
    fmt.Println(x)
}
/ of	,
{
  fmt.Println("5bth")
    var x,y*big.Int=big.NewInt(0),big.NewInt(1)
    var lim big.Int
    (&lim).Exp(big.NewInt(10),big.NewInt(10000),nil)
    for x.Cmp(&lim)<0{
      x.Add(x,y)
      x,y=y,x
    }
    fmt.Println(x)
}


5th

13399118865171321091147405334169778942335097547195203972963282180892395905425608922308258564917423670634128916896298338468940023556348836730159469922331219041392457718184582505479917720349940850579827792747965048051460984599070008854057577407559770352167835399125721836994646924667419521784130519859791684361515881552209814263053497846304728832864549613874159955354304406861516743057554546853620523934993088616509973529063866526484308715529092382831635743229693722820020965136601372066956900591626414130767860135818527552091659013812258184987623565830938896250435868952820216762743120263151389800843875875121587938314693324008280527493372575886709408268448975131933004279931871759862406759622109044508835860411619039924400061296535075157657774923615354576682435857120131271059618629989387296193094301790856803126767947824482564992786386137353157890007840510284515291026165871395248140086168209790369489642054947961535575918315439728306708834979668556949589337656361305633139679305167520153127406014156945657145996775716588882530991011928337332982566669386417697984037036443342215276218457817738927830034303852999400446426449493789986448278548968070507538789778716050965469366267423578344184361374693047906422598924460711492760827368163631916673041625191485488708729700052827287030025298121605392743671793897797500099683828021088166166144286492847363025214320934631789796590786467463633607629191936101695150218095630245949538978438386289406780945833042012522021815586110472753150907774918791279387923628991197053237814226953664247774955788765115332025984564359742582316806678095156193036979173744796596723056375907871711531365680369729112678729502528905093791631357514801660801516913908673142228767022060860861589731239461672413892278729401779111250451730284368997951429235741520425980937152388861815273240728192796879194241131491977286159737219007450954274623915640206381813964356896174446208969965130185965296783419293203203582614605870555587263482496967538930614225362380577331147959513100195590204857359831958514268467357806919737254919051829537274626389713843756673215199481877846125354961316749847903610698004790473017948271408924944351048957485235593145464711625708849859938560470883283920687087808678385181248845687362620160664684453619639757973660083344596033536104450500696636814712372695354217527337996862577135376018002533482644013064731800592135364520260163136829724743751328207477999746562521254640651412484781297222826637568412498922673306793874084393550110584961733733182231920166234994386081381747119724341179571957392392946284594783685192305266426187807211221096364896666394334077045437182707257362696428909346700379731797641237729017547827992696221879973677077379678657755515135643862934024825075942463057982387696668017760702860562865637580687072956363483966077571381252276639849294216212916562309138125000326946796695229950108270120298754668087988236447444492885213520443733141246719435056927129411123706879428550292289939169250041886315556431260750120178193498590684098676763066005952253074757888826797344132751669723671524114314198529073144207566959808885901066957403652010059607682308803241922842250553925867828311346870411707347167814007514766619816986848839724591423133127676469647685444638815034107742905690560759417826577789122157168929733767653584170327323172107138803703906827996456426831274099052277049758787614893966610218503704566306361249052310690593318473313783802873096234702205159199450988562567859911825391422856255052568451177609442029459375103558694887725529065067987907247762883802035981286860209194278424241189845794834866386480975416672864365811443526487476291128565982619937925730400049266874357760815242294861250527768479659260674840320387171199554230674942491794199819660288618168892144858421781707913412357044261435799750211183247986454169239373831452607936909693621625341821282714729541092220867203371366960776429333478880497577703673017266139237348453860412803447772966222616421556055413177805290539411075945749697490247821564432776097530300617091376766309991559178498078370495377712004811545274654452973728681448602570850165959790029472105170225566026735751393276958695201079752745037312750988040221175468875048706895109513719392183837793703426341227750913886109990074619955581432696079996086490552925017461788095258981921323564517339422188603940505439358012958668576350354671967148448541987055623537097417544151238986762672185835350273217687801252966278431863470534407310437996715258120061282549075139834460106924067617773653534403375206252168722092979623763165654169838728930960464464503367406215319313734356197785551900895858043837440171764063710136015943820487730485804150418119223247061074450118541500682723247593449427612602935635570265456525324452113559532595730315637428451871476616415003975595207873381878227245593345685900368930775931559392580157953086867884653987749898273439298404880838702934055523702586936817493813865392936618279997279400589588525848878518716379093455813065838268508369921643972634458247918078043303067812522095118392162878730550087619895733786310793556481657876905654019028747540848421476058207560409214453882970761100539107192384055142628161007893344616945790599041887237505078010778051988570691823079950693375370896295378162213074038826443035701672461159089397344720132036265070653379996761101911017833034095501642847356527101997244024493296458750076926211018246257136336045180524496449399362244339634745519048510664542267677213629824321416921096043359934139326581000159360402231815222734794083264127606844244714838525587908551947009160379947856916606362572314564931028876718757425145672054449772920604435626047444689300088114568746074974663949076880889678514014005145885492772380657515779919106605616737187719144993637979543255751662808231884648178598014087181074376609201752860740202492355387729293750586736816151092299175065180292092615880286290340519003759266757455665308793826238181588048386254853444588583798259053271019332802693132648234161009761627063034724252604143095276079415407151025969731759325503137888497698911059719098107563781274160814828961388396025375350816000694039252667611769247189450794795461764075671944722662386739871247712656936433737753532805214827766651564454422237888366167685016624214870389053116474762289561338527740963904498035646222002913365651805986646296982474811692570162192000430286858841486934075313210083910395212802078365462090418320493317656026169781499936304337468658791458176118740702795501050772522929952159782301879384291583521072287688253157801389333924232197740862164204676008811097881973302415001659591945267340965823502986997220358103311565213557226299277426321375719413377847630535868602455496468838170042229200120913791680891790001807414362505712076382194668362825265980034195809460815982119423735161093662249847100666842125880053419772915397895353053030977462246113390199122560858831949814310241861164330154816285077609994784803458680396504886287503680703877000360942792902156086636045627437050260573136794411676868710285619942780407899699663520243087646786699033477568528818995294857566389800093080084145490338075269177274780672883857414534406893426314587969984347464998791769335808356932530684142298239336129398158102803983149605933492627239501992363263277043615135718383074943008900212155809660776447971474584315859228152857919007375702637486207760442939909731726098482904458684731556174648561929551465077112356129400395016527795545732870256738427417864248068171912193537831139008701137472899315503175543220175981711954172241610982540784461275299660159548328997646848807825211750639729575802847511871073789163902866686658290082024102401962567210368284606133031876529264245953213575085298100820598801423986374848288545012488675560085515916968244815855431754559316028223014202790396600409287283772325424176839775860281273761793988606730505765379333542952645415360440761644549733556886316017791394856770984217303506094391952818407513550557346321949975513891041599821492769799942254155354972637937119528605227048145245965192384813323128164097096549323850835138142350494371704289380719507350003556485027141625751705480259061496272396635369306504277406691349465003332512502007577341207876885083301259170106055477107913011149932517449078667339664694701045904195494671394589391311731043312362375388774411918414363074469080394741627492109120066246003699611189922776049449131921967459258004717531130667222606488763387298284830539697871736487434710692672920819027060866189720673223411553661878666877064595432238404308603980875055546270099356991959529178712023430966375924370656348445918512391942856341630712816932033653163940792552857448345785153576369309307959638889576459941741483824597655746812152766389477393181338376308230847439519450407555852046594896083517545033697284759362197059539504761482936209327156129729599943069385068886455370590328605439683572674103927313537484786757496024845275486860576055269260576145887645217211858201476728630777816729769671672655155929234358718872399706857705483885174693935813558725329618197230046113098299589826926258081699166476952859722763385606468415017112051230225469810985044878595214996613426068744315826356331959590485796970876328155473147607975330907600198112134281656808024957427192618111434952142104240550273188093686911374415399406223208235499820194818326897593911009649793726001279747913532704841941685401161076405746580849030113134279063795498822525476245807135228924003167652222249754406474627676416038212879515606291055705630129263073862970566562719950078344294469696290273872310367648454830478971446937197939976111701006977210926690739981416737629524089894072659572227928277648932656813241639366970012312116925875870451029068319075394233314853493494000780065801619468840963261393916621903026583085643800457421650869603992768181206328932235377364289461070013878997051632603963543983886542169971314956459637630435527694055708526593454603912852745535333631085552567580231888147199531876607596569607425508538755308544567733489157247385864175089763666434171535267024577958019458979341541730508683736485847296013280516761949


/ 13	. 

{
  fmt.Println("6th")
  var fibo func(int,chan*big.Int)=func(n int, c chan*big.Int){
    var x,y*big.Int=big.NewInt(0),big.NewInt(1)
    var i int
    for i=0;i<n;i++{
      c<-x
      x,y=y,x.Add(x,y)
      fmt.Println(x)
    }
    close(c)
  }
  var c chan*big.Int=make(chan*big.Int,100)
  go fibo(cap(c),c)
  var i*big.Int 
  for i=range c{
    fmt.Println(*i)  // TODO
  }
  var lim big.Int
  (&lim).Exp(big.NewInt(10),big.NewInt(100),nil)
}

/ Lees	,
https://blog.golang.org/pipelines
http://dave.cheney.net/tag/golang-3

/ 13	. 

{
  fmt.Println("6bth")
  var c chan int=make(chan int,2)
  var x,y int=0,1
  c<-x
  c<-y
  var i int
  for i=range c{
    fmt.Println(i)  
  } 

//  var a,b int
//  a,b=<-c,<-c
//  fmt.Println(a,b)
}

6bth
0
1
fatal error: all goroutines are asleep - deadlock!

/ we moeten close(c) 	, 


  fmt.Println("6bth")
  var c chan int=make(chan int,2)
  var x,y int=0,1
  c<-x
  c<-y
  close(c)
  var i int
  for i=range c{
    fmt.Println(i)
  }
//  var a,b int
//  a,b=<-c,<-c
//  fmt.Println(a,b)
}

6bth
0
1


/ 1313	. 

{
  fmt.Println("6ath")
  var c chan*big.Int=make(chan* big.Int,2)
  var x,y*big.Int=big.NewInt(0),big.NewInt(1)
  c<-x
  c<-y
  close(c)
  var i*big.Int 
  for i=range c{
    fmt.Println(i)
  }
}

6ath
0
1






/ 13	. 

/ Lees	,
http://dave.cheney.net/tag/golang-3

// 1313	. 

/ we moeten een channel close	,

/ Als we het NIET doen	,

{
  fmt.Println("6cth")
  var c chan int=make(chan int,2)
  var x,y int=0,1
  c<-x
  c<-y
  var i int
  for i=0;i<cap(c)+1;i++{
    v,ok:=<-c
    fmt.Println(v,ok)
  }
}

6cth
0 true
1 true
fatal error: all goroutines are asleep - deadlock!

/ als we het WEL doen	,

{
  fmt.Println("6cth")
  var c chan int=make(chan int,2)
  var x,y int=0,1
  c<-x
  c<-y
  close(c)
  var i int
  for i=0;i<cap(c)+1;i++{
    v,ok:=<-c
    fmt.Println(v,ok)
  }
}

6cth
0 true
1 true
0 false		/ op dit moment is de channel closed	,

/ 1313	. 

/ range	, uses closed zijn van channel op een gegeven positie	,

{
  fmt.Println("6cth")
  var d chan int=make(chan int,2)
  var a,b int=0,1
  d<-a
  d<-b
  close(d)
  for v:=range d{
    fmt.Println(v)
  }

}

6cth
0
1

/ 13	. 

/ 1313	. 

/ zonder range	, 

{
  fmt.Println("6dth")
  var c chan*big.Int=make(chan*big.Int,2)
  c<-big.NewInt(0)
  c<-big.NewInt(1)
  close(c)
  var i int
  for i=0;i<cap(c)+1;i++{
    v,ok:=<-c
    fmt.Printf("%T, %T, %v, %v, %p, %d\n",v,ok,v,ok,v,v)
  }
6dth
*big.Int, bool, 0, true, 0xc82000eba0, 0
*big.Int, bool, 1, true, 0xc82000ebc0, 1
*big.Int, bool, <nil>, false, 0x0, <nil>

/ dus %v == %d	WH	, 

/ 1313	. 

/ met range	,

{
  fmt.Println("6dth")
  var c chan*big.Int=make(chan*big.Int,2)
  c<-big.NewInt(0)
  c<-big.NewInt(1)
  close(c)
  for v:=range c{
    fmt.Printf("%T, %v, %p, %d\n",v,v,v,v)
  }
 
}

6dth
*big.Int, 0, 0xc8200be8e0, 0
*big.Int, 1, 0xc8200be900, 1

/ 13	. 

/ *big.Int %v -> de big.Int zelf	, 
/ *int %v -> de pointer	, we moeten deref	, 

/ 4ath: *int	, for i
/ 6th	, *big.Int	, for i
/ 6zth	, *big.Int, groeiende slice	, 

{
  fmt.Println("4ath")
  var fibo func(int,chan*int)=func(n int, c chan*int){
    var a[]int=make([]int,n)
    a[0],a[1]=0,1
    c<-&a[0]
    c<-&a[1]
    var i int
    for i=2;i<n;i++{
      a[i]=a[i-1]+a[i-2]
      c<-&a[i]
    }
    close(c)
  }
  var c chan*int=make(chan*int,8)
  go fibo(cap(c),c)
  var i*int
  for i=range c{
    fmt.Printf("%T,%p,%v,%v\n",i,i,i,*i)
  }
}

4ath
*int,0xc8200a81c0,0xc8200a81c0,0
*int,0xc8200a81c8,0xc8200a81c8,1
*int,0xc8200a81d0,0xc8200a81d0,1
*int,0xc8200a81d8,0xc8200a81d8,2
*int,0xc8200a81e0,0xc8200a81e0,3
*int,0xc8200a81e8,0xc8200a81e8,5
*int,0xc8200a81f0,0xc8200a81f0,8
*int,0xc8200a81f8,0xc8200a81f8,13

{
  fmt.Println("6th")
  var fibo func(int,chan*big.Int)=func(n int, c chan*big.Int){
    var a[]*big.Int=make([]*big.Int,n)
    a[0],a[1]=big.NewInt(0),big.NewInt(1)
    c<-a[0]
    c<-a[1]
    var i int
    for i=2;i<n;i++{
      a[i]=big.NewInt(0)
      a[i].Add(a[i-1],a[i-2])
      c<-a[i]
    }
    close(c)
  }
  var c chan*big.Int=make(chan*big.Int,8)
  go fibo(cap(c),c)
  var i*big.Int
  for i=range c{
    fmt.Printf("%T, %p, %v\n",i,i,i)
  }
  //var lim big.Int
  //(&lim).Exp(big.NewInt(10),big.NewInt(100),nil)
}

6th
*big.Int, 0xc8200be020, 0
*big.Int, 0xc8200be040, 1
*big.Int, 0xc8200be060, 1
*big.Int, 0xc8200be080, 2
*big.Int, 0xc8200be0a0, 3
*big.Int, 0xc8200be0c0, 5
*big.Int, 0xc8200be0e0, 8
*big.Int, 0xc8200be100, 13

{
  fmt.Println("6zth")
  var fibo func(chan*big.Int)=func(c chan*big.Int){
    var a[]*big.Int
    a=append(a,big.NewInt(0))
    a=append(a,big.NewInt(1))
    c<-a[0]
    c<-a[1]
    var lim*big.Int=big.NewInt(0)
    lim.Exp(big.NewInt(10),big.NewInt(3),nil)
    var i int
    for i=2;;i++{
      var b*big.Int=big.NewInt(0)
      b.Add(a[i-1],a[i-2])
      a=append(a,b)
      if a[i].Cmp(lim)<0{
        c<-a[i]
      }else{
        break
      }
    }
    close(c)
  }
  var c chan*big.Int=make(chan*big.Int)
  go fibo(c)

  var i*big.Int
  for i=range c{
    fmt.Printf("%T, %p, %v\n",i,i,i)
  }
}

6zth
*big.Int, 0xc820074160, 0
*big.Int, 0xc820074180, 1
*big.Int, 0xc820074200, 1
*big.Int, 0xc820074240, 2
*big.Int, 0xc820074260, 3
*big.Int, 0xc820074280, 5
*big.Int, 0xc8200742a0, 8
*big.Int, 0xc8200742c0, 13
*big.Int, 0xc8200742e0, 21
*big.Int, 0xc820074300, 34
*big.Int, 0xc820074320, 55
*big.Int, 0xc820074340, 89
*big.Int, 0xc820074360, 144
*big.Int, 0xc820074380, 233
*big.Int, 0xc8200743a0, 377
*big.Int, 0xc8200743c0, 610
*big.Int, 0xc8200743e0, 987















































/ 7	. 

/ Lees	,
https://golang.org/doc/install

$ vi ~/.bash_profile
...
GOPATH=/home/eric/Devel/Golang/work
GOBIN=/home/eric/Devel/Golang/work/bin
export GOPATH GOBIN
PATH=$PATH:$GOBIN

[eric@almond src]$ vi my/my_hello/hello.go 
package main
import "fmt"
func main(){
    fmt.Printf("Hello, world\n")
}
[eric@almond src]$ go install my/my_hello
[eric@almond src]$ my_hello 
Hello, world

/ hello.go mag ook main.go heten	,

/ we moeten in src/ staat met 'go install'	, want	als we ergens anders gaan staan	,
eric@almond my]$ go install my_hello
can't load package: package my_hello: cannot find package "my_hello" in any of:
	/usr/lib/golang/src/my_hello (from $GOROOT)
	/home/eric/Devel/Golang/work/src/my_hello (from $GOPATH)

/ Dus hij kijkt in $GOPATH=/home/eric/Devel/Golang/work	, daarbinnen zijn src/ en bin/	en hij gaat opzoek naar my_hello/ in  $GOPATH/src	,

/ Dus de exec is named na de dir/	,

[eric@almond src]$ cd my/my_hello
[eric@almond my_hello]$ ls
hello.go
[eric@almond my_hello]$ git init
Initialized empty Git repository in /home/eric/Devel/Golang/work/src/my_hello/.git/
[eric@almond my_hello]$ git add hello.go 
[eric@almond my_hello]$ git commit -m "first commit"

/ 13	. 

/ Lees	,
https://golang.org/cmd/compile/

[eric@almond src]$ go tool compile -S my/my_hello/main.go 
/ we zien asm	,

/ Lees	,
https://golang.org/cmd/go/
...
/ GOBIN is waar go install de bin in set	,

/ 7. 
	
/ Lees	,
https://golang.org/doc/
/ Op deze pagina staan veel refs	,
/ bijv naar	,
A Tour of Go
How to write Go code
https://golang.org/doc/effective_go.html
https://golang.org/doc/cmd
/ die refs naar	,
https://golang.org/cmd/go/




/ 7	. 

/ Lees,	How to Write Go Code
https://golang.org/doc/code.html

[eric@almond src]$ mkdir my/my_stringutil
[eric@almond src]$ vi my/my_stringutil/reverse.go

package my_stringutil

func Reverse(s string)string{
	r:=[]rune(s)
	for i,j:=0,len(r)-1;i<len(r)/2;i,j=i+1,j-1{
		r[i],r[j]=r[j],r[i]
	}
	return string(r)
}

[eric@almond src]$ go build my/my_stringutil
/ Dit moet je in de src/ doen	, 

/ als we 1 hoger gaan	,
[eric@almond work]$ go build src/my/stringutil
/ ERR

[eric@almond src]$ ls ../pkg/linux_amd64/my/
my_stringutil.a
[eric@almond src]$ ar -t ../pkg/linux_amd64/my/my_stringutil.a 
__.PKGDEF
_go_.o

/ wat doet go build	? 
/ TODO
/ WH is go build voor pkg	,
/ TODO

[eric@almond src]$ vi my/my_hello2/hello.go 
package main
import (
    "fmt"
    "my/stringutil"
)
func main(){
    fmt.Printf(my_stringutil.Reverse("!oG,olleH"))
}

[eric@almond src]$ go install my/my_hello2/

[eric@almond src]$ ../bin/my_hello2
Hello,Go![eric@almond src]$ 

/ 7. 	

/ testing	,

[eric@almond src]$ pwd
/home/eric/Devel/Golang/work/src

[eric@almond src]$ vi my/my_stringutil/reverse.go

package my_stringutil

func Reverse(s string)string{
    r:=[]rune(s)
    for i,j:=0,len(r)-1;i<len(r)/2;i,j=i+1,j-1{
        r[i],r[j]=r[j],r[i]
    }
    return string(r)
}

[eric@almond src]$ vi my/my_stringutil/reverse_test.go 

package my_stringutil
import "testing"

func TestReverse(t*testing.T){
    cases:=[]struct{
        in,want string
    }{
        {"Hello, world","dlrow ,olleH"},
        {"Hello, "," ,olleH"},
        {"",""},
    }
    for _,c:=range cases{
        got:=Reverse(c.in)
        if got!=c.want{
            t.Errorf("Reverse(%q)==%q, want %q",c.in,got,c.want)
        }
    }
}

[eric@almond src]$ go build my/my_stringutil
/ voor de zekerheid	,
[eric@almond src]$ go test my/my_stringutil
ok  	my/my_stringutil	0.001s

/ Hoe maken we die 2 runes?
/ In insert mode in vi	, ^c,u03c0 geeft 	,

/ 7	.

[eric@almond src]$ go get github.com/golang/example/hello
eric@almond src]$ ls github.com/golang/example
appengine-hello  gotypes  hello  LICENSE  outyet  README.md  stringutil

/ we hebben meteen heel github.com/golang/example
[eric@almond src]$ go get github.com/golang/example
/ ERR
/ TODO 

[eric@almond src]$ ls -1tr ../bin | tail -1
hello
/ we hebben ook meteen 
[eric@almond src]$ ../bin/hello 
Hello, Go examples!

/ 13	. 

/ we gaan naar	,
https://github.com/golang/example

/ Daar zien we ' Google App Engine SDK for Go.'	,
/ we download	,
[eric@almond src]$ ls -ltr ~/Downloads/ | tail -1
-rw-r-----. 1 eric eric    35884172 Dec 31 21:53 go_appengine_sdk_linux_amd64-1.9.30.zip

[eric@almond Google]$ pwd
/home/eric/Devel/Cloud/Google
[eric@almond Google]$ unzip  ~/Downloads/go_appengine_sdk_linux_amd64-1.9.30.zip 
[eric@almond Google]$ vi ~/.bash_profile 
...
PATH=$PATH:$HOME/Devel/Cloud/Google/go_appengine

[eric@almond src]$  /home/eric/Devel/Cloud/Google/go_appengine/goapp get github.com/golang/example/appengine-hello/

/ Nodig? , omdat we met  heel examples/ al	,
[eric@almond src]$ go get github.com/golang/example/hello
/ TODO

/ we lezen in de README.md	,

[eric@almond src]$  /home/eric/Devel/Cloud/Google/go_appengine/goapp serve github.com/golang/example/appengine-hello/app.yaml 
INFO     2015-12-31 21:10:03,106 devappserver2.py:769] Skipping SDK update check.
WARNING  2015-12-31 21:10:03,268 simple_search_stub.py:1126] Could not read search indexes from /tmp/appengine.you-application-id.eric/search_indexes
INFO     2015-12-31 21:10:03,270 api_server.py:205] Starting API server at: http://localhost:32855
INFO     2015-12-31 21:10:03,798 dispatcher.py:197] Starting module "default" running at: http://localhost:8080
INFO     2015-12-31 21:10:03,798 admin_server.py:116] Starting admin server at: http://localhost:8000

/ we geven localhost:8080	, 
/ OK
/ we geven localhost:8000	, 
/ OK
/ we geven localhost:32855, 
/ OK




/ Einde GOLANG

/ GOLANG CONCURRENCY

/ 13. 

/ Geef in google
go 
/ Kijk	,
https://www.youtube.com/watch?v=f6kdp27TYZs

/ when main writes to a chan, the channel block until someone , a goroutine , is ready to receive it	,
/ whatever the 2 goroutines are doing, finally the reach the point	, where the send and receive are happening, we know it is like a lockstep position	,
/ it is a synchronization operation, next to send/receive	,

/ When the main fct executes <-c (read), it will wait for a value to be send	, 
/ when the boring fct executes value<-c, it waits for a receiver to be ready	,
/ a sender and receiver must both be ready to play their part in the communication. Otherwise we wait until they are. 
/ thus channels both communicate and synchronize	 in a single operation	,

 /er zijn ook buffered channels	, WH make(chan int,7)	, 
/ buffering removes synchronization	,


/ Verderop gaan we verder met boring fct en main, in src/video/main.go

/ 13	. 

/ Geef in google	,
fatal error: all goroutines are asleep - deadlock!
/ Lees	,
http://stackoverflow.com/questions/12391371/all-goroutines-are-asleep-deadlock-exit-status-2-error-in-a-printer-receive

/ 1313	. 

{
    var c chan int=make(chan int)
		c<-0
}
fatal error: all goroutines are asleep - deadlock!
/ Want er is geen receiver	,  the main routine wachts totdat er een receiver is, maar die is er niet: deadlock	, dat wordt herkend	, 
/ hijzelf kan die receiver niet zijn	, dus 

    var c chan int=make(chan int)
		c<-0
		var i int=<-c
/ ERR	, deadlock	,

/ 2 oplossingen	,

/ we maken een receiver	, in een andere goroutine	,
/ je kunt best een time.Sleep in de receiver maken	, dat maakt niet uit: er is een receiver, en main waits , geen deadlock	,
/ we moeten de receiver VOOR c<-0 maken	,
{
    var c chan int=make(chan int)
    var i int
    go func(){ i=<-c }() 
    c<-0 
    fmt.Printf("%v\n",i)
}
0

{
    var c chan int=make(chan int)
    var i int
    c<-0 
    go func(){ i=<-c }() 
    fmt.Printf("%v\n",i)
}
/ deadlock	, main writes	, maar weet niet dat er een receiver is	, dus waits forever	, 



/ we write in een andere go routine	,
/ main weet dat er een writer is	,
{
    var c chan int=make(chan int)
    go func(){c<-0}()
    var i=<-c
    fmt.Printf("%v\n",i)
}
0

{
    var c chan int=make(chan int)
    var i=<-c
    go func(){c<-0}()
    fmt.Printf("%v\n",i)
}
/ deadlock	, want main reads	, maar weet niet dat er een writer is	, 

{
    var c chan int=make(chan int,1)
    c<-0
    //go func(){c<-0}()
    var i=<-c
    fmt.Printf("%v\n",i)
}
0
/ Buffered channel	, removes synchronization	, 


/ 13	. 

/ Door vorige vb weten we dat printer een goroutine moet zijn	,

/ 1313

$ vi src/tmp/main.go

package main

import (
    "fmt"
    "time"
)

func printer(c chan int) {
    for i := 0; i < 3; i++ {
        c <- i
        time.Sleep(time.Second)
    }
}

func receiver(c chan int) {
    for {
        receivedMsg := <-c
        fmt.Println(receivedMsg)
    }
}

func main() {
{
    fmt.Println("1st")
    newChanel := make(chan int)
    go printer(newChanel)
    receiver(newChanel)
}
}

/ Nu zien we ook	, 
1st
0
1
2
fatal error: all goroutines are asleep - deadlock!
/ TODO

/ 1313	.

/ Daarom doen we close(c) in printer	,

func printer(c chan int) {
    for i := 0; i < 3; i++ {
        c <- i
        time.Sleep(time.Second)
    }
    close(c)
}

/ Dan zien we 	, oneindig vaak de default value 0	,

1st
0
1
2
0
...

/ 1313	. 

/ Daarom moeten we range doen in receiver	,

func receiver(c chan int) {
    for receivedMsg := range c{
        fmt.Println(receivedMsg)
    }
}
/ we zien 	,
1st
0
1
2

/ 13	 

$ vi src/video/main.go

package main

import (
    "fmt"
    "time"
    "math/rand"
)
func main(){
{
  fmt.Printf("main_recv\n")
  c:=make(chan string)
  go boring_send("boring!",c)
/*
  for i:=0;i<5;i++{ 
    fmt.Printf("You say: %q\n",<-c)
  }
*/
  fmt.Printf("You are boring, I am leaving\n")
}
}
func boring_send(msg string,c chan string ){
  for i:=0;;i++{
    c<-fmt.Sprintf("%s %d",msg,i)
    time.Sleep(time.Duration(rand.Intn(1e3))*time.Millisecond)
  }
}


[eric@almond work2]$ video
main_recv
You are boring, I am leaving
[eric@almond work2]$ 
/ Als we geen recv zijn	, stopt program	,

/ Als we	, 

package main

import (
    "fmt"
    "time"
    "math/rand"
)
func main(){
{
  fmt.Printf("main_recv\n")
  c:=make(chan string)
  go boring_send("boring!",c)
  for i:=0;i<5;i++{ 
    fmt.Printf("You say: %q\n",<-c)
  }
  fmt.Printf("You are boring, I am leaving\n")
}
func boring_send(msg string,c chan string ){
  for i:=0;;i++{
    c<-fmt.Sprintf("%s %d",msg,i)
    time.Sleep(time.Duration(rand.Intn(1e3))*time.Millisecond)
  }
}

[eric@almond work2]$ video
main_recv
You say: "boring! 0"
You say: "boring! 1"
You say: "boring! 2"
You say: "boring! 3"
You say: "boring! 4"
You are boring, I am leaving
[eric@almond work2]$ 

/ Als i=5, is er geen recv meer	, dus stopt het prgr	, 

/ als we omdraaien	,

package main

import (
    "fmt"
    "time"
    "math/rand"
)
func main(){
{
  fmt.Printf("main_recv\n")
  c:=make(chan string)
  for i:=0;i<5;i++{ 
    fmt.Printf("You say: %q\n",<-c)							<- deadlock	, 
  }
  go boring_send("boring!",c)
  fmt.Printf("You are boring, I am leaving\n")
}
func boring_send(msg string,c chan string ){
  for i:=0;;i++{
    c<-fmt.Sprintf("%s %d",msg,i)
    time.Sleep(time.Duration(rand.Intn(1e3))*time.Millisecond)
  }
}
[eric@almond work2]$ video
main_recvfatal error: all goroutines are asleep - deadlock!
 

/ 13	. 

/ OVERZICHT 

$ vi src/video2/main.go


/ Als main exits, stops program	,


/ Als er genoeg listeners zijn	, dan missen die toch de laatste send	, want main is al exit	, 
func main(){
{
  fmt.Printf("main\n")
  c:=make(chan string)
  go my(c)
  for i:=0;i<8;i++{
    c<-fmt.Sprintf("foo%d",i)
  }
  //time.Sleep(time.Second)
  fmt.Printf("fin\n")
}
}
func my(c chan string){
  //time.Sleep(time.Second)
  var x string
  for i:=0;;i++{
    x=<-c
    fmt.Printf("%s\n",x)
  }
}
[eric@almond work2]$ video2
main
foo0
foo1
foo2
foo3
foo4
foo5
foo6
fin

/ Als er te weinig listeners zijn	, dan ERR	, 

func my(c chan string){
  //time.Sleep(time.Second)
  var x string
  for i:=0;i<4;i++{
    x=<-c
    fmt.Printf("%s\n",x)
  }
}

[eric@almond work2]$ video2
main
foo0
foo1
foo2
foo3
fatal error: all goroutines are asleep - deadlock!



/ 13. 

/ Als we te weinig recv's zijn in main	, OK	, als main klaar is met recv's , stopt het prgr	, 
func main(){
{
  fmt.Printf("main\n")
  c:=make(chan string)
  go my2(c)
  var x string
  for i:=0;i<8;i++{
    x=<-c
    fmt.Printf("%s\n",x)
  }
  //time.Sleep(time.Second)
  fmt.Printf("fin\n")
}
}
func my2(c chan string){
  for i:=0;i<16;i++{
    c<-fmt.Sprintf("foo%d",i)
  }
}
/ we zien	, 
[eric@almond work2]$ video2
main
foo0
foo1
foo2
foo3
foo4
foo5
foo6
foo7
fin

/ Als er teveel recv in main	, dan ERR	,
/ want main listens	, maar er komt NIETS MEER	, 

func main(){
{
  fmt.Printf("main\n")
  c:=make(chan string)
  go my2(c)
  var x string
  for i:=0;i<16;i++{
    x=<-c
    fmt.Printf("%s\n",x)
  }
  //time.Sleep(time.Second)
  fmt.Printf("fin\n")
}
}
func my2(c chan string){
  for i:=0;i<8;i++{
    c<-fmt.Sprintf("foo%d",i)
  }
}

[eric@almond work2]$ video2
main
foo0
foo1
foo2
foo3
foo4
foo5
foo6
foo7
fatal error: all goroutines are asleep - deadlock!

/ 7	 

/ SAMENVATTING

main									go routine
#sends			>						#recvs					ERR
#recvs			>						#sends					ERR

/ ERR
/=
	fatal error: all goroutines are asleep - deadlock!

/ Of het nou sends is of recvs	, als main meer doet dan de go routine is het ERR

/ Als main minder doet, stopt het prog, want als main stops, stops de prog	, 

/ Einde SAMENVATTING

/ SAMENVATTING

/ we moeten in main altijd minder of gelijk doen als in de go routine,	

[eric@almond work2]$ pwd
/home/eric/Devel/Golang/work2
$ vi src/video2/main.go

package main

import (
    "fmt"
    "time"
)
func main(){
{
  fmt.Printf("main\n")
  c:=make(chan string)
  go my(c)
  for i:=0;i<8;i++{
    c<-fmt.Sprintf("foo%d",i)
  }
  //time.Sleep(time.Second)
  fmt.Printf("fin\n")
}
func my(c chan string){
  //time.Sleep(time.Second)
  var x string
  for i:=0;i<16;i++{
    x=<-c
    fmt.Printf("%s\n",x)
  }
}

[eric@almond work2]$ video2
main
foo0
foo1
foo2
foo3
foo4
foo5
foo6
fin
/ als main stopt	, stopt prg	, 
/ we zien foo7 niet, want main is al gestopt	, 
/ we kunnen in main of in my een time.Sleep doen	, dan zien we foo7	,



$ vi src/video2/main.go

package main

import (
    "fmt"
    "time"
)
func main(){

{
  fmt.Printf("main\n")
  c:=make(chan string)
  go my2(c)
  var x string
  for i:=0;i<8;i++{
    x=<-c
    fmt.Printf("%s\n",x)
  }
  //time.Sleep(time.Second)
  fmt.Printf("fin\n")
}


func my2(c chan string){
  for i:=0;i<16;i++{
    c<-fmt.Sprintf("foo%d",i)
  }
}

[eric@almond work2]$ go install video2
[eric@almond work2]$ video2
main
foo0
foo1
foo2
foo3
foo4
foo5
foo6
foo7
fin

/ nu wel ook foo7	, 

/ Einde SAMENVATTING

/ SAMENVATTING

[eric@almond work2]$ cat ~/.bash_profile 
export GOPATH=/home/eric/Devel/Golang/work2
[eric@almond work2]$ . ~/.bash_profile 

[eric@almond work2]$ pwd
/home/eric/Devel/Golang/work2
[eric@almond work2]$ ls src/video2
main.go
[eric@almond work2]$ go install video2
[eric@almond work2]$ video2
...

/ als we	, 
[eric@almond work2]$ cat ~/.bash_profile 
export GOPATH=/home/eric/Devel/Golang/work
[eric@almond work2]$ . ~/.bash_profile 
[eric@almond work2]$ go install video2
can't load package: package video2: cannot find package "video2" in any of:
	/usr/lib/golang/src/video2 (from $GOROOT)
	/home/eric/Devel/Golang/work/src/video2 (from $GOPATH)


/ Einde SAMENVATTING

 
/ 7	. 

/ channels: communication & synchronization	, 

/ de data gaat door de channel heen en weer, naar de procs aan weerszijden	,  
/ ipv een stuk mem. beschermd met locks en mutexes	, 

/ 13	. 

/ call the go routine in boring func itself	, iso in main	, 

func main(){
  var c <-chan string=boring("boring!")
  var i int
  for i=0;i<5;i++{
    fmt.Printf("You say: %q\n",<-c)
  }
  fmt.Printf("You are boring, I am leaving\n")
}
func boring(msg string) <-chan string{
  var c chan string=make(chan string)
  go func(){
    var i int
    for i=0;;i++{
      c<-fmt.Sprintf("%s %d",msg,i)
  		fmt.Printf("Written in c\n")
      time.Sleep(time.Duration(rand.Intn(1000))*time.Millisecond)
    }
  }()
  return c
}

[eric@almond work2]$ video3
You say: "boring! 0"
You say: "boring! 1"
You say: "boring! 2"
You say: "boring! 3"
You say: "boring! 4"
You are boring, I am leaving

 /WH gaat het zo	, 

    fmt.Printf("You say: %q\n",<-c) 			/ in main
      c<-fmt.Sprintf("%s %d",msg,i)				/ in go rtn	,

/ Beide (WH een van beide) wachten totdat ze samen komen	, dan de msg van go rtn naar main	,
/ dit gebeurt een aantal keer	, 
/ als main niets meer heeft	, stopt het prg	,

 /Het is dus niet zo, dat in de go routine er oneindig veel loops onstaan	, 
/ Het is zo dat 
      c<-fmt.Sprintf("%s %d",msg,i)				/ in go rtn	,
/ wacht todat de andere kant, main, 
    fmt.Printf("You say: %q\n",<-c) 			/ in main
/ en weer zo de volgende	, 

/ 13	. 

$ vi src/video3/main.go

/ func boring is like a service	,

{
  var joe <-chan string =boring("Joe!")
  var ann<-chan string =boring("Ann!")
  var i int
  for i=0;i<5;i++{
    fmt.Println(<-joe)
    fmt.Println(<-ann)
  }
  fmt.Printf("You both are boring, I am leaving\n")
}

Joe! 0
Ann! 0
Joe! 1
Ann! 1
Joe! 2
Ann! 2
Joe! 3
Ann! 3
Joe! 4
Ann! 4
You both are boring, I am leaving

/ 13	. 

    fmt.Println(<-joe)
    fmt.Println(<-ann)
/ Ann moet wachten op joe	, willen we niet	,

/ Intermezzo 

/ 7	.  

type Duration int64

  var s time.Duration=time.Second
  fmt.Printf("%d\n",s)
1000000000
/ 1 sec = 1 miljard nanosec	, 

  var s time.Duration=time.Second
  var ms time.Duration=time.Millisecond
  var t time.Duration=time.Duration(10)

  fmt.Printf("%T %d\n",s/ms,s/ms)
  fmt.Printf("%T %d\n",s*t,s*t)
time.Duration 1000
time.Duration 10000000000

/ 7	. 

https://golang.org/pkg/database/sql/
/->
https://github.com/golang/go/wiki/SQLDrivers
/->
https://github.com/bradfitz/go-sql-test

https://golang.org/pkg/database/sql/
->
https://github.com/golang/go/wiki/SQLInterface

https://github.com/lib/pq
https://godoc.org/github.com/lib/pq

/ In video Golang UK	, 
https://twitter.github.io/finagle/

/ In google	, 
scala microservice framework
akka

/ In google	, 
akka finagle 
http://blog.samibadawi.com/2013/04/akka-vs-finagle-vs-storm.html
/ akka, finagle , storm vs. hadoop	,
https://developers.soundcloud.com/blog/building-products-at-soundcloud-part-3-microservices-in-scala-and-finagle

/ In google	, 
microservices framework	,
https://www.infoq.com/news/2016/03/lagom-microservices-framework
/->
http://www.lightbend.com/lagom

http://zeroturnaround.com/rebellabs/why-spring-is-winning-the-microservices-game/
http://zeroturnaround.com/rebellabs/exploring-the-virtues-of-microservices-with-play-and-akka/
http://www.infoworld.com/article/3036518/application-development/java-finally-gets-microservices-tools.html

/ Einde Intermezzo 

/ Daarom	, 

func main(){
{
  var c1 <-chan string=boring("Joe!")
  var c2 <-chan string=boring("Ann!")
  var c <-chan string=fanIn(c1,c2)
  var i int
  for i=1;i<100;i++{
    fmt.Printf("%q\n",<-c)
  }
  fmt.Printf("You both are boring, I am leaving\n")
}
}
func boring(msg string) <-chan string{
  var c chan string=make(chan string)
  go func(){
    var i int
    for i=0;;i++{
      c<-fmt.Sprintf("%s %d",msg,i)
      //fmt.Printf("Written in c\n")
      time.Sleep(time.Duration(rand.Intn(1000))*time.Millisecond)
    }
  }()
  return c
}
func fanIn(c1,c2<-chan string)<-chan string{
  var c chan string =make(chan string)
  go func(){
    for{
      c<- <-c1
    }
  }()
  go func(){
    for{
      c<- <-c2
    }
  }()
  return c
}
[eric@almond work2]$ video3
"Joe! 0"
"Ann! 0"
"Ann! 1"
"Joe! 1"
"Ann! 2"
"Joe! 2"
"Ann! 3"
"Joe! 3"
"Ann! 4"
"Joe! 4"
"Ann! 5"
"Joe! 5"
"Ann! 6"
"Joe! 6"
"Joe! 7"
"Ann! 7"
...
"Ann! 34"
"Joe! 34"
"Ann! 35"
"Joe! 35"
"Joe! 36"
"Joe! 37"
"Ann! 36"
"Ann! 37"
"Joe! 38"
"Ann! 38"
"Ann! 39"
"Joe! 39"
"Joe! 40"
"Ann! 40"
"Joe! 41"
"Joe! 42"
"Joe! 43"
"Joe! 44"
"Joe! 45"
"Joe! 46"
"Ann! 41"
"Joe! 47"
"Joe! 48"
"Ann! 42"
"Ann! 43"
"Joe! 49"
"Joe! 50"
"Ann! 44"
"Ann! 45"
"Joe! 51"
"Ann! 46"
You both are boring, I am leaving

/ it is all synchronous	, but they can independently execute	,

/ 13	. 

/ See MORGENAVOND






	
 





 

/ Einde GOLANG CONCURRENCY


/ COCKROACH BUILD

/ Lees	(via README.md),
https://github.com/cockroachdb/cockroach/blob/master/CONTRIBUTING.md

/ we hebben GOPATH, GOBIN set	,

[eric@almond work]$ pwd
/home/eric/Devel/Golang/work
[eric@almond work]$ go get -d github.com/cockroachdb/cockroach

[eric@almond work]$  ls
bin  pkg  src
[eric@almond work]$ ls src
github.com  golang.org  gopkg.in
[eric@almond work]$ ls src/github.com/
agtorre      elazarl        lib           peterh    spf13
biogo        gogo           inconshreveable  mattn         rcrowley  tebeka
cockroachdb  golang         jteeuwen         mibk          robfig    termie
coreos       google         julienschmidt    montanaflynn  russross
cpuguy83     gordonklaus    kisielk          olekukonko    samalba
docker       go-sql-driver  kr               opennota      shurcooL

[eric@almond work]$ ls src/golang.org/
x
/ 'n dir	,
[eric@almond work]$ ls src/gopkg.in/
yaml.v1
/ 'n dir	,

[eric@almond cockroach]$ cd src/github.com/cockroachdb/cockroach/
[eric@almond cockroach]$ make build
installing githooks/post-rewrite
installing githooks/post-checkout
installing githooks/post-merge
go get github.com/robfig/glock
github.com/agtorre/gocolorize                      f42b554bf7f0	[OK]
github.com/biogo/store                             3b4c041f52c2	[OK]
github.com/cockroachdb/c-lz4                       c40aaae2fc50	[OK]
github.com/cockroachdb/c-protobuf                  6a18bfcdd516	[OK]
github.com/cockroachdb/c-rocksdb                   bf15ead80bdc	[OK]
github.com/cockroachdb/c-snappy                    5c6d0932e0ad	[OK]
github.com/cockroachdb/yacc                        443154b1852a	[get OK]
github.com/coreos/etcd                             729b530c489a	[checkout 0eb46eb1457b]
github.com/cpuguy83/go-md2man                      71acacd42f85	[get OK]
 github.com/docker/docker                           603d488a00ea	[get checkout 5e0283effa73]
github.com/elazarl/go-bindata-assetfs              57eb5e1fc594	[checkout d5cac425555c]
github.com/go-sql-driver/mysql                     d512f204a577	[get OK]
github.com/gogo/protobuf                           9dc510915846	[checkout 8658879224bd]
github.com/golang/lint                             32a87160691b	[get OK]
github.com/google/btree                            cc6329d4279e	[OK]
github.com/gordonklaus/ineffassign                 507e48671a07	[get OK]
github.com/inconshreveable/mousetrap               76626ae9c91c	[get OK]
github.com/jteeuwen/go-bindata                     a0ff2567cfb7	[get OK]
github.com/julienschmidt/httprouter                f30ab90cccbd	[OK]
 failed to get: github.com/kisielk/errcheck

> go get -v -d github.com/kisielk/errcheck
github.com/kisielk/errcheck (download)
...
/ TODO

/ we doen met de hand	,
[eric@almond work]$ go get github.com/kisielk/errcheck
[eric@almond work]$ ls src/github.com/kisielk/
errcheck/ gotool/  
/ OK

[eric@almond cockroach]$ make build
github.com/agtorre/gocolorize                      f42b554bf7f0	[OK]
github.com/biogo/store                             3b4c041f52c2	[OK]
github.com/cockroachdb/c-lz4                       c40aaae2fc50	[OK]
github.com/cockroachdb/c-protobuf                  6a18bfcdd516	[OK]
github.com/cockroachdb/c-rocksdb                   bf15ead80bdc	[OK]
github.com/cockroachdb/c-snappy                    5c6d0932e0ad	[OK]
github.com/cockroachdb/yacc                        443154b1852a	[OK]
github.com/coreos/etcd                             0eb46eb1457b	[OK]
github.com/cpuguy83/go-md2man                      71acacd42f85	[OK]
github.com/docker/docker                           5e0283effa73	[OK]
github.com/elazarl/go-bindata-assetfs              d5cac425555c	[OK]
github.com/go-sql-driver/mysql                     d512f204a577	[OK]
github.com/gogo/protobuf                           8658879224bd	[OK]
github.com/golang/lint                             32a87160691b	[OK]
github.com/google/btree                            cc6329d4279e	[OK]
github.com/gordonklaus/ineffassign                 507e48671a07	[OK]
github.com/inconshreveable/mousetrap               76626ae9c91c	[OK]
github.com/jteeuwen/go-bindata                     a0ff2567cfb7	[OK]
github.com/julienschmidt/httprouter                f30ab90cccbd	[OK]
github.com/kisielk/errcheck                        12fd1ab9811e	[OK]
github.com/kisielk/gotool                          58a7a198f2ec	[OK]
github.com/kr/pretty                               e6ac2fc51e89	[OK]
github.com/kr/text                                 bb797dc4fb83	[OK]
github.com/lib/pq                                  11fc39a580a0	[OK]
github.com/mattn/go-runewidth                      d96d1bd051f2	[OK]
github.com/mibk/dupl                               47b66d6a523f	[OK]
github.com/montanaflynn/stats                      4dd27fe9ac79	[OK]
github.com/olekukonko/tablewriter                  333c0610de34	[OK]
github.com/opennota/check                          591428223a6a	[OK]
github.com/peterh/liner                            4d47685ab2fd	[OK]
github.com/rcrowley/go-metrics                     7839c01b09d2	[OK]
github.com/robfig/glock                            cb3c3ec56de9	[OK]
github.com/russross/blackfriday                    d18b67ae0afd	[OK]
github.com/samalba/dockerclient                    4656b1bc6cbc	[OK]
github.com/shurcooL/sanitized_anchor_name          10ef21a441db	[OK]
github.com/spf13/cobra                             ee6224d01f6a	[OK]
github.com/spf13/pflag                             08b1a584251b	[OK]
github.com/tebeka/go2xunit                         0519fcc9b45b	[OK]
github.com/termie/go-shutil                        bcacb06fecae	[OK]
golang.org/x/crypto                                7b85b097bf75	[OK]
golang.org/x/net                                   21af302bb527	[OK]
golang.org/x/text                                  00e205363f74	[OK]
golang.org/x/tools                                 d6e83e534da9	[checkout 1cdaff4a02c5]
gopkg.in/yaml.v1                                   9f9df34309c0	[OK]
cmd github.com/cockroachdb/c-protobuf/cmd/protoc               	[built]
cmd github.com/cockroachdb/cockroach/protoc-gen-gogoroach      	[built]
cmd github.com/cockroachdb/yacc                                	[built]
cmd github.com/golang/lint/golint                              	[built]
cmd github.com/gordonklaus/ineffassign                         	[built]
cmd github.com/jteeuwen/go-bindata/go-bindata                  	[built]
cmd github.com/kisielk/errcheck                                	[built]
cmd github.com/mibk/dupl                                       	[built]
cmd github.com/opennota/check/cmd/varcheck                     	[built]
cmd github.com/robfig/glock                                    	[OK]
cmd github.com/tebeka/go2xunit                                 	[built]
cmd golang.org/x/tools/cmd/goimports                           	[built]
cmd golang.org/x/tools/cmd/stress                              	[built]
cmd golang.org/x/tools/cmd/stringer                            	[built]
touch .bootstrap
go build -tags ''  -ldflags '-X "github.com/cockroachdb/cockroach/util.buildTag=v0.1-alpha-41-gcd80624" -X "github.com/cockroachdb/cockroach/util.buildTime=2015/12/27 12:02:01" -X "github.com/cockroachdb/cockroach/util.buildDeps=github.com/biogo/store:3b4c041f52c224ee4a44f5c8b150d003a40643a0 github.com/cockroachdb/c-lz4:c40aaae2fc50293eb8750b34632bc3efe813e23f github.com/cockroachdb/cockroach:cd80624707adec8c7e23ae692b638383b09d0eae github.com/cockroachdb/c-protobuf:6a18bfcdd5169966cd1235edb71d749c950216e8 github.com/cockroachdb/c-rocksdb:bf15ead80bdc205a19b3d33415b23c156a3cf371 github.com/cockroachdb/c-snappy:5c6d0932e0adaffce4bfca7bdf2ac37f79952ccf github.com/coreos/etcd:0eb46eb1457bf277a5d6093287290b2b5cd6a964 github.com/cpuguy83/go-md2man:71acacd42f85e5e82f70a55327789582a5200a90 github.com/elazarl/go-bindata-assetfs:d5cac425555ca5cf00694df246e04f05e6a55150 github.com/gogo/protobuf:8658879224bd739bf5f1009a686d4841ef397843 github.com/google/btree:cc6329d4279e3f025a53a83c397d2339b5705c45 github.com/inconshreveable/mousetrap:76626ae9c91c4f2a10f34cad8ce83ea42c93bb75 github.com/julienschmidt/httprouter:f30ab90cccbd5171771d26b6557d3c2f49e047a6 github.com/lib/pq:11fc39a580a008f1f39bb3d11d984fb34ed778d9 github.com/mattn/go-runewidth:d96d1bd051f2bd9e7e43d602782b37b93b1b5666 github.com/montanaflynn/stats:4dd27fe9ac7947061538cabe6563c806a4bb3807 github.com/olekukonko/tablewriter:333c0610de3426f738e7ec63801cfd1883b0aeb4 github.com/peterh/liner:4d47685ab2fd2dbb46c66b831344d558bc4be5b9 github.com/rcrowley/go-metrics:7839c01b09d2b1d7068034e5fe6e423f6ac5be22 github.com/russross/blackfriday:d18b67ae0afd61dae240896eae1785f00709aa31 github.com/shurcooL/sanitized_anchor_name:10ef21a441db47d8b13ebcc5fd2310f636973c77 github.com/spf13/cobra:ee6224d01f6a83f543ae90f881b703cf195782ba github.com/spf13/pflag:08b1a584251b5b62f458943640fc8ebd4d50aaa5 golang.org/x/crypto:7b85b097bf7527677d54d3220065e966a0e3b613 golang.org/x/net:21af302bb52737bcf1e6ce0128ec5932bf0d8ae9 golang.org/x/text:00e205363f74f74c3c03b7a12427ec0747a23089 gopkg.in/yaml.v1:9f9df34309c04878acc86042b16630b0f696e1de"' -i -o cockroach

[eric@almond cockroach]$ make test
go test -tags ''  -i ./...
go test -tags ''  -run . ./... -timeout 1m10s 
?   	github.com/cockroachdb/cockroach	[no test files]
?   	github.com/cockroachdb/cockroach/acceptance/cluster	[no test files]
?   	github.com/cockroachdb/cockroach/acceptance/terrafarm	[no test files]
ok  	github.com/cockroachdb/cockroach/base	0.022s
ok  	github.com/cockroachdb/cockroach/cli	2.740s
ok  	github.com/cockroachdb/cockroach/client	1.345s
?   	github.com/cockroachdb/cockroach/cmd/monitor	[no test files]
ok  	github.com/cockroachdb/cockroach/config	0.041s
ok  	github.com/cockroachdb/cockroach/gossip	0.174s
ok  	github.com/cockroachdb/cockroach/gossip/resolver	0.026s
?   	github.com/cockroachdb/cockroach/gossip/simulation	[no test files]
ok  	github.com/cockroachdb/cockroach/keys	0.047s
I1227 13:05:21.699788 15971 gossip/simulation/network.go:56  simulating gossip network with 1 nodes
I1227 13:05:21.700473 15971 gossip/gossip.go:188  setting node descriptor node_id:1 address:<network_field:"tcp" address_field:"127.0.0.1:42281" > attrs:<> 
E1227 13:05:21.700792 15971 gossip/gossip.go:180  different node IDs were set for the same gossip instance (1, 6)
I1227 13:05:21.700837 15971 gossip/gossip.go:188  setting node descriptor node_id:6 address:<network_field:"" address_field:"" > attrs:<> 
...
	/home/eric/Devel/Golang/work/src/github.com/cockroachdb/cockroach/util/stop/stopper.go:87 +0x52
created by github.com/cockroachdb/cockroach/util/stop.(*Stopper).RunWorker
	/home/eric/Devel/Golang/work/src/github.com/cockroachdb/cockroach/util/stop/stopper.go:88 +0x62
FAIL	github.com/cockroachdb/cockroach/kv	14.252s
ok  	github.com/cockroachdb/cockroach/multiraft	0.496s
ok  	github.com/cockroachdb/cockroach/multiraft/storagetest	0.014s
?   	github.com/cockroachdb/cockroach/protoc-gen-gogoroach	[no test files]
ok  	github.com/cockroachdb/cockroach/roachpb	0.019s
ok  	github.com/cockroachdb/cockroach/rpc	2.673s
ok  	github.com/cockroachdb/cockroach/rpc/codec	0.008s
?   	github.com/cockroachdb/cockroach/rpc/codec/message	[no test files]
?   	github.com/cockroachdb/cockroach/rpc/codec/wire	[no test files]
ok  	github.com/cockroachdb/cockroach/security	0.205s
?   	github.com/cockroachdb/cockroach/security/securitytest	[no test files]
ok  	github.com/cockroachdb/cockroach/server	3.518s
ok  	github.com/cockroachdb/cockroach/server/status	0.079s
ok  	github.com/cockroachdb/cockroach/sql	12.332s
ok  	github.com/cockroachdb/cockroach/sql/driver	2.327s
ok  	github.com/cockroachdb/cockroach/sql/parser	0.083s
ok  	github.com/cockroachdb/cockroach/sql/pgwire	0.038s
ok  	github.com/cockroachdb/cockroach/sql/privilege	0.043s
ok  	github.com/cockroachdb/cockroach/storage	18.147s
ok  	github.com/cockroachdb/cockroach/storage/engine	0.571s
?   	github.com/cockroachdb/cockroach/storage/engine/rocksdb	[no test files]
?   	github.com/cockroachdb/cockroach/storage/simulation	[no test files]
?   	github.com/cockroachdb/cockroach/testutils	[no test files]
?   	github.com/cockroachdb/cockroach/testutils/gossiputil	[no test files]
ok  	github.com/cockroachdb/cockroach/ts	0.122s
?   	github.com/cockroachdb/cockroach/ui	[no test files]
ok  	github.com/cockroachdb/cockroach/util	0.015s
ok  	github.com/cockroachdb/cockroach/util/cache	0.006s
ok  	github.com/cockroachdb/cockroach/util/caller	0.016s
ok  	github.com/cockroachdb/cockroach/util/encoding	0.038s
ok  	github.com/cockroachdb/cockroach/util/hlc	0.036s
?   	github.com/cockroachdb/cockroach/util/leaktest	[no test files]
ok  	github.com/cockroachdb/cockroach/util/log	1.016s
?   	github.com/cockroachdb/cockroach/util/log/logflags	[no test files]
ok  	github.com/cockroachdb/cockroach/util/randutil	0.013s
ok  	github.com/cockroachdb/cockroach/util/retry	0.004s
ok  	github.com/cockroachdb/cockroach/util/stop	0.018s
ok  	github.com/cockroachdb/cockroach/util/tracer	0.012s
ok  	github.com/cockroachdb/cockroach/util/uuid	0.004s
Makefile:109: recipe for target 'test' failed
make: *** [test] Error 1

/ 7	. 

[eric@almond work]$  go get -d github.com/cockroachdb/examples-go
package github.com/cockroachdb/examples-go: no buildable Go source files in /home/eric/Devel/Golang/work/src/github.com/cockroachdb/examples-go

/ dus	,

[eric@almond github.com]$ ls
agtorre      docker   gordonklaus      kisielk  montanaflynn  robfig    tebeka
biogo        elazarl  go-sql-driver    kr       olekukonko    russross  termie
cockroachdb  gogo     inconshreveable  lib      opennota      samalba
coreos       golang   jteeuwen         mattn    peterh        shurcooL
cpuguy83     google   julienschmidt    mibk     rcrowley      spf13
[eric@almond github.com]$ ls cockroachdb/
c-lz4  cockroach  c-protobuf  c-rocksdb  c-snappy  examples-go  yacc

/ we zien examples-go/ 	, naast cockroach/	,

eric@almond examples-go]$ make build
go get -d bazil.org/fuse
go get -d ./...
go build -tags ''  -ldflags '' -v -i -o block_writer/block_writer ./block_writer
github.com/cockroachdb/examples-go/block_writer
go build -tags ''  -ldflags '' -v -i -o fakerealtime/fakerealtime ./fakerealtime
github.com/cockroachdb/examples-go/fakerealtime
go build -tags ''  -ldflags '' -v -i -o filesystem/filesystem ./filesystem
bazil.org/fuse
bazil.org/fuse/fuseutil
bazil.org/fuse/fs
bazil.org/fuse/fs/fstestutil
github.com/cockroachdb/examples-go/filesystem
go build -tags ''  -ldflags '' -v -i -o bank/sql_bank/sql_bank ./bank/sql_bank
github.com/cockroachdb/examples-go/bank/sql_bank

[eric@almond try]$ pwd
/home/eric/Devel/Golang/try
[eric@almond try]$ PATH=$PATH:$PWD/../work/src/github.com/cockroachdb/cockroach/

[eric@almond try]$ cockroach init --stores=ssd=/tmp/data0

[eric@almond try]$ cockroach cert create-ca
[eric@almond try]$ cockroach cert create-node 127.0.0.1 localhost almond

/ Lees	,
https://github.com/cockroachdb/cockroach/issues/2022

/ we hebben certs/	,
/ we probeerden	,
[eric@almond try]$ cockroach init --stores=ssd=db0
[eric@almond try]$ cockroach start --stores=ssd="./db0" --addr=":8080" --gossip=":8080,:8081,:8082"
[eric@almond try]$ cockroach start --stores=ssd="./db1" --addr=":8081" --gossip=":8080,:8081,:8082"
[eric@almond try]$ cockroach start --stores=ssd="./db2" --addr=":8082" --gossip=":8080,:8081,:8082"
[eric@almond try]$ ../work/src/github.com/cockroachdb/examples-go/bank/sql_bank/sql_bank --num-accounts=200 https://node@localhost:8080

/ we proberen	,
eric@almond try]$ cockroach start --stores=ssd="./db0" --addr=":8080" --gossip=":8080"






 






/ Einde COCKROACH BUILD

/ COCKROACH


/ 7	 

/ examples	,


/ 7	. 

[eric@almond Cockroach]$ pwd
/home/eric/Devel/Cockroach
[eric@almond Cockroach]$ git clone https://github.com/cockroachdb/cockroach.git

[eric@almond cockroach]$ make build
go get github.com/robfig/glock
package github.com/robfig/glock: cannot download, $GOPATH not set. For more details see: go help gopath
go build -tags ''  -ldflags '-X "github.com/cockroachdb/cockroach/util.buildTag=v0.1-alpha-27-g6ef0f08" -X "github.com/cockroachdb/cockroach/util.buildTime=2015/12/25 14:48:12" -X "github.com/cockroachdb/cockroach/util.buildDeps="' -i -o cockroach
main.go:26:2: cannot find package "github.com/cockroachdb/cockroach/cli" in any of:
	/usr/lib/golang/src/github.com/cockroachdb/cockroach/cli (from $GOROOT)
	($GOPATH not set)
main.go:27:2: cannot find package "github.com/cockroachdb/cockroach/util/randutil" in any of:
	/usr/lib/golang/src/github.com/cockroachdb/cockroach/util/randutil (from $GOROOT)
	($GOPATH not set)
Makefile:63: recipe for target 'build' failed
make: *** [build] Error 1


/ 7	. 

[eric@almond Docker2]$ docker pull cockroachdb/cockroach

[eric@almond Docker2]$ docker run -it --rm cockroachdb/cockroach  shell
# ls /
bin   cockroach  etc   lib    media  opt   root  sbin  sys  usr
boot  dev	 home  lib64  mnt    proc  run	 srv   tmp  var
# pwd
/cockroach

eric@almond cockroach]$ docker exec -it db /bin/bash
root@97951d1c3f13:/cockroach# ls
cockroach  cockroach.sh
/ Nu wel /bin/bash
/ TODO

/ in de 1ste	,
# ./cockroach start --dev

/ in de 2de	,
oot@97951d1c3f13:/cockroach# ./cockroach sql --dev
97951d1c3f13:26257> show databases;
I1223 22:18:55.453528 37 context.go:168  running in insecure mode, this is strongly discouraged. See --insecure and --certs.
+----------+
| Database |
+----------+
| system   |
+----------+

97951d1c3f13:26257> set database=system;
OK
97951d1c3f13:26257> show tables;
+------------+
|   Table    |
+------------+
| descriptor |
| lease      |
| namespace  |
| users      |
| zones      |
+------------+

97951d1c3f13:26257> ^c
root@97951d1c3f13:/cockroach#  ./cockroach help
...

/7	.

eric@almond Docker2]$ docker run --net=my-bridge --rm -it --name node0 cockroachdb/cockroach shell

[eric@almond Docker2]$ docker run --net=my-bridge --rm -it --name node1 cockroachdb/cockroach shell

/ in node0	,

# ./cockroach init --stores=ssd=/tmp/data0
#  ls /tmp
data0

# ./cockroach cert create-ca
# ls
certs  cockroach  cockroach.sh
# ls certs	
ca.crt	ca.key

/ 7	. 

/ scp debian	,

[eric@almond cockroach]$ pwd
/home/eric/Devel/Cockroach/cockroach
[eric@almond cockroach]$ find -name Dockerfile
./build/Dockerfile
./build/deploy/Dockerfile
$ less build/deploy/Dockerfile

FROM buildpack-deps:jessie-curl

MAINTAINER Tobias Schottdorf <tobias.schottdorf@gmail.com>

RUN mkdir -p /cockroach
COPY cockroach.sh cockroach /cockroach/
# Set working directory so that relative paths
# are resolved appropriately when passed as args.
WORKDIR /cockroach/

EXPOSE 26257
ENTRYPOINT ["/cockroach/cockroach.sh"]

/ 13	.

/ Lees	,
http://askubuntu.com/questions/216287/unable-to-install-files-with-apt-get-unable-to-locate-package
Try running sudo apt-get update before trying to install the package. After installation the system doesn't have an up-to-date package list so you won't be able to find the package.

/ bij Debian moeten we eerst apt-get update	 	, 

/ Intermezzo

/ doe in 1 keer	, in elke container	,
# apt-get update && apt-get -y install openssh-server openssh-client vim
# mkdir /var/run/sshd
# echo "root:root" | chpasswd 
# vim /etc/ssh/sshd_config 
PermitRootLogin yes
# /usr/sbin/sshd -D&

/ als we node0, node1, node2 hebben , en we willen password less login	, moeten we op elke node	,
# ssh-keygen -t rsa
# ssh node(n) "mkdir .ssh" 	/ op de andere nodes
# ssh node(n) < <(cat /root/.ssh/id_rsa.pub)  "cat >>.ssh/authorized_keys" / naar de andere nodes	,

/ kunnen we known_hosts automate	, 
root@dd22d12e3ac2:/cockroach# ssh node2
The authenticity of host 'node2 (172.19.0.4)' can't be established.
ECDSA key fingerprint is 00:e1:36:fe:7e:cc:1d:74:84:55:7f:fb:f5:97:15:0f.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added 'node2,172.19.0.4' (ECDSA) to the list of known hosts.
root@node2's password: 
/ er verschijnt op de node /root/.ssh/known_hosts	,

/ op iedere node	,
root@dd22d12e3ac2:/cockroach# ls /root/.ssh
authorized_keys  id_rsa  id_rsa.pub  known_hosts


/ Einde Intermezzo



[eric@almond Docker2]$ docker run --net=my-bridge --rm -it --name node1 cockroachdb/cockroach shell
# bash
root@372fb67081c8:/cockroach# apt-get update
Get:1 http://security.debian.org jessie/updates InRelease [63.1 kB]
Ign http://httpredir.debian.org jessie InRelease        
Get:2 http://httpredir.debian.org jessie-updates InRelease [136 kB]
Get:3 http://security.debian.org jessie/updates/main amd64 Packages [219 kB]   
Get:4 http://httpredir.debian.org jessie Release.gpg [2373 B]                  
Get:5 http://httpredir.debian.org jessie Release [148 kB]                      
Get:6 http://httpredir.debian.org jessie-updates/main amd64 Packages [3619 B]  
Get:7 http://httpredir.debian.org jessie/main amd64 Packages [9035 kB]
Fetched 9608 kB in 12s (762 kB/s)                                              
Reading package lists... Done

/ scp krijgen we met openssh-client	, 
/ maar aan de andere kant moet wel op port 22 openssh server 	,

/ want als op aan beiden kanten openssh-client install	,en we doen op node0	,
# bash  	
root@5a1c1ff0bf0d:/cockroach# scp cockroach.sh node1:
ssh: connect to host node1 port 22: Connection refused
lost connection

/ we install nu ook openssh-server	,

/ we doen	,
root@5a1c1ff0bf0d:/cockroach# /usr/sbin/sshd -D&      
[1] 421
root@5a1c1ff0bf0d:/cockroach# Missing privilege separation directory: /var/run/sshd

/ Lees	,
https://docs.docker.com/engine/examples/running_ssh_service/

/ Inderdaad	, daar zien we dat we dat moeten doen	,  (aan de server kant)	,

root@5a1c1ff0bf0d:/cockroach# mkdir /var/run/sshd
root@5a1c1ff0bf0d:/cockroach# echo "root:root" | chpasswd
root@484c1ab4fa75:/cockroach# apt-get install vim
root@484c1ab4fa75:/cockroach# vi /etc/ssh/sshd_config 
#PermitRootLogin without-password
PermitRootLogin yes

/ start sshd op server, (node1)
# /usr/sbin/sshd -D 

/ Als node1 server, dan kan een client  op node0	,
# scp ... node1:

/ Maak Dockerfile bovenop die van cockroach	, die sshd start	, 
/ TODO




/ Intermezzo

/ TOT NU TOE	, 

/ doe in 1 keer	, in elke container	,

# apt-get update && apt-get -y install openssh-server openssh-client vim
# mkdir /var/run/sshd
# echo "root:root" | chpasswd 
# vim /etc/ssh/sshd_config 
PermitRootLogin yes
# /usr/sbin/sshd -D&

/ Kijk hoe de nodes heten	,
4150ff9396df c117ea0bb348 bb302ec823b2

/ doe op node0	,

root@4150ff9396df:/cockroach# ./cockroach cert create-ca
root@4150ff9396df:/cockroach# ./cockroach cert create-node 4150ff9396df c117ea0bb348 bb302ec823b2 
root@4150ff9396df:/cockroach# ./cockroach cert create-client root
root@4150ff9396df:/cockroach# scp -r certs node1:/cockroach/certs
root@node1's password: root
root@4150ff9396df:/cockroach# scp -r certs node2:/cockroach/certs
root@node1's password: root

root@4150ff9396df:/cockroach# ./cockroach init --stores=ssd=/data
root@4150ff9396df:/cockroach# ./cockroach start --stores=ssd=/data --gossip=4150ff9396df:26257,c117ea0bb348:26257,bb302ec823b2:26257
/ of	,
root@4150ff9396df:/cockroach# ./cockroach start --stores=ssd=/data --gossip=node0:26257,node1:26257,node2:26257

/ we zien	,
I1227 09:40:25.182439 514 gossip/gossip.go:707  starting client to bb302ec823b2:26257
W1227 09:40:27.053448 514 rpc/client.go:300  dial tcp 69.172.201.208:26257: i/o timeout
W1227 09:40:28.183037 514 rpc/client.go:300  dial tcp 69.172.201.208:26257: i/o timeout
E1227 09:40:29.084153 514 storage/queue.go:373  failure processing replica range=1 [/Min-/Max) from replicate queue: storage/allocator.go:254: unable to allocate a target store; no candidates available

/ we kunnen	,
root@bb302ec823b2:/cockroach# apt-get install net-tools

/TODO




/ Einde Intermezzo

/ 7	 .

/ Lees	,
https://github.com/cockroachdb/cockroach

/ node1, node2 zijn sshd servers	, node0 een sshd client	,

dd22d12e3ac2 ccd232c3d2f1 94d616400477
4150ff9396df c117ea0bb348 bb302ec823b2

/ op node0	,
root@5a1c1ff0bf0d:/cockroach# ./cockroach cert create-ca
root@5a1c1ff0bf0d:/cockroach# ./cockroach cert create-node dd22d12e3ac2 ccd232c3d2f1 94d616400477 
root@5a1c1ff0bf0d:/cockroach# ./cockroach cert create-client root
root@5a1c1ff0bf0d:/cockroach# scp -r certs node(n):/cockroach/certs
root@node1's password: root
ca.key                                        100% 1679     1.6KB/s   00:00    
node.server.crt                               100% 1159     1.1KB/s   00:00    
root.client.crt                               100% 1103     1.1KB/s   00:00    
node.client.crt                               100% 1103     1.1KB/s   00:00    
node.client.key                               100% 1679     1.6KB/s   00:00    
ca.crt                                        100% 1111     1.1KB/s   00:00    
root.client.key                               100% 1679     1.6KB/s   00:00    
node.server.key                               100% 1675     1.6KB/s   00:00    

root@5a1c1ff0bf0d:/cockroach# scp -r certs node2:certs
The authenticity of host 'node2 (172.19.0.4)' can't be established.
ECDSA key fingerprint is d5:c7:07:0c:8c:61:93:fe:ca:e4:58:6f:d1:3e:c8:eb.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added 'node2,172.19.0.4' (ECDSA) to the list of known hosts.
root@node2's password: 
ca.key                                        100% 1679     1.6KB/s   00:00    
node.server.crt                               100% 1159     1.1KB/s   00:00    
root.client.crt                               100% 1103     1.1KB/s   00:00    
node.client.crt                               100% 1103     1.1KB/s   00:00    
node.client.key                               100% 1679     1.6KB/s   00:00    
ca.crt                                        100% 1111     1.1KB/s   00:00    
root.client.key                               100% 1679     1.6KB/s   00:00    
node.server.key                               100% 1675     1.6KB/s   00:00    

/ op node1	, 
root@484c1ab4fa75:/cockroach# pwd
/cockroach
root@484c1ab4fa75:/cockroach# ls 
cockroach  cockroach.sh
root@484c1ab4fa75:/cockroach# ls /root
certs  cockroach.sh

/ Is het de bedoeling dat certs/ in /root	?
/ TODO 
/ We doen voor de zekerheid op node1, node2	,
root@0ede61fe14e1:/cockroach# cp -a /root/certs/ .

./cockroach init --stores=ssd=/data
./cockroach start --stores=ssd=/data --gossip=node1:26257,node2:26257
/ ERR
/ Op welke machine	? 
/ TODO

/7	. 

/ Lees	,
https://github.com/cockroachdb/cockroach-prod

/7	. 

/ we proberen nog een keer in een container	,

[eric@almond try]$  docker run --net=my-bridge --rm -it --name node0 -P cockroachdb/cockroach shell
# bash
root@dd1ae6662835:/cockroach# PATH=$PATH:.
root@dd1ae6662835:/cockroach# cockroach cert create-ca
root@dd1ae6662835:/cockroach# cockroach cert create-node 127.0.0.1 localhost $(hostname) 
root@dd1ae6662835:/cockroach# cockroach cert create-client root
root@dd1ae6662835:/cockroach# cockroach init --stores=ssd=db0
root@dd1ae6662835:/cockroach# cockroach start --stores=ssd=db0 --addr=:8080 --gossip=:8080           
E1227 14:48:09.069732 39 storage/queue.go:373  failure processing replica range=1 [/Min-/Max) from replicate queue: storage/allocator.go:254: unable to allocate a target store; no candidates available

/ 13	. 

/ we hebben ook in container	,

eric@almond try]$  docker run --net=my-bridge --rm -it --name node0 -P cockroachdb/cockroach shell
root@dd1ae6662835:/cockroach# cockroach start --stores=ssd=db0 --addr=:8080 --gossip=:8080,:8081,:8082

$ docker exec -it node0 /bin/bash
root@dd1ae6662835:/cockroach# cockroach start --stores=ssd=db1 --addr=:8081 --gossip=:8080,:8081,:8082

$ docker exec -it node0 /bin/bash
root@dd1ae6662835:/cockroach# cockroach start --stores=ssd=db2 --addr=:8082 --gossip=:8080,:8081,:8082

/ Niet alles is fout	,
/ De webapp doen het toch niet	, 
# apt-get update && apt-get install curl
# curl localhost:8080
# curl localhost:8081
# curl localhost:8082
/ Had het moeten doen	,


/ Einde COCKROACH

/ COCKROACH QUESTION

/ 7	 .

/ we doen	,

/ term 0 
[eric@almond Docker2]$ docker run --net=my-bridge --rm -it --name node0 -P cockroachdb/cockroach shell
# 

/ term 1
[eric@almond Docker2]$ docker exec -it node0 /bin/bash
root@50c4afb6a9ea:/cockroach# PATH=$PATH:.
root@50c4afb6a9ea:/cockroach# cockroach init --stores=ssd=db0

root@50c4afb6a9ea:/cockroach# cockroach cert create-ca
root@50c4afb6a9ea:/cockroach# cockroach cert create-node 127.0.0.1 localhost $(hostname)
root@50c4afb6a9ea:/cockroach# cockroach cert create-client root
root@50c4afb6a9ea:/cockroach# cockroach start --stores=ssd=db0 --addr=:8080 --gossip=:8080,:8081,:8082
/ of	,
root@50c4afb6a9ea:/cockroach# cockroach start --stores=ssd=db0 --addr=:8080 --gossip=:8080
/ of	,

/ term 2

[eric@almond Docker2]$ docker exec -it node0 /bin/bash
root@50c4afb6a9ea:/cockroach# PATH=$PATH:.
root@50c4afb6a9ea:/cockroach# cockroach start --stores=ssd=db1 --addr=:8081 --gossip=:8080,:8081,:8082
/ of	,
root@50c4afb6a9ea:/cockroach# cockroach start --stores=ssd=db1 --addr=:8081 --gossip=:8080


/ term 3

[eric@almond Docker2]$ docker exec -it node0 /bin/bash
root@50c4afb6a9ea:/cockroach# PATH=$PATH:.
root@50c4afb6a9ea:/cockroach# cockroach start --stores=ssd=db2 --addr=:8082 --gossip=:8080,:8081,:8082
/ of	,
root@50c4afb6a9ea:/cockroach# cockroach start --stores=ssd=db2 --addr=:8082 --gossip=:8080

/ term 4

eric@almond Docker2]$ docker exec -it node0 /bin/bash
root@50c4afb6a9ea:/cockroach# apt-get update && apt-get install curl

root@50c4afb6a9ea:/cockroach# echo $(hostname)
50c4afb6a9ea
root@50c4afb6a9ea:/cockroach# curl $(hostname):8080
...
root@50c4afb6a9ea:/cockroach# curl $(hostname):8081
...
root@50c4afb6a9ea:/cockroach# curl $(hostname):8082
...
root@50c4afb6a9ea:/cockroach# curl $(hostname):8083
curl: (7) Failed to connect to 50c4afb6a9ea port 8083: Connection refused

/ Dus hij lijkt het te doen	,

/ 7	 .

/we exec de bank appl	, 

/ we run cockroach op laptop	, niet in docker	,

/ term 1

[eric@almond try]$ PATH=$PATH:../work/src/github.com/cockroachdb/cockroach/
[eric@almond try]$ cockroach init --stores=ssd=db0
[eric@almond try]$ cockroach cert create-ca
[eric@almond try]$ cockroach cert create-node 127.0.0.1 localhost $(hostname)
[eric@almond try]$ cockroach cert create-client root
[eric@almond try]$ cockroach start --stores=ssd=db0 --addr=:8080 --gossip=:8080

/ term 2

[eric@almond try]$ PATH=$PATH:$PWD/../work/src/github.com/cockroachdb/cockroach/
[eric@almond try]$ cockroach start --stores=ssd=db1 --addr=:8081 --gossip=:8080

/ term 3
[eric@almond try]$ PATH=$PATH:$PWD/../work/src/github.com/cockroachdb/cockroach/
[eric@almond try]$ cockroach start --stores=ssd=db2--addr=:8082 --gossip=:8080

/ term 4
[eric@almond try]$  ../work/src/github.com/cockroachdb/examples-go/bank/sql_bank/sql_bank  https://$(hostname):8080 
/ of	,
eric@almond try]$  ../work/src/github.com/cockroachdb/examples-go/bank/sql_bank/sql_bank  -num-accounts=200  https://$(hostname):8080 
/ of	,
eric@almond try]$  ../work/src/github.com/cockroachdb/examples-go/bank/sql_bank/sql_bank  -num-accounts=200 -concurrency 4 https://$(hostname):8081 

/ 7	. 

/ Met meerdere nodes werkt NIET	,

[eric@almond Logs]$ docker run --net=my-bridge --rm -it --name node1 -P cockroachdb/cockroach shell
[eric@almond Logs]$ docker run --net=my-bridge --rm -it --name node2 -P cockroachdb/cockroach shell
[eric@almond Logs]$ docker run --net=my-bridge --rm -it --name node3 -P cockroachdb/cockroach shell
# bash
root@18c830761509:/cockroach# PATH=$PATH:.
root@18c830761509:/cockroach# apt-get update && apt-get install openssh-server openssh-client vim
root@18c830761509:/cockroach# mkdir /var/run/sshd
root@18c830761509:/cockroach# vi /etc/ssh/sshd_config 
PermitRootLogin yes
root@18c830761509:/cockroach# /usr/sbin/sshd -D& 
root@18c830761509:/cockroach# echo "root:root" | chpasswd 



/ on node1 I did	,
root@18c830761509:/cockroach# cockroach cert create-ca
root@18c830761509:/cockroach# cockroach cert create-node 18c830761509 localhost 1c78f2273514 node2 a31077735387 node3
root@18c830761509:/cockroach# cockroach cert create-client root
root@18c830761509:/cockroach# scp -r certs node2:/cockroach
root@node2's password: root 
root@18c830761509:/cockroach# scp -r certs node3:/cockroach
root@node3's password: root 

root@18c830761509:/cockroach# cockroach init --stores=ssd=db0 

root@18c830761509:/cockroach# cockroach start --stores=ssd=db0 --gossip=localhost:26257,node2:26257,node3:26257
/ or	,
root@18c830761509:/cockroach# cockroach start --stores=ssd=db0 --gossip=18c830761509:26257,1c78f2273514:26257,a31077735387:26257

/ we zien ERR	,
E1229 20:32:59.042901 653 storage/queue.go:373  failure processing replica range=1 [/Min-/Max) from replicate queue: storage/allocator.go:254: unable to allocate a target store; no candidates available
W1229 20:33:00.980191 653 rpc/client.go:300  dial tcp 69.172.201.208:26257: i/o timeout


/ Einde COCKROACH QUESTION

/ MATH

/ Lees	,
http://mathoverflow.net/questions/136052/cyclotomic-extension-of-p-adic-fields
http://www1.spms.ntu.edu.sg/~frederique/antchap7.pdf



/ Einde MATH

/ AWK

/ 7	. 

/ Moet beter	,

/ we willen	,
PermitRootLogin yes

[root@b30cf98da85e /]# awk  '{print gensub("(#)(PermitRootLogin yes)","\\2","g")}' <(echo "#Permit yes") 
PermitRootLogin yes
[root@b30cf98da85e /]# awk  '{gsub(/#/,"");print}' <(echo "#PermitRootLogin yes") 
PermitRootLogin yes
[root@b30cf98da85e /]# awk  '{sub(/#/,"");print}' <(echo "#PermitRootLogin yes")
PermitRootLogin yes

/ Einde AWK

/ DOCKER SSH PASSWORDLESS 

/ 7	. 

/ centos	,

[eric@almond ssh]$ pwd
/home/eric/Devel/Docker2/centos/ssh

[eric@almond ssh]$ cat Dockerfile2

from centos
run yum -y install openssh-server openssh-clients
run yum clean all

run echo 'root:rtdMpo45' | chpasswd

[eric@almond ssh]$ docker build --rm -t local/sshd:v2 -f Dockerfile2 .

eric@almond ssh]$ docker run --rm --name node1 --net=my-bridge -it local/sshd:v2 /usr/bin/bash

[eric@almond ssh]$ docker run --rm --name node2 --net=my-bridge -it local/sshd:v2 /usr/bin/bash

/ in beide	,

[root@f670018ff3ba /]# FIL="/etc/ssh/sshd_config" TMP="$(mktemp)" ;awk '{print gensub("(#)(PermitRootLogin yes)","\\2",1);}' "$FIL" >"$TMP";mv -f "$TMP" "$FIL"

[root@fc30e1310203 /]# vi /etc/ssh/sshd_config 
PermitRootLogin yes
[root@fc30e1310203 /]# ssh-keygen -A
ssh-keygen: generating new host keys: RSA1 RSA DSA ECDSA ED25519 
[root@fc30e1310203 /]# /usr/sbin/sshd -D&

/ ssh-keygen maakt	,
[root@f0c61d6791a7 /]# ls /etc/ssh/ssh_host_
ssh_host_dsa_key          ssh_host_ed25519_key      ssh_host_rsa_key
ssh_host_dsa_key.pub      ssh_host_ed25519_key.pub  ssh_host_rsa_key.pub
ssh_host_ecdsa_key        ssh_host_key              
ssh_host_ecdsa_key.pub    ssh_host_key.pub          
/ TODO
/ Op centos moeten we dit doen	, op debian niet	, 
/ TODO
/ Op debian moeten we mkdir /var/run/sshd
/ TODO
/ Dit is iets anders dan 
# ssh-keygen -t rsa
/ die een key maakt in /root/.ssh

/ we kunnen met password inlog van node1 naar node2	,

[root@fc30e1310203 /]# ssh node2
The authenticity of host 'node2 (172.19.0.3)' can't be established.
ECDSA key fingerprint is df:64:63:b3:f8:b3:5c:26:04:06:8d:3d:b5:69:9e:19.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added 'node2,172.19.0.3' (ECDSA) to the list of known hosts.
root@node2's password: 
[root@25244fd43837 ~]# ls 
anaconda-ks.cfg
[root@25244fd43837 ~]# echo foo >foo

/ en als we in ander terminal kijken (node2)	,
[root@25244fd43837 /]# ls /root
anaconda-ks.cfg  foo

/ 13	. 

/ nu zonder password in orde maken	,

/ Lees	,
http://www.linuxproblem.org/art_9.html

/ op node1,	

[root@fc30e1310203 /]# ssh-keygen -t rsa
Generating public/private rsa key pair.
Enter file in which to save the key (/root/.ssh/id_rsa): 
Enter passphrase (empty for no passphrase): 
Enter same passphrase again: 

[root@fc30e1310203 /]# ssh node2 mkdir .ssh
root@node2's password: 

[root@fc30e1310203 /]# ssh node2 "cat >>.ssh/authorized_keys" < <(cat /root/.ssh/id_rsa.pub )
root@node2's password: 

/ we kunnen ook	,
[root@fc30e1310203 /]# ssh node2  < <(cat /root/.ssh/id_rsa.pub ) "cat >>.ssh/authorized_keys2"

/ Nu is het al goed	,

/ 13	. 

/ we maken complete Dockerfile	,

from centos
run yum -y install openssh-server openssh-clients
run yum clean all

run echo 'root:rtdMpo45' | chpasswd

run FIL="/etc/ssh/sshd_config";TMP="$(mktemp)";awk '{print gensub("(#)(PermitRootLogin yes)","\\2",1);}' "$FIL" >"$TMP";mv -f "$TMP" "$FIL"

run ssh-keygen -A
expose 22
cmd ["/usr/sbin/sshd","-D"]

/ Omdat we  een cmd geven	, moeten we niet bij create container /usr/bin/bash als arg geven	,
[eric@almond ssh]$ docker run  --name node1 --net=my-bridge -d -P local/sshd:v2 

/ Lees	,
https://docs.docker.com/engine/examples/running_ssh_service/

/ we kunnen vanaf host ssh in de container	,
/ het kan op twee manieren	,

[eric@almond ssh]$ ssh root@172.19.0.2
/=
[eric@almond ssh]$ ssh root@172.19.0.2 -p 22

/ of	,
[eric@almond ssh]$ ssh root@127.0.0.1 -p  32769
/=
[eric@almond ssh]$ ssh root@92.168.123.182 -p  32769
/=
[eric@almond ssh]$ ssh root@localhost -p  32769


/ 7	 .

/ debian	,

[eric@almond ssh]$ pwd
/home/eric/Devel/Docker2/debian/ssh

[eric@almond ssh]$ cat Dockerfile2

from debian 
run apt-get update && apt-get -y install openssh-server openssh-client

run echo 'root:rtdMpo45' | chpasswd

[eric@almond ssh]$ docker build --rm -t local/sshd:v3 -f Dockerfile2 .

[eric@almond ssh]$ docker rmi $(awk '/<none>/{print $3}' <(docker images))
/ opruimen	,

/ 13	. 

[eric@almond ssh]$ docker run --net=my-bridge --rm --name node1 -it local/sshd:v3 /bin/bash
[eric@almond ssh]$ docker run --net=my-bridge --rm --name node2 -it local/sshd:v3 /bin/bash

/ op beide	,
root@c0a6aaeb3e7f:/# mkdir /var/run/sshd
root@c0a6aaeb3e7f:/# /usr/sbin/sshd -D&
[1] 12
root@c0a6aaeb3e7f:/# apt-get install vim
root@c0a6aaeb3e7f:/# vi /etc/ssh/sshd_config 
PermitRootLogin yes
root@ba6c70c6d5b6:/# kill -HUP <PID>


/ op node1	,
oot@c0a6aaeb3e7f:/# ssh-keygen -t rsa 
Generating public/private rsa key pair.
Enter file in which to save the key (/root/.ssh/id_rsa): 
Created directory '/root/.ssh'.
Enter passphrase (empty for no passphrase): 
Enter same passphrase again: 

root@c0a6aaeb3e7f:/# ssh node2 < <(cat /root/.ssh/id_rsa.pub)  "cat >>.ssh/authorized_keys"
root@node2's password: 
root@c0a6aaeb3e7f:/# ssh node2
/ OK

/ 7	. 

/ Hoe expose 22 speelt rol?

/ Qua connect verschillende containers NIET	, 
/ wel als je vanuit de host wil connect naar de containers met -p

[eric@almond ssh]$ cat Dockerfile
from centos
run yum -y install openssh-server openssh-clients
run yum clean all

run echo 'root:root' | chpasswd

run FIL="/etc/ssh/sshd_config";TMP="$(mktemp)";awk '{print gensub("(#)(PermitRootLogin yes)","\\2",1);}' "$FIL" >"$TMP";mv -f "$TMP" "$FIL"

run ssh-keygen -A
expose 22
CMD ["/usr/sbin/sshd","-D"]

/ we kunnen zonder/met 
expose 22
/ we doen eerst zonder	, 

[eric@almond ssh]$ docker build --rm -t local/sshd -f Dockerfile3 .

[eric@almond ssh]$ docker run  --name node1 --net=my-bridge -d -P local/sshd
2a0e132f19baa87b55f3ba654c073c751bae51b01ec25317cdfabfecb3d2d84f
[eric@almond ssh]$ docker run  --name node2 --net=my-bridge -d -P local/sshd
330a7288d299de46df4322a9ca407b5d6dbd781d6533fd14e1236ab4abd1cd5b

[eric@almond ssh]$ docker exec -ti node1 /usr/bin/bash
[root@2a0e132f19ba /]# 
eric@almond ssh]$ docker exec -it node2 /usr/bin/bash
[root@330a7288d299 /]# 

/ op node1	,
[root@2a0e132f19ba /]# ssh node2 "mkdir .ssh"
The authenticity of host 'node2 (172.19.0.3)' can't be established.
ECDSA key fingerprint is ac:14:d8:04:99:01:ad:dd:36:85:55:0d:3d:10:68:b0.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added 'node2,172.19.0.3' (ECDSA) to the list of known hosts.
root@node2's password: 

root@2a0e132f19ba /]# ssh-keygen -t rsa
Generating public/private rsa key pair.
Enter file in which to save the key (/root/.ssh/id_rsa): 
Enter passphrase (empty for no passphrase): 
Enter same passphrase again: 

root@2a0e132f19ba:/# ssh node2 < <(cat /root/.ssh/id_rsa.pub)  "cat >>.ssh/authorized_keys"
root@node2's password: 
/ OK

/ Nu met	, 
expose 22

[eric@almond ssh]$ docker inspect node1
    "NetworkSettings": {
        "Ports": {
            "22/tcp": [
                {
                    "HostIp": "0.0.0.0",
                    "HostPort": "32771"
                }
            ]
        },

/ Als we GEEN expose 22	, dan zien we dit NIET	,

/ Zonder expose 22	, kunnen we WEL	,
[eric@almond ssh]$ ssh root@172.19.0.2
/ maar NIET 
[eric@almond ssh]$ ssh root@localhost -p ...

/ 7	. 

/ we maken de volgende Dockerfile	,

from centos
run yum -y install openssh-server openssh-clients
run yum clean all

run echo 'root:root' | chpasswd

run FIL="/etc/ssh/sshd_config";TMP="$(mktemp)";awk '{print gensub("(#)(PermitRootLogin yes)","\\2",1);}' "$FIL" >"$TMP";mv -f "$TMP" "$FIL"

run ssh-keygen -A

run ssh-keygen -N "" -t rsa -f ~/.ssh/id_rsa
run cat ~/.ssh/id_rsa.pub >>~/.ssh/authorized_keys

CMD ["/usr/sbin/sshd","-D"]

/ Dus in iedere container staat dezelfde ~/.ssh/id_rsa	, en deze staat dus ook in de andere container's ~/.ssh/authorized_keys	,
/ Grappig zo	,

/we check	,

[eric@almond ssh]$ docker build --rm -t local/sshd -f Dockerfile3 .
/ en dan	,
[eric@almond ssh]$ docker run  --name node1 --net=my-bridge -d -P local/sshd
[eric@almond ssh]$ docker run  --name node2 --net=my-bridge -d -P local/sshd

$ docker exec -it node1 /usr/bin/bash
[root@4446dd0dc6be /]# scp node2:.ssh/id_rsa /tmp
[root@4446dd0dc6be /]# diff ~/.ssh/id_rsa /tmp/id_rsa 
[root@4446dd0dc6be /]# 
/ GEEN	,

/ 7	. 

/ we kunnen ook vanuit de host password less ssh	,
/ TODO






/ Einde DOCKER SSH PASSWORDLESS 

/ DOCKER MONGO

 /Lees	,
https://hub.docker.com/_/mongo/

/ Lees	,
https://docs.docker.com/engine/articles/dockerfile_best-practices/
ENTRYPOINT



/Einde DOCKER MONGO

/ NODE NVM

/ we update fedora eerst	,
$ sudo dnf update --refresh

/ Lees	,
https://fedoraproject.org/wiki/Node.js

/ Lees	,
https://github.com/creationix/nvm

[eric@almond ~]$ curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.30.2/install.sh | bash
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  7750  100  7750    0     0  27043      0 --:--:-- --:--:-- --:--:-- 27097
=> Downloading nvm from git to '/home/eric/.nvm'
=> Cloning into '/home/eric/.nvm'...
remote: Counting objects: 4344, done.
remote: Compressing objects: 100% (3/3), done.
remote: Total 4344 (delta 0), reused 0 (delta 0), pack-reused 4341
Receiving objects: 100% (4344/4344), 1.09 MiB | 365.00 KiB/s, done.
Resolving deltas: 100% (2544/2544), done.
Checking connectivity... done.
* (HEAD detached at v0.30.2)
  master

=> Appending source string to /home/eric/.bashrc
=> Close and reopen your terminal to start using nvm

/ We zien inderdaad	,
[eric@almond ~]$ cat ~/.bashrc
export NVM_DIR="/home/eric/.nvm"
[ -s "$NVM_DIR/nvm.sh" ] && . "$NVM_DIR/nvm.sh"  # This loads nvm

[eric@almond ~]$ ls ~/.nvm
bash_completion  install.sh  Makefile  nvm.sh        README.markdown
CONTRIBUTING.md  LICENSE.md  nvm-exec  package.json  test

/ er is ook,	
https://github.com/nodejs/node
/ we zien de laatste versie v5.5.0

[eric@almond ~]$ nvm install 5.5
Downloading https://nodejs.org/dist/v5.5.0/node-v5.5.0-linux-x64.tar.xz...
######################################################################## 100.0%
WARNING: checksums are currently disabled for node.js v4.0 and later
Now using node v5.5.0 (npm v3.3.12)

/ we hebben al node	,
[eric@almond ~]$  node -v
v5.5.0
[eric@almond ~]$ which node
~/.nvm/versions/node/v5.5.0/bin/node

/ In een nieuwe bash kent hij node niet	, 
[eric@almond Logs]$ node -v
bash: node: command not found...
[eric@almond Logs]$ nvm use 5.5
Now using node v5.5.0 (npm v3.3.12)
[eric@almond Logs]$ node -v
v5.5.0
[eric@almond Logs]$ npm --version
3.3.12


/ we kunnen ook in 1 keer in nieuwe bash	,
[eric@almond Logs]$ nvm run 5.5
Running node v5.5.0 (npm v3.3.12)
> 

https://www.joyent.com/noderoad/videos
/ videos 	, 

/ 7	.

/ Ryan Dahl's video	,
https://www.youtube.com/watch?v=jo_B4LTHi3I

[eric@almond ryan_dahl]$ pwd
/home/eric/Devel/Node/videos/ryan_dahl

[eric@almond ryan_dahl]$ nvm use 5.5
Now using node v5.5.0 (npm v3.3.12)
[eric@almond ryan_dahl]$ node -v
v5.5.0

eric@almond ryan_dahl]$ node
> 1+2
3

> function add(a,b){
... return a+b
... }
undefined
> add(7,13)
20
> var min=function(a,b){
... return a-b
... }
undefined
> min(7,13)
-6

> var cl=(function(x){
...         return function(y){
.....                 return x*y
.....         }
...         }(7))
undefined
> cl(13)
91

/ cl, de inner fct dus,	 sluit over x	, sluit x in	,

/ process is als window in DOM	,
> process.env
{ NVM_RC_VERSION: '',
...

/ 13	. 

[eric@almond ryan_dahl]$ cat hello-world.js 
setTimeout(function(){
	console.log("world")
},2000)
console.log("hello")
[eric@almond ryan_dahl]$ node hello-world.js 
hello
world
[eric@almond ryan_dahl]$ 


/ setTimeout idles	, not sleeping	, 
/ sleeping is constant looping to see if 2 seconds are passed	,

 /13	. 


/ in php
echo("hello")
sleep(2)
echo("world")

/ hier is sleep niet idle	, maar spins	,

/ 13	. 

/ als een program niets meer te doen heeft, stopt node er mee	,
/ zoals boven bij hello-world	,

[eric@almond ryan_dahl]$ cat hello-world2.js 
setInterval(function(){
	console.log("world")
},2000)
console.log("hello")
[eric@almond ryan_dahl]$ node hello-world2.js 
hello
world
world
...
/ programma stopt niet	, heeft steeds nog wat te doen	,

/ 13	. 

[eric@almond ryan_dahl]$ cat web-server.js 
var http=require("http")
var s=http.createServer(function(req,res){
	res.writeHead(200,{"content-type":"plain/text"})
	res.write("hello\n")
	setTimeout(function(){
		res.end("world\n")
	},2000)
})
s.listen(8000)

/ als we 
		res.write("world\n")
/ dan stopt web-server nooit	, en gaat de ab test hieronder fout	, 


/ in bash	,
[eric@almond ryan_dahl]$ node web-server.js 

/ in andere bash	,
eric@almond ryan_dahl]$ curl -i http://localhost:8000
HTTP/1.1 200 OK
content-type: plain/text
Date: Wed, 03 Feb 2016 17:14:33 GMT
Connection: keep-alive
Transfer-Encoding: chunked			/ to send variable length response	,

hello
world
[eric@almond ryan_dahl]$ 

/ we moeten \n geven bij de res.write, dus res.write("hello\n")	, 
/ anders zien we hello pas na 2 seconden	,

/ we hadden ipv Transfer-Encoding: chuncked, ook : content-length: 12 , maar dat kan niet altijd	,  als je de header write, weet je bij een db query bijvoorbeeld niet wat er in de body komen gaat	,  

[eric@almond ryan_dahl]$ ab -n 100 -c 100 http://localhost:8000/
Server Software:        
Server Hostname:        localhost
Server Port:            8000

Document Path:          /
Document Length:        12 bytes

Concurrency Level:      100
Time taken for tests:   2.051 seconds
Complete requests:      100

/ inderdaad	, concurrent	,

/ 13	. 

  

 




/ Einde NODE NVM

/ DOCKER POSTGRES

/ 7	. 

/ Dockerfile training/postgres
...
RUN echo "host    all             all             0.0.0.0/0 trust" >> /etc/postgresql/$PG_VERSION/main/pg_hba.conf

/ Deze is ook NIET OK	, want psql uses ::1	,  

/ Deze is NIET OK	, want in pg_hba.conf staat al host entries 	, boven deze	, en daardoor wordt die uit de Dockerfile NIET gepakt	,


/ In een tty ,

[eric@almond misc]$ docker run --rm --net my-bridge-2 --name db training/postgres
2016-07-23 06:45:54 UTC LOG:  database system was interrupted; last known up at 2014-06-02 23:51:25 UTC
2016-07-23 06:45:54 UTC LOG:  database system was not properly shut down; automatic recovery in progress
2016-07-23 06:45:54 UTC LOG:  redo starts at 0/1782F38
2016-07-23 06:45:54 UTC LOG:  record with zero length at 0/17835C8
2016-07-23 06:45:54 UTC LOG:  redo done at 0/1783598
2016-07-23 06:45:54 UTC LOG:  last completed transaction was at log time 2014-06-02 23:51:25.978993+00
2016-07-23 06:45:54 UTC LOG:  database system is ready to accept connections
2016-07-23 06:45:54 UTC LOG:  autovacuum launcher started

/ In een andere tty	,

[eric@almond misc]$ docker exec -it db bash
root@ab39e1a75370:/# ps ajx
 PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND
    0     1     1     1 ?           -1 Ss       0   0:00 su postgres -c /usr/lib/postgresql/$PG_VERSION/bin/pos
    1     9     9     9 ?           -1 Ss     102   0:00 /usr/lib/postgresql/9.3/bin/postgres -D /var/lib/postg
    9    11    11    11 ?           -1 Ss     102   0:00 postgres: checkpointer process                        
    9    12    12    12 ?           -1 Ss     102   0:00 postgres: writer process                              
    9    13    13    13 ?           -1 Ss     102   0:00 postgres: wal writer process                          
    9    14    14    14 ?           -1 Ss     102   0:00 postgres: autovacuum launcher process                 
    9    15    15    15 ?           -1 Ss     102   0:00 postgres: stats collector process                     
    0    16    16    16 ?           26 Ss       0   0:00 bash
   16    26    26    16 ?           26 R+       0   0:00 ps ajx

root@9c321dbf1f8d:/# su - postgres     

postgres@9c321dbf1f8d:~$ vi /etc/postgresql/9.3/main/pg_hba.conf
# IPv4 local connections:
host    all             all             127.0.0.1/32            md5
# IPv6 local connections:
#host    all             all             ::1/128                 md5		<- #

host    all             all             0.0.0.0/0 trust
host    all             all             ::1/128 trust				<- new

/ De 1ste host line doet er niet toe	, want psql uses ::1	,

postgres@1c8deae40de2:/$ /usr/lib/postgresql/9.3/bin/pg_ctl reload -D /var/lib/postgresql/9.3/main 
server signaled

postgres@9c321dbf1f8d:~$ psql -U postgres -h localhost                                            
/ of	,
postgres@9c321dbf1f8d:~$ psql -U postgres
psql (9.3.4)
SSL connection (cipher: DHE-RSA-AES256-SHA, bits: 256)
Type "help" for help.

postgres=# \dt
No relations found.
postgres=# \q

/ 13	. 

stgres@be3a7de34706:~$ /usr/lib/postgresql/9.3/bin/initdb -D /var/lib/postgresql/9.3/main  -U postgres

The files belonging to this database system will be owned by user "postgres".
This user must also own the server process.

The database cluster will be initialized with locale "C".
The default database encoding has accordingly been set to "SQL_ASCII".
The default text search configuration will be set to "english".

Data page checksums are disabled.

initdb: directory "/var/lib/postgresql/9.3/main" exists but is not empty
If you want to create a new database system, either remove or empty
the directory "/var/lib/postgresql/9.3/main" or run initdb
with an argument other than "/var/lib/postgresql/9.3/main".

/ we zien dat initdb al heeft run	, 
/ TODO
/ we zien SQL_ASCII	, 
/ TODO
/ we zien locale "C"
/ TODO

/ 13	. 

/ op laptop 3 consoles	,
[eric@almond misc]$ docker run --rm --net my-bridge-2 --name db training/postgres

[eric@almond Docker2]$ docker exec -it training/postgres bash
root@be3a7de34706:/# su - postgres
postgres@be3a7de34706:~$ psql -U postgres
postgres=# 

[eric@almond Docker2]$ docker exec -it training/postgres bash

/ we zien	,

postgres@be3a7de34706:~$  ps aux --width 2000
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root         1  0.0  0.0  46636  2644 ?        Ss   07:51   0:00 su postgres -c /usr/lib/postgresql/$PG_VERSION/bin/postgres -D /var/lib/postgresql/$PG_VERSION/main/ -c config_file=/etc/postgresql/$PG_VERSION/main/postgresql.conf
postgres     8  0.0  0.1 244864 20376 ?        Ss   07:51   0:00 /usr/lib/postgresql/9.3/bin/postgres -D /var/lib/postgresql/9.3/main/ -c config_file=/etc/postgresql/9.3/main/postgresql.conf
postgres    10  0.0  0.0 244864  3280 ?        Ss   07:51   0:00 postgres: checkpointer process                                                                                               
postgres    11  0.0  0.0 244864  4652 ?        Ss   07:51   0:00 postgres: writer process                                                                                                     
postgres    12  0.0  0.0 244864  3280 ?        Ss   07:51   0:00 postgres: wal writer process                                                                                                 
postgres    13  0.0  0.0 245712  6072 ?        Ss   07:51   0:00 postgres: autovacuum launcher process                                                                                        
postgres    14  0.0  0.0 100540  3592 ?        Ss   07:51   0:00 postgres: stats collector process                                                                                            
root        15  0.0  0.0  18144  3256 ?        Ss   07:51   0:00 bash
root        25  0.0  0.0  46636  2668 ?        S    07:51   0:00 su - postgres
postgres    26  0.0  0.0  18152  3228 ?        S    07:51   0:00 -su
root        36  0.0  0.0  18144  3264 ?        Ss   07:58   0:00 bash
postgres    74  0.0  0.0  97356  6248 ?        S+   08:11   0:00 /usr/lib/postgresql/9.3/bin/psql -U postgres
postgres    82  0.0  0.0 252312  9416 ?        Ss   08:11   0:00 postgres: postgres postgres [local] idle                                                                                     
root        84  0.0  0.0  46636  2596 ?        S    08:13   0:00 su - postgres
postgres    85  0.0  0.0  18152  3372 ?        S    08:13   0:00 -su
postgres   100  0.0  0.0  15576  2148 ?        R+   08:19   0:00 ps aux --width 2000

///////////////////////////////////////////////////
/ Dus dit is de server	,
/usr/lib/postgresql/9.3/bin/postgres -D /var/lib/postgresql/9.3/main/ -c config_file=/etc/postgresql/9.3/main/postgresql.conf

/ en dit is een client	,
/usr/lib/postgresql/9.3/bin/psql -U postgres

/ PGDATA is NIET set	, maar zou zijn /var/lib/postgresql/9.3/main/	, want daar is postmaster.pid	,


/ 7	. 

/ Lees
https://wiki.postgresql.org/wiki/First_steps
https://wiki.postgresql.org/wiki/YUM_Installation

/ Lees	,
https://www.postgresql.org/download/
Binary packages
	Redhat family
https://www.postgresql.org/download/linux/redhat/
Included in distribution
/of	,
PostgreSQL Yum Repository
/ click repository RPM listing
/ Install deze rpm	, en doe wat er daarna staat	,

/ lees	,
https://fedoraproject.org/wiki/PostgreSQL

/ Lees	,
https://github.com/fedora-cloud/Fedora-Dockerfiles/blob/master/postgresql





/ 13	. 

/ we doen 	,
https://fedoraproject.org/wiki/PostgreSQL

[eric@almond misc]$ docker pull fedora
Using default tag: latest
latest: Pulling from library/fedora
7c91a140e7a1: Pull complete 
Digest: sha256:a97914edb6ba15deb5c5acf87bd6bd5b6b0408c96f48a5cbd450b5b04509bb7d
Status: Downloaded newer image for fedora:latest

[eric@almond misc]$ docker pull centos
Using default tag: latest
latest: Pulling from library/centos
8c3d77a518cb: Pull complete 
Digest: sha256:7b754086d2c7d74ac39dc0a2545d7b06d4266f873d502feb5b3e8bfca27c5dd8
Status: Downloaded newer image for centos:latest

[eric@almond misc]$ docker run --rm --name db -it fedora  bash

[root@9d61e486652a /]# dnf list postgres*
Available Packages
postgresql.x86_64                                              9.5.3-1.fc24                              fedora
postgresql-contrib.x86_64                                      9.5.3-1.fc24                              fedora
postgresql-dbi-link.noarch                                     2.0.0-13.fc24                             fedora
postgresql-devel.i686                                          9.5.3-1.fc24                              fedora
postgresql-devel.x86_64                                        9.5.3-1.fc24                              fedora
postgresql-docs.x86_64                                         9.5.3-1.fc24                              fedora
postgresql-ip4r.x86_64                                         2.0.2-9.fc24                              fedora
postgresql-jdbc.noarch                                         9.4.1200-3.fc24                           fedora
postgresql-jdbc-javadoc.noarch                                 9.4.1200-3.fc24                           fedora
postgresql-libs.i686                                           9.5.3-1.fc24                              fedora
postgresql-libs.x86_64                                         9.5.3-1.fc24                              fedora
postgresql-odbc.x86_64                                         09.05.0100-2.fc24                         fedora
postgresql-odbc-tests.x86_64                                   09.05.0100-2.fc24                         fedora
postgresql-pgpool-II.i686                                      3.5.2-1.fc24                              fedora
postgresql-pgpool-II.x86_64                                    3.5.2-1.fc24                              fedora
postgresql-pgpool-II-devel.i686                                3.5.2-1.fc24                              fedora
postgresql-pgpool-II-devel.x86_64                              3.5.2-1.fc24                              fedora
postgresql-pgpool-II-extensions.x86_64                         3.5.2-1.fc24                              fedora
postgresql-pgpoolAdmin.noarch                                  3.4.0-3.fc24                              fedora
postgresql-plperl.x86_64                                       9.5.3-1.fc24                              fedora
postgresql-plpython.x86_64                                     9.5.3-1.fc24                              fedora
postgresql-plpython3.x86_64                                    9.5.3-1.fc24                              fedora
postgresql-plruby.x86_64                                       0.5.4-9.fc24                              fedora
postgresql-plruby-doc.x86_64                                   0.5.4-9.fc24                              fedora
postgresql-pltcl.x86_64                                        9.5.3-1.fc24                              fedora
postgresql-server.x86_64                                       9.5.3-1.fc24                              fedora
postgresql-static.i686                                         9.5.3-1.fc24                              fedora
postgresql-static.x86_64                                       9.5.3-1.fc24                              fedora
postgresql-test.x86_64                                         9.5.3-1.fc24                              fedora
postgresql-upgrade.x86_64                                      9.5.3-1.fc24                              fedora
postgresql_autodoc.noarch                                      1.41-6.fc24                               fedora

[root@9d61e486652a /]#  dnf install postgresql-server postgresql-contrib
Last metadata expiration check: 0:02:23 ago on Sat Jul 23 11:46:53 2016.
Dependencies resolved.
===============================================================================================================
 Package                          Arch                 Version                      Repository            Size
===============================================================================================================
Installing:
 libxslt                          x86_64               1.1.28-12.fc24               fedora               247 k
 postgresql                       x86_64               9.5.3-1.fc24                 fedora               1.3 M
 postgresql-contrib               x86_64               9.5.3-1.fc24                 fedora               654 k
 postgresql-libs                  x86_64               9.5.3-1.fc24                 fedora               246 k
 postgresql-server                x86_64               9.5.3-1.fc24                 fedora               4.4 M
 uuid                             x86_64               1.6.2-32.fc24                fedora                61 k


/ In andere console,	
[eric@almond misc]$ docker ps 
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
9d61e486652a        fedora              "bash"              21 minutes ago      Up 21 minutes                           db
[eric@almond misc]$ docker commit -m "added postgres" -a "Eric J." 9d61e486652a my/fedora_postgres
sha256:22030b78875dbdde797a8e419b6b2316f1b2b19c46f02bdf1e5fa1e6f6ee4893

[eric@almond misc]$ docker run --rm --name db -it my/fedora_postgres bash

/ we zien NIET 
# dnf repoquery
/ TODO
/ we zien NIET 
# rpm -q
/ TODO

[root@4513a34660b8 /]# dnf -y install 'dnf-command(repoquery)'
/ OK
[root@4513a34660b8 /]#  dnf repoquery -l postgresql-server
/var/lib/pgsql/data
/etc/pam.d/postgresql 		/ TODO
/usr/bin/initdb
/usr/bin/pg_ctl
/usr/bin/postgres		/ server !
/usr/bin/postgresql-setup	/ NIET voor in docker container	,

[root@4513a34660b8 /]#  dnf repoquery -l postgresql-libs  
/usr/lib/libpq.so.5

[root@4513a34660b8 /]#  dnf repoquery -l postgresql-contrib
...

[root@4513a34660b8 /]#  dnf repoquery -l postgresql
/usr/bin/pg_dump
/usr/bin/pg_dumpall
/usr/bin/pg_restore
/usr/bin/pg_upgrade
/usr/bin/psql
...

root@4513a34660b8 /]#  ls -l /var/lib/
total 40
drwxr-xr-x. 4 root     root     4096 Jul 30 19:41 dnf
drwx------. 4 postgres postgres 4096 Jul 23 11:49 pgsql

[root@4513a34660b8 /]#  ls -l /var/lib/pgsql/
total 8
drwx------. 2 postgres postgres 4096 May 12 13:33 backups
drwx------. 2 postgres postgres 4096 May 12 13:33 data

/ In andere tty	,
[eric@almond docs]$ docker ps 
CONTAINER ID        IMAGE                COMMAND                  CREATED             STATUS              PORTS               NAMES
4513a34660b8        my/fedora_postgres   "bash"                   36 minutes ago      Up 36 minutes                           db
[eric@almond docs]$ docker commit -m "added: dnf repoquery" -a "Eric J." 4513a34660b8        my/fedora_postgres
sha256:b4c901a545e1e8a298be41aaa6f70a01918da9d33eec75be75d0f2d9dfbff383

/ docker heeft 4513a34660b8  my/fedora_postgres nodig	,  want dat is de container, waaruit nieuw image wordt create	,

/ start opnieuw	,
[root@4513a34660b8 /]# exit
exit
[eric@almond docs]$ docker run --rm --name db -it my/fedora_postgres bash
[root@a3def043026d /]# dnf repoquery -l postgresql-server
/ OK


/ 7	. 

/ Lees initdb	,
https://www.postgresql.org/docs/9.3/static/app-initdb.html

/ Lees	,
https://wiki.postgresql.org/wiki/First_steps

/ Lees	,
https://www.postgresql.org/docs/9.1/static/creating-cluster.html

/ 7	. 

[root@847bb912ba10 /]# dnf -y install passwd
  Installing  : libuser-0.62-3.fc24.x86_64                                                                 1/2 
  Installing  : passwd-0.79-8.fc24.x86_64                                                                  2/2 

[root@847bb912ba10 /]# dnf -y install less vim

[root@847bb912ba10 /]# adduser eric
[root@847bb912ba10 /]# passwd eric
Changing password for user eric.
New password: 
Retype new password: 

[root@847bb912ba10 /]# dnf -y install sudo
/ voor visudo

[eric@almond docs]$ docker commit -m "installed sudo passwd less vim" -a "Eric J." 847bb912ba10        my/fedora_postgres

[root@b608aaac4c18 /]# exit
exit
[eric@almond docs]$ docker run --rm --name db -it my/fedora_postgres bash

[root@df24a7dc174b ~]#  visudo

## Allows people in group wheel to run all commands
%wheel  ALL=(ALL)       ALL

## Same thing without a password
%wheel  ALL=(ALL)       NOPASSWD: ALL


[root@df24a7dc174b /]# usermod -a -G wheel eric
[root@df24a7dc174b /]# su - eric
Last login: Sun Jul 31 06:33:55 UTC 2016 on console
[eric@df24a7dc174b ~]$ sudo su -
[root@df24a7dc174b ~]# 					/ OK	,
visudo: /etc/sudoers.tmp unchanged
[root@df24a7dc174b ~]# exit
logout
[eric@df24a7dc174b ~]$ exit
logout

[root@df24a7dc174b /]# mkdir /home/eric/pgsql
[root@df24a7dc174b /]# chown postgres /home/eric/pgsql/

/ we zitten in het typische geval van een home dir	, 
[root@df24a7dc174b /]# chmod o+rx /home/eric/
[root@df24a7dc174b /]# su - postgres
bash-4.3$ pwd
/var/lib/pgsql

/ in andere tty	,
[eric@almond docs]$ docker commit -m "added: /home/eric/psql" -a "Eric J." df24a7dc174b       my/fedora_postgres

/ en in huidige container	,
-bash-4.3$ exit
logout
[root@df24a7dc174b /]# exit
exit
[eric@almond docs]$ docker run --rm --name db -it my/fedora_postgres bash



[root@bc8b2a246191 /]# su postgres
bash-4.3$ 

 










/ 7	. 


# dnf -y install which findutils sudo  


[root@e0a28d54f476 /]# su - postgres
-bash-4.3$ which pg_ctl
/usr/bin/pg_ctl

-bash-4.3$  cat /var/lib/pgsql/.bash_profile 
[ -f /etc/profile ] && source /etc/profile

PGDATA=/var/lib/pgsql/data
export PGDATA

-bash-4.3$ echo $PGDATA
/var/lib/pgsql/data

/ we willen dat postgres sudo kan doen	,
[root@e0a28d54f476 /]#  usermod -a -G wheel postgres
[root@e0a28d54f476 /]# visudo
%wheel  ALL=(ALL)       NOPASSWD: ALL
/ TODO
/ Je moet opnieuw inlog		, 
/ TODO

[root@daaceabd050d /]# find / -name pg_hba.conf
/ Is er NIET	, 
-bash-4.3$ postgresql-setup --initdb
FATAL: /usr/bin/postgresql-setup requires root access for this action

[root@daaceabd050d /]# bash --debugger /usr/bin/postgresql-setup ""         
bashdb<4> set args --initdb
bashdb<6> pr $0
/usr/bin/postgresql-setup







 


/ 7	. 

/ Lees	,
/ Dockerize PostgreSQL
https://docs.docker.com/v1.11/engine/examples/postgresql_service/

[eric@almond docs]$ pwd
/home/eric/Devel/Docker2/postgres/docs

/ 7	. 






/ Einde DOCKER POSTGRES

/ DOCKER LOCALE

/ In docker container	,
[root@bc8b2a246191 /]# cat /etc/locale.conf 
LANG="en_US.UTF-8"
/ Deze is WH voor localectl	, maar hier heb je systemd voor nodig	,

/ Op laptop	,
[eric@almond Mars]$ sudo localectl status
   System Locale: LANG=en_US.UTF-8
       VC Keymap: us
      X11 Layout: us

/ In container	,
[root@bc8b2a246191 /]# localectl status
Failed to create bus connection: No such file or directory

/ Lees	,
https://docs.fedoraproject.org/en-US/Fedora/22/html/System_Administrators_Guide/ch-System_Locale_and_Keyboard_Configuration.html
LANG	Provides a default value for the system locale.
LC_COLLATE	Changes the behavior of functions which compare strings in the local alphabet.
LC_CTYPE	Changes the behavior of the character handling and classification functions and the multibyte character functions.
LC_NUMERIC	Describes the way numbers are usually printed, with details such as decimal point versus decimal comma.
LC_TIME	Changes the display of the current time, 24-hour versus 12-hour clock.
LC_MESSAGES	Determines the locale used for diagnostic messages written to the standard error output.

/ In container	, 
# vim /tmp/1.txt

/ Lukt	, maar  lukt NIET	, 
/ Ook	, 
[root@bc8b2a246191 /]# cat /tmp/1.txt   
/ Lukt NIET	,

/ Lees	,
http://jaredmarkell.com/docker-and-locales/

/ Op laptop	,

[eric@almond Mars]$ sudo locale
LANG=en_US.UTF-8
LC_CTYPE="en_US.UTF-8"
LC_NUMERIC="en_US.UTF-8"
LC_TIME="en_US.UTF-8"
LC_COLLATE="en_US.UTF-8"
LC_MONETARY="en_US.UTF-8"
LC_MESSAGES="en_US.UTF-8"
LC_PAPER="en_US.UTF-8"
LC_NAME="en_US.UTF-8"
LC_ADDRESS="en_US.UTF-8"
LC_TELEPHONE="en_US.UTF-8"
LC_MEASUREMENT="en_US.UTF-8"
LC_IDENTIFICATION="en_US.UTF-8"
LC_ALL=


/ In container	,
[root@bc8b2a246191 /]# locale
LANG=
LC_CTYPE="POSIX"
LC_NUMERIC="POSIX"
LC_TIME="POSIX"
LC_COLLATE="POSIX"
LC_MONETARY="POSIX"
LC_MESSAGES="POSIX"
LC_PAPER="POSIX"
LC_NAME="POSIX"
LC_ADDRESS="POSIX"
LC_TELEPHONE="POSIX"
LC_MEASUREMENT="POSIX"
LC_IDENTIFICATION="POSIX"
LC_ALL=

/ 13	. 

/ Lees	,
http://unix.stackexchange.com/questions/140299/locale-gen-command-in-centos6

/ ubuntu: locale-gen	, 
/ fedora: localedef		,

/ op laptop	,
[eric@almond Mars]$ sudo locale -a
aa_DJ
aa_DJ.iso88591
aa_DJ.utf8
...
[eric@almond Mars]$ sudo locale -a | grep en_US
en_US
en_US.iso88591
en_US.iso885915
en_US.utf8
[eric@almond Mars]$ sudo locale -a | awk '{c++}END{print c}'
817

/ in container	,
[root@bc8b2a246191 /]# locale -a
C
C.utf8
POSIX
/ Dat is alles	,

/ op laptop	,
[eric@almond Mars]$ sudo env |grep LANG
LANG=en_US.UTF-8
[eric@almond Mars]$ sudo env |grep LC
/ NIETS
/ TODO

/ Lees	,
http://www.linuxquestions.org/questions/fedora-35/c-locale-and-system-locale-304562/
/ C is english	, 

$ env LC_ALL=en_US ls /usr
/ TODO

/ we doen in container	,
[root@bc8b2a246191 /]# localedef -v -i en_US -f UTF-8 en_US.UTF-8
character map file `UTF-8' not found: No such file or directory
default character map file `ANSI_X3.4-1968' not found: No such file or directory


/ 7	. 

[eric@almond Mars]$ docker run --rm --name ub -it ubuntu bash
root@4d4e17a61dca:/# locale -a
C
C.UTF-8
POSIX

root@4d4e17a61dca:/# locale-gen en_US.UTF-8
Generating locales (this might take a while)...
  en_US.UTF-8... done
Generation complete.
root@4d4e17a61dca:/# locale -a
C
C.UTF-8
POSIX
en_US.utf8

root@4d4e17a61dca:/# apt-get install vim
Reading package lists... Done
Building dependency tree       
Reading state information... Done
E: Unable to locate package vim
/ TODO
root@4d4e17a61dca:/# apt-get update
Get:1 http://archive.ubuntu.com/ubuntu xenial InRelease [247 kB]
Get:2 http://archive.ubuntu.com/ubuntu xenial-updates InRelease [95.7 kB]
Get:3 http://archive.ubuntu.com/ubuntu xenial-security InRelease [94.5 kB]
Get:4 http://archive.ubuntu.com/ubuntu xenial/main Sources [1103 kB]
Get:5 http://archive.ubuntu.com/ubuntu xenial/restricted Sources [5179 B]
Get:6 http://archive.ubuntu.com/ubuntu xenial/universe Sources [9802 kB]
Get:7 http://archive.ubuntu.com/ubuntu xenial/main amd64 Packages [1558 kB]                                   
Get:8 http://archive.ubuntu.com/ubuntu xenial/restricted amd64 Packages [14.1 kB]                             
Get:9 http://archive.ubuntu.com/ubuntu xenial/universe amd64 Packages [9827 kB]                               
Get:10 http://archive.ubuntu.com/ubuntu xenial-updates/main Sources [212 kB]                                  
Get:11 http://archive.ubuntu.com/ubuntu xenial-updates/universe Sources [106 kB]                              
Get:12 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 Packages [417 kB]                           
Get:13 http://archive.ubuntu.com/ubuntu xenial-updates/universe amd64 Packages [374 kB]                       
Get:14 http://archive.ubuntu.com/ubuntu xenial-security/main Sources [39.2 kB]                                
Get:15 http://archive.ubuntu.com/ubuntu xenial-security/universe Sources [9617 B]                             
Get:16 http://archive.ubuntu.com/ubuntu xenial-security/main amd64 Packages [152 kB]                          
Get:17 http://archive.ubuntu.com/ubuntu xenial-security/universe amd64 Packages [42.9 kB]                     
/ Dit moeten we eerst doen	, 
/ TODO
root@4d4e17a61dca:/# apt-get install vim
The following additional packages will be installed:
  file libexpat1 libgpm2 libmagic1 libmpdec2 libpython3.5 libpython3.5-minimal libpython3.5-stdlib
  libsqlite3-0 libssl1.0.0 mime-support vim-common vim-runtime

root@4d4e17a61dca:/# dpkg-reconfigure locales
/ helpt NIET	,

/ In andere tty	,
[eric@almond Mars]$ docker commit -m "added: LANG=en_US.UTF-8, installed vim" -a "Eric J." 4d4e17a61dca my/ubuntu

root@4d4e17a61dca:/# exit
exit
[eric@almond Mars]$ docker run --rm --name ub -it my/ubuntu bash

/ 7	. 

/ Lees	,
http://jaredmarkell.com/docker-and-locales/
[eric@almond locale]$ pwd
/home/eric/Devel/Docker2/ubuntu/locale
[eric@almond locale]$ cat Dockerfile 
from ubuntu
run apt-get update && apt-get -y install vim
run locale-gen en_US.UTF-8
env LANG en_US.UTF-8
env LC_ALL en_US.UTF-8

[eric@almond locale]$ docker build -t my/ubuntu .
The following NEW packages will be installed:
  file libexpat1 libgpm2 libmagic1 libmpdec2 libpython3.5 libpython3.5-minimal
  libpython3.5-stdlib libsqlite3-0 libssl1.0.0 mime-support vim vim-common
  vim-runtime
debconf: delaying package configuration, since apt-utils is not installed
/ TODO
update-alternatives: using /usr/bin/vim.basic to provide /usr/bin/vim (vim) in auto mode
/ TODO
Processing triggers for libc-bin (2.23-0ubuntu3) ...
 ---> 3f5c5832be73
Removing intermediate container 3ff6c2a90598
Step 3 : RUN locale-gen en_US.UTF-8
 ---> Running in 950b336fd471
Generating locales (this might take a while)...
  en_US.UTF-8... done
Generation complete.
 ---> fef6dbbfd562
Removing intermediate container 950b336fd471
Step 4 : ENV LANG en_US.UTF-8
 ---> Running in aedb6910157d
 ---> e569fda63891
Removing intermediate container aedb6910157d
Step 5 : ENV LC_ALL en_US.UTF-8
 ---> Running in 275075285bd7
 ---> 6a32cac2935d
Removing intermediate container 275075285bd7
Successfully built 6a32cac2935d

root@a5c560697a51:/# locale
LANG=en_US.UTF-8
LANGUAGE=
LC_CTYPE="en_US.UTF-8"
LC_NUMERIC="en_US.UTF-8"
LC_TIME="en_US.UTF-8"
LC_COLLATE="en_US.UTF-8"
LC_MONETARY="en_US.UTF-8"
LC_MESSAGES="en_US.UTF-8"
LC_PAPER="en_US.UTF-8"
LC_NAME="en_US.UTF-8"
LC_ADDRESS="en_US.UTF-8"
LC_TELEPHONE="en_US.UTF-8"
LC_MEASUREMENT="en_US.UTF-8"
LC_IDENTIFICATION="en_US.UTF-8"
LC_ALL=en_US.UTF-8

root@a5c560697a51:/# env
LANG=en_US.UTF-8
/ Nu WEL	, zonder env in Dockerfile was deze er helemaal NIET	, 
/ TODO

root@a5c560697a51:/# cat /etc/default/locale
#  File generated by update-locale
/ NIETS gebeurd	,
/ Maar dit is WH voor localectl	, met systemd	,

root@a5c560697a51:/# locale -a
C
C.UTF-8
en_US.utf8
POSIX

root@a5c560697a51:/# vi /tmp/1.txt 

root@a5c560697a51:/# cat /tmp/1.txt 

/ Dit lukt nu	,

/ 7	 

/ Lees	, 
https://gist.github.com/naoya/5821987

RUN yum install -y passwd
RUN useradd naoya
RUN passwd -f -u naoya
RUN echo "naoya    ALL=(ALL)       ALL" >> /etc/sudoers.d/naoya


/ Lees	,
https://github.com/tutumcloud/mongodb/blob/master/3.2/Dockerfile

/ Lees	, 
http://askubuntu.com/questions/420784/what-do-the-disabled-login-and-gecos-options-of-adduser-command-stand

/ Intermezzo


eric@almond my]$ docker run --rm --name db -it my/fedora_postgres bash
[root@cd67a9a68227 /]# useradd saskia
[root@cd67a9a68227 /]# chmod o+rwx /home/saskia/
[root@cd67a9a68227 /]# su - postgres
Last login: Sun Jul 31 11:52:48 UTC 2016 on console
-bash-4.3$ mkdir /home/saskia/pgsql 
mkdir: cannot create directory '/home/saskia/pgsql': Permission denied
/ TODO
-bash-4.3$ exit
logout
[root@cd67a9a68227 /]# passwd -f -u saskia
Unlocking password for user saskia.
passwd: Success
[root@cd67a9a68227 /]# su - postgres
Last login: Sun Jul 31 11:53:22 UTC 2016 on console
-bash-4.3$ su - saskia
[saskia@cd67a9a68227 ~]$ exit
-bash-4.3$ mkdir /home/saskia/pgsql
-bash-4.3$ ls -l /home/saskia/
total 4
drwxr-xr-x. 2 postgres postgres 4096 Jul 31 12:08 pgsql


/ Einde Intermezzo

/ Intermezzo

/ we wilden	,
# visudo | awk ...
Vim: Warning: Output is not to a terminal
:q!

/ Lees	over 'vi output is not to a terminal',
http://stackoverflow.com/questions/1690274/how-do-i-launch-an-editor-from-a-shell-script 

/ Dit lukt wel	, 
[eric@2c308db0ceec ~]$ cat /etc/passwd | vim -


/ Einde Intermezzo

/ Intermezzo

/ Laat /etc/sudoers voor wat het is maar maak /etc/sudoers.d/wheel	 

/ we herstellen /etc/sudoers	,
[root@2c308db0ceec /]# visudo
[root@2c308db0ceec /]# su - eric
Last login: Sun Jul 31 17:01:36 UTC 2016 on console
[eric@2c308db0ceec ~]$ sudo su -
/ Vraagt om password	,
[eric@2c308db0ceec ~]$ exit
logout
[root@2c308db0ceec /]# visudo 
visudo: /etc/sudoers.tmp unchanged
[root@2c308db0ceec /]# echo "%wheel ALL=(ALL)       NOPASSWD: ALL"> /etc/sudoers.d/wheel
[root@2c308db0ceec /]# su - eric
Last login: Sun Jul 31 17:01:58 UTC 2016 on console
[eric@2c308db0ceec ~]$ sudo su -
Last login: Sun Jul 31 17:01:40 UTC 2016 on console
[root@2c308db0ceec ~]# exit					/ Dus lukt	,
logout


[root@15bea5e16523 /]# userdel -r eric
/ removes home dir + mail spool	,

/ 13	. 

/ Met # passwd -uf eric	, dan postgres zonder password login in home van eric	, en als eric dus write	,

[root@15bea5e16523 /]# userdel -r eric
[root@15bea5e16523 /]# useradd eric
[root@15bea5e16523 /]# su - postgres
Last login: Sun Jul 31 06:44:01 UTC 2016 on console
-bash-4.3$ su - eric
Password: 
/ Willen we niet	,
^c
-bash-4.3$ exit
logout
[root@15bea5e16523 /]# passwd -uf eric
Unlocking password for user eric.
passwd: Success
[root@15bea5e16523 /]# su - postgres
Last login: Sun Jul 31 17:50:52 UTC 2016 on console
-bash-4.3$ su - eric
[eric@15bea5e16523 ~]$ exit		/ OK
logout
-bash-4.3$ su - eric -c "mkdir pgsql"
-bash-4.3$ ls /home/eric/
ls: cannot open directory '/home/eric/': Permission denied	 / OK	, drwx------ /home/eric
-bash-4.3$ exit
logout
[root@15bea5e16523 /]# ls /home/eric/ -l
total 4
drwxrwxr-x. 2 eric eric 4096 Jul 31 17:55 pgsql		/ OK, maar NIET de bedoeling	,

/ we doen	,  postgres hoeft niet in te log als eric	, alleen schrijven naar die plaats	,

[root@dd6cbba73c77 /]# useradd eric
[root@dd6cbba73c77 /]# chmod o+rwx /home/eric/
[root@dd6cbba73c77 /]# su - postgres
Last login: Sun Jul 31 06:44:01 UTC 2016 on console
-bash-4.3$ mkdir /home/eric/pgsql
-bash-4.3$ chmod go-rx /home/eric/pgsql/



/ Met Google+ kunnen we inlog in ask fedora	,




/ Einde Intermezzo


/ 7	. 


/ Lees	,
https://fedoraproject.org/wiki/Changes/Glibc_locale_subpackaging
https://fedorahosted.org/spin-kickstarts/ticket/56

[root@19dfa7ee3596 /]# dnf -y install 'dnf-command(repoquery)'
[root@19dfa7ee3596 /]# dnf repoquery -l glibc-all-langpacks
[root@19dfa7ee3596 /]# dnf reinstall glibc-all-langpacks
[root@19dfa7ee3596 /]# head /usr/lib/locale/locale-archive
[root@19dfa7ee3596 /]# localedef -i en_US -c -f UTF-8 en_US.utf8
[root@19dfa7ee3596 /]# dnf install glibc-langpack-hi
[root@19dfa7ee3596 /]# locale -a

//////////////////////
/ we MOETEN install glibc-locale-source	, anders kunnen we NIET localedef  -i en_US -f UTF-8
[root@3ac469613a4a /]# dnf -y install 'dnf-command(repoquery)'
[root@3ac469613a4a /]# dnf install glibc-locale-source -y
[root@3ac469613a4a /]# localedef --no-archive -i en_US -f UTF-8 en_US.utf8@my
[root@3ac469613a4a /]# localedef  -i en_US -f UTF-8 en_US.utf8@my2
[root@3ac469613a4a /]# export LANG=en_US.utf8@my2
root@3ac469613a4a /]# ls /usr/lib/locale/
C.utf8  de_DE.utf8@myspecialgermanlocale  en_US.utf8@my  locale-archive  locale-archive.tmpl

//////////////////////////////

/we start container	,
[eric@almond locale]$ docker run --rm --name fd -it fedora bash
[root@d9cd63a10724 /]#  ls /usr/lib/locale/
C.utf8  locale-archive.tmpl

root@d9cd63a10724 /]# dnf list installed *glibc*
Installed Packages
glibc.x86_64                                          2.23.1-7.fc24                            @koji-override-0
glibc-all-langpacks.x86_64                            2.23.1-7.fc24                            @koji-override-0
glibc-common.x86_64                                   2.23.1-7.fc24                            @koji-override-0

/ we see that glibc-all-langpacks is installed, but there is NO /usr/lib/locale/locale-archive	,
/ SEE hieronder (*) 
/ 

/ FIX DOCKER FEDORA LOCALE

/ voor en_US.utf8 moeten we install glibc-langpack-en
/ in Dockerfile: env LANG en_US.utf8
/ om zelf een locale te maken, moeten we install glibc-locale-source

$ vi Dockerfile
from fedora
run ["dnf","-y","upgrade","--setopt=deltarpm=false"]
run ["dnf","-y","install","vim"]		/ to see if vim handles 	, for example	, 
run ["dnf","-y","install","glibc-langpack-en"]
env LANG en_US.UTF-8
# env LC_ALL en_US.UTF-8			/ TODO




[root@6a282d269671 /]# dnf -y install glibc-langpack-en
Installing:
 glibc-langpack-en                x86_64              2.23.1-8.fc24                 updates              275 k
Upgrading:
 glibc                            x86_64              2.23.1-8.fc24                 updates              3.6 M
 glibc-all-langpacks              x86_64              2.23.1-8.fc24                 updates              6.9 M
 glibc-common                     x86_64              2.23.1-8.fc24                 updates              861 k

[root@d9cd63a10724 /]#  ls /usr/lib/locale/
C.utf8      en_CA            en_GB.utf8  en_IN       en_SG            en_ZA.utf8
en_AG       en_CA.utf8       en_HK       en_NG       en_SG.utf8       en_ZM
en_AU       en_DK            en_HK.utf8  en_NZ       en_US            en_ZW
en_AU.utf8  en_DK.utf8       en_IE       en_NZ.utf8  en_US.iso885915  en_ZW.utf8
en_BW       en_GB            en_IE@euro  en_PH       en_US.utf8       locale-archive
en_BW.utf8  en_GB.iso885915  en_IE.utf8  en_PH.utf8  en_ZA            locale-archive.tmpl

[root@d9cd63a10724 /]# dnf -y install vim
# export LANG=en_US.utf8

/ In bash konden we al 	, ook al was LANG niet in # env	, 
/ TODO (Er is C.utf8 in  /usr/lib/locale	, 

/ 13	. 

/ Als we zelf een locale willen maken	, moeten we	,
[root@d9cd63a10724 /]# dnf -y install glibc-locale-source   

/ we kunnen dan	,
[root@d9cd63a10724 /]# localedef --no-archive -i en_US -f UTF-8 en_US.utf8@my.noarch
[root@d9cd63a10724 /]# localedef  -i en_US -f UTF-8 en_US.utf8@my.arch  
root@d9cd63a10724 /]#  ls /usr/lib/locale/
C.utf8      en_CA            en_GB.utf8  en_IN       en_SG                 en_ZA           locale-archive.tmpl
en_AG       en_CA.utf8       en_HK       en_NG       en_SG.utf8            en_ZA.utf8
en_AU       en_DK            en_HK.utf8  en_NZ       en_US                 en_ZM
en_AU.utf8  en_DK.utf8       en_IE       en_NZ.utf8  en_US.iso885915       en_ZW
en_BW       en_GB            en_IE@euro  en_PH       en_US.utf8            en_ZW.utf8
en_BW.utf8  en_GB.iso885915  en_IE.utf8  en_PH.utf8  en_US.utf8@my.noarch  locale-archive


/ 7	. 

/ Lees	,
https://fedorahosted.org/spin-kickstarts/ticket/56
https://bugzilla.redhat.com/show_bug.cgi?id=1343114

FROM fedora:23
RUN dnf upgrade -y
/usr/share/locale/de/LC_MESSAGES/elfutils.mo: No such file or directory
cannot reconstruct rpm from disk files
...

/ (*)
/ start een container , 
/ doe	,
[root@823675943b28 /]# dnf -y upgrade --setopt=deltarpm=false
/ in een andere tty	,
[eric@almond locale]$ docker commit -m "dnf -y upgrade --setopt=deltarpm=false" 823675943b28 fedora
/ Dit is OK, maar toch NIET doen	, want 
$ docker pull fedora zet hem weer terug op wat hij was	,

/ Maar daarom een Dockerfile	,
[eric@almond locale]$ pwd
/home/eric/Devel/Docker2/fedora/locale
from fedora
run dnf -y upgrade --setopt=deltarpm=false

[eric@almond locale]$ docker build -t my/fedora-locale .
Step 1 : FROM fedora
 ---> f9873d530588
Step 2 : RUN dnf -y upgrade --setopt=deltarpm=false
 ---> Running in 7ce30bf3cb82
Last metadata expiration check: 0:00:17 ago on Mon Aug  1 11:01:42 2016.
Dependencies resolved.
================================================================================
 Package                  Arch       Version                  Repository   Size
================================================================================
Installing:
 nss-pem                  x86_64     1.0.2-2.fc24             updates      76 k
Upgrading:
 audit-libs               x86_64     2.6.5-1.fc24             updates      96 k
...
Complete!
 ---> 77d60a583b96
Removing intermediate container 7ce30bf3cb82
Successfully built 77d60a583b96

eric@almond locale]$  docker run --rm --name fd-loc -it my/fedora-locale bash
[root@c57e4b76f0f0 /]# dnf -y upgrade --setopt=deltarpm=false
Last metadata expiration check: 0:05:22 ago on Mon Aug  1 11:01:42 2016.
Dependencies resolved.
Nothing to do.
Complete!

[root@230297e69fce /]# dnf -y install glibc-langpack-en
/ Nu hoeven we NIET meer te wachten	,

/ Als we doen	, 
$ docker pull fedora
/ dan geeft hij NIET aan dat er updates zijn	, hij doet dus niets	,
/ toch in container	, # dnf -y upgrade --setopt=deltarpm=false doet veel	, 
/ TODO
/ Het is bij ubuntu ook zo: 
$ docker pull fedora
/ Geen verandering	, is er al zegt hij	,
/ Maar dnf -y upgrade --setopt=deltarpm=false doet veel updates	, 
/ TODO

/ Einde FIX DOCKER FEDORA LOCALE

/ FIX DOCKER FEDORA LOCALE

/ Lees	, 
https://fedoraproject.org/wiki/Changes/Glibc_locale_subpackaging
Currently the file /usr/lib/locale/locale-archive contains all locales and is thus huge (103MB).

/ Als we de fedora image upgrade	, dan is /usr/lib/locale/locale-archive  er, en	,
[root@d153cd9822c0 /]# locale -a  | grep en_US.utf8
en_US.utf8

/ Voor vi hoeven we alleen	,
export LANG=en_US.utf8
/ of	,
export LC_ALL=en_US.utf8
/ TODO

/ we hoeven  NIET	,
run ["dnf","-y","install","glibc-langpack-en"]



/ Einde FIX DOCKER FEDORA LOCALE


/ Einde DOCKER LOCALE

/ DOCKER

/ 7	. 

[eric@almond postgres]$ docker images --filter dangling=true   | awk 'NR>1{print $3}' | xargs -I % docker rmi %
/ <none>'s	,

/ of	, 
/ Lees	,
https://forums.docker.com/t/how-to-delete-cache/5753/2
alias docker_clean_images='docker rmi $(docker images -a --filter=dangling=true -q)'
alias docker_clean_ps='docker rm $(docker ps --filter=status=exited --filter=status=created -q)'

docker kill $(docker ps -q)
docker_clean_ps
docker rmi $(docker images -a -q)

/ 7	. 

/ rename image	,

[eric@almond postgres]$ docker images | awk '/postgres/'
my/postgres             latest              77d60a583b96        2 hours ago         607.9 MB
my/fedora_postgres      latest              e433e7bd0549        19 hours ago        515.6 MB
mytraining/postgres     latest              0d0c2955f2d6        7 months ago        335.6 MB
postgres                latest              eebef0752804        8 months ago        265.1 MB
training/postgres       latest              6fa973bb3c26        2 years ago         364.6 MB

/ we willen my/fedora_postgres rmi	, en my/postgres my/fedora_postgres noemen	,


[eric@almond postgres]$ docker rmi my/fedora_postgres
Untagged: my/fedora_postgres:latest
Deleted: sha256:e433e7bd05491dcb356234220d135923453fd97649e4b9a201324b74f74a9bee
Deleted: sha256:fad97ad399d5ba53b915497b405dc9d024ab8f20bc2391e644a886e00e41d561
Deleted: sha256:41ab67e6763733bb3f57ce7c01311e79ac17d4b25933b6979d8293ff86df07c6
Deleted: sha256:f2a9e2bc8e75912460cee885ecfbab39ad52333969a869d63c96b329223de540
Deleted: sha256:fb06dd9508ae031ad8c3d00b371cc3f7a3df2f14f596d6b8f0ea15225a60c432
Deleted: sha256:920e1fbc4ce5915c24c0c7728ba838ab7644e022dbbb890288179cdb99310e3a
Deleted: sha256:7b40056146623141b1fb33223a5caf475d293ce38963d2a5f7bdd1b0d8fbb02c
Deleted: sha256:9035605f4383805f0860f3781c48df11e216896d14973e925fcc23c4a12c041e
Deleted: sha256:b4c901a545e1e8a298be41aaa6f70a01918da9d33eec75be75d0f2d9dfbff383
Deleted: sha256:48791832d8b2af56b1f6aba17e2d7b9a92a248925e94592dcabff808dcceacc8
Deleted: sha256:22030b78875dbdde797a8e419b6b2316f1b2b19c46f02bdf1e5fa1e6f6ee4893
Deleted: sha256:14b340335550df9a53c0f25941573d741259c5e1c7b70833248ecb7f3785a6a3

[eric@almond postgres]$ docker images | awk '/postgres/'
my/postgres             latest              77d60a583b96        2 hours ago         607.9 MB
mytraining/postgres     latest              0d0c2955f2d6        7 months ago        335.6 MB
postgres                latest              eebef0752804        8 months ago        265.1 MB
training/postgres       latest              6fa973bb3c26        2 years ago         364.6 MB

[eric@almond postgres]$ docker tag my/postgres my/fedora_postgres

[eric@almond postgres]$ docker images | awk '/postgres/'
my/fedora_postgres      latest              77d60a583b96        2 hours ago         607.9 MB
my/postgres             latest              77d60a583b96        2 hours ago         607.9 MB
mytraining/postgres     latest              0d0c2955f2d6        7 months ago        335.6 MB
postgres                latest              eebef0752804        8 months ago        265.1 MB
training/postgres       latest              6fa973bb3c26        2 years ago         364.6 MB
[eric@almond postgres]$ docker rmi my/postgres
Untagged: my/postgres:latest

[eric@almond postgres]$ docker rmi my/postgres
Untagged: my/postgres:latest
[eric@almond postgres]$ docker images | awk '/postgres/'
my/fedora_postgres      latest              77d60a583b96        2 hours ago         607.9 MB
mytraining/postgres     latest              0d0c2955f2d6        7 months ago        335.6 MB
postgres                latest              eebef0752804        8 months ago        265.1 MB
training/postgres       latest              6fa973bb3c26        2 years ago         364.6 MB



/ DOCKER DOCKERFILE

/ FIX DOCKER DOCKERFILE 

/ 13	. 

/ we moeten	,
run ["dnf","-y","install","vim"]		

/ als we	,
run ["dnf","-y","install vim"]		
/ we zien ERR	,
No such command: install vim. Please use /usr/bin/dnf --help

/ 13	. 

/ we moeten	,
run ["dnf","-y","install","postgresql-server","postgresql-contrib"]

/ als we	,
run ["dnf","-y","install","postgresql-server postgresql-contrib"]
/ dan ERR	,
o package postgresql-server postgresql-contrib available.
Error: Unable to find a match.

/ 13	. 

[eric@almond locale]$ pwd
/home/eric/Devel/Docker2/fedora/locale
[eric@almond locale]$ cat Dockerfile 
from fedora
...
[eric@almond locale]$ docker build -t my/fedora-locale .
...


[eric@almond postgres]$ pwd
/home/eric/Devel/Docker2/fedora/postgres
[eric@almond postgres]$ cat Dockerfile 
from my/fedora-locale
...
[eric@almond postgres]$ docker build -t my/fedora_postgres .
/ Deze begint opnieuw  (met line 2)	,

/ Intermezzo

[root@b802ae3cf4d5 /]# su - eric -c "ls -l";pwd
total 4
drwxr-xr-x. 3 postgres postgres 4096 Aug  2 12:56 pgsql
/
[root@b802ae3cf4d5 /]# su - eric -c ls -l;pwd
pgsql
/

/ Einde Intermezzo

$ cat Dockerfile
run ["su","-","eric","-c","ls -l"] 			/ OK
run ["su","-","eric","-c","ls","-l"]			/ ziet -l NIET	,
run ["su","-","eric","-c","ls -l;pwd"]			/ OK
run ["su","-","eric","-c","ls -l","pwd"]		/ ziet pwd NIET	, 

/////////////
/ er moet maar 1 arg na "-c"	,

[eric@almond postgres]$ docker build -t my/fedora_postgres .

Step 13 : RUN su - eric -c ls -l
 ---> Running in b52781511328
total 4
drwxr-xr-x. 3 postgres postgres 4096 Aug  2 12:56 pgsql
 ---> 473e81f14548
Removing intermediate container b52781511328
Step 14 : RUN su - eric -c ls -l
 ---> Running in 095d0eb73047
pgsql
 ---> 56bbdac0f66a
Removing intermediate container 095d0eb73047
Step 15 : RUN su - eric -c ls -l;pwd
 ---> Running in 225c7718fcb1
total 4
drwxr-xr-x. 3 postgres postgres 4096 Aug  2 12:56 pgsql
/home/eric
 ---> 325252684ad7
Removing intermediate container 225c7718fcb1
Step 16 : RUN su - eric -c ls -l pwd
 ---> Running in 97b497a8eac9
total 4
drwxr-xr-x. 3 postgres postgres 4096 Aug  2 12:56 pgsql
 ---> 2157b5c09607
Removing intermediate container 97b497a8eac9
Successfully built 2157b5c09607



/ 13	. 

$ vi Dockerfile
run ["dnf","-y","install","findutils","less"]
/ Hij installs deze 2

$ vi Dockerfile
run ["dnf","-y","install","findutils","less","procps-ng"]
/ Hij installs alle 3, dus findutils en less opnieuw	, 
/ Dit is omdat de layer met findutils en less eraf is , omdat die regel in Dockerfile is veranderd	.


/ Einde FIX DOCKER DOCKERFILE 


/ Einde Intermezzo

/ Intermezzo

[eric@almond locale]$  pwd
/home/eric/Devel/Docker2/fedora/locale

/ edit de Dockerfile, voor de dnf update regel	, set er een echo bij	, 
[eric@almond locale]$ cat Dockerfile 
from fedora
run ["echo",""]
run ["echo","x"]
run ["dnf","-y","upgrade","--setopt=deltarpm=false"]

[eric@almond locale]$ docker build  -t my/fedora-locale .

/ dan  zal hij f update
 /we zien 2 keer dezelfde ERR	,
  Cleanup     : dnf-1.1.9-2.fc24.noarch                                 106/198Failed to connect to bus: No such file or directory
  Cleanup     : libgcc-6.1.1-2.fc24.x86_64                              198/198Failed to connect to bus: No such file or directory
/ TODO

eric@almond locale]$  docker run --rm --name fd-loc -it my/fedora-locale bash
[root@bda7da5df737 /]#  

/ lees 
http://www.unicode.org/standard/where/
/ links menu item	,
Unicode Character Name Index
/ kijk bij de p voor pi	,
http://www.unicode.org/charts/PDF/U0370.pdf
 ctrl+shift+u, 3c0
 ctrl+shift+u, 3a0

/ MORGENAVOND





/ Einde Intermezzo

[eric@almond postgres]$ cat Dockerfile 
from fedora
run dnf -y upgrade --setopt=deltarpm=false 
run dnf -y install postgresql-server postgresql-contrib
#run dnf -y install 'dnf-command(repoquery)'
run dnf -y install sudo passwd vim less
run useradd eric
run usermod -a -G wheel eric
run passwd -uf eric
run chmod +rwx eric					/ ERR !
#run su - postgres -c "mkdir /home/eric//pgsql"

[eric@almond postgres]$ docker build -t my/fedora_postgres .
Sending build context to Docker daemon 2.048 kB
Step 1 : FROM fedora
 ---> f9873d530588
Step 2 : RUN dnf -y upgrade --setopt=deltarpm=false
 ---> Using cache					/ Klopt	, tot zover hadden we al	,
 ---> 77d60a583b96
Step 3 : RUN dnf -y install postgresql-server postgresql-contrib
 ---> Running in 895a453f8448
Last metadata expiration check: 2:43:50 ago on Mon Aug  1 11:01:42 2016.
Dependencies resolved.
================================================================================
 Package                  Arch         Version               Repository    Size
================================================================================
Installing:
 libxslt                  x86_64       1.1.28-12.fc24        fedora       247 k
 postgresql               x86_64       9.5.3-1.fc24          fedora       1.3 M
 postgresql-contrib       x86_64       9.5.3-1.fc24          fedora       654 k
 postgresql-libs          x86_64       9.5.3-1.fc24          fedora       246 k
 postgresql-server        x86_64       9.5.3-1.fc24          fedora       4.4 M
 uuid                     x86_64       1.6.2-32.fc24         fedora        61 k

Transaction Summary
================================================================================
Install  6 Packages

Total download size: 6.8 M
Installed size: 26 M
Downloading Packages:
--------------------------------------------------------------------------------
Total                                           597 kB/s | 6.8 MB     00:11     
Running transaction check
Transaction check succeeded.
Running transaction test
Transaction test succeeded.
Running transaction
  Installing  : postgresql-libs-9.5.3-1.fc24.x86_64                         1/6 
  Installing  : postgresql-9.5.3-1.fc24.x86_64                              2/6 
  Installing  : uuid-1.6.2-32.fc24.x86_64                                   3/6 
  Installing  : libxslt-1.1.28-12.fc24.x86_64                               4/6 
  Installing  : postgresql-contrib-9.5.3-1.fc24.x86_64                      5/6 
  Installing  : postgresql-server-9.5.3-1.fc24.x86_64                       6/6Failed to connect to bus: No such file or directory
 
  Verifying   : postgresql-server-9.5.3-1.fc24.x86_64                       1/6 
  Verifying   : postgresql-contrib-9.5.3-1.fc24.x86_64                      2/6 
  Verifying   : postgresql-9.5.3-1.fc24.x86_64                              3/6 
  Verifying   : postgresql-libs-9.5.3-1.fc24.x86_64                         4/6 
  Verifying   : libxslt-1.1.28-12.fc24.x86_64                               5/6 
  Verifying   : uuid-1.6.2-32.fc24.x86_64                                   6/6 

Installed:
  libxslt.x86_64 1.1.28-12.fc24            postgresql.x86_64 9.5.3-1.fc24       
  postgresql-contrib.x86_64 9.5.3-1.fc24   postgresql-libs.x86_64 9.5.3-1.fc24  
  postgresql-server.x86_64 9.5.3-1.fc24    uuid.x86_64 1.6.2-32.fc24            

Complete!
 ---> 0fc1b8cac762
Removing intermediate container 895a453f8448
Step 4 : RUN dnf -y install sudo passwd vim less
 ---> Running in b4fb1dff53a7
Last metadata expiration check: 2:44:13 ago on Mon Aug  1 11:01:42 2016.
Dependencies resolved.
================================================================================
 Package              Arch         Version                  Repository     Size
================================================================================
Installing:
 gpm-libs             x86_64       1.20.7-9.fc24            fedora         36 k
 less                 x86_64       481-5.fc24               fedora        157 k
 libuser              x86_64       0.62-3.fc24              fedora        397 k
 passwd               x86_64       0.79-8.fc24              fedora        109 k
 perl-Carp            noarch       1.38-2.fc24              fedora         28 k
 perl-Exporter        noarch       5.72-349.fc24            fedora         33 k
 perl-libs            x86_64       4:5.22.2-361.fc24        updates       1.4 M
 sudo                 x86_64       1.8.17p1-1.fc24          updates       711 k
 vim-common           x86_64       2:7.4.1868-1.fc24        updates       6.3 M
 vim-enhanced         x86_64       2:7.4.1868-1.fc24        updates       1.2 M
 vim-filesystem       x86_64       2:7.4.1868-1.fc24        updates        29 k
 which                x86_64       2.20-13.fc24             fedora         46 k

Transaction Summary
================================================================================
Install  12 Packages

Total download size: 10 M
Installed size: 40 M
Downloading Packages:
--------------------------------------------------------------------------------
Total                                           553 kB/s |  10 MB     00:19     
Running transaction check
Transaction check succeeded.
Running transaction test
Transaction test succeeded.
Running transaction
  Installing  : perl-Carp-1.38-2.fc24.noarch                               1/12 
  Installing  : perl-Exporter-5.72-349.fc24.noarch                         2/12 
  Installing  : perl-libs-4:5.22.2-361.fc24.x86_64                         3/12 
  Installing  : vim-filesystem-2:7.4.1868-1.fc24.x86_64                    4/12 
  Installing  : vim-common-2:7.4.1868-1.fc24.x86_64                        5/12 
  Installing  : which-2.20-13.fc24.x86_64                                  6/12 
  Installing  : gpm-libs-1.20.7-9.fc24.x86_64                              7/12 
  Installing  : libuser-0.62-3.fc24.x86_64                                 8/12 
  Installing  : passwd-0.79-8.fc24.x86_64                                  9/12 
  Installing  : vim-enhanced-2:7.4.1868-1.fc24.x86_64                     10/12 
  Installing  : sudo-1.8.17p1-1.fc24.x86_64                               11/12 
  Installing  : less-481-5.fc24.x86_64                                    12/12 
  Verifying   : passwd-0.79-8.fc24.x86_64                                  1/12 
  Verifying   : less-481-5.fc24.x86_64                                     2/12 
  Verifying   : libuser-0.62-3.fc24.x86_64                                 3/12 
  Verifying   : sudo-1.8.17p1-1.fc24.x86_64                                4/12 
  Verifying   : vim-enhanced-2:7.4.1868-1.fc24.x86_64                      5/12 
  Verifying   : gpm-libs-1.20.7-9.fc24.x86_64                              6/12 
  Verifying   : which-2.20-13.fc24.x86_64                                  7/12 
  Verifying   : vim-common-2:7.4.1868-1.fc24.x86_64                        8/12 
  Verifying   : perl-libs-4:5.22.2-361.fc24.x86_64                         9/12 
  Verifying   : perl-Carp-1.38-2.fc24.noarch                              10/12 
  Verifying   : perl-Exporter-5.72-349.fc24.noarch                        11/12 
  Verifying   : vim-filesystem-2:7.4.1868-1.fc24.x86_64                   12/12 

Installed:
  gpm-libs.x86_64 1.20.7-9.fc24           less.x86_64 481-5.fc24               
  libuser.x86_64 0.62-3.fc24              passwd.x86_64 0.79-8.fc24            
  perl-Carp.noarch 1.38-2.fc24            perl-Exporter.noarch 5.72-349.fc24   
  perl-libs.x86_64 4:5.22.2-361.fc24      sudo.x86_64 1.8.17p1-1.fc24          
  vim-common.x86_64 2:7.4.1868-1.fc24     vim-enhanced.x86_64 2:7.4.1868-1.fc24
  vim-filesystem.x86_64 2:7.4.1868-1.fc24 which.x86_64 2.20-13.fc24            

Complete!
 ---> a324076774ab
Removing intermediate container b4fb1dff53a7
Step 5 : RUN useradd eric
 ---> Running in 231a5ff031f1
 ---> 0666ef612cd2
Removing intermediate container 231a5ff031f1
Step 6 : RUN usermod -a -G wheel eric
 ---> Running in 49306ee559e4
 ---> e9d025f3a44b
Removing intermediate container 49306ee559e4
Step 7 : RUN passwd -uf eric
 ---> Running in fab92f6cfffc
Unlocking password for user eric.
passwd: Success
 ---> 3bdb3153d72a
Removing intermediate container fab92f6cfffc
Step 8 : RUN chmod o+rwx eric
 ---> Running in b2b98428e2f2
chmod: cannot access 'eric': No such file or directory
The command '/bin/sh -c chmod o+rwx eric' returned a non-zero code: 1

[eric@almond postgres]$ cat Dockerfile 
from fedora
run dnf -y upgrade --setopt=deltarpm=false 
run dnf -y install postgresql-server postgresql-contrib
#run dnf -y install 'dnf-command(repoquery)'
run dnf -y install sudo passwd vim less
run useradd eric
run usermod -a -G wheel eric
run passwd -uf eric
run su - eric
run chmod o+rwx . 

[eric@almond postgres]$ docker build -t my/fedora_postgres .
Sending build context to Docker daemon 2.048 kB
Step 1 : FROM fedora
 ---> f9873d530588
Step 2 : RUN dnf -y upgrade --setopt=deltarpm=false
 ---> Using cache
 ---> 77d60a583b96
Step 3 : RUN dnf -y install postgresql-server postgresql-contrib
 ---> Using cache
 ---> 0fc1b8cac762
Step 4 : RUN dnf -y install sudo passwd vim less
 ---> Using cache
 ---> a324076774ab
Step 5 : RUN useradd eric
 ---> Using cache
 ---> 0666ef612cd2
Step 6 : RUN usermod -a -G wheel eric
 ---> Using cache
 ---> e9d025f3a44b
Step 7 : RUN passwd -uf eric
 ---> Using cache
 ---> 3bdb3153d72a				/ Klopt, hadden we al	,
Step 8 : RUN su - eric
 ---> Running in 8add9c211724
 ---> 64773b7c0b94
Removing intermediate container 8add9c211724
Step 9 : RUN chmod o+rwx .
 ---> Running in 8bbdc6bd3ff1
 ---> a642df765dfb
Removing intermediate container 8bbdc6bd3ff1
Successfully built a642df765dfb

/ 13	. 

$ vi Dockerfile
run su - eric
run echo  > 1.txt 

/ We dachten dat eric dan  in 1.txt zou write	, maar root doet dat	, 
/ Het zijn aparte statements	, 
/ TODO

/ we hadden eerst	, 
run su - eric
run chmod o+rwx . 
/ Maar we zien 
root@9467bec4147c /]# ls -ld /
drwxr-xr-x. 18 root root 4096 Aug  1 20:31 /
/ Waarom heeft hij het niet gedaan	?
/ TODO

run su - eric;echo >3.txt
/=
run su - eric
run echo >3.txt
/ Dus 3.txt wordt door root write in /	,

$ vi Dockerfile
run ["echo >1.txt"]
[eric@almond postgres]$ docker build -t my/fedora_postgres .
exec: "echo >1.txt": executable file not found in $PATH
/ TODO

/ 7	. 

[eric@almond dockerfile]$ pwd
/home/eric/Devel/Docker2/fedora/dockerfile
[eric@almond dockerfile]$ cat Dockerfile 

from my/fedora_postgres
run dnf -y upgrade --setopt=deltarpm=false
run dnf -y install procps-ng
entrypoint ["top"]
cmd ["-b","-c"]

[eric@almond dockerfile]$ docker build -t my/fedora_dockerfile .
Sending build context to Docker daemon 2.048 kB
Step 1 : FROM my/fedora_postgres
 ---> f12ce0e586c0
Step 2 : RUN dnf -y upgrade --setopt=deltarpm=false				/ we zien nu al weer updates	,
 ---> Running in fd2ea38398d5
Last metadata expiration check: 0:25:36 ago on Mon Aug  1 20:36:15 2016.
Dependencies resolved.
================================================================================
 Package           Arch           Version                 Repository       Size
================================================================================
Upgrading:
 krb5-libs         x86_64         1.14.1-8.fc24           updates         837 k
 libsolv           x86_64         0.6.23-1.fc24           updates         338 k
 lua               x86_64         5.3.3-2.fc24            updates         297 k

Transaction Summary
================================================================================
Upgrade  3 Packages

Total download size: 1.4 M
Downloading Packages:
--------------------------------------------------------------------------------
Total                                           390 kB/s | 1.4 MB     00:03     
Running transaction check
Transaction check succeeded.
Running transaction test
Transaction test succeeded.
Running transaction
  Upgrading   : lua-5.3.3-2.fc24.x86_64                                     1/6 
  Upgrading   : libsolv-0.6.23-1.fc24.x86_64                                2/6 
  Upgrading   : krb5-libs-1.14.1-8.fc24.x86_64                              3/6 
  Cleanup     : lua-5.3.3-1.fc24.x86_64                                     4/6 
  Cleanup     : libsolv-0.6.22-3.fc24.x86_64                                5/6 
  Cleanup     : krb5-libs-1.14.1-7.fc24.x86_64                              6/6 
  Verifying   : krb5-libs-1.14.1-8.fc24.x86_64                              1/6 
  Verifying   : libsolv-0.6.23-1.fc24.x86_64                                2/6 
  Verifying   : lua-5.3.3-2.fc24.x86_64                                     3/6 
  Verifying   : krb5-libs-1.14.1-7.fc24.x86_64                              4/6 
  Verifying   : lua-5.3.3-1.fc24.x86_64                                     5/6 
  Verifying   : libsolv-0.6.22-3.fc24.x86_64                                6/6 

Upgraded:
  krb5-libs.x86_64 1.14.1-8.fc24          libsolv.x86_64 0.6.23-1.fc24         
  lua.x86_64 5.3.3-2.fc24                

Complete!
 ---> 00bbe71ca9aa
Removing intermediate container fd2ea38398d5
Step 3 : RUN dnf -y install procps-ng
 ---> Running in 8676a1c31bd3
Last metadata expiration check: 0:25:49 ago on Mon Aug  1 20:36:15 2016.
Dependencies resolved.
================================================================================
 Package           Arch           Version                  Repository      Size
================================================================================
Installing:
 procps-ng         x86_64         3.3.10-11.fc24           fedora         389 k

Transaction Summary
================================================================================
Install  1 Package

Total download size: 389 k
Installed size: 873 k
Downloading Packages:
--------------------------------------------------------------------------------
Total                                           234 kB/s | 389 kB     00:01     
Running transaction check
Transaction check succeeded.
Running transaction test
Transaction test succeeded.
Running transaction
  Installing  : procps-ng-3.3.10-11.fc24.x86_64                             1/1 
  Verifying   : procps-ng-3.3.10-11.fc24.x86_64                             1/1 

Installed:
  procps-ng.x86_64 3.3.10-11.fc24                                               

Complete!
 ---> 3292e2a0f3ae
Removing intermediate container 8676a1c31bd3
Step 4 : ENTRYPOINT top
 ---> Running in dff7553be790
 ---> 8ccc1be614d8
Removing intermediate container dff7553be790
Step 5 : CMD -b -c
 ---> Running in 364e5b0ee61b
 ---> 0dc946d2151f
Removing intermediate container 364e5b0ee61b
Successfully built 0dc946d2151f

/ 7	. 

[eric@almond dockerfile]$ pwd
/home/eric/Devel/Docker2/fedora/dockerfile

[eric@almond dockerfile]$ cat Dockerfile 
from my/fedora_postgres				/ most recent upgrade of fedora	,
run dnf -y upgrade --setopt=deltarpm=false
run dnf -y install procps-ng
entrypoint ["top"]
cmd ["-b","-c"]

[eric@almond dockerfile]$ docker run --rm --name dock my/fedora_dockerfile
top - 06:59:03 up 173 days, 22:33,  0 users,  load average: 0.41, 0.33, 0.33
Tasks:   1 total,   1 running,   0 sleeping,   0 stopped,   0 zombie
%Cpu(s): 20.2 us,  9.8 sy,  0.1 ni, 69.7 id,  0.2 wa,  0.0 hi,  0.0 si,  0.0 st
KiB Mem : 16310148 total,  1421796 free, 10916412 used,  3971940 buff/cache
KiB Swap:  8191996 total,  7653564 free,   538432 used.  4319904 avail Mem 

  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND
    1 root      20   0   46144   3440   3052 R   0.0  0.0   0:00.08 top -b -c
...

[eric@almond dockerfile]$ docker exec -it dock bash
[root@5d6d59eabe89 /]# top
TERM environment variable not set.  					/ Omdat we aan docker run NIET -t 	,  
[root@5d6d59eabe89 /]# ps ajx
 PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND
    0     1     1     1 ?           -1 Ss       0   0:00 top -b -c
    0     8     8     8 ?           30 Ss       0   0:00 bash
    8    30    30     8 ?           30 R+       0   0:00 ps ajx

/ we zien dat top execs zonder bash	,
/ bash komt van docker exec	,
/ omdat we ps jax gaven in bash (command interpreter)	, zien we dat van 30 de parent 8 is	, bash	, 
/ top heeft parent 0	,

/ bash interprets strings (commands) and calls exec to let them execute	, zoals wij hier direct doen met cmd in Dockerfile in exec mode	,
/ bash kan ook command substitution, pipe, variables	, ...

/ 13	.

/ we geven docker run -t	, 

[eric@almond dockerfile]$ docker run --rm --name -t dock my/fedora_dockerfile
top - 06:59:03 up 173 days, 22:33,  0 users,  load average: 0.41, 0.33, 0.33
Tasks:   1 total,   1 running,   0 sleeping,   0 stopped,   0 zombie
%Cpu(s): 20.2 us,  9.8 sy,  0.1 ni, 69.7 id,  0.2 wa,  0.0 hi,  0.0 si,  0.0 st
KiB Mem : 16310148 total,  1421796 free, 10916412 used,  3971940 buff/cache
KiB Swap:  8191996 total,  7653564 free,   538432 used.  4319904 avail Mem 

  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND
    1 root      20   0   46144   3440   3052 R   0.0  0.0   0:00.08 top -b -c
...

eric@almond dockerfile]$ docker exec -it dock bash
[root@4d41ce6e1fb0 /]# top								/ OK	, nu WEL	,

top - 07:13:30 up 173 days, 22:48,  0 users,  load average: 2.32, 2.53, 1.50
Tasks:   3 total,   1 running,   2 sleeping,   0 stopped,   0 zombie
%Cpu(s):  8.0 us,  3.7 sy,  0.0 ni, 88.3 id,  0.1 wa,  0.0 hi,  0.0 si,  0.0 st
KiB Mem : 16310148 total,  1425160 free, 10896552 used,  3988436 buff/cache
KiB Swap:  8191996 total,  7653564 free,   538432 used.  4342744 avail Mem 

  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND                                    
    1 root      20   0   46144   3324   2936 S   0.3  0.0   0:00.15 top                                        
   46 root      20   0   12568   3744   2732 S   0.0  0.0   0:00.08 bash                                       
   68 root      20   0   46252   3536   3064 R   0.0  0.0   0:00.00 top       

/ 7	. 

[eric@almond dockerfile]$ pwd
/home/eric/Devel/Docker2/fedora/dockerfile
eric@almond dockerfile]$ cat Dockerfile 

from my/fedora_postgres
run dnf -y upgrade --setopt=deltarpm=false
run dnf -y install procps-ng
cmd echo $HOME
#cmd ["echo","$HOME"]

[eric@almond dockerfile]$ docker run --rm --name dock  my/fedora_dockerfile
/root

/ Dit werkt zo, we geven GEEN -it	, de container execs de cmd	, en exits	,

eric@almond dockerfile]$ cat Dockerfile 

from my/fedora_postgres
run dnf -y upgrade --setopt=deltarpm=false
run dnf -y install procps-ng
#cmd echo $HOME
cmd ["echo","$HOME"]

[eric@almond dockerfile]$ docker run --rm --name dock  my/fedora_dockerfile
$HOME

/ we zien dat met 
cmd echo $HOME
/ echo in een shell moet hebben exec	, 
/ TODO (log?)

/ 7	 

/ we kunnen run ook in shell of exec form	,
/ we kunnen run ook ls of ps of echo	, 

$ vi Dockerfile
from my/fedora_postgres
run dnf -y upgrade --setopt=deltarpm=false
run dnf -y install procps-ng
run chmod o+rwx /home/eric
run ls -ld /home/eric

[eric@almond dockerfile]$ docker build -t my/fedora_dockerfile .
...
Step 5 : RUN chmod o+rwx /home/eric
 ---> Using cache
 ---> 4037010f3d59
Step 6 : RUN ls -ld /home/eric
 ---> Running in 2cdbd4b0f5a7
total 4
drwx---rwx. 2 eric eric 4096 Aug  1 13:46 /home/eric
 ---> 96affdfc98e7

/ maar als root chmod o+rwx .	, dan zien we dat dat niet gebeurt	,

[eric@almond dockerfile]$ cat Dockerfile 
from my/fedora_postgres
run dnf -y upgrade --setopt=deltarpm=false
run dnf -y install procps-ng
run chmod o+rwx /
run ls -ld /

[eric@almond dockerfile]$ docker build -t my/fedora_dockerfile .
Step 5 : RUN ls -ld /
 ---> Running in b3f12d9b5ede
drwxr-xr-x. 18 root root 4096 Aug  2 08:04 /
 ---> 11a483a50f1d
Removing intermediate container b3f12d9b5ede

/ 13	. 

/ we voegen hier 1 nieuw run to	, 'run echo'	, zodat (deze en ) de volgenden altijd  worden exec	,
/ we moeten deze wel steeds veranderen	, 
/ TODO Is er een andere manier? rm layers?

$ vi Dockerfile
rom my/fedora_postgres
run dnf -y upgrade --setopt=deltarpm=false
run dnf -y install procps-ng
run echo 					/ NEW, so this one and the following are NOT from cache	,
run echo $HOME
run ["echo","$HOME"]
#run chmod o+rwx /
run ls -ld /

[eric@almond dockerfile]$ docker build -t my/fedora_dockerfile . 

ending build context to Docker daemon 2.048 kB
Step 1 : FROM my/fedora_postgres
 ---> f12ce0e586c0
Step 2 : RUN dnf -y upgrade --setopt=deltarpm=false
 ---> Using cache
 ---> 00bbe71ca9aa
Step 3 : RUN dnf -y install procps-ng
 ---> Using cache
 ---> 3292e2a0f3ae
Step 4 : RUN echo				/ NEW, so this one and the following are NOT from cache	,
 ---> Running in cf5aa0e66c5d

 ---> 494cd4bbe4b4
Removing intermediate container cf5aa0e66c5d
Step 5 : RUN echo $HOME
 ---> Running in fa5e8e791f8e
/root
 ---> 369bf436d0c9
Removing intermediate container fa5e8e791f8e
Step 6 : RUN echo $HOME
 ---> Running in c4e59216c71b
$HOME
 ---> 27dece0ab676
Removing intermediate container c4e59216c71b
Step 7 : RUN ls -ld /
 ---> Running in f32f5a04bc05
drwxr-xr-x. 18 root root 4096 Aug  2 08:08 /
 ---> a6057b96dca8
Removing intermediate container f32f5a04bc05
Successfully built a6057b96dca8



[eric@almond dockerfile]$ docker history my/fedora_dockerfile
IMAGE               CREATED             CREATED BY                                      SIZE                COMMENT
a6057b96dca8        18 seconds ago      /bin/sh -c ls -ld /                             0 B                 
27dece0ab676        25 seconds ago      echo $HOME                                      0 B                 
369bf436d0c9        32 seconds ago      /bin/sh -c echo $HOME                           0 B                 
494cd4bbe4b4        39 seconds ago      /bin/sh -c echo                                 0 B                 

/ RUN CMD SHELL EXEX FORM
/ Hier zien we het:
run ["echo","$HOME"] 	-> 	echo $HOME
run echo $HOME		->	sh -c "echo $HOME"

/ Lees	,
https://lebkowski.name/docker-volumes/
https://docs.docker.com/engine/userguide/storagedriver/imagesandcontainers/
https://github.com/docker/docker/issues/1326

/ 7	. 

[eric@almond postgres]$ pwd
/home/eric/Devel/Docker2/fedora/postgres
[eric@almond postgres]$ cat Dockerfile 

from fedora
run dnf -y upgrade --setopt=deltarpm=false 
run dnf -y install postgresql-server postgresql-contrib
run dnf -y install sudo passwd vim less
run useradd eric
run usermod -a -G wheel eric
run passwd -uf eric
run echo a					/ Veranderen we steeds	, zodat cache van hieraf invalidates	,
run su - eric -c "echo  > 1.txt"
run su - eric -c "cat 1.txt"

[eric@almond postgres]$ docker build -t my/fedora_postgres .
Step 8 : RUN echo a
 ---> Running in 1cad5305169a
a
 ---> 7084e5792457
Removing intermediate container 1cad5305169a
Step 9 : RUN su - eric -c "echo  > 1.txt"
 ---> Running in b6f0631218ea
 ---> 85970f296b80
Removing intermediate container b6f0631218ea
Step 10 : RUN su - eric -c "cat 1.txt"
 ---> Running in e3a19b987ec9

 ---> 09c0d23ab401
Removing intermediate container e3a19b987ec9

eric@almond postgres]$ docker history my/fedora_postgres
IMAGE               CREATED             CREATED BY                                      SIZE                COMMENT
09c0d23ab401        30 seconds ago      /bin/sh -c su - eric -c "cat 1.txt"             292.3 kB            
85970f296b80        35 seconds ago      /bin/sh -c su - eric -c "echo  > 1.txt"        292.3 kB            
7084e5792457        42 seconds ago      /bin/sh -c echo a                               0 B                 

/ 13	. 

/ We maken de run in exec form	,

$ vi Dockerfile

from fedora
run dnf -y upgrade --setopt=deltarpm=false
run dnf -y install postgresql-server postgresql-contrib
run dnf -y install sudo passwd vim less
run useradd eric
run usermod -a -G wheel eric
run passwd -uf eric
run ["echo","a"]
run ["su","-","eric","-c","echo  > 1.txt"]
run su - eric -c "cat 1.txt"

[eric@almond postgres]$ docker build -t my/fedora_postgres .
...
Step 9 : RUN su - eric -c echo  > 1.txt
 ---> Running in 0e3e1a278c03
 ---> 5f8b648b9d5d
Removing intermediate container 0e3e1a278c03
Step 10 : RUN su - eric -c "cat 1.txt"
 ---> Running in 6f61657043b4


[eric@almond postgres]$ docker history my/fedora_postgres
IMAGE               CREATED              CREATED BY                                      SIZE                COMMENT
d709da9811be        14 seconds ago       /bin/sh -c su - eric -c "cat 1.txt"             292.3 kB            
5f8b648b9d5d        19 seconds ago       su - eric -c echo  > 1.txt                     292.3 kB            
f3b65ef56529        About a minute ago   echo a                                          0 B                 


/ Einde DOCKER DOCKERFILE 

/ DOCKER FEDORA POSTGRES

/ Lees 
DOCKER POSTGRES


[eric@almond postgres]$ pwd
/home/eric/Devel/Docker2/fedora/postgres

/ 7	. 

/ postgres maakt /home/eric/pgsql

/ we gaan uit van fedora-locale	, 

$ cat Dockerfile

from my/fedora-locale
run ["dnf","-y","install","postgresql-server","postgresql-contrib"]
run ["useradd","eric"]
run ["echo","1"]
run ["su","-","eric","-c","chmod o+rwx ."]
run ["su","-","postgres","-c","mkdir /home/eric/pgsql"]
run ["su","-","eric","-c","ls -l"]
run ["echo","1"]
run ["su","-","postgres","-c","initdb -D /home/eric/pgsql/data"]
run ["su","-","postgres","-c","ls -l /home/eric/pgsql/data"]
run ["su","-","eric","-c","chmod o-rwx ."]

/ we zagen al eerder	,

[eric@almond postgres]$ docker build -t my/fedora_postgres .
Sending build context to Docker daemon 15.36 kB
Step 1 : FROM my/fedora-locale
 ---> 824fa3c15f33
Step 2 : RUN dnf -y install postgresql-server postgresql-contrib
 ---> Running in 5831d44e2439
Last metadata expiration check: 0:08:18 ago on Tue Aug  2 12:34:43 2016.
Dependencies resolved.
================================================================================
 Package                  Arch         Version               Repository    Size
================================================================================
Installing:
 libxslt                  x86_64       1.1.28-12.fc24        fedora       247 k
 postgresql               x86_64       9.5.3-1.fc24          fedora       1.3 M
 postgresql-contrib       x86_64       9.5.3-1.fc24          fedora       654 k
 postgresql-libs          x86_64       9.5.3-1.fc24          fedora       246 k
 postgresql-server        x86_64       9.5.3-1.fc24          fedora       4.4 M
 uuid                     x86_64       1.6.2-32.fc24         fedora        61 k

Transaction Summary
================================================================================
Install  6 Packages

Total download size: 6.8 M
Installed size: 26 M
Downloading Packages:
--------------------------------------------------------------------------------
Total                                           547 kB/s | 6.8 MB     00:12     
Running transaction check
Transaction check succeeded.
Running transaction test
Transaction test succeeded.
Running transaction
  Installing  : postgresql-libs-9.5.3-1.fc24.x86_64                         1/6 
  Installing  : postgresql-9.5.3-1.fc24.x86_64                              2/6 
  Installing  : uuid-1.6.2-32.fc24.x86_64                                   3/6 
  Installing  : libxslt-1.1.28-12.fc24.x86_64                               4/6 
  Installing  : postgresql-contrib-9.5.3-1.fc24.x86_64                      5/6 
  Installing  : postgresql-server-9.5.3-1.fc24.x86_64                       6/6Failed to connect to bus: No such file or directory
 
  Verifying   : postgresql-server-9.5.3-1.fc24.x86_64                       1/6 
  Verifying   : postgresql-contrib-9.5.3-1.fc24.x86_64                      2/6 
  Verifying   : postgresql-9.5.3-1.fc24.x86_64                              3/6 
  Verifying   : postgresql-libs-9.5.3-1.fc24.x86_64                         4/6 
  Verifying   : libxslt-1.1.28-12.fc24.x86_64                               5/6 
  Verifying   : uuid-1.6.2-32.fc24.x86_64                                   6/6 

Installed:
  libxslt.x86_64 1.1.28-12.fc24            postgresql.x86_64 9.5.3-1.fc24       
  postgresql-contrib.x86_64 9.5.3-1.fc24   postgresql-libs.x86_64 9.5.3-1.fc24  
  postgresql-server.x86_64 9.5.3-1.fc24    uuid.x86_64 1.6.2-32.fc24            

Complete!
 ---> 6dc27be2b3e5
Removing intermediate container 5831d44e2439
Step 3 : RUN useradd eric
 ---> Running in da1c212e75f9
 ---> 8c444b30bcf3
Removing intermediate container da1c212e75f9
Step 4 : RUN echo 1
 ---> Running in e658bebb4b64
1
 ---> 1247dbd8366d
Removing intermediate container e658bebb4b64
Step 5 : RUN su - eric -c chmod o+rwx .
 ---> Running in e0e6e4b1bdfb
 ---> df4a216fdaed
Removing intermediate container e0e6e4b1bdfb
Step 6 : RUN su - postgres -c mkdir /home/eric/pgsql
 ---> Running in 4f385d959bc1
 ---> e7b73531eb07
Removing intermediate container 4f385d959bc1
Step 7 : RUN su - eric -c ls -l
 ---> Running in 09adf48372ce
total 4
drwxr-xr-x. 2 postgres postgres 4096 Aug  2 12:43 pgsql
 ---> 7649ee3bf949
Removing intermediate container 09adf48372ce
Step 8 : RUN echo 1
 ---> Running in 1ecd61a92426
1
 ---> 3730b90a7787
Removing intermediate container 1ecd61a92426
Step 9 : RUN su - postgres -c initdb -D /home/eric/pgsql/data
 ---> Running in 1ee7acc42b8b
The files belonging to this database system will be owned by user "postgres".
This user must also own the server process.

The database cluster will be initialized with locale "C".							/ ERR
The default database encoding has accordingly been set to "SQL_ASCII".
The default text search configuration will be set to "english".

Data page checksums are disabled.

creating directory /home/eric/pgsql/data ... ok
creating subdirectories ... ok
selecting default max_connections ... 100
selecting default shared_buffers ... 128MB
selecting dynamic shared memory implementation ... posix
creating configuration files ... ok
creating template1 database in /home/eric/pgsql/data/base/1 ... ok
initializing pg_authid ... ok
initializing dependencies ... ok
creating system views ... ok
loading system objects' descriptions ... ok
creating collations ... ok
creating conversions ... ok
creating dictionaries ... ok
setting privileges on built-in objects ... ok
creating information schema ... ok
loading PL/pgSQL server-side language ... ok
vacuuming database template1 ... ok
copying template1 to template0 ... ok
copying template1 to postgres ... ok
syncing data to disk ... ok

Success. You can now start the database server using:

    pg_ctl -D /home/eric/pgsql/data -l logfile start


WARNING: enabling "trust" authentication for local connections
You can change this by editing pg_hba.conf or using the option -A, or
--auth-local and --auth-host, the next time you run initdb.
 ---> 60ade6f14034
Removing intermediate container 1ee7acc42b8b
Step 10 : RUN su - postgres -c ls -l /home/eric/pgsql/data
 ---> Running in d686b5204b6b
total 112
-rw-------. 1 postgres postgres     4 Aug  2 12:44 PG_VERSION
drwx------. 5 postgres postgres  4096 Aug  2 12:44 base
drwx------. 2 postgres postgres  4096 Aug  2 12:44 global
drwx------. 2 postgres postgres  4096 Aug  2 12:44 pg_clog
drwx------. 2 postgres postgres  4096 Aug  2 12:44 pg_commit_ts
drwx------. 2 postgres postgres  4096 Aug  2 12:44 pg_dynshmem
-rw-------. 1 postgres postgres  4468 Aug  2 12:44 pg_hba.conf
-rw-------. 1 postgres postgres  1636 Aug  2 12:44 pg_ident.conf
drwx------. 4 postgres postgres  4096 Aug  2 12:44 pg_logical
drwx------. 4 postgres postgres  4096 Aug  2 12:44 pg_multixact
drwx------. 2 postgres postgres  4096 Aug  2 12:44 pg_notify
drwx------. 2 postgres postgres  4096 Aug  2 12:44 pg_replslot
drwx------. 2 postgres postgres  4096 Aug  2 12:44 pg_serial
drwx------. 2 postgres postgres  4096 Aug  2 12:44 pg_snapshots
drwx------. 2 postgres postgres  4096 Aug  2 12:44 pg_stat
drwx------. 2 postgres postgres  4096 Aug  2 12:44 pg_stat_tmp
drwx------. 2 postgres postgres  4096 Aug  2 12:44 pg_subtrans
drwx------. 2 postgres postgres  4096 Aug  2 12:44 pg_tblspc
drwx------. 2 postgres postgres  4096 Aug  2 12:44 pg_twophase
drwx------. 3 postgres postgres  4096 Aug  2 12:44 pg_xlog
-rw-------. 1 postgres postgres    88 Aug  2 12:44 postgresql.auto.conf
-rw-------. 1 postgres postgres 21788 Aug  2 12:44 postgresql.conf
 ---> ef43f540ea67
Removing intermediate container d686b5204b6b
Step 11 : RUN su - eric -c chmod o-rwx .
 ---> Running in 055b646dc28d
 ---> 1136b32c19e1
Removing intermediate container 055b646dc28d
Successfully built 1136b32c19e1

/ 7	. 


/ we zien dat initdb met de locale NIET OK

/ we start container, en kijken,	 
[eric@almond postgres]$ docker run --rm --name pg -it my/fedora_postgres bash

[root@8bfc040e9c48 /]# locale
LANG=en_US.UTF-8
LC_CTYPE="en_US.UTF-8"
LC_NUMERIC="en_US.UTF-8"
LC_TIME="en_US.UTF-8"
LC_COLLATE="en_US.UTF-8"
LC_MONETARY="en_US.UTF-8"
LC_MESSAGES="en_US.UTF-8"
LC_PAPER="en_US.UTF-8"
LC_NAME="en_US.UTF-8"
LC_ADDRESS="en_US.UTF-8"
LC_TELEPHONE="en_US.UTF-8"
LC_MEASUREMENT="en_US.UTF-8"
LC_IDENTIFICATION="en_US.UTF-8"
LC_ALL=

[root@8bfc040e9c48 /]# su - postgres
-bash-4.3$ initdb --help

Usage:
  initdb [OPTION]... [DATADIR]

Options:
  -A, --auth=METHOD         default authentication method for local connections
      --auth-host=METHOD    default authentication method for local TCP/IP connections
      --auth-local=METHOD   default authentication method for local-socket connections
 [-D, --pgdata=]DATADIR     location for this database cluster
  -E, --encoding=ENCODING   set default encoding for new databases
      --locale=LOCALE       set default locale for new databases
      --lc-collate=, --lc-ctype=, --lc-messages=LOCALE
      --lc-monetary=, --lc-numeric=, --lc-time=LOCALE
                            set default locale in the respective category for
                            new databases (default taken from environment)
      --no-locale           equivalent to --locale=C
      --pwfile=FILE         read password for the new superuser from file
  -T, --text-search-config=CFG
                            default text search configuration
  -U, --username=NAME       database superuser name
  -W, --pwprompt            prompt for a password for the new superuser
  -X, --xlogdir=XLOGDIR     location for the transaction log directory
...

/ 7	. 

/ Daarom	,

$ vi Dockerfile
...
run ["su","-","postgres","-c","initdb -D /home/eric/pgsql/data --locale=en_US.utf8"]
/ of	,
run ["su","-","postgres","-c","export LANG=en_US.utf8;initdb -D /home/eric/pgsql/data"]
/ of	,
run ["su","postgres","-c","initdb -D /home/eric/pgsql/data"]
...
run ["dnf","-y","install","findutils","less"]


[eric@almond postgres]$ docker build -t my/fedora_postgres .  
...
The database cluster will be initialized with locale "en_US.utf8".
The default database encoding has accordingly been set to "UTF8".
The default text search configuration will be set to "english".
...
Success. You can now start the database server using:

    pg_ctl -D /home/eric/pgsql/data -l logfile start

/ we create container	,
[eric@almond postgres]$ docker run --rm --name pg -it my/fedora_postgres bash 

[root@8593928ffe29 /]# find / -name pg_hba.conf | xargs cat
 TYPE  DATABASE        USER            ADDRESS                 METHOD

# "local" is for Unix domain socket connections only
local   all             all                                     trust
# IPv4 local connections:
host    all             all             127.0.0.1/32            trust
# IPv6 local connections:
host    all             all             ::1/128                 trust
# Allow replication connections from localhost, by a user with the
# replication privilege.
#local   replication     postgres                                trust
#host    replication     postgres        127.0.0.1/32            trust
#host    replication     postgres        ::1/128                 trust

/ Alles staat op trust	, 
/ TODO

/ 7	. 

/ we kunnen in Dockerfile NIET
cmd ["su","-","postgres","-c","pg_ctl -D /home/eric/pgsql/data -l logfile start"]
/ want als we container maken, stopt deze	, 

$ vi Dockerfile

from my/fedora-locale
run ["dnf","-y","install","postgresql-server","postgresql-contrib"]
run ["dnf","-y","install","findutils","less","procps-ng"]
run ["useradd","eric"]
run ["echo","1"]
run ["su","-","eric","-c","chmod o+rwx ."]
run ["su","-","postgres","-c","mkdir /home/eric/pgsql"]
run ["su","-","eric","-c","ls -l"]
run ["echo","1"]

#run ["su","-","postgres","-c","initdb -D /home/eric/pgsql/data --locale=en_US.utf8"]			/ or	,
#run ["su","-","postgres","-c","export LANG=en_US.utf8;initdb -D /home/eric/pgsql/data"]	/ or	,
run ["su","postgres","-c","initdb -D /home/eric/pgsql/data"]													

run ["su","-","postgres","-c","ls -l /home/eric/pgsql/data"]
#expose 5432

#cmd ["su","-","postgres","-c","postgres -D /home/eric/pgsql/data"]
cmd ["su","postgres","-c","postgres -D /home/eric/pgsql/data"]


[eric@almond postgres]$ docker build -t my/fedora_postgres .   
[eric@almond postgres]$ docker run --rm --name pg -t my/fedora_postgres
LOG:  redirecting log output to logging collector process
HINT:  Future log output will appear in directory "pg_log".
/ TODO

[eric@almond locale]$ docker exec -it pg bash
[root@eea180256d6b /]# ps ajx
 PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND
    0     1     1     1 ?           -1 Ss       0   0:00 su - postgres -c postgres -D /home/eric/pgsql/data
    1     9     9     9 ?           -1 Ss      26   0:00 postgres -D /home/eric/pgsql/data
    9    30    30    30 ?           -1 Ss      26   0:00 postgres: logger process   
    9    32    32    32 ?           -1 Ss      26   0:00 postgres: checkpointer process   
    9    33    33    33 ?           -1 Ss      26   0:00 postgres: writer process   
    9    34    34    34 ?           -1 Ss      26   0:00 postgres: wal writer process   
    9    35    35    35 ?           -1 Ss      26   0:00 postgres: autovacuum launcher process  
    9    36    36    36 ?           -1 Ss      26   0:00 postgres: stats collector process  
    0    37    37    37 ?           57 Ss       0   0:00 bash
   37    57    57    37 ?           57 R+       0   0:00 ps ajx
/ OK
[root@eea180256d6b /]# env
LC_ALL=en_US.UTF-8
LANG=en_US.UTF-8
[root@eea180256d6b /]# su - eric 
Last login: Tue Aug  2 14:38:28 UTC 2016
[eric@eea180256d6b ~]$ env
/ GEEN LANG, LC_ALL
/ TODO
[eric@eea180256d6b ~]$ psql -U postgres
psql (9.5.3)
Type "help" for help.

postgres=# \l
                                  List of databases
   Name    |  Owner   | Encoding |   Collate   |    Ctype    |   Access privileges   
-----------+----------+----------+-------------+-------------+-----------------------
 postgres  | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 template0 | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =c/postgres          +
           |          |          |             |             | postgres=CTc/postgres
 template1 | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =c/postgres          +
           |          |          |             |             | postgres=CTc/postgres
(3 rows)


/ 7	. 

/ set autocommit off	, 

[eric@a390e9853188 ~]$ cat ~/.psqlrc 
\set AUTOCOMMIT off												/ NIET : autocommit	,
[eric@a390e9853188 ~]$ psql -U postgres
 
postgres=# \set

AUTOCOMMIT = 'off'
ENCODING = 'SQL_ASCII'  		/ psql!	
/ TODO

/ MORGENOCHTEND	,
/ Lees	,
https://www.postgresql.org/docs/9.2/static/multibyte.html
Important: On most modern operating systems, PostgreSQL can determine which character set is implied by the LC_CTYPE setting,
https://www.postgresql.org/docs/9.3/static/app-initdb.html
https://www.postgresql.org/docs/current/static/app-psql.html#AEN88713
http://stackoverflow.com/questions/14525505/postgres-issue-encoding-utf8-has-no-equivalent-in-encoding-latin1

$ vi ~/.psqlrc
\set AUTOCOMMIT off
\set ENCODING UTF8

[eric@a390e9853188 ~]$ psql -U postgres
psql (9.5.3)
Type "help" for help.

postgres=# \set
AUTOCOMMIT = 'off'
ENCODING = 'UTF8'

/ Dit zijn psql properties	. Maar er is ook	,

postgres=# show client_encoding;
 client_encoding 
-----------------
 SQL_ASCII
(1 row)

postgres=# SET client_encoding = 'LATIN1';
SET
postgres=# select*from t;                 
ERROR:  character with byte sequence 0xcf 0x80 in encoding "UTF8" has no equivalent in encoding "LATIN1"

/ we kunnen client_encoding commit	, 
/ maar geldt alleen binnen deze session	, 
/ als we tegelijkertijd een andere session	, dan is daar client_encoding='SQL_ASCII'
/ SQL_ASCII snapt  ook	, 
/ TODO

/ Lees	, 
https://www.postgresql.org/docs/9.2/static/multibyte.html
/ we kunnen	, 
postgres=# \encoding
LATIN1

postgres=# \encoding LATIN1
LATIN1: invalid encoding name or conversion procedure not found
/ TODO

If the client character set is defined as SQL_ASCII, encoding conversion is disabled, regardless of the server's character set. Just as for the server, use of SQL_ASCII is unwise unless you are working with all-ASCII data.
/ TODO

/ 13	. 

/ als postgres	,
-bash-4.3$  vi /home/eric/pgsql/data/postgresql.conf
...

[eric@a390e9853188 ~]$ cat ~/.psqlrc 
\set AUTOCOMMIT off
\set ENCODING UTF8
set client_encoding='UTF8'

[eric@a390e9853188 ~]$ psql -U postgres
postgres=# \encoding 
UTF8

/ 13	. 

/ Lees	,
http://stackoverflow.com/questions/36922248/how-do-i-change-the-default-client-encoding-in-postgres

If at least one of standard input or standard output are a terminal, then psql sets the client encoding to "auto", which will detect the appropriate client encoding from the locale settings (LC_CTYPE environment variable on Unix systems). If this doesn't work out as expected, the client encoding can be overridden using the environment variable PGCLIENTENCODING.

[eric@a390e9853188 ~]$ export LC_TYPE=en_US.UTF-8
/ of	,
[eric@a390e9853188 ~]$ export LC_ALL=en_US.UTF-8
/ is ook OK	,
eric@a390e9853188 ~]$ cat ~/.psqlrc 
\set AUTOCOMMIT off
\set ENCODING UTF8
/*set client_encoding='UTF8'*/
[eric@a390e9853188 ~]$ psql -U postgres
postgres=# \encoding 
UTF8

/ 13	. 

[eric@a390e9853188 ~]$ export LC_ALL=en_US.UTF8
[eric@a390e9853188 ~]$ locale
LANG=
LC_CTYPE="en_US.UTF8"
LC_NUMERIC="en_US.UTF8"
LC_TIME="en_US.UTF8"
LC_COLLATE="en_US.UTF8"
LC_MONETARY="en_US.UTF8"
LC_MESSAGES="en_US.UTF8"
LC_PAPER="en_US.UTF8"
LC_NAME="en_US.UTF8"
LC_ADDRESS="en_US.UTF8"
LC_TELEPHONE="en_US.UTF8"
LC_MEASUREMENT="en_US.UTF8"
LC_IDENTIFICATION="en_US.UTF8"
LC_ALL=en_US.UTF8

[eric@a390e9853188 ~]$ unset LC_ALL            
[eric@a390e9853188 ~]$ locale                  
LANG=
LC_CTYPE="POSIX"
LC_NUMERIC="POSIX"
LC_TIME="POSIX"
LC_COLLATE="POSIX"
LC_MONETARY="POSIX"
LC_MESSAGES="POSIX"
LC_PAPER="POSIX"
LC_NAME="POSIX"
LC_ADDRESS="POSIX"
LC_TELEPHONE="POSIX"
LC_MEASUREMENT="POSIX"
LC_IDENTIFICATION="POSIX"
LC_ALL=

[eric@a390e9853188 ~]$ export LANG=en_US.UTF8  
[eric@a390e9853188 ~]$ locale                
LANG=en_US.UTF8
LC_CTYPE="en_US.UTF8"
LC_NUMERIC="en_US.UTF8"
LC_TIME="en_US.UTF8"
LC_COLLATE="en_US.UTF8"
LC_MONETARY="en_US.UTF8"
LC_MESSAGES="en_US.UTF8"
LC_PAPER="en_US.UTF8"
LC_NAME="en_US.UTF8"
LC_ADDRESS="en_US.UTF8"
LC_TELEPHONE="en_US.UTF8"
LC_MEASUREMENT="en_US.UTF8"
LC_IDENTIFICATION="en_US.UTF8"
LC_ALL=

/ TODO	,
/ Add aan Dockerfile
su eric LANG=$LANG,	 export
/ en .psql met \set AUTOCOMMIT \set ENCODING 
/ en print # show all naar een file	
/ we doen voorlopig	als root 
# psql -U postgres
/ want door env LANG in Dockerfile wordt er WH export LANG=en_US.utf8 	, 
/ Dit geldt voor een login	, als 
# su - eric 
$ export LANG=en_US.utf8
/ dan geldt dit totdat eric
$ exit
/ Dat geldt voor root ook, als we een container start, dan wordt er WH ook su - root gedaan	, en als exit, dan stopt in dit geval ook de container,	

/ 7	. 

/ Doe	in een tty op laptop	,, 
[eric@almond postgres]$ docker run --rm --name pg my/fedora_postgres
LOG:  redirecting log output to logging collector process
HINT:  Future log output will appear in directory "pg_log".

/ en in een andere tty	, 
[eric@almond postgres]$ docker exec -ti pg bash

/ 13	.  

/ In	,
[eric@almond postgres]$ docker exec -ti pg bash
[root@5fb2b0a64c2c /]# su - postgres
Last login: Wed Aug  3 07:03:12 UTC 2016
-bash-4.3$   pwd
/var/lib/pgsql
-bash-4.3$ ls
backups  data
/ Maar deze data/ gebruiken we nu niet	,
/ backups/ TODO

-bash-4.3$ find / -name pg_log
/home/eric/pgsql/data/pg_log
-bash-4.3$ ce /home/eric/pgsql/data/
-bash-4.3$ ls
PG_VERSION    pg_dynshmem    pg_multixact  pg_stat	    pg_xlog
base	        pg_hba.conf    pg_notify	   pg_stat_tmp	postgresql.auto.conf
global	      pg_ident.conf  pg_replslot   pg_subtrans	postgresql.conf
pg_clog       pg_log	       pg_serial	   pg_tblspc	  postmaster.opts
pg_commit_ts  pg_logical     pg_snapshots  pg_twophase	postmaster.pid
-bash-4.3$ ls pg_log
postgresql-Wed.log

-bash-4.3$ less postgresql.conf 
log_filename = 'postgresql-%a.log'      # log file name pattern,
log_truncate_on_rotation = on           # If on, an existing log file with the
log_rotation_age = 1d                   # Automatic rotation of logfiles will
log_rotation_size = 0                   # Automatic rotation of logfiles will
log_timezone = 'UTC'

/ Einde DOCKER FEDORA POSTGRES

/ DOCKER MANUAL AGAIN 2  NETWORKS

/ 7	. 

/ Lees	,
http://www.projectatomic.io/blog/2015/04/problems-with-ping-in-containers-on-atomic-hosts/

[eric@almond Docker2]$ docker run --rm --name fd -ti my/fedora-locale bash
[root@777e1e1c9459 /]# dnf -y install iputils
[root@5967a3cf4cd7 /]# ping 172.17.0.2
bash: /usr/bin/ping: Operation not permitted
[root@5967a3cf4cd7 /]# getcap /usr/bin/ping
/usr/bin/ping = cap_net_admin,cap_net_raw+ep
/ e moet eraf	,
[root@5967a3cf4cd7 /]# setcap cap_net_raw,cap_net_admin+p /usr/bin/ping
[root@5967a3cf4cd7 /]# ping 172.17.0.2
PING 172.17.0.2 (172.17.0.2) 56(84) bytes of data.
64 bytes from 172.17.0.2: icmp_seq=1 ttl=64 time=0.122 ms
...

/ 7	. 

/ we maken 3 containers	, 
/ pg en fd op bridge network	,
/ pg2 my-bridge-2 network	,

/ vanaf fd doen we ping	,

[eric@almond Docker2]$ docker run --rm --name fd -ti my/fedora-locale bash

[eric@almond postgres]$ docker run --rm --name pg -t my/fedora_postgres
[eric@almond postgres]$ docker run --rm --name pg2 -t --net=my-bridge-2 my/fedora_postgres

/ inspect networks	,

[eric@almond postgres]$ docker network inspect bridge 
       "Containers": {
            "777e1e1c9459367743e06a7f4928ce5eece922b9e332ef119231a2428d833c0b": {
                "Name": "fd",
                "EndpointID": "7d4d125a811a14f1cea219e19eccbd59af2eafec7dd2ecc1898b40679b2d56c8",
                "MacAddress": "02:42:ac:11:00:03",
                "IPv4Address": "172.17.0.3/16",
                "IPv6Address": ""
            },
            "a2a40394a317ba054a29305200fcd3726b4c1849639968417fda61a142cc4c05": {
                "Name": "pg",
                "EndpointID": "de94758155a406df4e3ff4ab65aaa7908c5ed54fb3f519f2af18ffbd95ab6adf",
                "MacAddress": "02:42:ac:11:00:02",
                "IPv4Address": "172.17.0.2/16",
                "IPv6Address": ""

[eric@almond postgres]$ docker network inspect my-bridge-2
        "Containers": {
            "ef28d9dc29b9973133c6c4f63846b842d930233108e5ef61c92aac3865f58d7a": {
                "Name": "pg2",
                "EndpointID": "5699aed2fce2af4a17d29ce63583605f83395f735f0927fb93751e0bbe1b10f4",
                "MacAddress": "02:42:ac:12:00:02",
                "IPv4Address": "172.18.0.2/16",
                "IPv6Address": ""
            }

/ IPv6Address TODO

/ Op fd doen we ping naar pg	,
[root@5967a3cf4cd7 /]# ping 172.17.0.2
PING 172.17.0.2 (172.17.0.2) 56(84) bytes of data.
64 bytes from 172.17.0.2: icmp_seq=1 ttl=64 time=0.178 ms

/ Op fd kunnen we NIET ping naar pg2	,
[root@5967a3cf4cd7 /]# ping 172.18.0.2
/ NIETS	,

/ 7	. 

/ Lees	,
https://major.io/2014/05/13/coreos-vs-project-atomic-a-review/
/ Atomic Host is een OS , zoals CoreOS	, geschikt om containers in te run	, 

/ Lees	,
http://www.projectatomic.io/docs/introduction/

/ 7	. 



/ Einde DOCKER MANUAL AGAIN 2  NETWORKS

/ DOCKER MANUAL AGAIN 2 VOLUMES

/ 7	. 

/ volumes	,

/ het is 
	run/create -v (host dir:/name:/niets)(dir in container)
/ als we niets geven dus -v (dir in container), gens docker de name dus staat er eig. (gen name:)(dir in container) 

/ eerst docker run zonder -v	,

[eric@almond postgres]$ docker run --rm --name fd   -ti my/fedora-locale bash
[root@6bb8676698da /]#

[eric@almond postgres]$ docker inspect fd
        "Mounts": [],
       "Config": {
           "Volumes": null,

/ nu met -v	,

/ dit is toch een named volume	, al geven we geen name	, docker gens de name	, 14070ae5f33464228ea102d220698d6945ee791c63aa3b533dcb6e0dae3a836c
/ als je een naam geeft	, bijv. fd	, dan doe je -v fd:/fd

[eric@almond postgres]$ docker run --rm --name fd -v /fd  -ti my/fedora-locale bash
[root@6bb8676698da /]#

        "Mounts": [
            {
                "Name": "14070ae5f33464228ea102d220698d6945ee791c63aa3b533dcb6e0dae3a836c",
                "Source": "/var/lib/docker/volumes/14070ae5f33464228ea102d220698d6945ee791c63aa3b533dcb6e0dae3a836c/_data",
                "Destination": "/fd",
                "Driver": "local",
                "Mode": "",
                "RW": true,
                "Propagation": ""
            }
        ],
       "Config": {
           "Volumes": {
                "/fd": {}
            },

/	7	. 

/ host dir,	

/ we deden het eerst verkeerd om	,

[eric@almond postgres]$ docker run --rm --name fd -v /fd:/home/eric/tmp/fd  -ti my/fedora-locale bash 
[root@2790602e23f0 /]# 
/ we zien dat op almond /fd/ is created	, 
/ we zien in de container dat /home/eric/tmp/fd/ is created	,

/ in de host	,
[eric@almond Docker2]$  ls -ld /fd
drwxr-xr-x. 2 root root 4096 Aug  3 11:55 /fd

/ in de container	,
[root@2790602e23f0 /]# ls -ld /home/
drwxr-xr-x. 3 root root 4096 Aug  3 09:59 /home/
[root@2790602e23f0 /]# ls -ld /home/eric/
drwxr-xr-x. 3 root root 4096 Aug  3 09:59 /home/eric/
[root@2790602e23f0 /]# ls -ld /home/eric/tmp/
drwxr-xr-x. 3 root root 4096 Aug  3 09:59 /home/eric/tmp/
[root@2790602e23f0 /]# ls -ld /home/eric/tmp/fd
drwxr-xr-x. 2 root root 4096 Aug  3 09:55 /home/eric/tmp/fd

[eric@almond postgres]$ rmdir /fd
rmdir: failed to remove /fd: Permission denied
[eric@almond postgres]$ sudo rmdir /fd
/ OK

/ dus als eric 	, dan doet docker WH sudo	,  
$ docker
/ TODO

/ 7	.

/ host dir (not existing yet) as volume	,

/ Nu doen we	,
[eric@almond postgres]$ docker run --rm --name fd -v /home/eric/tmp/fd:/fd  -ti my/fedora-locale bash 
[root@1fdd0d0217fd /]# ls -l
drwxr-xr-x.   2 root root 4096 Aug  3 11:06 fd

[eric@almond postgres]$ ls ~/tmp/ -l
total 8
drwxr-xr-x. 2 root root 4096 Aug  3 13:06 fd

/ in container	,
[root@cd9e9f70c935 /]# echo  >/fd/1.txt
[root@cd9e9f70c935 /]# cat /fd/1.txt 


/ op host	,
[eric@almond Docker2]$ cat /home/eric/tmp/fd/1.txt 

[eric@almond Docker2]$ ls -ld /home/eric/tmp/fd/1.txt 
-rw-r--r--. 1 root root 3 Aug  3 14:50 /home/eric/tmp/fd/1.txt

[eric@almond Docker2]$ docker volume ls
DRIVER              VOLUME NAME
/ Klopt	, we hebben GEEN named volume create	,

/ exit de container	,
[root@cd9e9f70c935 /]# exit
exit

/ op de host de volume is still there	,
[eric@almond Docker2]$ cat /home/eric/tmp/fd/1.txt 


/ we maken opnieuw een container	, op dezelfe mount point	,
/ De 

[eric@almond postgres]$ docker run --rm --name fd -v /home/eric/tmp/fd:/fd  -ti my/fedora-locale bash
[root@23d74185d26b /]# ls /fd/
1.txt
[root@23d74185d26b /]# cat /fd/1.txt 

/ hij is er nog	,

[root@23d74185d26b /]# exit
exit
 
/ 7	. 

/ rm	,


[eric@almond postgres]$ rmdir ~/tmp/fd
/ Kan	, 
/ TODO

/ Lees	,
https://madcoda.com/2016/03/docker-named-volume-explained/

/ 7	. 

/ rm dangling volumes	,
[eric@almond postgres]$ docker volume ls -f dangling=true | awk 'NR>1{print $2}' | xargs -I % docker volume rm %
8c7556255a64495d9b283265f2a9cb098bf6a3c61930ac7897939cd36c980a1d
bc134bfc2f4a61221c447633955c38566491e7c971fab95bfdba54dbcc0fe55f
fa528a71da9af56d3ddde77443273d18b13b392b4308300867ac8ad1ccc1e145

/ 7	. 

/ named volumne	,

[eric@almond postgres]$ docker run --rm --name fd -v my-fd:/fd  -ti my/fedora-locale bash
root@8eb678c2567a /]# ls
bin   dev  fd    lib    lost+found  mnt  proc  run   srv  tmp  var
boot  etc  home  lib64  media       opt  root  sbin  sys  usr
[root@8eb678c2567a /]# ls fd
/ Leeg	,

[eric@almond postgres]$ docker volume ls
DRIVER              VOLUME NAME
local               my-fd

[eric@almond postgres]$ docker inspect fd
       "Mounts": [
            {
                "Name": "my-fd",
                "Source": "/var/lib/docker/volumes/my-fd/_data",
                "Destination": "/fd",
                "Driver": "local",
                "Mode": "z",
                "RW": true,
                "Propagation": "rprivate"
            }
        ],
        "Config": {
            "Volumes": null,

/ Kun je een andere plaats geven aan de named volume?
/ TODO

/ we kunnen ook het volume inspect	,
[eric@almond postgres]$ docker volume inspect  my-fd
[
    {
        "Name": "my-fd",
        "Driver": "local",
        "Mountpoint": "/var/lib/docker/volumes/my-fd/_data"
    }
]

/ 13	. 

/ we close de container	, de named volume is dan dangling	,
[root@8eb678c2567a /]# exit
exit
[eric@almond postgres]$ docker ps -a
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
[eric@almond postgres]$ docker volume ls -f dangling=true 
DRIVER              VOLUME NAME
local               my-fd

/ we start de container weer	, de named volume is dan NIET dangling meer	,
[eric@almond postgres]$ docker run --rm --name fd -v my-fd:/fd  -ti my/fedora-locale bash
[root@c1c0cb594e84 /]# 

[eric@almond postgres]$ docker volume ls -f dangling=true
DRIVER              VOLUME NAME
/ Dus de volume is NIET dangling meer	,

/ we stop container, en rm volume	,
[root@c1c0cb594e84 /]# exit
exit
[eric@almond postgres]$ docker volume ls -f dangling=true | awk 'NR>1{print $2}' | xargs  docker volume rm 
my-fd


/ 7	. 

[eric@almond postgres]$ docker create -it --name fd my/fedora-locale bash
[eric@almond postgres]$ docker ps -a
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
355c5e7e9819        my/fedora-locale    "bash"              4 seconds ago       Created                                 fd

[eric@almond postgres]$ docker start -a -i fd
[root@355c5e7e9819 /]# 
[eric@almond ch44]$ docker ps -a
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
355c5e7e9819        my/fedora-locale    "bash"              17 seconds ago      Up 5 seconds                            fd

[root@355c5e7e9819 /]# exit
exit
[eric@almond postgres]$ docker ps -a
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS                     PORTS               NAMES
355c5e7e9819        my/fedora-locale    "bash"              33 seconds ago      Exited (0) 8 seconds ago                       fd
[eric@almond postgres]$ docker rm fd
fd

/ 7	. 

/ volume in Dockerfile	,

/ Lees	,
http://container-solutions.com/understanding-volumes-docker/
http://container42.com/2014/11/03/docker-indepth-volumes/

/ Lees	,
https://docs.docker.com/engine/reference/run/#/clean-up-rm

[eric@almond volume]$ pwd
/home/eric/Devel/Docker2/fedora/volume
[eric@almond volume]$ cat Dockerfile 
from my/fedora-locale
run ["dnf","-y","upgrade","--setopt=deltarpm=false"]
run ["mkdir","/myvol"]
run ["echo","1"]
run echo  > /myvol/1.txt
run ["cat","/myvol/1.txt"]
volume /myvol

[eric@almond volume]$ docker run  --rm --name vol -v /myvol2 -ti my/fedora-volume bash 
[root@43a1459160f0 /]# 

[eric@almond ch44]$ docker volume ls 
DRIVER              VOLUME NAME
local               d30f728e79f1676dcde55bf0fb9cc30f7f8749a0528dad74eeb1dd703f90873c
local               0bc33036abd7dc277ffd740a3ab5d4263b90a8b90b6d3cff4f6356ffbc6a1eb0

/ we zien dat volume in een Dockerfile hetzelfde is als run -v /myvol		, dus een named volume,	 waarbij de name is gen door Docker	,

/ we close de container	,
[root@43a1459160f0 /]# exit
exit
[eric@almond ch44]$ docker volume ls 
DRIVER              VOLUME NAME
/ Geen volumes meer	, dat is omdat we --rm gaven	, 

/ 13	. 

/ nu ZONDER --rm	,
[eric@almond volume]$ docker run  --name vol -v /myvol2 -ti my/fedora-volume bash 
[root@43a1459160f0 /]# exit
exit
[eric@almond ch44]$ docker volume ls 
DRIVER              VOLUME NAME
local               f13eb9d79844d66c94bf3bd419df8d0bf4453a305ed87d188c5e160e70ce1836
local               dec3868ae21aaa5bd61d47171bc225326bef49848c912054ea547fb8a89df90c
[eric@almond ch44]$ docker volume ls -f dangling=true
DRIVER              VOLUME NAME
[eric@almond ch44]$ docker ps -a
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS                     PORTS               NAMES
c388917f52ae        my/fedora-volume    "bash"              4 minutes ago       Exited (0) 3 minutes ago                       vol
/ de vols zijn NIET dangling	, want de container is er nog	,

eric@almond volume]$ docker run  --name vol -v /myvol2 -ti my/fedora-volume bash 
docker: Error response from daemon: Conflict. The name "/vol" is already in use by container c388917f52ae303c38498db67674a362897db40428464a28ec11717ed9f5567a. You have to remove (or rename) that container to be able to reuse that name..

[eric@almond ch44]$ docker volume ls -f dangling=true
DRIVER              VOLUME NAME
local               dec3868ae21aaa5bd61d47171bc225326bef49848c912054ea547fb8a89df90c
local               f13eb9d79844d66c94bf3bd419df8d0bf4453a305ed87d188c5e160e70ce1836

[eric@almond volume]$ docker run  --name vol -v /myvol2 -ti my/fedora-volume bash 
[root@080a3c4a83fc /]# 
[eric@almond ch44]$ docker volume ls
DRIVER              VOLUME NAME
local               dec3868ae21aaa5bd61d47171bc225326bef49848c912054ea547fb8a89df90c
local               f13eb9d79844d66c94bf3bd419df8d0bf4453a305ed87d188c5e160e70ce1836
local               9a89661a77e28554f11a6e535e5f1a70c0a74ee07a4f7c53a2705026ad5cd443
local               c0786491f0bda623cc80b243df506556025e0f044061f2174d3a06b2fb0dd021
[eric@almond ch44]$ docker volume ls -f dangling=true
DRIVER              VOLUME NAME
local               dec3868ae21aaa5bd61d47171bc225326bef49848c912054ea547fb8a89df90c
local               f13eb9d79844d66c94bf3bd419df8d0bf4453a305ed87d188c5e160e70ce1836

/ So we are not reusing our volumes from before	,
/ TODO Can we when we use volume in our Dockerfile	?

/ 13	. 

/ Geef in google	,
docker volume database
/ Lees	,
http://stackoverflow.com/questions/18496940/how-to-deal-with-persistent-storage-e-g-databases-in-docker
->
http://www.offermann.us/2013/12/tiny-docker-pieces-loosely-joined.html
http://crosbymichael.com/advanced-docker-volumes.html

/ 13	. 

/ Intermezzo

/ my/fedora_postgres	,

/ Zolang we de container NIET rm, is de data nog in de container	,

[eric@almond postgres]$ docker run --name pg -t my/fedora_postgres					/ --rm zinloos	, 
...
[eric@almond volume]$ docker exec -it pg bash
[root@77a09149584e /]# psql -U postgres
postgres=# create table t(s varchar(32));
postgres=# insert into t values('');
postgres=# \q
[root@77a09149584e /]# exit
exit
[eric@almond postgres]$ docker stop pg
pg
[eric@almond postgres]$ docker start pg
pg
eric@almond volume]$ docker exec -it pg bash
[root@77a09149584e /]# psql -U postgres
postgres=# select*from t;
 s 
---
 
(1 row)

/ Nu gaan we de pg container rm	,

postgres=# \q
[root@77a09149584e /]# exit
exit
/ In tty	, docker run	, 
^c
[eric@almond postgres]$ docker stop pg
pg
[eric@almond postgres]$ docker rm pg
pg
[eric@almond postgres]$ docker start pg
Error response from daemon: No such container: pg
[eric@almond postgres]$ docker run --name pg -t my/fedora_postgres
...
[eric@almond volume]$ docker exec -it pg bash
[root@d6c7b4f9b585 /]# psql -U postgres
postgres=# \dt
No relations found.

/ 13	. 

$ vi Dockerfile
from my/fedora-locale
run ["useradd","eric"]
run ["su","-","eric","-c","chmod o+rwx ."]
run ["su","postgres","-c","mkdir /home/eric/pgsql"]
run ["su","postgres","-c","initdb -D /home/eric/pgsql/data"]	
cmd ["su","postgres","-c","postgres -D /home/eric/pgsql/data"]

/ Bij laatste 2 GEEN su - postgres	,anders GEEN LANG uit fedora-locale	, die in env van root is	, 
																																
/ /home/eric/pgsql/data is alleen in de container,	 
/ Dat moeten we veranderen	,

/ Einde Intermezzo

/ Intermezzo

/ Zolang de container NIET is rm	, is alles er nog	,

/ We kunnen een Created/Exited container start	,

[eric@almond postgres]$ docker create -it --name fd my/fedora-locale bash
eric@almond postgres]$ docker ps -a
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
7ab49897c975        my/fedora-locale    "bash"              8 seconds ago       Created                                 fd
[eric@almond postgres]$ docker start -i fd
[root@b069b0dc1eb3 /]# echo  >1.txt
[root@b069b0dc1eb3 /]# exit
exit
[eric@almond postgres]$ docker ps -a
CONTAINER ID        IMAGE               COMMAND             CREATED              STATUS                     PORTS               NAMES
b069b0dc1eb3        my/fedora-locale    "bash"              About a minute ago   Exited (0) 4 seconds ago                       fd
[eric@almond postgres]$ docker start -i fd
[root@b069b0dc1eb3 /]# cat 1.txt 


/ Nu rm	,
[root@b069b0dc1eb3 /]# exit
exit
[eric@almond postgres]$ docker  rm fd
fd
[eric@almond postgres]$ docker ps -a
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES

/ docker rm -v fd removes ook alle volumes assoc. with fd	,

/ Einde Intermezzo

/ 13	. 

/ we share een volume tussen 2 containers	, 
/ Maak 1 data container, die de volume heeft	, 
/ Maak 2 containers, waar we mee gaan werken, die deze volume use	,
/ Als we in de ene container iets write naar de volume	, ziet de andere container dat	,
/ we kunnen de 2 container rm, maar zolang de  data container er nog is (hij zal Created blijven)	, is het volume er nog	, dus je nog een keer een 3de container maken die dit volume use	,  

/ Dat we hier my_fedora_postgres use	, heeft geen betekenis	, we doen niets met postgres in dit voorbeeld	,

[eric@almond postgres]$ docker create -v /pgdata --name pg my/fedora_postgres
[eric@almond postgres]$ docker ps -a
CONTAINER ID        IMAGE                COMMAND                  CREATED             STATUS              PORTS               NAMES
c427a228f2f2        my/fedora_postgres   "su postgres -c 'post"   25 seconds ago      Created                                 pg

[eric@almond postgres]$ docker run --volumes-from pgdata --name pg1 my/fedora_postgres
/ OK
[eric@almond postgres]$ docker run --volumes-from pgdata --name pg2 my/fedora_postgres
/ OK

[eric@almond volume]$ docker ps -a
CONTAINER ID        IMAGE                COMMAND                  CREATED              STATUS              PORTS               NAMES
23c418874e1b        my/fedora_postgres   "su postgres -c 'post"   48 seconds ago       Up 47 seconds                           pg2
e7981566e5ff        my/fedora_postgres   "su postgres -c 'post"   About a minute ago   Up About a minute                       pg1
dca2fdb96abf        my/fedora_postgres   "su postgres -c 'post"   About a minute ago   Created                                 pgdata

[eric@almond volume]$ docker inspect pgdata
       "Mounts": [
            {
                "Name": "dc92883777575f178142e010f422be4799e14065474eb475f6dda19102026778",
                "Source": "/var/lib/docker/volumes/dc92883777575f178142e010f422be4799e14065474eb475f6dda19102026778/_data",
                "Destination": "/pgdata",
                "Driver": "local",
                "Mode": "",
                "RW": true,
                "Propagation": ""
            }
        ],
        "Config": {
           "Volumes": {
                "/pgdata": {}
            },

[eric@almond volume]$ docker inspect pg1
/ of	,
[eric@almond volume]$ docker inspect pg2
        "Mounts": [
            {
                "Name": "dc92883777575f178142e010f422be4799e14065474eb475f6dda19102026778",
                "Source": "/var/lib/docker/volumes/dc92883777575f178142e010f422be4799e14065474eb475f6dda19102026778/_data",
                "Destination": "/pgdata",
                "Driver": "local",
                "Mode": "",
                "RW": true,
                "Propagation": ""
            }
        ],
        "Config": {
            "Volumes": null,

[eric@almond volume]$ docker exec -ti pg1 bash
[root@e7981566e5ff /]# echo  >/pgdata/1.txt
[root@e7981566e5ff /]# exit
exit
[eric@almond ch44]$ docker exec -ti pg2 bash
[root@23c418874e1b /]# cat /pgdata/1.txt 

[root@23c418874e1b /]# exit 
exit
[eric@almond ch44]$ docker ps -a
CONTAINER ID        IMAGE                COMMAND                  CREATED             STATUS              PORTS               NAMES
23c418874e1b        my/fedora_postgres   "su postgres -c 'post"   15 minutes ago      Up 15 minutes                           pg2
e7981566e5ff        my/fedora_postgres   "su postgres -c 'post"   15 minutes ago      Up 15 minutes                           pg1
dca2fdb96abf        my/fedora_postgres   "su postgres -c 'post"   16 minutes ago      Created                                 pgdata

[eric@almond ch44]$ docker stop pg1 pg2
pg1
pg2
[eric@almond ch44]$ docker rm pg1 pg2
pg1
pg2
eric@almond ch44]$ docker ps -a
CONTAINER ID        IMAGE                COMMAND                  CREATED             STATUS              PORTS               NAMES
dca2fdb96abf        my/fedora_postgres   "su postgres -c 'post"   20 minutes ago      Created                                 pgdata

[eric@almond postgres]$ docker run --volumes-from pgdata --name pg1 my/fedora_postgres
/ OK
[eric@almond ch44]$ docker exec -ti pg1 bash
[root@e2f31e7359e5 /]# cat pgdata/2.txt 


/ 13	. 

/ we maken een backup	van het volume	, en set deze op de host	,

/ we hadden eerder	, en doen we nu dus NIET	, want in het volume zit onze data	, 1.txt en 2.txt	,
[eric@almond postgres]$ docker create -v /pgdata --name pgdata my/fedora_postgres
/ ->
[eric@almond ch44]$ docker ps -a
CONTAINER ID        IMAGE                COMMAND                  CREATED             STATUS              PORTS               NAMES
dca2fdb96abf        my/fedora_postgres   "su postgres -c 'post"   33 minutes ago      Created                                 pgdata

/ 7	. 

/ 13	. 	 

$ docker run --volumes-from pgdata -v /home/eric/tmp/pgdata:/backup my/fedora_postgres tar cvf /backup/backup.tar /pgdata
/ OK
/ we vervangen het postgres cmd uit de Dockerfile door tar cfv ...
/ deze tar cfv ... creates backup.tar in backup/	, en deze verschijnt dus in ~eric/tmp/pgdata/	, 

/ Inderdaad	,
[root@almond ~]# ls /var/lib/docker/volumes/dc92883777575f178142e010f422be4799e14065474eb475f6dda19102026778/_data/ -l
total 12
-rw-r--r--. 1 root root 3 Aug  4 11:10 1.txt
-rw-r--r--. 1 root root 3 Aug  4 11:17 2.txt
-rw-r--r--. 1 root root 3 Aug  4 14:01 3.txt
[eric@almond volume]$ ls ~/tmp/pgdata -l
total 12
-rw-r--r--. 1 root root 10240 Aug  4 13:13 backup.tar

/ 13	. 

[eric@almond ch44]$ docker run --name pg1 --volumes-from pgdata -v /home/eric/tmp/pgdata:/backup my/fedora_postgres tar cvf /backup/backup.tar /pgdata
tar: Removing leading `/' from member names
/pgdata/
/pgdata/2.txt
/pgdata/1.txt

/ OK, 	maar door het tar command dat meteen weer stopt, kunnen we nooit in de container pg1 kijken naar /backup	,
/ Met het command overwrite we het command uit de Dockerfile die de postgres server start	, 

[eric@almond ch44]$ ls -ld /home/eric/tmp/pgdata/backup.tar 
-rw-r--r--. 1 root root 10240 Aug  4 13:00 /home/eric/tmp/pgdata/backup.tar
[eric@almond ch44]$ tar tvf /home/eric/tmp/pgdata/backup.tar 
drwxr-xr-x root/root         0 2016-08-04 11:17 pgdata/
-rw-r--r-- root/root         3 2016-08-04 11:17 pgdata/2.txt
-rw-r--r-- root/root         3 2016-08-04 11:10 pgdata/1.txt

[eric@almond ch44]$ docker ps -a
CONTAINER ID        IMAGE                COMMAND                  CREATED             STATUS                     PORTS               NAMES
dca4f284c53f        my/fedora_postgres   "tar cvf /backup/back"   4 minutes ago       Exited (0) 4 minutes ago                       pg1
dca2fdb96abf        69bb8926c617         "su postgres -c 'post"   2 hours ago         Created                                        pgdata
[eric@almond ch44]$ docker volume ls
DRIVER              VOLUME NAME
local               dc92883777575f178142e010f422be4799e14065474eb475f6dda19102026778

/ 13	. 

[eric@almond ch44]$ docker start -i pg1 bash
You cannot start and attach multiple containers at once.
/ Dit komt door bash erachter	,
/ TODO

[eric@almond ch44]$ docker start -i pg1
tar: Removing leading `/' from member names
/pgdata/
/pgdata/2.txt
/pgdata/1.txt
[eric@almond ch44]$ docker start -i pg1
tar: Removing leading `/' from member names
/pgdata/
/pgdata/2.txt
/pgdata/1.txt

/ 13	. 

/ we maken een my/fedora_postgres container pg2 met command bash	, 
/ Dit hoeft niet	, we kunnen ook geen command geven, en dus de command uit de Dockerfile laten exec	, de postgres server, die niet meteen stopt	, dus kunnen we met docker exec aanhaken aan de container	, 
/ we zullen dat straks doen	,

[eric@almond postgres]$ docker run --name pg2 --volumes-from pgdata -v /home/eric/tmp/pgdata:/backup -it my/fedora_postgres bash
[root@e9b6cd1a77de /]# ls -ld backup/
drwxr-xr-x. 2 root root 4096 Aug  4 11:00 backup/
[root@e9b6cd1a77de /]# ls -ld backup/backup.tar 
-rw-r--r--. 1 root root 10240 Aug  4 11:13 backup/backup.tar
[root@e9b6cd1a77de /]# tar tvf backup/backup.tar 
drwxr-xr-x root/root         0 2016-08-04 09:17 pgdata/
-rw-r--r-- root/root         3 2016-08-04 09:17 pgdata/2.txt
-rw-r--r-- root/root         3 2016-08-04 09:10 pgdata/1.txt

/ we zien dat inderdaad ook in deze container de backup er is	,

[root@e9b6cd1a77de /]# ls
backup  boot  etc   lib    lost+found  mnt  pgdata  root  sbin  sys  usr
bin     dev   home  lib64  media       opt  proc    run   srv   tmp  var
[root@e9b6cd1a77de /]# ls pgdata/ -l
total 8
-rw-r--r--. 1 root root 3 Aug  4 09:10 1.txt
-rw-r--r--. 1 root root 3 Aug  4 09:17 2.txt

[eric@almond volume]$ docker ps -a
CONTAINER ID        IMAGE                COMMAND                  CREATED             STATUS                      PORTS               NAMES
e9b6cd1a77de        my/fedora_postgres   "bash"                   6 minutes ago       Up 6 minutes                                    pg2
dca4f284c53f        my/fedora_postgres   "tar cvf /backup/back"   35 minutes ago      Exited (0) 23 minutes ago                       pg1
dca2fdb96abf        69bb8926c617         "su postgres -c 'post"   2 hours ago         Created                                         pgdata

/ we kunnen aan pg2 container ook aanhaken	,
[eric@almond volume]$ docker exec -it pg2 bash
[root@e9b6cd1a77de /]# ps ajx
 PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND
    0     1     1     1 ?            1 Ss+      0   0:00 bash
    0    52    52    52 ?           73 Ss       0   0:00 bash
   52    73    73    52 ?           73 R+       0   0:00 ps ajx

[eric@almond volume]$ docker ps -a
CONTAINER ID        IMAGE                COMMAND                  CREATED             STATUS                      PORTS               NAMES
e9b6cd1a77de        my/fedora_postgres   "bash"                   7 minutes ago       Up 7 minutes                                    pg2
dca4f284c53f        my/fedora_postgres   "tar cvf /backup/back"   37 minutes ago      Exited (0) 24 minutes ago                       pg1
dca2fdb96abf        69bb8926c617         "su postgres -c 'post"   2 hours ago         Created                                         pgdata
/ In docker ps -a verandert er NIETS	,

[root@e9b6cd1a77de /]# exit
exit
/ docker exec exits	, 

[root@e9b6cd1a77de /]# exit
exit
/ docker run --name pg2 exits	,

[eric@almond postgres]$ docker ps -a
CONTAINER ID        IMAGE                COMMAND                  CREATED             STATUS                      PORTS               NAMES
e9b6cd1a77de        my/fedora_postgres   "bash"                   9 minutes ago       Exited (0) 26 seconds ago                       pg2
dca4f284c53f        my/fedora_postgres   "tar cvf /backup/back"   38 minutes ago      Exited (0) 26 minutes ago                       pg1
dca2fdb96abf        69bb8926c617         "su postgres -c 'post"   2 hours ago         Created                                         pgdata

[eric@almond postgres]$ docker start -i pg2
[root@e9b6cd1a77de /]# ls
backup  boot  etc   lib    lost+found  mnt  pgdata  root  sbin  sys  usr
bin     dev   home  lib64  media       opt  proc    run   srv   tmp  var
/ OK, kan	,

[root@e9b6cd1a77de /]# exit
exit
/ exit pg2	,
[eric@almond postgres]$ docker rm pg2
pg2
/ Omdat ons volume GEEN named volume is	, hoeven we NIET -v in docker rm -v pg2	, 
[eric@almond postgres]$ docker run --name pg2 --volumes-from pgdata -v /home/eric/tmp/pgdata:/backup -it my/fedora_postgres bash

/ 13	. 

/ Maar om aan te haken kunnen we ook	,
[eric@almond postgres]$ docker run --name pg2 --volumes-from pgdata -v /home/eric/tmp/pgdata:/backup -it my/fedora_postgres
LOG:  redirecting log output to logging collector process
HINT:  Future log output will appear in directory "pg_log".

[eric@almond volume]$ docker exec -it pg2 bash
[root@dbdc0993b2fe /]# ls
backup  boot  etc   lib    lost+found  mnt  pgdata  root  sbin  sys  usr
bin     dev   home  lib64  media       opt  proc    run   srv   tmp  var

/ we kunnen docker exec aan een Up container,	

/ 7	. 

[eric@almond postgres]$ docker stop pg1 pg2
pg1
pg2
[eric@almond postgres]$ docker rm pg1 pg2
pg1
pg2
[eric@almond postgres]$ docker ps -a
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMES
dca2fdb96abf        69bb8926c617        "su postgres -c 'post"   2 hours ago         Created                                 pgdata

[eric@almond volume]$ mkdir /home/eric/tmp/pgdata2
[eric@almond postgres]$ docker run --name pg --volumes-from pgdata -v /home/eric/tmp/pgdata2:/backup -it my/fedora_postgres
LOG:  redirecting log output to logging collector process
HINT:  Future log output will appear in directory "pg_log".

[eric@almond volume]$ docker exec -it pg bash
/ in container,	
[root@c32cdcfa251f /]# echo  > pgdata/3.txt			/ gaat naar named volume	, hadden we niet echt hoeven doen	,
pgdata/
pgdata/3.txt
pgdata/2.txt
pgdata/1.txt

/ Klopt	,
[eric@almond volume]$ docker inspect pg
       "Mounts": [
            {
                "Name": "dc92883777575f178142e010f422be4799e14065474eb475f6dda19102026778",
                "Source": "/var/lib/docker/volumes/dc92883777575f178142e010f422be4799e14065474eb475f6dda19102026778/_data",
                "Destination": "/pgdata",
...
root@almond ~]# ls /var/lib/docker/volumes/dc92883777575f178142e010f422be4799e14065474eb475f6dda19102026778/_data/ -l
total 12
-rw-r--r--. 1 root root 3 Aug  4 11:10 1.txt
-rw-r--r--. 1 root root 3 Aug  4 11:17 2.txt
-rw-r--r--. 1 root root 3 Aug  4 14:01 3.txt

/ in container,
[root@c32cdcfa251f /]# tar cvf /backup/my.tar pgdata/
/ op laptop	,
[eric@almond volume]$ ls /home/eric/tmp/pgdata2 -l
total 12
-rw-r--r--. 1 root root 10240 Aug  4 14:03 my.tar

/ in container,	
root@c32cdcfa251f /]# mv /backup/my.tar /backup/root.tar

/ op laptop	,
[eric@almond volume]$ ls /home/eric/tmp/pgdata2 -l
total 12
-rw-r--r--. 1 root root 10240 Aug  4 14:03 root.tar

/ in container,	
[root@c32cdcfa251f /]# su - eric
[eric@c32cdcfa251f ~]$ tar cvf /backup/eric.tar -C / pgdata
pgdata/
pgdata/3.txt
pgdata/2.txt
pgdata/1.txt

/ op laptop	,
[eric@almond volume]$ ls /home/eric/tmp/pgdata2 -l
total 24
-rw-rw-r--. 1 eric eric 10240 Aug  4 14:12 eric.tar
-rw-r--r--. 1 root root 10240 Aug  4 14:03 root.tar
[eric@almond volume]$ tar tvf /home/eric/tmp/pgdata2/eric.tar 
drwxr-xr-x root/root         0 2016-08-04 14:01 pgdata/
-rw-r--r-- root/root         3 2016-08-04 14:01 pgdata/3.txt
-rw-r--r-- root/root         3 2016-08-04 11:17 pgdata/2.txt
-rw-r--r-- root/root         3 2016-08-04 11:10 pgdata/1.txt
/ Klopt	, de files zijn als root create in de container's /pgdata	,

/ in container	,
[root@c32cdcfa251f /]# su - postgres
Last login: Thu Aug  4 12:00:50 UTC 2016 on console
-bash-4.3$ tar cvf /backup/postgres.tar /pgdata/
tar: /backup/postgres.tar: Cannot open: Permission denied
/ dit is WH omdat postgres NIET in /home/eric/tmp/pgdata2 mag write	,


/ 13	. 

/ op laptop	,
/ postgresql-setup moet als root	, NIET als postgres	, wel wordt door postgresql-setup initdb als postgres run	,

[eric@almond volume]$ sudo bash -c "rm -rf  /var/lib/pgsql/data/*"
[eric@almond volume]$ sudo postgresql-setup --initdb
 * Initializing database in '/var/lib/pgsql/data'
 * Initialized, logs are in /var/lib/pgsql/initdb_postgresql.log


/ 13	. 

///////////////////////////////////////////////////////////////////
/ linux & permissions	,
/ postgres wil een file create of edit	,
/ kijk of postgres de laatste in de reeks kan write, de parent's,  daar moet hij doorheen	, 
/ Dus als parent een nieuwe file wilt maken	in een dir	, moet postgres +wx hebben in die dir	, en in parent dir's +x	,
/ Dus als parent een bestaande file wilt edit in een dir	, moet postgres +w hebben op die file	, en +x in alle dir's er naar toe	, 

/ als postgres een file wilt create in een dir van eric	, dan moet deze dir o+wx hebben 	, en parent dir's o+x (als deze niet van postgres zijn)	,
/ als postgres een file wilt create in een dir van postgres, dan moet deze dir u+wx hebben 	, en de alle dir's erboven o+x (als deze dir's niet van postgres zijn)	, 
/ als postgres een file wilt edit in een dir van eric	, en de file is van postgres, dan moeten alle dir's o+x hebben 	,  en de file u+w , maar dat zal wel	,
/ als postgres een file wilt edit in een dir van eric	, en de file is van eric, dan moeten alle dir's o+x hebben 	, en de file o+w , 

/ 1313	. 

/ Voorbeelden	,

/ in container	, 

/ situatie: 
/home is o+x , is van root
/home/eric is o+x , is van eric 
/home/eric/test is o+wx , is van eric 
/ Dus kan postgres een nieuwe file write in home/eric/test/ 	, omdat o+wx	, 


[root@c32cdcfa251f /]# su - eric -c "mkdir test"
[root@c32cdcfa251f /]# ls /home/eric/ -l
drwxrwxr-x. 2 eric     eric     4096 Aug  4 13:04 test
[root@c32cdcfa251f /]# su - postgres
Last login: Thu Aug  4 12:29:01 UTC 2016
-bash-4.3$ echo a >/home/eric/test/1.txt
-bash: /home/eric/test/1.txt: Permission denied
[root@c32cdcfa251f /]# su - eric -c "chmod o+w test"
[root@c32cdcfa251f /]# su - postgres
Last login: Thu Aug  4 13:04:31 UTC 2016
-bash-4.3$ echo a >/home/eric/test/1.txt
-bash-4.3$  
/ OK

[root@c32cdcfa251f /]# su eric -c "echo ~"
/home/eric
[root@c32cdcfa251f /]# su eric -c "chmod o-rwx ~"
[root@c32cdcfa251f /]# su postgres
bash-4.3$ echo a >/home/eric/test/1.txt
bash: /home/eric/test/1.txt: Permission denied
[root@c32cdcfa251f /]# su eric -c "chmod o+x ~"
[root@c32cdcfa251f /]# su postgres -c "echo a >/home/eric/test/1.txt"
/ OK	, edit bestaande file in test/: hoeft alleen o+x test/	, 
[root@c32cdcfa251f /]# su eric -c "mkdir ~/test/sub"
[root@c32cdcfa251f /]# ls -ld /home/eric/
drwx-----x. 4 eric eric 4096 Aug  4 13:04 /home/eric/
[root@c32cdcfa251f /]# ls -ld /home/eric/test/
drwxrwxrwx. 3 eric eric 4096 Aug  4 13:14 /home/eric/test/
[root@c32cdcfa251f /]# ls -ld /home/eric/test/sub
drwxr-xr-x. 2 eric eric 4096 Aug  4 13:14 /home/eric/test/sub
root@c32cdcfa251f /]# su eric -c "chmod go-w ~/test"
[root@c32cdcfa251f /]# ls -ld /home/eric/test/
drwxr-xr-x. 3 eric eric 4096 Aug  4 13:14 /home/eric/test/
[root@c32cdcfa251f /]# su postgres -c "echo a >/home/eric/test/1.txt"		/ omdat 1.txt van postgres is	, dus u+w
[root@c32cdcfa251f /]# su postgres -c "echo a >/home/eric/test/2.txt"		/ omdat test/ NIET o+wx is	,
bash: /home/eric/test/2.txt: Permission denied
[root@c32cdcfa251f /]# su postgres -c "echo a >/home/eric/test/sub/1.txt"
bash: /home/eric/test/sub/1.txt: Permission denied
[root@c32cdcfa251f /]# su eric -c "chmod o+w ~/test/sub"
[root@c32cdcfa251f /]# su postgres -c "echo a >/home/eric/test/sub/1.txt"

/ 13	. 

/ situatie: 
/home is o+x , is van root
/home/eric is o+x , is van eric 
/home/eric/tmp is o+x , is van eric 
/home/eric/tmp/pgdata3 is u+wx , is van postgres 
/ Dus kan postgres een nieuwe file write in home/eric/tmp/pgdata3/ 	, 

/ we maken op de host een dir voor postgres in ~eric	,
[root@almond volume]# mkdir /home/eric/tmp/pgdata3
[root@almond volume]# chown postgres.postgres /home/eric/tmp/pgdata3
[root@almond volume]# su - postgres
-bash-4.3$ echo  > /home/eric/tmp/pgdata3/1.txt
-bash: /home/eric/tmp/pgdata3/1.txt: Permission denied
-bash-4.3$ exit
logout
[eric@almond ~]$ chmod o+x ~
[eric@almond ~]$ ls -ld ~
drwx-----x. 38 eric wheel 4096 Aug  7 15:17 /home/eric
[eric@almond ~]$ exit
logout
[root@almond volume]# su - postgres
-bash-4.3$ echo  > /home/eric/tmp/pgdata3/1.txt

[root@almond volume]# ls -ld /home/
drwxr-xr-x. 4 root root 4096 Sep 10  2015 /home/
[root@almond volume]# ls -ld /home/eric
drwx-----x. 38 eric wheel 4096 Aug  7 15:17 /home/eric
[root@almond volume]# ls -ld /home/eric/tmp
drwxrwxr-x. 6 eric eric 4096 Aug  7 19:13 /home/eric/tmp
[root@almond volume]# ls -ld /home/eric/tmp/pgdata3
drwxr-xr-x. 2 postgres postgres 4096 Aug  7 19:18 /home/eric/tmp/pgdata3
/ Omdat pgdata3 van postgres is	, heeft hij +wx	, dus kan postgres inderdaad in pgdata3 write	,

/ we maken hem leeg	,
[root@almond volume]# rm /home/eric/tmp/pgdata3/*

/ 7	. 

/ we gaan nu volume bind op dir die van postgres is	, 

/ we hadden eerder	, 
[eric@almond postgres]$ docker create -v /pgdata --name pgdata my/fedora_postgres

[eric@almond postgres]$ docker run --volumes-from pgdata -v /home/eric/tmp/pgdata3:/backup -it my/fedora_postgres bash

/ In container	,

[root@8c0433a28364 /]# ls -l
total 56
drwxr-xr-x.   2 postgres postgres 4096 Aug  7 17:43 backup
/////////////////////////////////////////////////////////
/ we zien dat nu ook de dir van postgres is	,

drwxr-xr-x.   2 root     root     4096 Aug  4 12:01 pgdata

root@924b69b8f36b /]# ls -l pgdata/
total 16
-rw-r--r--. 1 root root 3 Aug  7 19:45 1.txt
-rw-r--r--. 1 root root 3 Aug  4 09:17 2.txt
-rw-r--r--. 1 root root 3 Aug  4 12:01 3.txt

[root@924b69b8f36b /]# ls -ld pgdata/
drwxr-xr-x. 2 root root 4096 Aug  7 19:51 pgdata/
[root@924b69b8f36b /]# chmod o+w pgdata/
[root@924b69b8f36b /]# su eric
[eric@924b69b8f36b /]$ echo  > /pgdata/4.txt
[root@924b69b8f36b /]# chmod o-w pgdata/				/ herstel	,

[root@924b69b8f36b /]# ls -l pgdata/
total 16
-rw-r--r--. 1 root root 3 Aug  7 19:45 1.txt
-rw-r--r--. 1 root root 3 Aug  4 09:17 2.txt
-rw-r--r--. 1 root root 3 Aug  4 12:01 3.txt
-rw-rw-r--. 1 eric eric 3 Aug  7 19:59 4.txt

bash-4.3$ tar cvf /backup/postgres.tar /pgdata/
tar: Removing leading `/' from member names
/pgdata/
/pgdata/3.txt
/pgdata/2.txt
/pgdata/4.txt
/pgdata/1.txt

/ Op host	,
[eric@almond volume]$ ls ~/tmp/pgdata3 -l
total 12
-rw-r--r--. 1 postgres postgres 10240 Aug  7 22:01 postgres.tar

/ In container	,

bash-4.3$ exit
exit
[root@924b69b8f36b /]# su - postgres
-bash-4.3$ pwd
/var/lib/pgsql
-bash-4.3$ tar xvf /backup/postgres.tar 
-bash-4.3$ ls -l
total 12
drwxr-xr-x. 2 postgres postgres 4096 Aug  7 19:51 pgdata
-bash-4.3$ ls -l pgdata/
total 16
-rw-r--r--. 1 postgres postgres 3 Aug  7 19:45 1.txt
-rw-r--r--. 1 postgres postgres 3 Aug  4 09:17 2.txt
-rw-r--r--. 1 postgres postgres 3 Aug  4 12:01 3.txt
-rw-r--r--. 1 postgres postgres 3 Aug  7 19:59 4.txt

/ 7	. 

[eric@almond postgres]$ docker run --name pg -t  my/fedora_postgres 
LOG:  redirecting log output to logging collector process
HINT:  Future log output will appear in directory "pg_log".

[eric@almond volume]$ docker exec -it pg bash
[root@53b9510c2a87 /]# su - postgres
Last login: Sun Aug  7 20:45:21 UTC 2016 on console
-bash-4.3$ exit
logout

/ we zien dat user postgres al bestaat	, initdb moet nog run	,

/ we gaan de Dockerfile aanpassen: run initdb	, laat in /var/lib/pgsql/data	, en volume mount deze naar een dir in /home/eric	, 
/ MORGENOCHTEND	,

/ 13	. 

//////////////////////////////////////////////////////////////////////////////////////////////

[eric@almond postgres]$ docker run --name pg -ti  my/fedora_postgres bash
[eric@almond volume]$ docker exec -ti pg bash
/ handig om er nog een te hebben	, hierin doen we bijv 
[root@51cbec43bcc4 /]# su postgres
/ We doen NIET su - postgres	, want met $ su postgres heeft postgres LANG=en_US.utf8 in env	, see (*) beneden	, bij encoding, collate	, ... in de databases	,

-bash-4.3$ initdb -D /home/eric/pgsql/data -A ident
/ In postgresql-set wordt >> log file	, /var/lib/pgsql/initdb_postgresql.log

/ Intermezzo

/ Als we toch $ su - postgres doen	, en postgres LANG=en_US.utf8 NIET in env heeft, dan postgres altijd nog	,
-bash-4.3$ initdb -D /home/eric/pgsql/data -A ident --locale=en_US.utf8
/ of	,
-bash-4.3$ export LANG=en_US.utf8;initdb -D /home/eric/pgsql/data -A ident --locale=en_US.utf8

/ Einde Intermezzo


/ we zien de pg_hba.conf die we altijd zien	,
-bash-4.3$ cat /home/eric/pgsql/data/pg_hba.conf 
# TYPE  DATABASE        USER            ADDRESS                 METHOD

# "local" is for Unix domain socket connections only
local   all             all                                     peer
# IPv4 local connections:
host    all             all             127.0.0.1/32            ident
# IPv6 local connections:
host    all             all             ::1/128                 ident
# Allow replication connections from localhost, by a user with the
# replication privilege.
#local   replication     postgres                                peer
#host    replication     postgres        127.0.0.1/32            ident
#host    replication     postgres        ::1/128                 ident

/ Maar deze gaat user postgres edit
-bash-4.3$ vi /home/eric/pgsql/data/pg_hba.conf 
local   all             all                                    	trust 
host    all             all             ::1/128                 password 

/ Als user postgres LATER pg_hba.conf edit, en postgres is al start	, kan hij volstaan met  
-bash-4.3$ pg_ctl  -D /home/eric/pgsql/data/ reload
server signaled

/ peer kan NIET bij host	, alleen (TODO) bij local	,

/ initdb zegt	,
    pg_ctl -D /home/eric/pgsql/data -l logfile start
/ logfile verschijnt in ~postgres=/var/lib/pgsql/	, als postgres daar is	, 
/ we kunnen daar naar toe gaan	, maar door $ su postgres is postgres in / 	, dus doen we -l logfile NIET	,
-bash-4.3$  pg_ctl -D /home/eric/pgsql/data start
server starting
-bash-4.3$ 
[root@51cbec43bcc4 /]# ps ajx
 PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND
    0     1     1     1 ?          154 Ss       0   0:00 bash
    1   146   144     1 ?          154 S       26   0:00 /usr/bin/postgres -D /home/eric/pgsql/data
  146   147   147   147 ?           -1 Ss      26   0:00 postgres: logger process   
  146   149   149   149 ?           -1 Ss      26   0:00 postgres: checkpointer process   
  146   150   150   150 ?           -1 Ss      26   0:00 postgres: writer process   
  146   151   151   151 ?           -1 Ss      26   0:00 postgres: wal writer process   
  146   152   152   152 ?           -1 Ss      26   0:00 postgres: autovacuum launcher process   
  146   153   153   153 ?           -1 Ss      26   0:00 postgres: stats collector process   
    1   154   154     1 ?          154 R+       0   0:00 ps ajx

/ Intermezzo

/ als we pg_hba.conf NIET hadden edit	, 

[root@51cbec43bcc4 /]# psql -U postgres
psql: FATAL:  Peer authentication failed for user "postgres"
/ omdat	,
local   all             all                                     peer 

/ TODO

/ Einde Intermezzo

////////////////////////////////////////////
/ (*)
[root@759e45c6c58d /]# psql -U postgres
postgres=# \l
                                  List of databases
   Name    |  Owner   | Encoding |   Collate   |    Ctype    |   Access privileges   
-----------+----------+----------+-------------+-------------+-----------------------
 postgres  | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 | 
 template0 | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =c/postgres          +
           |          |          |             |             | postgres=CTc/postgres
 template1 | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =c/postgres          +
           |          |          |             |             | postgres=CTc/postgres
(3 rows)
/ Omdat user postgres bij start postgres in zijn env LANG en_US.utf8 heeft	, staat alles goed	, 
/ Als user postgres dat NIET heeft, dan zouden we zien	,
postgres=# \l
                             List of databases
   Name    |  Owner   | Encoding  | Collate | Ctype |   Access privileges   
-----------+----------+-----------+---------+-------+-----------------------
 postgres  | postgres | SQL_ASCII | C       | C     | 
 template0 | postgres | SQL_ASCII | C       | C     | =c/postgres          +
           |          |           |         |       | postgres=CTc/postgres
 template1 | postgres | SQL_ASCII | C       | C     | =c/postgres          +
           |          |           |         |       | postgres=CTc/postgres
(4 rows)


/ root sets eric's linux password to: foobarbaz 

[root@0c3cb1306a76 /]# su eric
[eric@0c3cb1306a76 /]$ cat ~/.psqlrc
\set AUTOCOMMIT off
[eric@0c3cb1306a76 /]$ psql -U postgres
postgres=# \set
AUTOCOMMIT = 'off'
...
/ autocommit is een eig. van psql	, dus moet \set AUTOCOMMIT in ~eric staan	, want eric execs psql	,
/ In postgres=# is postgres de database	, dus er is een user postgres en een database postgres	,

/ create role/alter role  moet worden commit	, create database niet	,

postgres=# create role eric login createdb password 'eric';
CREATE ROLE
postgres=# commit;
COMMIT
postgres=# \q
[eric@0c3cb1306a76 /]$ psql -U eric
psql: FATAL:  database "eric" does not exist

[eric@0c3cb1306a76 /]$ psql -U eric postgres 						/ Met local rule uit pg_hba.conf
postgres=> \q
[eric@759e45c6c58d /]$ psql -U eric -h localhost postgres		/ Met host rule uit pg_hba.conf
Password for user eric: eric 
postgres=> \q

[eric@0c3cb1306a76 /]$ psql -U eric postgres
postgres=> create database eric;
CREATE DATABASE
postgres=> \q																		/ commit niet nodig bij create database	,
[eric@759e45c6c58d /]$ psql -U eric 
eric=> select current_user;
 current_user 
--------------
 eric
(1 row)

eric=> \encoding
UTF8
/ TODO 

//////////////////////////////////////////////////////////////////

/ 7	. 

/ Onthoud: use met psql NIET -c 	, maar use HERE docs	,
/ Met -c ziet psql NIET .psqlrc	, met AUTOCOMMIT off er in	, met HERE docs ziet psql deze wel	,


/ Lees	,
https://www.postgresql.org/docs/9.5/static/app-psql.html
-c command
Specifies that psql is to execute one command string, command, and then exit. This is useful in shell scripts. Start-up files (psqlrc and ~/.psqlrc) are ignored with this option.

/ We hadden in ~eric/.psqlrc \set AUTOCOMMIT off	 , maar dat wordt NIET gezien	 door psql -U postgres -c	,
[root@759e45c6c58d /]# su eric -c "psql -U postgres -c \"create role eric login createdb password 'foo'\""
CREATE ROLE

/ we oef in een container	,

[root@97b3b2e43764 /]# ls -l /home/eric/.psqlrc 
-rw-rw-r--. 1 eric eric 20 Aug  9 18:16 /home/eric/.psqlrc
[root@97b3b2e43764 /]#  cat /home/eric/.psqlrc 
\set AUTOCOMMIT off


[eric@almond postgres]$ docker run --name pg -ti  my/fedora_postgres
/ en	,
[eric@almond volume]$ docker exec -ti pg bash

/ we doen 2 keer here docs	,

[root@97b3b2e43764 /]# su - eric <<BASH
> psql -U postgres <<SQL
> \dg
> SQL
> BASH
Last login: Tue Aug  9 10:39:56 UTC 2016
                                   List of roles
 Role name |                         Attributes                         | Member of 
-----------+------------------------------------------------------------+-----------
 postgres  | Superuser, Create role, Create DB, Replication, Bypass RLS | {}

[root@97b3b2e43764 /]# su - eric <<BASH
psql -U postgres <<SQL
create role eric login createdb password 'foo'
SQL
BASH

Last login: Tue Aug  9 19:35:33 UTC 2016
CREATE ROLE
[root@97b3b2e43764 /]# su - eric <<BASH
psql -U postgres <<SQL
\dg                                           
SQL
BASH
Last login: Tue Aug  9 20:29:13 UTC 2016
                                   List of roles
 Role name |                         Attributes                         | Member of 
-----------+------------------------------------------------------------+-----------
 postgres  | Superuser, Create role, Create DB, Replication, Bypass RLS | {}

/ Dus eric moet commit	,

/ Lees	,
http://stackoverflow.com/questions/19512327/how-to-insert-newline-in-a-already-existing-bash-string-on-the-command-line

/ we zien dat autocommit off is	, wat de bedoeling is	,  we moeten dus commit	,

[root@97b3b2e43764 /]# su - eric <<BASH
psql -U postgres <<SQL
> drop role eric;
create role eric login createdb password 'foo';
commit
SQL
BASH
[root@97b3b2e43764 /]# su - eric <<BASH
psql -U postgres <<SQL
\dg
SQL
BASH
Last login: Tue Aug  9 20:39:52 UTC 2016
                                   List of roles
 Role name |                         Attributes                         | Member of 
-----------+------------------------------------------------------------+-----------
 eric      | Create DB                                                  | {}
 postgres  | Superuser, Create role, Create DB, Replication, Bypass RLS | {}


/ 13	. 

/ Maar dan dit ook in Docker	? 
/ In docker redirect NIET	, dus in docker file NIET echo '\set AUTOCOMMIT off` >.psqlrc 
/ We use add	,

[eric@almond postgres]$ pwd
/home/eric/Devel/Docker2/fedora/postgres
[eric@almond postgres]$ ls -al
-rw-rw-r--. 1 eric eric 1978 Aug  9 21:15 Dockerfile
-rw-rw-r--. 1 eric eric   20 Aug  9 20:16 .psqlrc

[eric@almond postgres]$ cat .psqlrc 
\set AUTOCOMMIT off

[eric@almond postgres]$ cat Dockerfile 
...
add ["/.psqlrc","/home/eric"]
run ["chown","eric.eric","/home/eric/.psqlrc"]

/ die chown moet niet nodig zijn met volumes	,
/ TODO

/ In container,
[eric@almond postgres]$ docker run --name pg -ti  my/fedora_postgres bash
[root@514395d5c779 /]# ls -al /home/eric/
drwxr-xr-x. 3 postgres postgres 4096 Aug  9 10:40 pgsql
-rw-rw-r--. 1 eric     eric       20 Aug  9 18:16 .psqlrc

/ 13	. 

/ Intermezzo

/ In container,	

[root@97b3b2e43764 /]# su - eric <<BASH
> ls 
> BASH
Last login: Tue Aug  9 20:55:58 UTC 2016
pgsql

/ =

[root@97b3b2e43764 /]# echo ls | su - eric
Last login: Tue Aug  9 20:59:29 UTC 2016
pgsql

/ =

[root@97b3b2e43764 /]# echo ls >/tmp/script
[root@97b3b2e43764 /]# su - eric </tmp/script
Last login: Tue Aug  9 20:58:54 UTC 2016
pgsql

/ 1313	. 

/ we kunnen dus ipv HERE docs	, 

[root@97b3b2e43764 /]# su - eric

[eric@97b3b2e43764 ~]$ echo '\dg' | psql -U postgres
                                   List of roles
 Role name |                         Attributes                         | Member of 
-----------+------------------------------------------------------------+-----------
 postgres  | Superuser, Create role, Create DB, Replication, Bypass RLS | {}

[eric@97b3b2e43764 ~]$ echo "create role eric login createdb password 'foo'" | psql -U postgres
CREATE ROLE
[eric@97b3b2e43764 ~]$ echo '\dg' | psql -U postgres
                                   List of roles
 Role name |                         Attributes                         | Member of 
-----------+------------------------------------------------------------+-----------
 postgres  | Superuser, Create role, Create DB, Replication, Bypass RLS | {}

/ we zien dat .psqlrc gezien wordt	, 

/1313	. 

/ we moeten hierboven 1 stap apart maken	,
# su - eric
$ ...

/ Kunnen we zoiets als
[root@97b3b2e43764 /]# echo '\dg' | psql -U postgres | su - eric
/ TODO

/ Geef in google	, 
docker file here document

/ 13	. 

/ pipe kan in Dockerfile	,

run echo "ls" | su - eric
/ OK




/ Einde Intermezzo

/ 7	. 

/ Lees	,
/ Geef in google	,
docker postgres create user
->
http://stackoverflow.com/questions/26598738/how-to-create-user-database-in-script-for-docker-postgres
->
https://docs.docker.com/engine/admin/using_supervisord/
/ Lees	,
https://hub.docker.com/_/postgres/
If you would like to do additional initialization in an image derived from this one, add one or more *.sql or *.sh scripts under /docker-entrypoint-initdb.d (creating the directory if necessary). 

/	7	. 

$ vi Dockerfile
run echo '\dg' | psql -U postgres
/ Hoe in exec form	?


/ Einde DOCKER MANUAL AGAIN 2 VOLUMES

/ DOCKER LIBRARY POSTGRES

$ vi ~/bin/rm-dangling-images.sh
docker images -f dangling=true | awk 'NR>1{print $3}' | xargs docker rmi

/ Intermezzo

[eric@almond postgres]$  docker ps -a
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMES
dca2fdb96abf        69bb8926c617        "su postgres -c 'post"   5 days ago          Created                                 pgdata

[eric@almond postgres]$  docker images -f dangling=true | awk 'NR>1{print $3}' | xargs docker rmi 
Failed to remove image (69bb8926c617): Error response from daemon: conflict: unable to delete 69bb8926c617 (must be forced) - image is being used by stopped container dca2fdb96abf

/ Einde Intermezzo

/ 7	. 

/ Lees	,
https://docs.docker.com/v1.11/engine/userguide/eng-image/dockerfile_best-practices/#entrypoint

$ docker pull postgres
/ OK

[eric@almond postgres]$  docker run postgres
The files belonging to this database system will be owned by user "postgres".
This user must also own the server process.

The database cluster will be initialized with locale "en_US.utf8".
The default database encoding has accordingly been set to "UTF8".
The default text search configuration will be set to "english".

Data page checksums are disabled.

fixing permissions on existing directory /var/lib/postgresql/data ... ok
creating subdirectories ... ok
selecting default max_connections ... 100
selecting default shared_buffers ... 128MB
selecting dynamic shared memory implementation ... posix
creating configuration files ... ok
creating template1 database in /var/lib/postgresql/data/base/1 ... ok
initializing pg_authid ... ok
initializing dependencies ... ok
creating system views ... ok
loading system objects' descriptions ... ok
creating collations ... ok
creating conversions ... ok
creating dictionaries ... ok
setting privileges on built-in objects ... ok
creating information schema ... ok
loading PL/pgSQL server-side language ... ok
vacuuming database template1 ... ok
copying template1 to template0 ... ok
copying template1 to postgres ... ok
syncing data to disk ... ok

Success. You can now start the database server using:

    pg_ctl -D /var/lib/postgresql/data -l logfile start


WARNING: enabling "trust" authentication for local connections
You can change this by editing pg_hba.conf or using the option -A, or
--auth-local and --auth-host, the next time you run initdb.
****************************************************
WARNING: No password has been set for the database.
         This will allow anyone with access to the
         Postgres port to access your database. In
         Docker's default configuration, this is
         effectively any other container on the same
         system.

         Use "-e POSTGRES_PASSWORD=password" to set
         it in "docker run".
****************************************************
waiting for server to start....LOG:  database system was shut down at 2016-08-10 07:57:54 UTC
LOG:  MultiXact member wraparound protections are now enabled
LOG:  database system is ready to accept connections
LOG:  autovacuum launcher started
 done
server started
ALTER ROLE


/docker-entrypoint.sh: ignoring /docker-entrypoint-initdb.d/*

LOG:  received fast shutdown request
LOG:  aborting any active transactions
waiting for server to shut down....LOG:  autovacuum launcher shutting down
LOG:  shutting down
LOG:  database system is shut down
 done
server stopped

PostgreSQL init process complete; ready for start up.

LOG:  database system was shut down at 2016-08-10 07:57:56 UTC
LOG:  MultiXact member wraparound protections are now enabled
LOG:  database system is ready to accept connections
LOG:  autovacuum launcher started

[eric@almond volume]$ docker ps -a
CONTAINER ID        IMAGE               COMMAND                  CREATED              STATUS              PORTS               NAMES
9b6b836ed988        postgres            "/docker-entrypoint.s"   About a minute ago   Up About a minute   5432/tcp            gloomy_shaw

[eric@almond volume]$ docker exec -it gloomy_shaw bash
root@9b6b836ed988:/# ps ajx
 PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND
    0     1     1     1 ?           -1 Ss     999   0:00 postgres
    1    85    85    85 ?           -1 Ss     999   0:00 postgres: checkpointer process  
    1    86    86    86 ?           -1 Ss     999   0:00 postgres: writer process  
    1    87    87    87 ?           -1 Ss     999   0:00 postgres: wal writer process  
    1    88    88    88 ?           -1 Ss     999   0:00 postgres: autovacuum launcher process  
    1    89    89    89 ?           -1 Ss     999   0:00 postgres: stats collector process  
    0    92    92    92 ?          100 Ss       0   0:00 bash
   92   100   100    92 ?          100 R+       0   0:00 ps ajx
root@9b6b836ed988:/# psql -U postgres
psql (9.5.3)
Type "help" for help.

postgres=# \q

root@9b6b836ed988:/# cat /var/lib/postgresql/data/pg_hba.conf 
# TYPE  DATABASE        USER            ADDRESS                 METHOD

# "local" is for Unix domain socket connections only
local   all             all                                     trust
# IPv4 local connections:
host    all             all             127.0.0.1/32            trust
# IPv6 local connections:
host    all             all             ::1/128                 trust
# Allow replication connections from localhost, by a user with the
# replication privilege.
#local   replication     postgres                                trust
#host    replication     postgres        127.0.0.1/32            trust
#host    replication     postgres        ::1/128                 trust

host all all 0.0.0.0/0 trust

/ 7	.

[eric@almond postgres]$  docker run --rm -it postgres bash
root@48004d5989fd:/# ps ajx
 PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND
    0     1     1     1 ?            9 Ss       0   0:00 bash
    1     9     9     1 ?            9 R+       0   0:00 ps ajx
root@48004d5989fd:/# ls /var/lib/postgresql/data/												
root@48004d5989fd:/# su - postgres																			
No directory, logging in with HOME=/
$ whoami 
postgres
$ ls /
bin   dev			  docker-entrypoint.sh	home  lib64  mnt  proc	run   srv  tmp	var
boot  docker-entrypoint-initdb.d  etc			lib   media  opt  root	sbin  sys  usr

/ 1313	. 
/ we zien dat /var/lib/postgresql/data LEEG is	, initdb moet nog run in docker-entrypoint.sh 	,

/ 1313	.
/ we zien dat user postgres  GEEN home dir heeft	, in Dockerfile wordt user postgres eerst create	, en dan wordt postgres installed	, MISSCHIEN omdat user postgres al bestaat	 , wordt deze door install postgres niet create	, zoals we altijd laten doen	,
/ TODO

root@541d2ab1c8a4:/# dpkg-query -l | grep postgres
ii  pgdg-keyring               2014.1                   all          keyring for apt.postgresql.org
ii  postgresql-9.5             9.5.3-1.pgdg80+1         amd64        object-relational SQL database, version 9.5 server
ii  postgresql-client-9.5      9.5.3-1.pgdg80+1         amd64        front-end programs for PostgreSQL 9.5
ii  postgresql-client-common   175.pgdg80+1             all          manager for multiple PostgreSQL client versions
ii  postgresql-common          175.pgdg80+1             all          PostgreSQL database-cluster manager
ii  postgresql-contrib-9.5     9.5.3-1.pgdg80+1         amd64        additional facilities for PostgreSQL

root@541d2ab1c8a4:/# apt-cache search postgres | grep common
postgresql-common - PostgreSQL database-cluster manager

/ 1313	.
/ Als we docker-entrypoint.sh willen run, moeten we postgres als arg geven	,

root@541d2ab1c8a4:/# bash docker-entrypoint.sh postgres
The files belonging to this database system will be owned by user "postgres".
This user must also own the server process.

The database cluster will be initialized with locale "en_US.utf8".
The default database encoding has accordingly been set to "UTF8".
The default text search configuration will be set to "english".

Data page checksums are disabled.

/ initdb	,

fixing permissions on existing directory /var/lib/postgresql/data ... ok					
creating subdirectories ... ok
selecting default max_connections ... 100
selecting default shared_buffers ... 128MB
selecting dynamic shared memory implementation ... posix
creating configuration files ... ok
creating template1 database in /var/lib/postgresql/data/base/1 ... ok
initializing pg_authid ... ok
initializing dependencies ... ok
creating system views ... ok
loading system objects' descriptions ... ok
creating collations ... ok
creating conversions ... ok
creating dictionaries ... ok
setting privileges on built-in objects ... ok
creating information schema ... ok
loading PL/pgSQL server-side language ... ok
vacuuming database template1 ... ok
copying template1 to template0 ... ok
copying template1 to postgres ... ok
syncing data to disk ... ok

WARNING: enabling "trust" authentication for local connections
You can change this by editing pg_hba.conf or using the option -A, or
--auth-local and --auth-host, the next time you run initdb.

Success. You can now start the database server using:

    pg_ctl -D /var/lib/postgresql/data -l logfile start

****************************************************
WARNING: No password has been set for the database.
         This will allow anyone with access to the
         Postgres port to access your database. In
         Docker's default configuration, this is
         effectively any other container on the same
         system.

         Use "-e POSTGRES_PASSWORD=password" to set
         it in "docker run".
****************************************************

/ pg_ctl 	, start server om scripts in docker-entrypoint-init.d/ te exec, 

waiting for server to start....LOG:  database system was shut down at 2016-08-10 09:13:15 UTC
LOG:  MultiXact member wraparound protections are now enabled
LOG:  database system is ready to accept connections
LOG:  autovacuum launcher started
 done
server started
ALTER ROLE


docker-entrypoint.sh: ignoring /docker-entrypoint-initdb.d/*

/ pg_ctl	, stop server die scripts in /docker-entrypoint-initdb.d/* execs	, 

LOG:  received fast shutdown request
LOG:  aborting any active transactions
LOG:  autovacuum launcher shutting down
LOG:  shutting down
waiting for server to shut down....LOG:  database system is shut down
 done
server stopped

PostgreSQL init process complete; ready for start up.

/ start server met postgres	, uiteindelijk	,

LOG:  database system was shut down at 2016-08-10 09:13:16 UTC
LOG:  MultiXact member wraparound protections are now enabled
LOG:  database system is ready to accept connections
LOG:  autovacuum launcher started
/ Als we willen stop	,
^CLOG:  received fast shutdown request
LOG:  aborting any active transactions
LOG:  autovacuum launcher shutting down
LOG:  shutting down
LOG:  database system is shut down
root@541d2ab1c8a4:/# exit
exit


/ 1313	.
[eric@almond volume]$ docker ps -a
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMES
541d2ab1c8a4        postgres            "/docker-entrypoint.s"   22 minutes ago      Up 22 minutes       5432/tcp            stoic_davinci

root@541d2ab1c8a4:/# ps ajx
 PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND
    0     1     1     1 ?          202 Ss       0   0:00 bash
    1   202   202     1 ?          202 S+     999   0:00 postgres
  202   279   279   279 ?           -1 Ss     999   0:00 postgres: checkpointer process  
  202   280   280   280 ?           -1 Ss     999   0:00 postgres: writer process  
  202   281   281   281 ?           -1 Ss     999   0:00 postgres: wal writer process  
  202   282   282   282 ?           -1 Ss     999   0:00 postgres: autovacuum launcher process  
  202   283   283   283 ?           -1 Ss     999   0:00 postgres: stats collector process  
    0   293   293   293 ?          300 Ss       0   0:00 bash
  293   300   300   293 ?          300 R+       0   0:00 ps ajx

/ 7	. 

/ bashdb zit niet in apt-get	,
/ we download bashdb	, en maken een dir in ~eric/tmp/bashdb	, met de download er in	, 
/ we start container met volume	,

[eric@almond postgres]$ cp ~/Downloads/bashdb-4.4-0.92.tar.gz ~/tmp/bashdb/
[eric@almond postgres]$  docker run --name pg -v ~/tmp/bashdb:/bashdb   -it postgres bash
root@f8693085f270:/# cd bashdb 
root@f8693085f270:/bashdb# tar xvfz bashdb-4.4-0.92.tar.gz 
root@f8693085f270:/bashdb/bashdb-4.4-0.92# apt-get install vim
root@f8693085f270:/bashdb/bashdb-4.4-0.92# vi INSTALL 
...
root@f8693085f270:/bashdb/bashdb-4.4-0.92# ./configure 
configure: error: no acceptable ld found in $PATH
root@f8693085f270:/bashdb/bashdb-4.4-0.92# apt-get install binutils
root@f8693085f270:/bashdb/bashdb-4.4-0.92# ./configure
root@f8693085f270:/bashdb/bashdb-4.4-0.92# apt-get install make
root@f8693085f270:/bashdb/bashdb-4.4-0.92# make 
/ WH nothing to do
root@f8693085f270:/bashdb/bashdb-4.4-0.92# make install
...
 /bin/mkdir -p '/usr/share/bin'
 /usr/bin/install -c bashdb '/usr/share/bin'

root@f8693085f270:/# bash --debugger docker-entrypoint.sh postgres
/ GEEN debugging	, runs script	, 
/ TODO

$ vi Dockerfile
ENTRYPOINT ["/docker-entrypoint.sh"]
CMD ["postgres"]
/////////////////////////////////////////////////////////
/ docker-entrypoint.sh heeft dus postgres als arg	,

/ Als we een arg geven	,  'bash' bijv	,
$ docker run --name pg postgres bash
/ dan wordt de hele combinatie overwrite	,
ENTRYPOINT ["/docker-entrypoint.sh"]
CMD ["postgres"]


root@f8693085f270:/# /usr/share/bin/bashdb docker-entrypoint.sh postgres
/ OK
/ we moeten 
# set -e
/ TODO

if [ "${1:0:1}" = '-' ]; then 			/ 1ste char argument	, bij ons 'p'	, omdat postgres argument is	,
/ NEE
/ TODO
if [ "$1" = 'postgres' ]; then
	mkdir -p "$PGDATA"
	chmod 700 "$PGDATA"
	chown -R postgres "$PGDATA"

	chmod g+s /run/postgresql
	chown -R postgres /run/postgresql

bashdb<2> pr $PGDATA
/var/lib/postgresql/data

/ Intermezzo


[eric@almond volume]$ docker exec -ti pg bash
root@f8693085f270:/# ps ajxw
 PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND
    0     1     1     1 ?         3746 Ss       0   0:00 bash
    1  3746  3746     1 console   3746 S+       0   0:00 /bin/bash /usr/share/bin/bashdb docker-entrypoint.sh postgres
    0  3871  3871  3871 ?         3879 Ss       0   0:00 bash
 3871  3879  3879  3871 ?         3879 R+       0   0:00 ps ajxw

[eric@almond postgres]$ ps ajxw | grep docker
30613  3702  3702 30613 pts/36    3702 Sl+   1000   0:01 docker run --name pg -v /home/eric/tmp/bashdb:/bashdb -it postgres bash
 3760  8049  8049  3760 pts/19    8049 S+       0   0:00 /bin/bash /usr/share/bin/bashdb docker-entrypoint.sh postgres
 4166  8294  8294  4166 pts/9     8294 Sl+   1000   0:00 docker exec -ti pg bash
    1 31905 31905 31905 ?           -1 Ssl      0  23:17 /usr/bin/docker daemon -H fd://

/ we zien op de host 	, met dnf installed	,
/usr/bin/bashdb
/ en in container, NIET op de host	,
/usr/share/bin/bashdb

/ TODO TTY console 	, en bashdb in ps op host	,  

/ Einde Intermezzo

/ Door eerdere docker-entrypoint.sh runs	, zien we in docker exec	,
root@f8693085f270:/# ls /var/lib/postgresql/data/
base	      pg_dynshmem    pg_multixact  pg_snapshots  pg_tblspc    postgresql.auto.conf
global	      pg_hba.conf    pg_notify	   pg_stat	 pg_twophase  postgresql.conf
pg_clog       pg_ident.conf  pg_replslot   pg_stat_tmp	 PG_VERSION   postmaster.opts
pg_commit_ts  pg_logical     pg_serial	   pg_subtrans	 pg_xlog

/ Daarom	,
root@f8693085f270:/# rm -rf /var/lib/postgresql/data/*

/ Nu weer verder in docker run	,

(//docker-entrypoint.sh:17):
17:		if [ ! -s "$PGDATA/PG_VERSION" ]; then
bashdb<8>  n
(//docker-entrypoint.sh:18):
18:			eval "gosu postgres initdb $POSTGRES_INITDB_ARGS"
bashdb<9> pr $POSTGRES_INITDB_ARGS													/ GEEN , dus GEEN -auth=ident	,

bashdb<10> n
(//docker-entrypoint.sh:18):
18:			eval "gosu postgres initdb $POSTGRES_INITDB_ARGS"
gosu postgres initdb
bashdb<11> n
The files belonging to this database system will be owned by user "postgres".
This user must also own the server process.

The database cluster will be initialized with locale "en_US.utf8".
The default database encoding has accordingly been set to "UTF8".
The default text search configuration will be set to "english".

Data page checksums are disabled.

fixing permissions on existing directory /var/lib/postgresql/data ... ok
creating subdirectories ... ok
selecting default max_connections ... 100
selecting default shared_buffers ... 128MB
selecting dynamic shared memory implementation ... posix
creating configuration files ... ok
creating template1 database in /var/lib/postgresql/data/base/1 ... ok
initializing pg_authid ... ok
initializing dependencies ... ok
creating system views ... ok
loading system objects' descriptions ... ok
creating collations ... ok
creating conversions ... ok
creating dictionaries ... ok
setting privileges on built-in objects ... ok
creating information schema ... ok
loading PL/pgSQL server-side language ... ok
vacuuming database template1 ... ok
copying template1 to template0 ... ok
copying template1 to postgres ... ok
syncing data to disk ... ok

WARNING: enabling "trust" authentication for local connections
You can change this by editing pg_hba.conf or using the option -A, or
--auth-local and --auth-host, the next time you run initdb.

Success. You can now start the database server using:

    pg_ctl -D /var/lib/postgresql/data -l logfile start

(//docker-entrypoint.sh:22):
22:			if [ "$POSTGRES_PASSWORD" ]; then
bashdb<12> pr $POSTGRES_PASSWORD

bashdb<13> n
(//docker-entrypoint.sh:27):
27:				cat >&2 <<-'EOWARN'
bashdb<14> n
****************************************************
WARNING: No password has been set for the database.
         This will allow anyone with access to the
         Postgres port to access your database. In
         Docker's default configuration, this is
         effectively any other container on the same
         system.

         Use "-e POSTGRES_PASSWORD=password" to set
         it in "docker run".
****************************************************
(//docker-entrypoint.sh:41):
41:				pass=
42:				authMethod=trust

45:			{ echo; echo "host all all 0.0.0.0/0 $authMethod"; } >> "$PGDATA/pg_hba.conf"
bashdb<17> n
(//docker-entrypoint.sh:45):
45:			{ echo; echo "host all all 0.0.0.0/0 $authMethod"; } >> "$PGDATA/pg_hba.conf"
echo "host all all 0.0.0.0/0 $authMethod"
bashdb<18> n
(//docker-entrypoint.sh:49):
/ TODO

		# internal start of server in order to allow set-up using psql-client		
		# does not listen on external TCP/IP and waits until start finishes
		gosu postgres pg_ctl -D "$PGDATA" \
			-o "-c listen_addresses='localhost'" \
			-w start

bashdb<19> pr $PGDATA
/var/lib/postgresql/data
bashdb<20> n
waiting for server to start....LOG:  database system was shut down at 2016-08-10 10:29:17 UTC
LOG:  MultiXact member wraparound protections are now enabled
LOG:  database system is ready to accept connections
LOG:  autovacuum launcher started
 done
server started

/ Intermezzo

/ we kijken in docker exec

root@f8693085f270:/# ps ajx --width 2000
 PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND
    0     1     1     1 ?         3746 Ss       0   0:00 bash
    1  3746  3746     1 console   3746 S+       0   0:00 /bin/bash /usr/share/bin/bashdb docker-entrypoint.sh postgres
    0  3871  3871  3871 ?         4069 Ss       0   0:00 bash
    1  4047  3746     1 ?         3746 S+     999   0:00 /usr/lib/postgresql/9.5/bin/postgres -D /var/lib/postgresql/data -c listen_addresses=localhost
 4047  4049  4049  4049 ?           -1 Ss     999   0:00 postgres: checkpointer process                                                                
 4047  4050  4050  4050 ?           -1 Ss     999   0:00 postgres: writer process                                                                      
 4047  4051  4051  4051 ?           -1 Ss     999   0:00 postgres: wal writer process                                                                  
 4047  4052  4052  4052 ?           -1 Ss     999   0:00 postgres: autovacuum launcher process                                                         
 4047  4053  4053  4053 ?           -1 Ss     999   0:00 postgres: stats collector process                                                             
root@f8693085f270:/# psql -U postgres
postgres=# \dt
No relations found.
postgres=# \q

/ Einde Intermezzo

bashdb<21> pr ${POSTGRES_USER}
""

53:			: ${POSTGRES_USER:=postgres}

bashdb<23> pr ${POSTGRES_USER}
postgres

/ Intermezzo

: in bash: Provide a placeholder where a binary operation is expected, see Example 8-2 and default parameters.

/ Einde Intermezzo

54:			: ${POSTGRES_DB:=$POSTGRES_USER}
55:			export POSTGRES_USER POSTGRES_DB

57:			psql=( psql -v ON_ERROR_STOP=1 )
bashdb<28> pr $psql
psql
/ TODO

		if [ "$POSTGRES_USER" = 'postgres' ]; then
/ JA
			op='ALTER'

		"${psql[@]}" --username postgres <<-EOSQL
			$op USER "$POSTGRES_USER" WITH SUPERUSER $pass ;
		EOSQL

bashdb<33> pr ${psql[@]}
psql -v ON_ERROR_STOP=1

bashdb<34> pr $op
ALTER
bashdb<35> pr $pass
""

/ Intermezzo

/ we doen het met de hand	,

root@f8693085f270:/# psql -v ON_ERROR_STOP=1 --username postgres
postgres=# alter user postgres with superuser;
ALTER ROLE
postgres=# \dg
                                   List of roles
 Role name |                         Attributes                         | Member of 
-----------+------------------------------------------------------------+-----------
 postgres  | Superuser, Create role, Create DB, Replication, Bypass RLS | {}

/ Maar postgres was al een super user	,

/ Einde Intermezzo

76:			psql+=( --username "$POSTGRES_USER" --dbname "$POSTGRES_DB" )
bashdb<43> pr ${psql[@]}
psql -v ON_ERROR_STOP=1 --username postgres --dbname postgres

		for f in /docker-entrypoint-initdb.d/*; do
			case "$f" in
				*)        echo "$0: ignoring $f" ;;

89:			gosu postgres pg_ctl -D "$PGDATA" -m fast -w stop
bashdb<50> n
LOG:  received fast shutdown request
LOG:  aborting any active transactions
waiting for server to shut down...FATAL:  terminating connection due to administrator command
.LOG:  autovacuum launcher shutting down
LOG:  shutting down
LOG:  database system is shut down
 done
server stopped

		echo 'PostgreSQL init process complete; ready for start up.'

	exec gosu postgres "$@"
bashdb<54> pr $@
postgres
/ user postgres starts program postgres

bashdb<65> n
LOG:  database system was shut down at 2016-08-10 12:20:04 UTC
LOG:  MultiXact member wraparound protections are now enabled
LOG:  database system is ready to accept connections
LOG:  autovacuum launcher started

/ Nu zien we op de host ook NIET MEER de bashdb entry	, 
/ TODO

/ We geven ^C op docker exec	,  we komen op de host	,
[eric@almond volume]$ 

/ we geven ^c op docker run	, we blijven op de host	, want we hadden $ docker run -ti postgres bash	, 
LOG:  aborting any active transactions
LOG:  autovacuum launcher shutting down
LOG:  shutting down
LOG:  database system is shut down
root@f8693085f270:/# ps ajx
 PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND
    0     1     1     1 ?         4484 Ss       0   0:00 bash
    1  4484  4484     1 ?         4484 R+       0   0:00 ps ajx

/ 7	. 

[eric@almond postgres]$  docker run --name pg   postgres

/ psql naar server	,

[eric@almond volume]$ docker network inspect  bridge 
[
        "Containers": {
            "7c7c367b0ba2e430251f82eabdde5d48e021c7ab876fd820567fe5b3cf04464b": {
                "Name": "pg",
                "EndpointID": "3b6f49296364d3bf4eea091abd3f22030d097322b3a79d5159a938a88cbb13b9",
                "MacAddress": "02:42:ac:11:00:02",
                "IPv4Address": "172.17.0.2/16",
                "IPv6Address": ""
            }

/ 13	. 

/ vanaf host	, 

[eric@almond volume]$ psql -U postgres -h 172.17.0.2
psql (9.4.8, server 9.5.3)
WARNING: psql major version 9.4, server major version 9.5.
         Some psql features might not work.
Type "help" for help.
postgres=# \q

/ 13	. 

/ vanaf andere container in hetzelfde network , bridge 	,

/ 1313	. 

eric@almond volume]$ docker run --name cli -ti postgres bash
oot@c477e7dac086:/# psql -U postgres -h 172.17.0.2
psql (9.5.3)
Type "help" for help.

postgres=# \q

/ 1313	. 

[eric@almond postgres]$ docker run   --name cli -it postgres psql -U postgres -h 172.17.0.2
psql (9.5.3)
Type "help" for help.

postgres=# \q

/ 1313	.

/ Als je het ip & niet weet	,

[eric@almond postgres]$ docker run  --rm  --name cli -it --link pg:cli postgres psql -U postgres -h cli
psql (9.5.3)
Type "help" for help.

postgres=# \q

/ Let op: -it

/ 7	. 

/ we maken de scripts in de official postgres image	,

/ we maken de scripts in een dir op de host	, en dan bind met volume in een container	,

/ we set AUTOCOMMIT off in het script	, 

[eric@almond postgres]$ pwd
/home/eric/Devel/Docker2/postgres
[eric@almond postgres]$ ls
docker-entrypoint-initdb.d
[eric@almond postgres]$ cat docker-entrypoint-initdb.d/init-user-db.sql 
\set AUTOCOMMIT off
create role docker login createdb password 'docker';
commit;
create database docker;

/ GEEN ; achter \set AUTOCOMMIT off	, want de value off;  kent postgres niet	,
/ GEEN create database in een tx	, 

/ start server	,

[eric@almond postgres]$ docker run --rm --name pg -v $(pwd)/docker-entrypoint-initdb.d:/docker-entrypoint-initdb.d  postgres
...
/docker-entrypoint.sh: running /docker-entrypoint-initdb.d/init-user-db.sql
CREATE ROLE
CREATE DATABASE
...

/ -v ABSOLUTE PATH host dir	, or a name value	: ABSOLUTE path dir in container	,

[eric@almond postgres]$  docker run --name pg -v ~/tmp/bashdb:/bashdb   -it postgres bash



/ 1313	. 

[eric@almond ch44]$ docker exec -it pg bash
root@4086b4b2c89d:/# psql -U postgres
psql (9.5.3)
Type "help" for help.

postgres=# \dg
                                   List of roles
 Role name |                         Attributes                         | Member of 
-----------+------------------------------------------------------------+-----------
 docker    | Create DB                                                  | {}
 postgres  | Superuser, Create role, Create DB, Replication, Bypass RLS | {}

 /of	,
/ 1313	.

[eric@almond ch44]$ docker run --rm --name cli --link pg:cli -ti postgres psql -U postgres -h cli
psql (9.5.3)
Type "help" for help.

postgres=# \dg
                                   List of roles
 Role name |                         Attributes                         | Member of 
-----------+------------------------------------------------------------+-----------
 docker    | Create DB                                                  | {}
 postgres  | Superuser, Create role, Create DB, Replication, Bypass RLS | {}
postgres=# \q

/ 7	. 

/ we  wilden .psqlrc met \set AUTOCOMMIT off mount in postgres container, maar user postgres heeft geen home dir	,
/ TODO (MORGEN in eigen postgres	, hoe met owner host/container?)

/ useradd -r postgres : -r system account	, dus GEEN home dir	, dus kunnen we ook niet .psqlrc maken voor user postgres	,

/ Intermezzo

/ Geef in google
postgres autocommit off	,
https://www.postgresql.org/docs/9.1/static/ecpg-sql-set-autocommit.html
https://www.postgresql.org/docs/9.3/static/ecpg-commands.html

/ fedora	,
[root@875da0e92194 /]# useradd eric
/ creates /home/eric	, creates /var/spool/mail/eric	,
[root@875da0e92194 /]#  userdel -r eric
/ -r : rm /var/spool/mail/eric

/ debian	,
root@54a8cb608d25:/# useradd eric
/ creates NOT /home/eric	, creates NOT /var/spool/mail/eric	,
root@54a8cb608d25:/# userdel eric

/ TODO (How configured	?)


/ Einde Intermezzo

/ 7	. 

/ we zien dat .psqlrc met \set AUTOCOMMIT off werkt 	,

[eric@almond postgres]$ pwd
/home/eric/Devel/Docker2/postgres

[eric@almond postgres]$ cat docker-entrypoint-initdb.d/init-user-db.sql 
create role docker login createdb password 'docker';
create database docker;

[eric@almond postgres]$ cat root/.psqlrc 
\set AUTOCOMMIT off

/ Het zal blijken dat ownership in de container van /root/.psqlrc geen rol speelt	, 
/ Hij moet readable zijn voor root	,
/ Ook die van /docker-entrypoint-initdb.d/init-user-db.sql niet	,
/ Hij moet readable zijn voor root	,

/ 13	. 

[eric@almond postgres]$  docker run --rm --name pg -v $(pwd)/root/.psqlrc:/root/.psqlrc -v $(pwd)/docker-entrypoint-initdb.d:/docker-entrypoint-initdb.d  postgres 
...
/docker-entrypoint.sh: running /docker-entrypoint-initdb.d/init-user-db.sql
CREATE ROLE
ERROR:  CREATE DATABASE cannot run inside a transaction block
STATEMENT:  create database docker;

/ we zien dat autocommit off is	,

/ 13	. 

[eric@almond postgres]$  docker run --rm --name pg  -v $(pwd)/docker-entrypoint-initdb.d:/docker-entrypoint-initdb.d  postgres 
...
/docker-entrypoint.sh: running /docker-entrypoint-initdb.d/init-user-db.sql
CREATE ROLE
CREATE DATABASE

/ we zien dat autocommit on is	,

/ 13	 .

/ we willen de fout begrijpen	,
/ we doen de SQL met de hand	,

/ we zien dat we een tx ERR krijgen op create database	, 
# create role ...
# create database ...
/ maar dat OK is	,
# create database ...
/ Omdat autocommit off is	, en create role binnen een tx execs	, wordt er een tx start	, 
/ maar create database runs NIET in een tx	, dus is er geen tx start	, 
/ oplossing	, 
# create role ...
# commit;
# create database ...

/ in console	,
[eric@almond postgres]$  docker run --rm --name pg -v $(pwd)/root/.psqlrc:/root/.psqlrc   postgres 
...
/ in andere console	,
[eric@almond postgres]$ docker exec -it pg bash
postgres=# create role docker login createdb password 'docker';
CREATE ROLE
postgres=# create database docker;
ERROR:  CREATE DATABASE cannot run inside a transaction block
postgres=# commit;
ROLLBACK
postgres=# \dg
                                   List of roles
 Role name |                         Attributes                         | Member of 
-----------+------------------------------------------------------------+-----------
 postgres  | Superuser, Create role, Create DB, Replication, Bypass RLS | {}

postgres=# create database docker;
CREATE DATABASE

/ 13	. 

/ pg_hba.conf

[eric@almond postgres]$ docker exec -it pg bash
# apt-get update && apt-get install vim
root@894200afa833:/# vi /var/lib/postgresql/data/pg_hba.conf 
host    all             all             0.0.0.0/0               md5
root@894200afa833:/# gosu postgres pg_ctl reload
server signaled
root@894200afa833:/# psql -U postgres -h 172.17.0.2          
Password for user postgres: 
/ OK	, 
/ Dus any ipv4 is 0.0.0.0/0
/ Wat is dat in ipv6	? Is dat ::/128	?

/ Lees	,
https://docs.docker.com/v1.5/articles/networking/#ipv6
http://stackoverflow.com/questions/7474066/how-to-listen-on-all-ipv6-addresses-using-c-sockets-api
/ we zien dat postgres in docker container ipv4 	, op host ipv6	, 
/ Lees	,
https://en.wikipedia.org/wiki/0.0.0.0
n IPv6, the all-zeros address is typically represented by "::". [2]
/ Lees	,
http://ipv6.com/articles/general/IPv6-Addressing.htm

/ Geef in google
postgresql fedora
/Lees	,
/////////////////////////////////////////////////////////
https://fedoraproject.org/wiki/PostgreSQL

/ we doen op de host	, want daar ipv6	,

[root@almond ~]# postgresql-setup --initdb --unit postgresql
 * Initializing database in '/var/lib/pgsql/data'
 * Initialized, logs are in /var/lib/pgsql/initdb_postgresql.log

[root@almond ~]# env | grep LANG
LANG=en_US.UTF-8

/ Geef in google	,
could not connect to server: Invalid argument Is the server running on host
/ Lees	,
http://www.revsys.com/writings/postgresql/errors.html#cannot-connect-local

/ we doen postgres admin in een aparte console	,
[root@almond ~]# su - postgres
-bash-4.3$ env | grep LANG
LANG=en_US.UTF-8
-bash-4.3$ pg_ctl start
server starting
-bash-4.3$ LOG:  redirecting log output to logging collector process
HINT:  Future log output will appear in directory "pg_log".
/ Geef Enter
///////////////////////////////////////////////////////////////////////////
-bash-4.3$ vi /var/lib/pgsql/data/postgresql.conf 
listen_addresses = '*'          / WAS 'localhost'	, 
-bash-4.3$ pg_ctl restart
waiting for server to shut down.... done
server stopped
server starting

-bash-4.3$ vi /var/lib/pgsql/data/pg_hba.conf 
#local   all             all                                     peer				/ 
local   all             all                                     trust
# IPv4 local connections:
host    all             all             127.0.0.1/32            ident
# IPv6 local connections:
#host    all             all             ::1/128                 ident
host    all             all             ::1/128                 md5
-bash-4.3$ pg_ctl reload
server signaled

/ In andere console	,
[eric@almond volume]$ psql -U postgres
postgres=# create role eric login createdb password 'foo';
CREATE ROLE
postgres=# commit;
COMMIT
postgres=# create database eric;
CREATE DATABASE
postgres=# \q


/ Lees	,
http://stackoverflow.com/questions/38898217/cannot-connect-to-local-machine-by-name
If you need the specific address to work add this line to your file:
host  all  all  fe80::6d80:62eb:5bab:f7f6/10  md5
However, for LAN access add this line to IPv6 local connections in pg_hba.conf file:
host  all  all  fe80::/10  md5
Adresses in IPv6 that start with fe80:: are link-local addresses which are used only for communication in one segment of local network or within connection type point-to-point. They can't be routed across the internet/different subnets.

/ TODO ipv6 werkt niet op host	, ping6 naar fe80::2e44:fdff:fe68:82d4  ERR	, 

/ 13	. 

[eric@almond volume]$ psql -U eric -h ::1
Password for user eric: foo
eric=> \q
/ OK, maar is WH fake	, niet echt ipv6	,

/ 13	. 

-bash-4.3$ pg_ctl stop
waiting for server to shut down.... done
server stopped
-bash-4.3$ exit
logout
/ van	,
[root@almond ~]# su - postgres

/ 13	. 

[eric@almond postgres]$ cat docker-entrypoint-initdb.d/init-user-db.sql 
create role docker login createdb password 'eric';
commit;
create database eric;

[eric@almond postgres]$ cat root/.psqlrc 
\set AUTOCOMMIT off

[eric@almond postgres]$  docker run --rm --name pg -v $(pwd)/root/.psqlrc:/root/.psqlrc -v $(pwd)/docker-entrypoint-initdb.d:/docker-entrypoint-initdb.d  postgres 

[eric@almond postgres]$ docker exec -it pg bash
root@924e19e42e63:/# su postgres -c bash
bash: cannot set terminal process group (105): Inappropriate ioctl for device
bash: no job control in this shell
/ TODO
postgres@924e19e42e63:/$ 


ln -sv ../postgresql.conf.sample 
	&& sed -ri "s!^#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!" /usr/share/postgresql/postgresql.conf.sample

/ 13	. 

/ Lees SED hieronder	,
$ vi Dockerfile
...
[eric@almond Mars]$ echo "#listen_addresses='localhost'   # comment"| sed -r "s|^#?(listen_addresses)\s*=\s*(\S+).*|\1 = '*'|"
listen_addresses = '*'
/ OK	,

/ Maar met ! werkt het niet: !\1 Event not found	, dat Bash antwoordt	,
/ Hoe kan dat met !\1 in sed in de Dockerfile	?
/ TODO

/ 13	. 

$ vi Dockerfile
...
/ we doen zelf in een container,

postgres@924e19e42e63:/$ mkdir tmp/sub
postgres@924e19e42e63:/$ echo foo >tmp/1.txt
postgres@924e19e42e63:/$ ln -sv ../1.txt /tmp/sub/
/tmp/sub/1.txt -> ../1.txt
postgres@924e19e42e63:/$ ls /tmp/sub/ -l
total 0
lrwxrwxrwx. 1 postgres postgres 8 Aug 12 13:00 1.txt -> ../1.txt

/ 13	. 

 

/ Einde DOCKER LIBRARY POSTGRES

/ FEDORA

/13	. 

[eric@almond volume]$ host www.google.com
www.google.com has address 216.58.212.164
www.google.com has IPv6 address 2a00:1450:400e:803::2004
[eric@almond volume]$ ping6 2a00:1450:400e:803::2004
connect: Network is unreachable

[eric@almond volume]$ ip -6 fe80::2e44:fdff:fe68:82d4
Object "fe80::2e44:fdff:fe68:82d4" is unknown, try "ip help".

eric@almond volume]$ host ipv6.google.com
ipv6.google.com is an alias for ipv6.l.google.com.
ipv6.l.google.com has IPv6 address 2a00:1450:400e:801::200e

[eric@almond volume]$ host www.google.com
www.google.com has address 216.58.212.164
www.google.com has IPv6 address 2a00:1450:400e:800::2004

[eric@almond volume]$ netstat -r -6
Kernel IPv6 routing table
Destination                    Next Hop                   Flag Met Ref Use If
fe80::/64                      [::]                       U    256 0  1603 docker0
fe80::/64                      [::]                       U    256 0    50 br-d864cce2936f
fe80::/64                      [::]                       U    256 0     0 enp0s25
[::]/0                         [::]                       !n   -1  1739162 lo
localhost6.localdomain6/128    [::]                       Un   0   5   222 lo
almond.nuts.org/128            [::]                       Un   0   1   229 lo
almond.nuts.org/128            [::]                       Un   0   1   884 lo
almond.nuts.org/128            [::]                       Un   0   1    20 lo
ff00::/8                       [::]                       U    256 4  3846 docker0
ff00::/8                       [::]                       U    256 4   309 br-d864cce2936f
ff00::/8                       [::]                       U    256 3    23 enp0s25
[::]/0                         [::]                       !n   -1  1739162 lo

/ 13	. 

/ Lees	, 
http://www.linuxquestions.org/questions/linux-newbie-8/ping6-network-unreachable-4175442765/

[eric@almond volume]$ ip route
default via 192.168.123.254 dev enp0s25  proto static  metric 100 
172.17.0.0/16 dev docker0  proto kernel  scope link  src 172.17.0.1 
172.18.0.0/16 dev br-d864cce2936f  proto kernel  scope link  src 172.18.0.1 
172.19.0.0/16 dev br-b59b1e45ee2b  proto kernel  scope link  src 172.19.0.1 
192.168.122.0/24 dev virbr0  proto kernel  scope link  src 192.168.122.1 
192.168.123.0/24 dev enp0s25  proto kernel  scope link  src 192.168.123.182  metric 100 

[eric@almond volume]$ ip -6 route
fe80::/64 dev docker0  proto kernel  metric 256  pref medium
fe80::/64 dev br-d864cce2936f  proto kernel  metric 256  pref medium
fe80::/64 dev enp0s25  proto kernel  metric 256  pref medium

/ 13	. 

/ Lees	,
http://helpforlinux.blogspot.nl/2009/07/use-ipv6-in-linux.html

[eric@almond volume]$ lsmod  | grep ipv
nf_nat_masquerade_ipv4    16384  1 ipt_MASQUERADE
nf_reject_ipv6         16384  1 ip6t_REJECT
nf_conntrack_ipv6      20480  12
nf_defrag_ipv6         36864  1 nf_conntrack_ipv6
nf_nat_ipv6            16384  1 ip6table_nat
nf_conntrack_ipv4      16384  1
nf_defrag_ipv4         16384  1 nf_conntrack_ipv4
nf_nat_ipv4            16384  1 iptable_nat
nf_nat                 24576  4 nf_nat_ipv4,nf_nat_ipv6,xt_nat,nf_nat_masquerade_ipv4
nf_conntrack          106496  9 nf_conntrack_netbios_ns,nf_nat,nf_nat_ipv4,nf_nat_ipv6,xt_conntrack,nf_nat_masquerade_ipv4,nf_conntrack_broadcast,nf_conntrack_ipv4,nf_conntrack_ipv6

/ TODO

/ Lees	,
https://fedoraproject.org/wiki/How_to_setup_IPv6_connectivity_with_your_ISP

[eric@almond volume]$ cat /etc/sysconfig/network-scripts/ifcfg-enp0s25 
TYPE="Ethernet"
BOOTPROTO="dhcp"
DEFROUTE="yes"
IPV4_FAILURE_FATAL="no"
IPV6INIT="yes"
IPV6_AUTOCONF="yes"
IPV6_DEFROUTE="yes"
IPV6_FAILURE_FATAL="no"
NAME="enp0s25"
UUID="ef625510-d047-40b0-b73e-16ddc68b1449"
ONBOOT="yes"
HWADDR="2C:44:FD:68:82:D4"
PEERDNS="yes"
PEERROUTES="yes"
IPV6_PEERDNS="yes"
IPV6_PEERROUTES="yes"

/ Lees	,
http://www.cyberciti.biz/faq/rhel-redhat-fedora-centos-ipv6-network-configuration/



/ Einde FEDORA

/ SED

/ Lees	,
http://www.grymoire.com/Unix/Sed.html

[eric@almond Mars]$ echo "one
> two" | sed 's/one/ONE/'
ONE
two

[eric@almond Mars]$ echo "one
> two" | sed 's|one|ONE|'
ONE
two

[eric@almond Mars]$ echo "one two" | sed 's!one!ONE!'
ONE two
[eric@almond Mars]$ echo "one 
> two" | sed 's!one!ONE!'
bash: !one!ONE!': event not found
/ TODO


[eric@almond Mars]$ echo "one
one" | sed 's|one|(one)|'
(one)
(one)

[eric@almond Mars]$ echo "one
one" | sed 's|one|(&)|'
(one)
(one)

[eric@almond Mars]$ echo "one
two" | sed 's|[a-z]*|(&)|'
(one)
(two)

[eric@almond Mars]$ echo "one one
two two" | sed 's|[a-z]*|(&)|'
(one) one
(two) two

[eric@almond Mars]$ echo "123 abc" | sed 's|[0-9]*|&&|'
123123 abc
[eric@almond Mars]$ echo "abc 123" | sed 's|[0-9]*|&&|'
abc 123

[eric@almond Mars]$ echo "123 abc" | sed  's|[0-9]+|&&|'
123 abc
[eric@almond Mars]$ echo "123 abc" | sed -r 's|[0-9]+|&&|'
123123 abc

/ 13	. 

[eric@almond Mars]$ echo "abc 123" | sed 's/\([a-z]*\).*/\1/'
abc

[eric@almond Mars]$ echo "123 abc" | sed 's/.*\([a-z]*\).*/\1/'

[eric@almond Mars]$ echo "123 abc" | sed 's/\(.*\)\([a-z]*\).*/\1/'
123 abc
/ de 1ste is lege string, want .* heeft alles genomen (greedy)	, 
[eric@almond Mars]$ echo "123 abc" | sed 's/\([^a-z]*\)\([a-z]*\).*/\2/'
abc


[eric@almond Mars]$ echo "abc 123" | sed 's/.*\([a-z]*\).*/\1/'

/ TODO
[eric@almond Mars]$ echo "abc 123" | sed  's/.*\([a-z]+\).*/\1/'
abc 123
[eric@almond Mars]$ echo "abc 123" | sed -r 's/.*\([a-z]+\).*/\1/'
sed: -e expression #1, char 20: invalid reference \1 on `s' command's RHS
/ TODO

[eric@almond Mars]$ echo "abc 123" | sed 's!\([a-z]*\)!\1\1!'
abcabc 123
[eric@almond Mars]$ echo "123 abc" | sed 's!\([a-z]*\)!\1\1!'
123 abc
/ We zien weer greedy	,

/ 13	. 

/ we escape ( en ) niet	, maar dan moeten we -r	,

/ of we '...' of "..." om de sed-expressie, lijkt niets uit te maken	,

[eric@almond Mars]$ echo "abc 123" | sed 's/\(abc\)/\1\1/'
abcabc 123
[eric@almond Mars]$ echo "abc 123" | sed 's/(abc)/\1\1/'
sed: -e expression #1, char 13: invalid reference \1 on `s' command's RHS
[eric@almond Mars]$ echo "abc 123" | sed -r 's/(abc)/\1\1/'
abcabc 123

[eric@almond Mars]$ echo "abc='123'" | sed -r "s/(abc)=\S+.*/\1='*'/"
abc='*'
/ Wat debug	,
[eric@almond Mars]$ echo "abc='123'" | sed -r "s/(abc)=(\S+).*/\1='*' and \2/"
abc='*' and '123'
[eric@almond Mars]$ echo "abc='123' 1" | sed -r "s/(abc)=(\S+)(.*)/\1='*' and \2 and \3/"
abc='*' and '123' and  1

[eric@almond Mars]$ echo "listen_addresses='localhost'"| sed -r "s|^#?(listen_addresses)\s*=\s*(\S+).*|\1 = '*'|"
listen_addresses = '*'
[eric@almond Mars]$ echo "listen_addresses='localhost'"| sed -r "s!^#?(listen_addresses)\s*=\s*(\S+).*!\1 = '*'!"
bash: !\1: event not found
/ TODO
[eric@almond Mars]$ echo "#listen_addresses='localhost'"| sed -r "s|^#?(listen_addresses)\s*=\s*(\S+).*|\1 = '*'|"
listen_addresses = '*'


/ 13	. 

/ Nu vanuit een file	,
[eric@almond Mars]$ cat ~/tmp/my.conf 
#listen_addresses = 'localhost'			# comma-separated list of addresses;
[eric@almond Mars]$ cat ~/tmp/my.conf | sed -r "s|^#?(listen_addresses)\s*=\s*(\S+).*|\1 = '*'|"
listen_addresses = '*'
/ wat debug	,
[eric@almond Mars]$ cat ~/tmp/my.conf | sed -r "s|^#?(listen_addresses)\s*=\s*(\S+)(.*)|\1 = '*' and \2 and \3|"
listen_addresses = '*' and 'localhost' and 			# comma-separated list of addresses;




/ Einde SED

/ DOCKER VOLUMES

/ 13	.  

/ volumes in container, met/zonder name	,

/ deze zien we met 
$ docker volume ...

/ als de container Exited	, is de volume NIET dangling	, want je kunt de container opnieuw start	, en in de nieuwe container is het volume er nog	,

/ Nu is er een verschil of de container volume een name heeft of niet	,
/ Als we de Exited container rm	, worden in beide gevallen de volume dangling	, maar als hij een name heeft,	kan een nieuwe container hem toch oppakken	,

/ Stel de container is Exited	,
/ Als de volume GEEN name heeft, 
/ en we de Exited container rm	, dan wordt de volume dangling	, 
/ en als we een nieuwe container maken , met -v /myvolume precies zo weer, dan wordt er een nieuw volume create	, 

/ Stel de container is Exited	,
/ Als de volume WEL name heeft, 
/ als we de Exited container rm	, dan wordt de volume TOCH OOK dangling	, 
/ en als we een nieuwe container maken , met -v /myvolume precies zo weer, dan is het volume er nog	, met de files er in 	, 

/ zonder name	,

[eric@almond volume]$ docker run  --name fd -ti -v /myvolume my/fedora-locale bash
[root@e1120f16f336 /]# echo  >myvolume/1.txt
[root@e1120f16f336 /]# exit
exit
[eric@almond volume]$ docker volume ls -f dangling=true
DRIVER              VOLUME NAME
[eric@almond volume]$ docker  start -i fd
[root@e1120f16f336 /]# ls myvolume/
1.txt
[root@e1120f16f336 /]# exit
exit
[eric@almond volume]$ docker volume ls
DRIVER              VOLUME NAME
local               7c05a04590ed6d4da2ee3a1409522554d6cac3fb7f0f582dbd6ca59b10cfcd0c
/ NIET dangling	,

[eric@almond volume]$ rm-exited-containers.sh 
e1120f16f336
[eric@almond volume]$ docker run  --name fd -ti -v /myvolume my/fedora-locale bash
[root@e924f32939c6 /]# exit
exit
[eric@almond volume]$ docker volume ls
DRIVER              VOLUME NAME
local               7c05a04590ed6d4da2ee3a1409522554d6cac3fb7f0f582dbd6ca59b10cfcd0c
local               9de3e6e9853afa0a3a297dd62a5e0667f70124603ec6426cedf3a3c3a3c98f36
[eric@almond volume]$ docker volume ls -f dangling=true 
DRIVER              VOLUME NAME
local               7c05a04590ed6d4da2ee3a1409522554d6cac3fb7f0f582dbd6ca59b10cfcd0c


/ met name	,  

[eric@almond volume]$ docker run  --name fd -ti -v myvolume:/myvolume my/fedora-locale bash
[root@69666c164d8f /]# echo  >/myvolume/1.txt
[root@87b561800ce3 /]# exit
exit
[eric@almond volume]$ docker volume ls
DRIVER              VOLUME NAME
local               myvolume
/ NIET dangling	,
[eric@almond volume]$ rm-exited-containers.sh 
87b561800ce3
[eric@almond volume]$ docker volume ls -f dangling=true
DRIVER              VOLUME NAME
local               myvolume
[eric@almond volume]$ docker run  --name fd -ti -v myvolume:/myvolume my/fedora-locale bash
[root@6544ffe67779 /]# ls myvolume/
1.txt
[root@6544ffe67779 /]# exit
exit
[eric@almond volume]$ docker volume ls 
DRIVER              VOLUME NAME
local               myvolume
[eric@almond volume]$ rm-exited-containers.sh 
6544ffe67779
[eric@almond volume]$ rm-dangling-volumes.sh 
myvolume


/ 13	. 

/ volumes in container	, met/zonder name	,

/ Ook is er een verschil als run --rm 

eric@almond volume]$ docker run  --rm --name fd -ti -v /myvolume my/fedora-locale bash
[root@5d774640631a /]# exit
exit
/ de volume is nu ook RM	,

[eric@almond volume]$ docker run  --rm --name fd -ti -v myvolume:/myvolume my/fedora-locale bash
[root@2d02db4a04b4 /]# exit
exit
[eric@almond volume]$ docker volume ls -f dangling=true
DRIVER              VOLUME NAME
local               myvolume


/ 13	. 

/ volumes op de host	,

[eric@almond volume]$ mkdir ~/tmp/myvolume
[eric@almond volume]$ echo foo    bar >~/tmp/myvolume/1.txt
[eric@almond volume]$ docker run  --name fd -ti -v ~/tmp/myvolume:/myvolume my/fedora-locale bash
[root@9f259eb32a47 /]# ls -l myvolume/1.txt 
-rw-rw-r--. 1 1000 1000 14 Aug 11 15:01 myvolume/1.txt 				<- 1000 1000	, van de host	,
[root@9f259eb32a47 /]# useradd eric
[root@9f259eb32a47 /]# ls -l
drwxrwxr-x.   2 eric eric 4096 Aug 11 15:01 myvolume
[root@9f259eb32a47/]# echo   > myvolume/2.txt
[root@9f259eb32a47/]# ls -l myvolume/
-rw-rw-r--. 1 eric eric 14 Aug 11 15:01 1.txt
-rw-r--r--. 1 root root  6 Aug 11 15:28 2.txt
[root@9f259eb32a47 /]# exit
exit
[eric@almond volume]$ rm-exited-containers.sh 
9f259eb32a47
/ docker volume betreft volumes by name	,  dus volumes op de host zien we niet daarmee	,
[eric@almond volume]$ ls -l ~/tmp/
drwxrwxr-x. 2 eric     eric     4096 Aug 11 17:28 myvolume
[eric@almond volume]$ ls -l ~/tmp/myvolume/
total 8
-rw-rw-r--. 1 eric eric 14 Aug 11 17:01 1.txt
-rw-r--r--. 1 root root  6 Aug 11 17:28 2.txt

/ Einde DOCKER VOLUMES

/ DOCKER DOCKERFILE

/ Wat is image gedeelte en wat is container gedeelte	?

/ 7	. 

[eric@almond dockerfile]$ pwd
/home/eric/Devel/Docker2/fedora/dockerfile
[eric@almond dockerfile]$ cp Dockerfile Dockerfile1
[eric@almond dockerfile]$  ls
Dockerfile  Dockerfile1  script.sh

/ Eerst	, 
 
[eric@almond dockerfile]$ cat Dockerfile
from my/fedora_postgres
run dnf -y upgrade --setopt=deltarpm=false

[eric@almond dockerfile]$ docker build -t my/fedora-dockerfile .
Running transaction
  Upgrading   : systemd-libs-229-12.fc24.x86_64                            1/26 
  Upgrading   : openssl-libs-1:1.0.2h-3.fc24.x86_64                        2/26 
  Upgrading   : system-python-libs-3.5.1-13.fc24.x86_64                    3/26 
  Upgrading   : python3-libs-3.5.1-13.fc24.x86_64                          4/26 
  Upgrading   : libcurl-7.47.1-6.fc24.x86_64                               5/26 
  Upgrading   : audit-libs-2.6.6-1.fc24.x86_64                             6/26 
  Upgrading   : systemd-229-12.fc24.x86_64                                 7/26 
  Upgrading   : curl-7.47.1-6.fc24.x86_64                                  8/26 
  Upgrading   : python3-3.5.1-13.fc24.x86_64                               9/26 
  Upgrading   : perl-libs-4:5.22.2-362.fc24.x86_64                        10/26 
  Upgrading   : libsolv-0.6.23-2.fc24.x86_64                              11/26 
  Upgrading   : fedora-repos-24-2.noarch                                  12/26 
  Upgrading   : chkconfig-1.8-1.fc24.x86_64                               13/26 
...

/ Lees	,
https://docs.fedoraproject.org/en-US/Fedora/22/html/System_Administrators_Guide/ch-System_Locale_and_Keyboard_Configuration.html



/ 13	. 

[eric@almond dockerfile]$ cat Dockerfile
from my/fedora_postgres
run dnf -y upgrade --setopt=deltarpm=false
run ["echo",""]
run ls
copy script.sh /
entrypoint ["/script.sh"]
cmd ["foo"]

 /13	. 

/ we moeten / in 	,
entrypoint ["/script.sh"]
/ anders zoekt root in de container script.sh in $PATH	, en hij is in /	,

/ 13	. 

/ entrypoint wordt ALTIJD exec, 	we moeten alleen het script laten bepalen wat er gebeurt als we args geven aan docker run	, net zo als official postgres dat doet	, 

$ cat script.sh
#!/usr/bin/bash
echo "$@"
pwd
#cat >/tmp/res.txt
if [ "$1" = "foo" ];then
	for i in 1 2 3
	do 
		echo ''
		sleep 3
	done
	exit 0
fi
exec "$@"

/ dus als we straks	geen args geven	,
[eric@almond dockerfile]$ docker run --rm --name fd   my/fedora-dockerfile
foo
/




/ Maar als we dat wel doen	, passeert hij de if niet	, en gaat exec arg doen	,
[eric@almond dockerfile]$ docker run --rm --name fd  -ti  my/fedora-dockerfile bash
bash
/
[root@395340fc0a8a /]# exit
exit
[eric@almond dockerfile]$ 
 

/ WH t/m copy runs in image	 ,
/ entrypoint en command  worden in layers set	, maar nog niet exec	, dat gebeurt in docker run	, 

[eric@almond dockerfile]$ docker build -t my/fedora-dockerfile .

Sending build context to Docker daemon 4.096 kB
Step 1 : FROM my/fedora_postgres
 ---> a4f19b3c7f9a
Step 2 : RUN dnf -y upgrade --setopt=deltarpm=false
 ---> Using cache
 ---> df95081bda5f
Step 3 : RUN echo 
 ---> Running in 710b7eabd091

 ---> 946e3f7336ae
Removing intermediate container 710b7eabd091
Step 4 : RUN ls
 ---> Running in f3b3bee0b745
bin
boot
dev
etc
home
lib
lib64
lost+found
media
mnt
opt
proc
root
run
sbin
srv
sys
tmp
usr
var
 ---> b08239eb5421
Removing intermediate container f3b3bee0b745
Step 5 : COPY script.sh /
 ---> a2883e0e3f01
Removing intermediate container caeb5838d200
Step 6 : ENTRYPOINT /script.sh
 ---> Running in afe7d1684479
 ---> 7aa9bbf320b7
Removing intermediate container afe7d1684479
Step 7 : CMD foo
 ---> Running in 1c2c3137e22b
 ---> 47e3e43f5347
Removing intermediate container 1c2c3137e22b
Successfully built 47e3e43f5347


/ Nu docker run	, zoals we al zagen	,

[eric@almond dockerfile]$ docker run --rm --name fd   my/fedora-dockerfile
foo
/




/ Maar als we dat wel doen	, passeert hij de if niet	, en gaat exec arg doen	,
[eric@almond dockerfile]$ docker run --rm --name fd  -ti  my/fedora-dockerfile bash
bash
/
[root@395340fc0a8a /]# exit
exit
[eric@almond dockerfile]$ 

/ 13	. 

Als we de copy NIET	, en een volume maken	,

/ Dat kan OOK	, 

[eric@almond dockerfile]$ cat Dockerfile
from my/fedora_postgres
run dnf -y upgrade --setopt=deltarpm=false
run ["echo",""]
run ls
#copy script.sh /
entrypoint ["/script.sh"]
cmd ["foo"]

[eric@almond dockerfile]$ docker build -t my/fedora-dockerfile .

[eric@almond dockerfile]$ docker run --rm --name fd  -v $(pwd)/script.sh:/script.sh  my/fedora-dockerfile
foo
/



[eric@almond dockerfile]$ docker run --rm --name fd  -v $(pwd)/script.sh:/script.sh -ti  my/fedora-dockerfile bash
bash
/
[root@a3ff7aa7f57a /]# exit
exit
[eric@almond dockerfile]$

/ dus precies hetzelfde	, 






/ Einde DOCKER DOCKERFILE

/ DOCKER FEDORA

/ Af en toe moeten we my/fedora-locale opnieuw build	,

[eric@almond locale]$  pwd
/home/eric/Devel/Docker2/fedora/locale
[eric@almond locale]$ cat Dockerfile 
from fedora
run ["echo",""]																			<- verander deze voor docker build	,
run ["dnf","-y","upgrade","--setopt=deltarpm=false"]
run ["dnf","-y","install","vim"]
run ["dnf","-y","install","glibc-langpack-en"]
env LANG en_US.UTF-8
env LC_ALL en_US.UTF-8

[eric@almond locale]$ docker build -t my/fedora-locale .
...
 glibc                    x86_64     2.23.1-8.fc24            updates     3.6 M
 glibc-all-langpacks      x86_64     2.23.1-8.fc24            updates     6.9 M
 glibc-common             x86_64     2.23.1-8.fc24            updates     861 k
...
/ klopt,	 deze zitten in fedora image ook	,

/ we zien dus glibc-all-langpacks	, 


/ Einde DOCKER FEDORA

/ DOCKER POSTGRES

/ user postgres hoeft alleen export LANG=en_US.utf8	, 

[eric@almond ch44]$ docker run --name pg --rm -ti my/fedora-locale bash
[root@2b015bc053c1 /]# dnf -y install postgresql-server postgresql-contrib
[root@2b015bc053c1 /]# su - postgres
-bash-4.3$ export LANG=en_US.utf8
-bash-4.3$ initdb 
-bash-4.3$ pg_ctl start

/ we kunnen ook	,
-bash-4.3$ echo "export LANG=en_US.utf8" >>.bash_profile 
-bash-4.3$ . .bash_profile 


[eric@almond java]$ docker exec -ti pg bash
[root@2b015bc053c1 /]# psql -U postgres
postgres=# \l
                                 List of databases
   Name    |  Owner   | Encoding |  Collate   |   Ctype    |   Access privileges   
-----------+----------+----------+------------+------------+-----------------------
 postgres  | postgres | UTF8     | en_US.utf8 | en_US.utf8 | 
 template0 | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +
           |          |          |            |            | postgres=CTc/postgres
 template1 | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +
           |          |          |            |            | postgres=CTc/postgres
(


/ Einde DOCKER POSTGRES

/ DOCKER DOCKERFILE

/ redirect OK in Dockerfile met run shell form	, 

/ WH NIET in exec form	,
/ TODO

/ Af en toe moeten we my/fedora-locale build	, dan weer uptodate fedora	,

/ we maken een user , postgres	, en we zorgen dat 


[eric@almond dockerfile]$ pwd
/home/eric/Devel/Docker2/fedora/dockerfile

[eric@almond dockerfile]$ cat Dockerfile 

from my/fedora-locale
run dnf -y upgrade --setopt=deltarpm=false
run useradd postgres
run echo "export LANG=en_US.utf8" >>/home/postgres/.bash_profile
run cat /home/postgres/.bash_profile 
run echo "" >/1.txt
run cat /1.txt

[eric@almond dockerfile]$ docker build -t my/fedora-dockerfile .
...
[eric@almond dockerfile]$ docker run --rm --name df -ti my/fedora-dockerfile bash
[root@68ee9b8c1bc6 /]# su - postgres
Last login: Sat Aug 13 09:14:12 UTC 2016 on console
[postgres@68ee9b8c1bc6 ~]$ env|grep LANG
LANG=en_US.utf8
[postgres@68ee9b8c1bc6 ~]$ exit
logout
[root@68ee9b8c1bc6 /]# cat 1.txt 


[eric@almond dockerfile]$ pwd
/home/eric/Devel/Docker2/fedora/dockerfile
[eric@almond dockerfile]$ ls
1  2  3  Dockerfile
/ 2/ is met script.sh
/ 3/ is redirect in Dockerfile	,

/ 7	. 

$ vi Dockerfile
expose 5000

docker run -P 
/ -P tells Docker to map any required network ports inside our container to our host

/ Dat kan bijv 32784 zijn	, 
/ Een webapp moet een port hebben	, die geven we met: expose 5000	, 
/ de webapp heeft in de container dus port 5000	, zoals Tomcat 8080 heeft	, maar -P maps port 5000 naar een port op de host	, dat kan 32784 zijn	, dus moeten we in de browser localhost:32784  geven	,




/ Einde DOCKER DOCKERFILE

/ DOCKER SSHD

/ Lees
http://stackoverflow.com/questions/18351198/what-are-the-uses-of-the-exec-command-in-shell-scripts

[eric@almond sshd]$ pwd
/home/eric/Devel/Docker2/fedora/sshd
[eric@almond sshd]$ ls
Dockerfile  script.sh

[eric@almond sshd]$ cat Dockerfile 

from my/fedora-locale 
run dnf -y install openssh-server openssh-clients
run dnf -y install less procps-ng hostname iputils
run setcap cap_net_raw,cap_net_admin+p /usr/bin/ping

run ssh-keygen -A

expose 22

run ssh-keygen -N "" -t rsa -f ~/.ssh/id_rsa
run cat /root/.ssh/id_rsa.pub >>~/.ssh/authorized_keys

copy script.sh /

entrypoint ["/script.sh"]

[eric@almond sshd]$  cat script.sh 
#!/usr/bin/bash

if [ "$#" -eq 0 ];then
	/usr/sbin/sshd -D	
else
 	exec "$@"	
fi

/ We moeten WH , see (*) beneden	,
	exec "usr/sbin/sshd -D"

/ we hebben eerder	,
$ docker network create -d bridge my-bridge

/ we moeten de containers --net my-bridge , met een zelf created network	, dus NIET met de default bridge	, 
/ want nu kunnen we in een container ping/ssh naar een andere container en kunnen we de --name use	,

[eric@almond sshd]$ docker run --name fd-sshd  --rm --net my-bridge my/fedora-sshd

[eric@almond ch44]$ docker run --name fd-sshd2  --rm --net my-bridge -ti my/fedora-sshd bash
[root@d93951d83e70 /]# ping fd-sshd
PING fd-sshd (172.19.0.2) 56(84) bytes of data.
64 bytes from fd-sshd.my-bridge (172.19.0.2): icmp_seq=1 ttl=64 time=0.218 ms
...
[root@d93951d83e70 /]# ssh fd-sshd
The authenticity of host 'fd-sshd (172.19.0.2)' can't be established.
ECDSA key fingerprint is SHA256:8R+7NvDiURavKx+yY4nALSvdft/7bk++e4nLOHdLD44.
ECDSA key fingerprint is MD5:fc:c1:45:1d:fa:ff:c3:35:1a:40:16:17:35:e4:51:19.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added 'fd-sshd,172.19.0.2' (ECDSA) to the list of known hosts.
[root@b233d449f3e9 ~]# pwd
/root
[root@b233d449f3e9 ~]# cd /
[root@b233d449f3e9 /]# ls
bin   dev  home  lib64       media  opt   root  sbin       srv  tmp  var
boot  etc  lib   lost+found  mnt    proc  run   script.sh  sys  usr
[root@b233d449f3e9 /]# hostname
b233d449f3e9
[root@b233d449f3e9 /]# ps ajx
 PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND
    0     1     1     1 ?           -1 Ss       0   0:00 /usr/bin/bash /script.sh
    1     9     1     1 ?           -1 S        0   0:00 /usr/sbin/sshd -D
    9    10    10    10 ?           -1 Ss       0   0:00 sshd: root [priv]
   10    12    10    10 ?           -1 R        0   0:00 sshd: root@pts/0
   12    13    13    13 pts/0       56 Ss       0   0:00 -bash
    0    35    35    35 ?           35 Ss+      0   0:00 bash
   13    56    56    13 pts/0       56 R+       0   0:00 ps ajx

/ We zien dat we in script.sh	,
	/usr/sbin/sshd -D
/ moeten vervangen door	,
	exec "usr/sbin/sshd -D"

/ dan wordt sshd WH PID 1 en PPID 0	, en kunnen we de container met ^c stop	, 
/ nu moeten we 
$ docker stop ...


/ Einde DOCKER SSHD

/ DOCKER SSHD POSTGRES

/ we zullen sshd als daemon start	, en postgres niet	, 

/ we moeten postgres-locale en postgres-sshd samenvoegen	, en postgres-sshd GEEN entrypoint en/of cmd geven	, een soort abstract container, die je include met from, maar waar je gee container van maakt	, 

/ 13	. 

/ we hebben nu sshd in de dockerfile van postgres	,

/ Nu is het nog zo	,

[eric@almond postgres]$ pwd
/home/eric/Devel/Docker2/fedora/postgres

$ cat Dockerfile

from my/fedora-locale
run dnf -y upgrade  --setopt=deltarpm=false

# sshd

run dnf -y install openssh-server openssh-clients

run dnf -y install less procps-ng hostname iputils
run setcap cap_net_raw,cap_net_admin+p /usr/bin/ping

run ssh-keygen -A

expose 22

run ssh-keygen -N "" -t rsa -f ~/.ssh/id_rsa
run cat /root/.ssh/id_rsa.pub >>~/.ssh/authorized_keys

# postgresql

run dnf -y install postgresql-server postgresql-contrib

run dnf -y install findutils tar sudo passwd 
run dnf -y install "dnf-command(repoquery)"																/ "" to escape (	,

run su - postgres -c "echo \"export LANG=en_US.utf8\">>.bash_profile"
run su - postgres -c "initdb"

copy script.sh /

entrypoint ["/script.sh"]

[eric@almond postgres]$ cat script.sh 

#!/usr/bin/bash

if [ "$#" -eq 0 ];then
  /usr/sbin/sshd 
	su - postgres <<-BASH
		postgres
	BASH
else
  exec "$@"
fi

/ Let op: sluit-BASH met een tab	,


[eric@almond postgres]$ docker build -t my/fedora-postgres .

/ in 1ste console	,
[eric@almond postgres]$ docker run --rm --name pg --net my-bridge my/fedora-postgres
...

/ in 2de console	,
eric@almond Devel]$ docker run --rm --name cli --net my-bridge -ti my/fedora-postgres bash
[root@ae3fcd2f87aa /]# ssh pg
The authenticity of host 'pg (172.19.0.2)' can't be established.
ECDSA key fingerprint is SHA256:7KAT30ywS/Ufvqs6ajuon+8/I85FyqGOwNuxEc7Lc3c.
ECDSA key fingerprint is MD5:1d:8f:6e:2a:3e:a8:60:0f:4e:6b:44:da:cc:63:6b:b1.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added 'pg,172.19.0.2' (ECDSA) to the list of known hosts.
[root@4b4a935a291a ~]# ps ajx
 PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND
    0     1     1     1 ?           -1 Ss       0   0:00 /usr/bin/bash /script.sh
    1    10    10    10 ?           -1 Ss       0   0:00 /usr/sbin/sshd
    1    11     1     1 ?           -1 S        0   0:00 su - postgres -c postgres
   11    12    12    12 ?           -1 Ss      26   0:00 postgres
   12    33    33    33 ?           -1 Ss      26   0:00 postgres: logger process  
   12    35    35    35 ?           -1 Ss      26   0:00 postgres: checkpointer process  
   12    36    36    36 ?           -1 Ss      26   0:00 postgres: writer process  
   12    37    37    37 ?           -1 Ss      26   0:00 postgres: wal writer process  
   12    38    38    38 ?           -1 Ss      26   0:00 postgres: autovacuum launcher process  
   12    39    39    39 ?           -1 Ss      26   0:00 postgres: stats collector process  
   10    40    40    40 ?           -1 Ss       0   0:00 sshd: root [priv]
   40    42    40    40 ?           -1 R        0   0:00 sshd: root@pts/0
   42    43    43    43 pts/0       62 Ss       0   0:00 -bash
   43    62    62    43 pts/0       62 R+       0   0:00 ps ajx
[root@4b4a935a291a ~]# psql -U postgres
psql (9.5.3)
Type "help" for help.

postgres=# \l
                                 List of databases
   Name    |  Owner   | Encoding |  Collate   |   Ctype    |   Access privileges   
-----------+----------+----------+------------+------------+-----------------------
 postgres  | postgres | UTF8     | en_US.utf8 | en_US.utf8 | 
 template0 | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +
           |          |          |            |            | postgres=CTc/postgres
 template1 | postgres | UTF8     | en_US.utf8 | en_US.utf8 | =c/postgres          +
           |          |          |            |            | postgres=CTc/postgres
(3 rows)
 


[root@4b4a935a291a ~]# 
stgres=# \q
[root@4b4a935a291a ~]# psql -U postgres -h pg
psql: could not connect to server: Connection refused
	Is the server running on host "pg" (172.19.0.2) and accepting
	TCP/IP connections on port 5432?
/ we moeten repareren	,

/ in 3de console	,
[eric@almond ch44]$ docker exec -ti pg bash
[root@4b4a935a291a /]# su - postgres
Last login: Sat Aug 13 18:31:04 UTC 2016
-bash-4.3$ vi data/pg_hba.conf 
host    all             all             172.19.0.0/24           trust
-bash-4.3$ vi data/postgresql.conf 
#listen_addresses = '*'                 # what IP address(es) to listen on;
-bash-4.3$ pg_ctl restart
waiting for server to shut down....
[eric@almond ch44]$ 

/ Lees	,
https://www.postgresql.org/docs/9.3/static/server-shutdown.html
/ Ook als postgres	,
$ kill -INT `head -1 data/postmaster.pid` 
/ dan exits de container pg	,

/ 7.	 

/ we keren sshd en postgres om in script.sh	,

$ vi script.sh

#!/usr/bin/bash

if [ "$#" -eq 0 ];then
  su - postgres <<-BASH
    pg_ctl start  
  BASH
  /usr/sbin/sshd -D
else
  exec "$@"
fi

/ we kunnen nu 
	pg_ctl start
/ maar ook OK	,
	postgres

[eric@almond postgres]$ docker build -t my/fedora-postgres .
/ 1ste console	,
[eric@almond postgres]$ docker run --rm --name pg my/fedora-postgres
...
/ 2de console	,
[eric@almond Devel]$ docker exec -ti pg bash
[root@9c288ce17b6f /]# su - postgres
Last login: Sat Aug 13 21:23:42 UTC 2016
-bash-4.3$ pg_ctl restart
waiting for server to shut down.... done
server stopped
server starting
-bash-4.3$ LOG:  redirecting log output to logging collector process
HINT:  Future log output will appear in directory "pg_log".

-bash-4.3$ ps axj
 PPID   PID  PGID   SID TTY      TPGID STAT   UID   TIME COMMAND
    0     1     1     1 ?           -1 Ss       0   0:00 /usr/bin/bash /script.sh
    1    33     1     1 ?           -1 S        0   0:00 /usr/sbin/sshd -D
    0    41    41    41 ?          104 Ss       0   0:00 bash
   41    61    61    41 ?          104 S        0   0:00 su - postgres
   61    62    62    41 ?          104 S       26   0:00 -bash
    1    96    95    41 ?          104 S       26   0:00 /usr/bin/postgres
   96    97    97    97 ?           -1 Ss      26   0:00 postgres: logger process  
   96    99    99    99 ?           -1 Ss      26   0:00 postgres: checkpointer process  
   96   100   100   100 ?           -1 Ss      26   0:00 postgres: writer process  
   96   101   101   101 ?           -1 Ss      26   0:00 postgres: wal writer process  
   96   102   102   102 ?           -1 Ss      26   0:00 postgres: autovacuum launcher process  
   96   103   103   103 ?           -1 Ss      26   0:00 postgres: stats collector process  
   62   104   104    41 ?          104 R+      26   0:00 ps axj

-bash-4.3$ exit
logout
[root@9c288ce17b6f /]# kill -9 33
[root@9c288ce17b6f /]# [eric@almond Devel]$ 

/ Nu stoppen we de container weer	, nu door de laatste, sshd te kill	,

/ 7	. 


/ Einde DOCKER SSHD POSTGRES

/ POSTGRES

/ 7	. 

/ als postgres is ingelogd, dan hij psql doen, psql -U postgres hoeft niet	,

/ op host	,
[eric@almond postgres]$ sudo su - postgres
-bash-4.3$ psql																					
psql (9.4.8)
Type "help" for help.

postgres=# \q
-bash-4.3$ exit
logout
[eric@almond postgres]$

/ 7	. 

/ <<-SQL 	, de - is ervoor dat we de sluit-SQL kunnen indent	, 
/ de sql ertussen maakt niet uit	,

psql -U postgres<<SQL
  create table if not exists t(s varchar(32));
  insert into t values('');
  select*from t;
  drop table t;
SQL

/ Dit is gemaakt voor situaties als	,

sudo su - postgres<<BASH
	psql <<-SQL
  	create table if not exists t(s varchar(32));
  	insert into t values('');
  	select*from t;
  	drop table t;
	SQL
BASH

/ Let op: de sluit SQL moet met een tab	, NIET met spaces	,

/ Einde POSTGRES

/ AWK SED

/ 7	. 

/ user postgres wil in pg_hba.conf veranderen	, 
local   all             all                                     peer 
->
local   all             all                                     trust 
/ en	,
host    all             all             ::1/128                 ident 
->
host    all             all             ::1/128                 password 

bash-4.3$ cat /home/eric/pgsql/data/pg_hba.conf 
...
# "local" is for Unix domain socket connections only
local   all             all                                     peer 
# IPv4 local connections:
host    all             all             127.0.0.1/32            ident
# IPv6 local connections:
host    all             all             ::1/128                 ident 
# Allow replication connections from localhost, by a user with the
# replication privilege.
#local   replication     postgres                                peer
#host    replication     postgres        127.0.0.1/32            ident
#host    replication     postgres        ::1/128                 ident


/ 13	.

/ Geef in google	,

awk change column value
http://unix.stackexchange.com/questions/136322/how-to-replace-the-content-of-a-specific-column-with-awk
awk change line
http://stackoverflow.com/questions/9503159/change-a-line-with-awk
awk gsub replaces   tab by space
http://stackoverflow.com/questions/15501242/how-to-make-awk-gsub-return-a-tab-separated-line


/ Let op verschil	, print alleen veranderde line	, of hele file	(met veranderde line)	,

bash-4.3$ awk '/^local/{$4="trust";print}' /home/eric/pgsql/data/pg_hba.conf 
local all all trust 

bash-4.3$ awk '/^local/{$4="peer"}{print}' /home/eric/pgsql/data/pg_hba.conf 
...
# "local" is for Unix domain socket connections only
local all all trust
# IPv4 local connections:
host    all             all             127.0.0.1/32            ident
# IPv6 local connections:
host    all             all             ::1/128                 ident 
# Allow replication connections from localhost, by a user with the
# replication privilege.
#local   replication     postgres                                peer
#host    replication     postgres        127.0.0.1/32            ident
#host    replication     postgres        ::1/128                 ident

/ we zien dat OK	, maar de spaces ertussen zijn we kwijt	, 
/ we probeerden	,
bash-4.3$ awk 'BEGIN{FS ~ /\t/;OFS="\t"}/^local/{$4="trust";print}' /home/eric/pgsql/data/pg_hba.conf 
local		all		all 	trust	
/ TODO

/ 13	. 

/ sed werkt OK	, maar werkt niet met columns	, dus je moet weten wat er in de column staat	,

bash-4.3$ sed '/^local/ s/peer/trust/' /home/eric/pgsql/data/pg_hba.conf
...
# "local" is for Unix domain socket connections only
local   all             all                                     trust 
# IPv4 local connections:
host    all             all             127.0.0.1/32            ident
# IPv6 local connections:
host    all             all             ::1/128                 password 
# Allow replication connections from localhost, by a user with the
# replication privilege.
#local   replication     postgres                                peer
#host    replication     postgres        127.0.0.1/32            ident
#host    replication     postgres        ::1/128                 ident

/ 13	. 

/ de tweede line	,
bash-4.3$ awk '/^host/ && /::1\/128/{$5="password"}{print}' /home/eric/pgsql/data/pg_hba.conf 
# "local" is for Unix domain socket connections only
local 	all 		all 				  	peer	
# IPv4 local connections:
host    all             all             127.0.0.1/32            ident
# IPv6 local connections:
host all all ::1/128 password																								<-
# Allow replication connections from localhost, by a user with the
# replication privilege.
#local   replication     postgres                                peer
#host    replication     postgres        127.0.0.1/32            ident
#host    replication     postgres        ::1/128                 ident

/ 13	. 

/ Met sed 	,
/ we hebben 2 conditions	, dit kan op eveneens 2 manieren	,

bash-4.3$ sed '/^host.*::1\/128/s/ident/password/' /home/eric/pgsql/data/pg_hba.conf  
/ of	,
bash-4.3$ sed '/^host/{/::1\/128/s/ident/password/}' /home/eric/pgsql/data/pg_hba.conf  
...
# "local" is for Unix domain socket connections only
local   all             all                                     peer
# IPv4 local connections:
host    all             all             127.0.0.1/32            ident
# IPv6 local connections:
host    all             all             ::1/128                 password
# Allow replication connections from localhost, by a user with the
# replication privilege.
#local   replication     postgres                                peer
#host    replication     postgres        127.0.0.1/32            ident
#host    replication     postgres        ::1/128                 ident

/ 13	. 

/ Dus we doen	

bash-4.3$ cat /home/eric/pgsql/data/pg_hba.conf 
# "local" is for Unix domain socket connections only
local   all             all                                     peer
# IPv4 local connections:
host    all             all             127.0.0.1/32            ident
# IPv6 local connections:
host    all             all             ::1/128                 password

bash-4.3$ sed -i '/^host/{/::1\/128/s/ident/password/}' /home/eric/pgsql/data/pg_hba.conf  

bash-4.3$ cat /home/eric/pgsql/data/pg_hba.conf  
...
# "local" is for Unix domain socket connections only
local   all             all                                     peer
# IPv4 local connections:
host    all             all             127.0.0.1/32            ident
# IPv6 local connections:
host    all             all             ::1/128                 password

bash-4.3$ sed -i '/^local/s/peer/trust/' /home/eric/pgsql/data/pg_hba.conf   

bash-4.3$ cat /home/eric/pgsql/data/pg_hba.conf  
...
# "local" is for Unix domain socket connections only
local   all             all                                     trust
# IPv4 local connections:
host    all             all             127.0.0.1/32            ident
# IPv6 local connections:
host    all             all             ::1/128                 password

sed: -e expression #1, char 14: unknown command: `1'



/ Einde AWK SED

/ BASH

[eric@almond volume]$ sudo rm -rf /var/lib/pgsql/data/*
/ NIETS	, 
[eric@almond volume]$ sudo ls /var/lib/pgsql/data/*
ls: cannot access /var/lib/pgsql/data/*: No such file or directory

/ Lees	, 
http://unix.stackexchange.com/questions/101847/cannot-expand-asterisk-without-proper-permission

The shell that's doing the expansion of the * wildcard is the shell where you type it. If the shell has the permission to read the list of files in the directory, then it expands /temp/sit/build/* to /temp/sit/build/file, and runs sudo with the arguments ls, -l and /temp/sit/build/file. If the shell is unable to find any match for /temp/sit/build/* (whether it's because there are no matches, or because the shell has no permission to see the matches), then it leaves the pattern alone, and sudo is called with the arguments ls, -l and /temp/sit/build/*.

Since there is no file called /temp/sit/build/*, the ls command complains if you pass it that name. Recall that ls doesn't expand wildcards, that's the shell's job.

If you want wildcard expansion to happen in a directory where you don't have read permission, then the expansion must happen in a shell that's started by sudo instead of in the shell that calls sudo. sudo doesn't automatically start a shell, you need to do that explicitly.



[eric@almond volume]$ sudo bash -c "ls /var/lib/pgsql/data/*"
/var/lib/pgsql/data/pg_hba.conf    /var/lib/pgsql/data/postgresql.auto.conf
...
[eric@almond volume]$ sudo bash -c "echo rm -rf  /var/lib/pgsql/data/*"
rm -rf /var/lib/pgsql/data/base /var/lib/pgsql/data/global /var/lib/pgsql/data/pg_clog /var/lib/pgsql/data/pg_dynshmem /var/lib/pgsql/data/pg_hba.conf /var/lib/pgsql/data/pg_ident.conf /var/lib/pgsql/data/pg_log /var/lib/pgsql/data/pg_logical /var/lib/pgsql/data/pg_multixact /var/lib/pgsql/data/pg_notify /var/lib/pgsql/data/pg_replslot /var/lib/pgsql/data/pg_serial /var/lib/pgsql/data/pg_snapshots /var/lib/pgsql/data/pg_stat /var/lib/pgsql/data/pg_stat_tmp /var/lib/pgsql/data/pg_subtrans /var/lib/pgsql/data/pg_tblspc /var/lib/pgsql/data/pg_twophase /var/lib/pgsql/data/PG_VERSION /var/lib/pgsql/data/pg_xlog /var/lib/pgsql/data/postgresql.auto.conf /var/lib/pgsql/data/postgresql.conf

[eric@almond volume]$ sudo bash -c "rm -rf  /var/lib/pgsql/data/*"
[eric@almond volume]$ sudo ls /var/lib/pgsql/data
/ LEEG	,
[eric@almond volume]$  







/ Einde BASH

/ POSTGRES ECPG

https://www.postgresql.org/docs/9.3/static/ecpg-commands.html

/ Einde POSTGRES ECPG

/ POSTGRES

/ Lees	,
https://fedoraproject.org/wiki/PostgreSQL

[root@almond ~]# dnf list postgres*
...
postgresql-jdbc.noarch                                         9.4.1200-2.fc23                            fedora 
/ TODO

[root@almond ~]#  dnf install postgresql-server postgresql-contrib
Last metadata expiration check: 0:05:27 ago on Sun Jul 24 08:20:54 2016.
Dependencies resolved.
=================================================================================================================
 Package                          Arch                 Version                       Repository             Size
=================================================================================================================
Installing:
 postgresql                       x86_64               9.4.8-1.fc23                  updates               1.1 M
 postgresql-contrib               x86_64               9.4.8-1.fc23                  updates               635 k
 postgresql-libs                  x86_64               9.4.8-1.fc23                  updates               240 k
 postgresql-server                x86_64               9.4.8-1.fc23                  updates               4.0 M
 uuid                             x86_64               1.6.2-31.fc23                 fedora                 60 k

[root@almond ~]# postgresql-setup  --initdb --unit postgresql
 * Initializing database in '/var/lib/pgsql/data'
 * Initialized, logs are in /var/lib/pgsql/initdb_postgresql.log
/ OK op laptop, ERR in docker	

/ 13	. 

/ we kunnen opnieuw postgresql-setup	, als we eerst PGDATA leeg maken	,

[root@almond ~]# cd /var/lib/pgsql/data/
[root@almond data]# ls
base         pg_ident.conf  pg_replslot   pg_subtrans  postgresql.auto.conf
global       pg_log         pg_serial     pg_tblspc    postgresql.conf
pg_clog      pg_logical     pg_snapshots  pg_twophase
pg_dynshmem  pg_multixact   pg_stat       PG_VERSION
pg_hba.conf  pg_notify      pg_stat_tmp   pg_xlog
[root@almond data]# rm -rf *

[root@almond ~]# postgresql-setup  --initdb --unit postgresql
 * Initializing database in '/var/lib/pgsql/data'
 * Initialized, logs are in /var/lib/pgsql/initdb_postgresql.log

/ 13	. 

/ Lees	,
http://www.rodericksmith.plus.com/outlines/manuals/bashdbOutline.html

[root@almond ~]# bash /usr/bin/bashdb -- /usr/bin/postgresql-setup  --initdb --unit postgresql
bashdb<0> c
 * Initializing database in '/var/lib/pgsql/data'
 * Initialized, logs are in /var/lib/pgsql/initdb_postgresql.log
/ OK	, 
/ Maar $0=/usr/bin/bashdb
/ TODO

/ we hadden eerst	,
[root@almond ~]# bash --debugger postgresql-setup  initdb
/ Ook OK, maar dit is truc, omdat ERR	, met options	,
[root@almond ~]# bash --debugger  postgresql-setup  --initdb --unit postgresql
/ TODO


/ Einde POSTGRES

/ DEBUG POSTGRESQL-SETUP

[root@almond data]# pwd
/var/lib/pgsql/data
[root@almond data]# rm -rf *

[root@almond ~]# bash /usr/bin/bashdb -- /usr/bin/postgresql-setup  --initdb --unit postgresql
...
595:    args=`getopt -o "$short_opts" -l "$long_opts" -n "postgresql-setup" -- "$@"` \
596:        || die "can't parse arguments"
/ pr $args 
/ TODO
597: => eval set -- "$args"
set -- --initdb --unit 'postgresql' --
/ TODO (laatste --)

while true; do
    case "$1" in
        --initdb|--upgrade)

bashdb<52> pr $1
--initdb
bashdb<53> pr $2
--unit
bashdb<54> pr $3
postgresql
bashdb<55> pr $4
--
/ TODO

            else
                option_mode=${1##--}
bashdb<61> pr $option_mode
initdb

            shift
/ volgende	,
while true; do
    case "$1" in
        --unit|--service)
            option_service=$2
            shift 2

/ volgende	,
   case "$1" in
        --)
            shift
            break
            ;;

bashdb<73> pr $option_mode
initdb
bashdb<74> pr $option_service
postgresql

initdb_log="$POSTGRES_HOMEDIR/initdb_${option_service}.log"
bashdb<78> pr $POSTGRES_HOMEDIR
/var/lib/pgsql
bashdb<80> pr $initdb_log
/var/lib/pgsql/initdb_postgresql.log

693:	root_prereq
/s
19:	    test "$(id -u)" -eq 0 || die "$0 requires root access for this action"

bashdb<87> pr $(id -u)
0
/t
696:	service_configuration initdb pgdata UNUSED "$option_service"
/s
service_configuration()
    local mode="$1" datavar="$2" portvar="$3" service="$4"
bashdb<102> pr $mode
initdb
bashdb<104> pr $datavar
pgdata
bashdb<105> pr $portvar
UNUSED
bashdb<106> pr $service
postgresql

    if test "0" = 1; then
/ NEE
        # Sysvinit has the default PGDATA (for default unit name only)
/ TODO
   else
        # We ship two service files, postgresql.service and
        # postgresql@.service.  The former has PGDATA set by default
        # similarly to sysvinit case.
        handle_service_env "$service"
bashdb<112> s
    local service="$1"
postgresql

   local systemd_env="$(systemctl show -p Environment "${service}.service")" \
        || { return; }

bashdb<117> pr $systemd_env
Environment=PG_OOM_ADJUST_FILE=/proc/self/oom_score_adj PG_OOM_ADJUST_VALUE=0 PGSTARTTIMEOUT=270 PGDATA=/var/lib/pgsql/data


/ Intermezzo

[root@almond pgsql]# dnf repoquery -l postgresql-server
/usr/lib/systemd/system/postgresql.service
/usr/lib/systemd/system/postgresql@.service

# cat /usr/lib/systemd/system/postgresql.service

Environment=PG_OOM_ADJUST_FILE=/proc/self/oom_score_adj
Environment=PG_OOM_ADJUST_VALUE=0

# Maximum number of seconds pg_ctl will wait for postgres to start.  Note that
# PGSTARTTIMEOUT should be less than TimeoutSec value.
Environment=PGSTARTTIMEOUT=270

Environment=PGDATA=/var/lib/pgsql/data

/ Deze laatste entry bepaalt dat de data dir /var/lib/pgsql/data wordt	, 

/ Als user postgres initdb met de hand runs (ipv postgresql-setup)	, kan hij -D of --pgdata geven voor een andere data dir,	

/ Nogmaals : postgresql-setup haalt /var/lib/pgsql/data uit usr/lib/systemd/system/postgresql.service	, 

/ Einde Intermezzo

   for env_var in `echo "$systemd_env" | sed 's/^Environment=//'`; do
$env_var=
PG_OOM_ADJUST_VALUE=0
PGSTARTTIMEOUT=270
PGDATA=/var/lib/pgsql/data

        # If one variable name is defined multiple times the last definition wins.
        case "$env_var" in
            PGDATA=*)
                unit_pgdata="${env_var##PGDATA=}"
/var/lib/pgsql/data
                debug "unit's datadir: '$unit_pgdata'"
/t
->0 in file `/usr/bin/postgresql-setup' at line 490
489:            handle_service_env "$service"
/d
        handle_service_envfiles "$option_mode" "$service"
/s
(/usr/bin/postgresql-setup:411):
   local mode="$1"
initdb
    local service="$2"
postgresql
    local envfiles="$(systemctl show -p EnvironmentFiles "${service}.service")"\
        || return
""
417:	    test -z "$envfiles" && return
/t
(/usr/bin/postgresql-setup:496):

bashdb<144> pr $unit_pgdata
/var/lib/pgsql/data
bashdb<145> pr $envfile_pgdata
""

   # EnvironmentFile beats Environment configuration in systemd.  In sysvinit
    # there is no "unit_pgdata".  So make sure the envfile_gpdata is used later
    # than unit_pgdata.
    test -n "$unit_pgdata"      && set_var "$datavar" "$unit_pgdata"
bashdb<154> pr $unit_pgdata
/var/lib/pgsql/data
bashdb<153> pr $datavar
pgdata

/s
(/usr/share/postgresql-setup/library.sh:12):
set_var()
{
    eval "$1=\"$2\""
/t
////////////////////////////////////////////////
bashdb<96> pr $pgdata
/var/lib/pgsql/data

    test -n "$envfile_pgdata"   && set_var "$datavar" "$envfile_pgdata"
/ NIETS

   # skip for the first run
    test initdb = "$mode" && return
/ JA 
/ TODO
bashdb<164> pr $mode
initdb
/t
(/usr/bin/postgresql-setup:699):
    696 service_configuration initdb pgdata UNUSED "$option_service"
/d
   698 # Check that nothing breaks --new-systemd-unit
    699 if test "$option_systemd_config" = yes; then
/ NEE
   712 elif test -n "$option_pgdata"; then
/ NEE
17: => test "$pgdata" = default \
718:        && die $"no db datadir (PGDATA) configured for '$option_service$srvsuff' unit"
/ NEE
bashdb<170> pr $pgdata
/var/lib/pgsql/data

## GATHER DATA FROM INITIALIZED DATADIR ##

# This is mostly for 'initdb'.  We assume that the default port is $PGPORT_DEF
# if not set explicitly for default service name 'postgresql'.
if test "$pgport" = default -a "$option_service" = "postgresql"; then
/ JA
    pgport=$PGPORT_DEF
5432

## LAST CHECK THE SETUP ##

check_daemon_reload
/s
check_daemon_reload() {
    local nr_option=NeedDaemonReload

    local nr_out="`systemctl show -p $nr_option $option_service.service 2>/dev/null`"
NeedDaemonReload=no
    if [[ "$nr_out" != "$nr_option=no" ]]; then
/ NEE
/t
(/usr/bin/postgresql-setup:788):
788:	export PGDATA=$pgdata
bashdb<196> pr $pgdata
/var/lib/pgsql/data
789:	export PGPORT=$pgport
bashdb<195> pr $pgport
5432

/ Intermezzo

[root@almond pgsql]# mountpoint /var/lib/pgsql/data/
/var/lib/pgsql/data/ is not a mountpoint

/ Einde Intermezzo

if /usr/bin/mountpoint -q "$pgdata" || /usr/bin/mountpoint -q "$(dirname "$pgdata")"; then
/ NEE

# See how we were called.
case "$option_mode" in
    initdb)
        initdb
bashdb<204> s
(/usr/bin/postgresql-setup:168):

173:	    info $"Initializing database in '$pgdata'$port_info"
bashdb<209> 
 * Initializing database in '/var/lib/pgsql/data'

    if check_not_initialized && perform_initdb; then
/s
check_not_initialized()
{
    if test -f "$pgdata/PG_VERSION"; then
/ NEE
bashdb<213> pr $PG_VERSION
""
/ TODO (Doen we niet aan?)
112:	    return 0
/t
/s
perform_initdb()
{
    if [ ! -e "$pgdata" ]; then
/ NEE

    # Clean up SELinux tagging for pgdata
    [ -x /sbin/restorecon ] && /sbin/restorecon "$pgdata"
/ TODO

    if [ ! -e "$initdb_log" -a ! -h "$initdb_log" ]; then
/ NEE	, 
/ is er al	,
/var/lib/pgsql/initdb_postgresql.log

/ POSTGRESQL-SETUP -> INITDB

    # Initialize the database
    initdbcmd=""
    initdbcmd+=" $PGENGINE/initdb --pgdata='$pgdata' --auth='ident'"
    initdbcmd+=" $PGSETUP_INITDB_OPTIONS"
bashdb<226> pr $initdbcmd
/usr/bin/initdb --pgdata='/var/lib/pgsql/data' --auth='ident'


    $SU_POSTGRES -c "$initdbcmd" >> "$initdb_log" 2>&1 < /dev/null

bashdb<227> pr $SU_POSTGRES
/usr/sbin/runuser -s /bin/sh -l postgres

/ Intermezzo

/ 7	. 

/ Lees over runuser	,	,
http://www.linuxnix.com/suid-set-suid-linuxunix/

/ Waarom een login shell (user postgres logs in)	?
/ WH om PATH, ... en cd home dir met .bash_profile	,	...


/ 7. 	

/ initdb doet	, 
[root@almond pgsql]# cat initdb_postgresql.log 

The files belonging to this database system will be owned by user "postgres".
This user must also own the server process.

The database cluster will be initialized with locale "en_US.UTF-8".
The default database encoding has accordingly been set to "UTF8".
The default text search configuration will be set to "english".

Data page checksums are disabled.

fixing permissions on existing directory /var/lib/pgsql/data ... ok
creating subdirectories ... ok
selecting default max_connections ... 100
selecting default shared_buffers ... 128MB
selecting dynamic shared memory implementation ... posix
creating configuration files ... ok
creating template1 database in /var/lib/pgsql/data/base/1 ... ok
initializing pg_authid ... ok
initializing dependencies ... ok
creating system views ... ok
loading system objects' descriptions ... ok
creating collations ... ok
creating conversions ... ok
creating dictionaries ... ok
setting privileges on built-in objects ... ok
creating information schema ... ok
loading PL/pgSQL server-side language ... ok
vacuuming database template1 ... ok
copying template1 to template0 ... ok
copying template1 to postgres ... ok
syncing data to disk ... ok

Success. You can now start the database server using:

    /usr/bin/postgres -D /var/lib/pgsql/data
or
    /usr/bin/pg_ctl -D /var/lib/pgsql/data -l logfile start

/ Einde Intermezzo

    143     # Create directory for postmaster log files
    144     mkdir "$pgdata/pg_log"
    145     chown postgres:postgres "$pgdata/pg_log"
    146     chmod go-rwx "$pgdata/pg_log"
    147     [ -x /sbin/restorecon ] && /sbin/restorecon "$pgdata/pg_log"

    163     test -f "$pgdata/PG_VERSION"
/t
ashdb<235> n
(/usr/bin/postgresql-setup:175):
    174     if check_not_initialized && perform_initdb; then
/d
819:	exit $script_result
0


/ Einde DEBUG POSTGRESQL-SETUP

/ JAVA

/ Page controller, Front controller , Application controller	, 

/ EJB has a controller ,  which connects to presentation tiers through business facade or delegate	,

/ Session facade / Business delegate	, 

/ http://martinfowler.com/bliki/TalkNotes.html
/ over databases	,








/ Einde JAVA

/ POSTGRES EXPLAIN

/ 7	. 

/ postgres server start	, 
$ sudo su - postgres
$ pg_ctl start

/ Lees	,
https://www.postgresql.org/docs/9.5/static/using-explain.html

[eric@almond Postgres]$ pwd
/home/eric/Devel/Postgres
[eric@almond Postgres]$ tar xvzf  ~/Downloads/postgresql-9.5.4.tar.gz 

/ Lees	,
https://www.postgresql.org/docs/current/static/install-short.html

https://www.postgresql.org/docs/9.5/static/datatype-numeric.html
/ serial	,

/ Lees	, 
http://www.tutorialspoint.com/postgresql/postgresql_using_autoincrement.htm

$ psql -E -U eric

eric=> create table t(i serial primary key,name text not null,age int not null,address char(50), salary real);
CREATE TABLE
eric=> commit;
COMMIT
eric=> insert into t(name,age,address,salary)values('foo bar',13,'gee 13',3.141529);
INSERT 0 1
eric=> insert into t(name,age,address,salary)values('foo bar',13,'gee 13',3.141529);
INSERT 0 1
eric=> select*from t;
 i |  name   | age |                      address                       | salary  
---+---------+-----+----------------------------------------------------+---------
 1 | foo bar |  13 | gee 13                                             | 3.14153
 2 | foo bar |  13 | gee 13                                             | 3.14153
(2 rows)
eric=> commit;
COMMIT

eric=> \d t
                            Table "public.t"
 Column  |     Type      |                   Modifiers                   
---------+---------------+-----------------------------------------------
 i       | integer       | not null default nextval('t_i_seq'::regclass)
 name    | text          | not null
 age     | integer       | not null
 address | character(50) | 
 salary  | real          | 
Indexes:
    "t_pkey" PRIMARY KEY, btree (i)

/ we zien dat serial niet een echte type is	, het wordt een int	, met een sequence	, 

eric=> \ds
          List of relations
 Schema |  Name   |   Type   | Owner 
--------+---------+----------+-------
 public | t_i_seq | sequence | eric
(1 row)

/ we hadden ook kunnen doen	,

eric=> create sequence s_j_seq;
eric=> commit;

/ primary key is automatisch not-null	,
eric=> create table s(j int primary key);
CREATE TABLE
eric=> commit ;
COMMIT
eric=> insert into s values(null);
ERROR:  null value in column "j" violates not-null constraint

eric=> create table s(j int primary key default nextval('s_j_seq'));
eric=> alter table s add column name text not null;
eric=> \d s
	                        Table "public.s"
 Column |  Type   |                   Modifiers                   
--------+---------+-----------------------------------------------
 j      | integer | not null default nextval('s_j_seq'::regclass)
 name   | text    | not null

eric=> insert into s(name)values('foo');
INSERT 0 1
eric=> insert into s(name)values('bar');
INSERT 0 1
eric=> commit ;
COMMIT
eric=> select*from s;
 j | name 
---+------
 1 | foo
 2 | bar
(2 rows)

/ default moet erbij	,
eric=> create table s(j int primary key nextval('s_j_seq'));
ERROR:  syntax error at or near "nextval"

/ 13	. 

/ Lees	, 
https://www.compose.com/articles/postgresql-series-random-with/

/ Lees	,
http://stackoverflow.com/questions/24841142/how-can-i-generate-big-data-sample-for-postgresql-using-generate-series-and-rand


/ Lees Ch 47	, Overview of PostgreSQL Internals	, 
https://www.postgresql.org/docs/9.4/static/overview.html

/ 7	. 


/ HIER HIER HIER






/ Einde POSTGRES EXPLAIN

/ POSTGRES TIME
`
/ 13	. 

/ Binnen een tx is now() constant, maar timeofday() niet	,

/ Lees	,
https://www.postgresql.org/message-id/20020418144134.A16277@zf.jcu.cz


eric=> select now();
              now              
-------------------------------
 2016-08-28 14:49:08.210259+02
(1 row)

eric=> select now();
              now              
-------------------------------
 2016-08-28 14:49:08.210259+02
(1 row)

eric=> select timeofday();
              timeofday               
--------------------------------------
 Sun Aug 28 15:08:19.341086 2016 CEST
(1 row)

eric=> select timeofday();
              timeofday               
--------------------------------------
 Sun Aug 28 15:08:20.927555 2016 CEST
(1 row)


eric=>  select now()::timestamp;
            now             
----------------------------
 2016-08-28 14:43:19.844146
(1 row)
eric=>  select now();
              now              
-------------------------------
 2016-08-28 14:43:19.844146+02
(1 row)


/ 13	. 

/ Lees	,
http://stackoverflow.com/questions/20812091/now-without-timezone

eric=>  SELECT current_setting('TimeZone');
 current_setting  
------------------
 Europe/Amsterdam
(1 row)

eric=>  SELECT now() AT TIME ZONE current_setting('TimeZone');
          timezone          
----------------------------
 2016-08-28 14:43:19.844146
(1 row)

SELECT now() AT TIME ZONE 'Europe/Paris';

eric=> select timeofday() at time zone 'utc';
ERROR:  function pg_catalog.timezone(unknown, text) does not exist
LINE 1: select timeofday() at time zone 'utc';
/ TODO

/ 13	. 

/ lees	, 
http://www.timeanddate.com/time/zones/cest

Central European Summer Time (CEST) is 2 hours ahead of Coordinated Universal Time. This time zone is a Daylight Saving Time time zone and is used in: Europe, Antarctica.

The abbreviation for Coordinated Universal Time is UTC. Why is it not abbreviated as CUT or TUC?

Greenwich Mean Time (GMT) is often interchanged or confused with Coordinated Universal Time (UTC). But GMT is a time zone and UTC is a time standard.

UTC, GMT and Daylight Saving Time
Neither UTC nor GMT ever change for Daylight Saving Time (DST). However, some of the countries that use GMT switch to different time zones during their DST period.
For example, the United Kingdom is not on GMT all year, it uses British Summer Time (BST), which is one hour ahead of GMT, during the summer months.

/ utc=Coordinated Universal Time

/ cest=central european summer time
CEST will be observed in Brussels, Troll Station until 30 Oct 2016, 03:00
UTC Offset: UTC +2

Winter Time & DST
This time zone is a daylight saving/summer time zone, in the winter some places will switch to the corresponding standard time zone: CET (Central European Time).

/ 13	. 

/ Lees	,
http://stackoverflow.com/questions/25456465/postgres-timestamp-with-timezone

eric=> select pg_typeof(now());
        pg_typeof         
--------------------------
 timestamp with time zone
(1 row)
eric=> select pg_typeof(timeofday());
 pg_typeof 
-----------
 text
(1 row)

/ 13	. 

eric=> select timeofday();
              timeofday               
--------------------------------------
 Mon Aug 29 19:54:09.817788 2016 CEST
(1 row)

eric=> select timeofday()::timestamp with time zone;
           timeofday           
-------------------------------
 2016-08-29 19:51:58.061114+02
(1 row)

eric=> select timeofday()::timestamp with time zone at time zone 'America/New_York';
          timezone          
----------------------------
 2016-08-29 13:53:14.538623
(1 row)

eric=> select timeofday()::timestamp  at time zone 'America/New_York';
           timezone            
-------------------------------
 2016-08-30 01:55:17.561947+02
(1 row)
/ TODO 

/ MORGENAVOND



/ Einde POSTGRES TIME

/ POSTGRES SERVER CONFIGURATION  

https://www.postgresql.org/docs/9.5/static/config-setting.html

eric=>  select current_setting('timezone');
 current_setting  
------------------
 Europe/Amsterdam
(1 row)

eric=> show timezone;
     TimeZone     
------------------
 Europe/Amsterdam
(1 row)


/ pg_settings: session config	/ 
/ TODO

/ 13	. 

/ Lees	,
http://stackoverflow.com/questions/3267769/show-query-result-column-types-postgresql



eric=> select pg_typeof(1);
 pg_typeof 
-----------
 integer
(1 row)

eric=> select pg_typeof(now());
        pg_typeof         
--------------------------
 timestamp with time zone
(1 row)

eric=> select pg_typeof(timeofday());
 pg_typeof 
-----------
 text
(1 row)

/ Maar het kan ook zo	, 

eric=> create table u as select now();
SELECT 1
eric=> \d u
               Table "public.u"
 Column |           Type           | Modifiers 
--------+--------------------------+-----------
 now    | timestamp with time zone | 

eric=> create table u as select timeofday();
eric=> \d u 
SELECT 1
       Table "public.u"
  Column   | Type | Modifiers 
-----------+------+-----------
 timeofday | text | 

/ 13	. 

eric=> select now()::timestamp with time zone;
/=
eric=> select now();															/ default 
              now              
-------------------------------
 2016-08-28 22:10:55.414653+02
(1 row)

eric=> select now()::timestamp without time zone;
/=
eric=> select now()::timestamp										/ timestamp=timestamp without time zone	,
            now             
----------------------------
 2016-08-28 22:10:55.414653
(1 row)

eric=>  select timeofday();
              timeofday               
--------------------------------------
 Sun Aug 28 22:15:56.099947 2016 CEST
(1 row)
eric=>  select timeofday()::timestamp;
         timeofday          
----------------------------
 2016-08-28 22:18:00.427479
(1 row)

eric=>  select timeofday()::timestamp with time zone;
           timeofday           
-------------------------------
 2016-08-28 22:18:07.025969+02
(1 row)










/ Einde POSTGRES SERVER CONFIGURATION  

/ POSTGRES GENERATE_SERIES 

/ Lees	, 
https://www.postgresql.org/docs/9.5/static/datatype-numeric.html

/ Lees	,
https://www.postgresql.org/docs/9.5/static/functions-srf.html
9.24. Set Returning Functions

eric=> select generate_series('2016-01-01'::date,'2016-02-01','15 days');
    generate_series     
------------------------
 2016-01-01 00:00:00+01
 2016-01-16 00:00:00+01
 2016-01-31 00:00:00+01
(3 rows)

eric=> select generate_series('2016-01-01'::timestamp,'2016-01-03','10 hours');
   generate_series   
---------------------
 2016-01-01 00:00:00
 2016-01-01 10:00:00
 2016-01-01 20:00:00
 2016-01-02 06:00:00
 2016-01-02 16:00:00
(5 rows)


create table town (
id serial primary key, 
code varchar(10) not null, 
article text,
name text not null, 
--department varchar(4) not null references department(code),
unique(code, department)

insert into towns (
    code, article, name, department
)
select
    left(md5(i::text), 10),
    md5(random()::text),
    md5(random()::text),
    left(md5(random()::text), 4)
from generate_series(1, 1000000) s(i)

/ Einde POSTGRES GENERATE_SERIES 

/ OPEN IN CHROME

https://www.postgresql.org/docs/9.5/static/functions-srf.html
http://stackoverflow.com/questions/25456465/postgres-timestamp-with-timezone			!
https://www.postgresql.org/docs/9.5/static/using-explain.html
http://ipv6.com/articles/general/IPv6-Addressing.htm
http://stackoverflow.com/questions/38898217/cannot-connect-to-local-machine-by-name
https://fedoraproject.org/wiki/PostgreSQL
https://www.postgresql.org/docs/9.1/static/creating-cluster.html									!
https://www.postgresql.org/docs/9.1/static/multibyte.html
https://wiki.postgresql.org/wiki/First_steps
https://www.postgresql.org/download/linux/ubuntu/
https://www.postgresql.org/docs/9.3/static/app-initdb.html
https://www.postgresql.org/docs/9.1/static/auth-pg-hba-conf.html
http://mherman.org/blog/2016/03/13/designing-a-restful-api-with-node-and-postgres/#.V4qVSmF97eQ	 			!
https://github.com/docker-library/postgres/blob/master/9.5/docker-entrypoint.sh

http://www.postmind.net/pgxl_docker-en.html																				!
http://pgsnaga.blogspot.nl/2014/06/deploying-postgres-xl-in-2-minutes-with.html
http://www.postgres-xl.org/download/





http://dave.cheney.net/tag/golang-3						!
https://www.youtube.com/watch?v=f6kdp27TYZs
https://blog.golang.org/strings
https://tour.golang.org/concurrency/1

https://www.centos.org/forums/viewtopic.php?t=54416
https://fedoraproject.org/wiki/Changes/Glibc_locale_subpackaging
https://docs.fedoraproject.org/en-US/Fedora/22/html/System_Administrators_Guide/ch-System_Locale_and_Keyboard_Configuration.html
http://unicode.org/charts/PDF/U0370.pdf
http://askubuntu.com/questions/162391/how-do-i-fix-my-locale-issue
http://unix.stackexchange.com/questions/75341/specify-the-sort-order-with-lc-collate-so-lowercase-is-before-uppercase
http://thomas-cokelaer.info/blog/2011/05/fedora-how-to-add-a-sudo-user-and-avoid-password/
https://fedoramagazine.org/managing-packages-fedora-dnf/
http://unix.stackexchange.com/questions/59243/tar-removing-leading-from-member-names/59246





http://www.grymoire.com/Unix/Sed.html


https://en.wikipedia.org/wiki/Order_statistic
https://en.wikipedia.org/wiki/Qubit
https://en.wikipedia.org/wiki/Momentum_operator

http://getbootstrap.com/css/#forms
https://github.com/gowravshekar/bootstrap-webpack				/ HTML/CSS3->Bootstrap

https://www.npmjs.com/package/body-parser								/ JavaScript-> Nodejs
http://bluebirdjs.com/docs/why-promises.html						/ JavaScript-> React
https://github.com/jprichardson/node-jsonfile/blob/master/index.js			/ JavaScript-> Nodejs




http://campus.codeschool.com/courses/powering-up-with-react/level/5/section/2/video


https://bugzilla.redhat.com/show_bug.cgi?id=1343114
http://stackoverflow.com/questions/25211198/docker-how-to-change-repository-name-or-rename-image
https://gist.github.com/naoya/5821987																																	/docker sshd	,
https://github.com/ncoghlan/fedbuildenv/blob/09a18d91e7af64a45394669bac2595a4b628960d/Dockerfile#L26	/ TODO
http://www.yegor256.com/2014/08/29/docker-non-root.html																									!
http://jaredmarkell.com/docker-and-locales/
https://github.com/docker-training/postgres/blob/master/Dockerfile
https://training.docker.com/
https://github.com/tianon/docker-brew-ubuntu-core/blob/e68c4b0d4c860a8e0547cfea6f1b07f0adb9ff46/xenial/Dockerfile
https://github.com/docker-library/official-images/blob/master/library/aerospike
http://crosbymichael.com/advanced-docker-volumes.html          											!
https://hub.docker.com/r/cockroachdb/cockroach/






https://facebook.github.io/flux/docs/todo-list.html#content
https://www.youtube.com/watch?list=PLb0IAmt7-GS188xDYE-u1ShQmFFGbrk0v&v=nYkdrAPrdcw
https://facebook.github.io/flux/

http://redhatstackblog.redhat.com/2016/07/25/introduction-to-red-hat-openstack-platform-director/		/ Cloud->RDO

http://kubernetes.io/docs/getting-started-guides/binary_release/

https://www.youtube.com/watch?v=HJ38vBIZOdA
http://developers.redhat.com/blog/2016/07/18/jboss-eap-7-on-openshift/
http://developers.redhat.com/products/cdk/overview/
https://mail.google.com/mail/u/0/?zx=xij7tkenoomy#search/redhat/155df7cc01fff8a1
http://www.meetup.com/JBoss-User-Group-Worldwide/events/228454602/
http://devops-assess.rhcloud.com/

http://www.javaworld.com/article/3060078/big-data/big-data-messaging-with-kafka-part-1.html


/ Deze laten we open	,
https://console.cloud.google.com/kubernetes/add?project=web-server-project-1148
https://console.cloud.google.com/launcher?project=web-server-project-1148&cat=INFRASTRUCTURE
https://cloud.google.com/container-engine/docs/quickstart
https://console.cloud.google.com/home/dashboard?project=web-server-project-1148
http://googlecloudplatform.github.io/																							!
https://docs.docker.com/v1.11/engine/userguide/containers/networkingcontainers/
https://docs.docker.com/v1.11/engine/reference/builder/#add
https://docs.docker.com/v1.11/engine/userguide/eng-image/dockerfile_best-practices/#entrypoint
http://crosbymichael.com/advanced-docker-volumes.html
http://www.javaworld.com/article/3060078/big-data/big-data-messaging-with-kafka-part-1.html
http://www.postgres-xl.org/download/
http://pgsnaga.blogspot.nl/2014/06/deploying-postgres-xl-in-2-minutes-with.html
http://www.postmind.net/pgxl_docker-en.html
http://devops-assess.rhcloud.com/
http://www.meetup.com/JBoss-User-Group-Worldwide/events/228454602/
https://mail.google.com/mail/u/0/?zx=xij7tkenoomy#search/redhat/155df7cc01fff8a1
http://developers.redhat.com/products/cdk/overview/
http://developers.redhat.com/blog/2016/07/18/jboss-eap-7-on-openshift/
http://kubernetes.io/docs/getting-started-guides/binary_release/
http://redhatstackblog.redhat.com/2016/07/25/introduction-to-red-hat-openstack-platform-director/
https://www.cockroachlabs.com/docs/start-a-local-cluster.html
https://tour.golang.org/concurrency/1
https://www.youtube.com/watch?v=f6kdp27TYZs




/ Einde OPEN IN CHROME
